/*! For license information please see bundle.29a6740e24c3847885b5.js.LICENSE.txt */
(()=>{var t={13:(t,e,i)=>{self,t.exports=(()=>{var t={267:(t,e,i)=>{"use strict";i.d(e,{Z:()=>h});var n=i(81),r=i.n(n),s=i(645),o=i.n(s),a=i(110),l=o()(r());l.i(a.Z),l.push([t.id,'.b2022-kg-story *,\n.b2022-kg-story *::before,\n.b2022-kg-story *::after {\n  box-sizing: border-box;\n}\n\n.b2022-kg-story >* {\n  font-family: "Inter",sans-serif;\n  color: #343c3c;\n  margin: 0;\n  font-size: 13pt;\n  font-weight: 400;\n  line-height: 1.5;\n  -webkit-text-size-adjust: 100%;\n  -webkit-tap-highlight-color: rgba(0,0,0,0);\n}\n\n.b2022-kg-story .scrolly-vis .scrollama-container {\n  position: relative;\n  display: flex;\n  flex-wrap: wrap;\n}\n\n.b2022-kg-story .scrolly-vis .scrollama-container .sticky-container {\n  position: sticky;\n  width: 100%;\n  height: 100%;\n  transform: translate3d(0, 0, 0);\n  z-index: 0;\n  flex-grow: 1;\n  flex-shrink: 1;\n  flex-basis: 0;\n  min-width: 300px;\n}\n\n.b2022-kg-story .scrolly-vis .scrollama-container .steps-container {\n  position: relative;\n  padding-left: 1rem;\n  padding-right: 1rem;\n  flex-grow: 1;\n  flex-shrink: 1;\n  flex-basis: 0;\n}\n\n.b2022-kg-story .scrolly-vis .step {\n  position: relative;\n  z-index: 1;\n  background: #f9f5f1;\n  padding: 1rem;\n  max-width: 450px;\n  min-width: 400px;\n  border-left: 4px solid #a5a9ad;\n  margin-left: auto;\n  margin-right: auto;\n}\n\n.b2022-kg-story .custom-vis-icons {\n  display: flex;\n  position: absolute;\n  top: 0;\n  right: 0;\n  font-size: 12pt;\n}\n\n.b2022-kg-story .custom-vis-icons img[data-bs-toggle=tooltip] {\n  cursor: pointer;\n}\n\n.b2022-kg-story .my-popover {\n  font-size: 12pt;\n}\n\n.b2022-kg-story .data-split-buttons {\n  display: flex;\n  justify-content: flex-end;\n  position: absolute;\n  bottom: 0;\n  right: 0;\n}\n\n.b2022-kg-story .data-split-buttons button {\n  background: #fff;\n}\n\n.b2022-kg-story .text-dark {\n  color: #343c3c !important;\n}\n\n.b2022-kg-story .my-badge {\n  padding-left: .2rem;\n  padding-right: .2rem;\n  padding-top: .1rem;\n  padding-bottom: .1rem;\n  border-radius: 5px;\n  white-space: nowrap;\n  background: #343c3c;\n  color: #fffffe;\n}\n\n.b2022-kg-story .my-badge-light {\n  color: #343c3c;\n  background-color: #fffffe;\n}\n\n.b2022-kg-story .my-badge-dark {\n  color: #fffffe;\n  background: #3b3b3b;\n}\n\n.b2022-kg-story .my-badge-light:hover {\n  background: #3b3b3b;\n  color: #fffffe;\n}\n\n.b2022-kg-story .my-badge-light-active {\n  background: #343c3c;\n  color: #fffffe;\n}\n\n.b2022-kg-story .my-badge-dark:hover {\n  color: #343c3c;\n  background: #fffffe;\n}\n\n.b2022-kg-story .bg-yellow-full {\n  background: #ffbf27 !important;\n}\n\n.b2022-kg-story .bg-yellow-muted {\n  background: #f9f5f0 !important;\n}\n\n.b2022-kg-story .border-purple-full {\n  border: 1px solid #666dd9 !important;\n}\n\n.b2022-kg-story .border-yellow-full {\n  border: 1px solid #ffbf27 !important;\n}\n\n.b2022-kg-story .color-yellow-full {\n  color: #ffbf27 !important;\n}\n\n.b2022-kg-story .bg-purple-full {\n  background: #666dd9 !important;\n}\n\n.b2022-kg-story .bg-purple-muted {\n  background: #eeeffe !important;\n}\n\n.b2022-kg-story .color-purple-full {\n  color: #666dd9 !important;\n}\n\n.b2022-kg-story .pointer {\n  cursor: pointer;\n}\n\n.b2022-kg-story .position-relative {\n  position: relative;\n}\n\n.b2022-kg-story .w-100 {\n  width: 100%;\n}\n\n.b2022-kg-story .h-100 {\n  height: 100%;\n}\n\n.b2022-kg-story .p-3 {\n  padding: 1rem;\n}\n\n.b2022-kg-story .my-0 {\n  margin-top: 0 !important;\n  margin-bottom: 0 !important;\n}\n\n.b2022-kg-story .mt-2 {\n  margin-top: .5rem !important;\n}\n\n.b2022-kg-story .me-1 {\n  margin-right: .25rem !important;\n}\n\n.b2022-kg-story .gender-legend {\n  position: absolute;\n  left: 10;\n  bottom: 0;\n}\n\n.b2022-kg-story .gender-legend .g-l-icon {\n  display: flex;\n  justify-items: center;\n  align-items: center;\n}\n\n.b2022-kg-story .gender-legend .g-l-shape {\n  height: 30px;\n  width: 30px;\n  border-radius: 15px;\n  margin-right: 5px;\n}\n\n.b2022-kg-story .gender-legend .g-l-label {\n  font-size: 10pt;\n}\n\n.b2022-kg-story .male-outline-fill {\n  border: 1px solid #0716d5;\n  background-color: #eff3f4;\n}\n\n.b2022-kg-story .female-outline-fill {\n  border: 1px solid #ffbf27;\n  background-color: #f9f5f0;\n}\n\n.b2022-kg-story .my-tooltip,\n.b2022-kg-story .my-popover {\n  color: #fff;\n}',""]);const h=l},110:(t,e,i)=>{"use strict";i.d(e,{Z:()=>a});var n=i(81),r=i.n(n),s=i(645),o=i.n(s)()(r());o.push([t.id,'.tippy-box[data-animation=fade][data-state=hidden]{opacity:0}[data-tippy-root]{max-width:calc(100vw - 10px)}.tippy-box{position:relative;background-color:#333;color:#fff;border-radius:4px;font-size:14px;line-height:1.4;white-space:normal;outline:0;transition-property:transform,visibility,opacity}.tippy-box[data-placement^=top]>.tippy-arrow{bottom:0}.tippy-box[data-placement^=top]>.tippy-arrow:before{bottom:-7px;left:0;border-width:8px 8px 0;border-top-color:initial;transform-origin:center top}.tippy-box[data-placement^=bottom]>.tippy-arrow{top:0}.tippy-box[data-placement^=bottom]>.tippy-arrow:before{top:-7px;left:0;border-width:0 8px 8px;border-bottom-color:initial;transform-origin:center bottom}.tippy-box[data-placement^=left]>.tippy-arrow{right:0}.tippy-box[data-placement^=left]>.tippy-arrow:before{border-width:8px 0 8px 8px;border-left-color:initial;right:-7px;transform-origin:center left}.tippy-box[data-placement^=right]>.tippy-arrow{left:0}.tippy-box[data-placement^=right]>.tippy-arrow:before{left:-7px;border-width:8px 8px 8px 0;border-right-color:initial;transform-origin:center right}.tippy-box[data-inertia][data-state=visible]{transition-timing-function:cubic-bezier(.54,1.5,.38,1.11)}.tippy-arrow{width:16px;height:16px;color:#333}.tippy-arrow:before{content:"";position:absolute;border-color:transparent;border-style:solid}.tippy-content{position:relative;padding:5px 9px;z-index:1}',""]);const a=o},645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i="",n=void 0!==e[5];return e[4]&&(i+="@supports (".concat(e[4],") {")),e[2]&&(i+="@media ".concat(e[2]," {")),n&&(i+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),i+=t(e),n&&(i+="}"),e[2]&&(i+="}"),e[4]&&(i+="}"),i})).join("")},e.i=function(t,i,n,r,s){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(n)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(o[l]=!0)}for(var h=0;h<t.length;h++){var c=[].concat(t[h]);n&&o[c[0]]||(void 0!==s&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=s),i&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=i):c[2]=i),r&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=r):c[4]="".concat(r)),e.push(c))}},e}},81:t=>{"use strict";t.exports=function(t){return t[1]}},99:function(t){t.exports=function(){"use strict";function t(t){console.error(`scrollama error: ${t}`)}function e(t){return+t.getAttribute("data-scrollama-index")}function i(t){if("string"==typeof t&&t.indexOf("px")>0){const e=+t.replace("px","");return isNaN(e)?(err("offset value must be in 'px' format. Fallback to 0.5."),{format:"percent",value:.5}):{format:"pixels",value:e}}return"number"!=typeof t&&isNaN(+t)?null:(t>1&&err("offset value is greater than 1. Fallback to 1."),t<0&&err("offset value is lower than 0. Fallback to 0."),{format:"percent",value:Math.min(Math.max(0,t),1)})}function n(t){const{top:e}=t.getBoundingClientRect();return e+window.pageYOffset-(document.body.clientTop||0)}let r,s,o;function a(t){const e=t?t.scrollTop:window.pageYOffset;r!==e&&(r=e,r>s?o="down":r<s&&(o="up"),s=r)}return function(){let l,h,c={},u=function(){const t="abcdefghijklmnopqrstuvwxyz",e=Date.now(),i=[];for(let e=0;e<6;e+=1){const e=t[Math.floor(Math.random()*t.length)];i.push(e)}return`${i.join("")}${e}`}(),d=[],f=0,p=!1,g=!1,v=!1,m=!1,y=[];function b(){c={stepEnter:()=>{},stepExit:()=>{},stepProgress:()=>{}},y=[]}function w(t){t&&!p&&O(),!t&&p&&E(),p=t}function _(t,i){const n=e(t),r=d[n];void 0!==i&&(r.progress=i);const s={element:t,index:n,progress:i,direction:o};"enter"===r.state&&c.stepProgress(s)}function x([t]){const i=e(t.target),n=d[i],r=t.target.offsetHeight;r!==n.height&&(n.height=r,S(n),T(n),A(n))}function k([t]){a(h);const{isIntersecting:i,target:n}=t;i?function(t,i=!0){const n=e(t),r=d[n],s={element:t,index:n,direction:o};r.direction=o,r.state="enter",y[n]||c.stepEnter(s),m&&(y[n]=!0)}(n):function(t,i=!0){const n=e(t),r=d[n];if(!r.state)return!1;const s={element:t,index:n,direction:o};g&&("down"===o&&r.progress<1?_(t,1):"up"===o&&r.progress>0&&_(t,0)),r.direction=o,r.state="exit",c.stepExit(s)}(n)}function C([t]){const i=e(t.target),n=d[i],{isIntersecting:r,intersectionRatio:s,target:o}=t;r&&"enter"===n.state&&_(o,s)}function S({observers:t}){Object.keys(t).map((e=>{t[e].disconnect()}))}function E(){d.forEach(S)}function A(t){const e=new ResizeObserver(x);e.observe(t.node),t.observers.resize=e}function T(t){const e=window.innerHeight,i=t.offset||l,n="pixels"===i.format?1:e,r=i.value*n,s=t.height/2-r,o=t.height/2-(e-r),a=new IntersectionObserver(k,{rootMargin:`${s}px 0px ${o}px 0px`,threshold:.5});a.observe(t.node),t.observers.step=a,v&&function({id:t,step:e,marginTop:i}){const{index:n,height:r}=e,s=`scrollama__debug-step--${t}-${n}`;let o=document.querySelector(`.${s}`);o||(o=function(t){const e=document.createElement("div");e.className=`scrollama__debug-step ${t}`,e.style.position="fixed",e.style.left="0",e.style.width="100%",e.style.zIndex="9999",e.style.borderTop="2px solid black",e.style.borderBottom="2px solid black";const i=document.createElement("p");return i.style.position="absolute",i.style.left="0",i.style.height="1px",i.style.width="100%",i.style.borderTop="1px dashed black",e.appendChild(i),document.body.appendChild(e),e}(s)),o.style.top=-1*i+"px",o.style.height=`${r}px`,o.querySelector("p").style.top=r/2+"px"}({id:u,step:t,marginTop:s,marginBottom:o})}function M(t){const e=window.innerHeight,i=t.offset||l,n="pixels"===i.format?1:e,r=i.value*n,s=`${-r+t.height}px 0px ${r-e}px 0px`,o=function(t,e){const i=Math.ceil(t/e),n=[],r=1/i;for(let t=0;t<i+1;t+=1)n.push(t*r);return n}(t.height,f),a=new IntersectionObserver(C,{rootMargin:s,threshold:o});a.observe(t.node),t.observers.progress=a}function O(){E(),d.forEach(A),d.forEach(T),g&&d.forEach(M)}const P={setup:({step:e,parent:o,offset:c=.5,threshold:u=4,progress:p=!1,once:y=!1,debug:_=!1,container:x})=>(function(t){r=0,s=0,document.addEventListener("scroll",(()=>a(t)))}(x),d=function(t,e=document){return"string"==typeof t?Array.from(e.querySelectorAll(t)):t instanceof Element?[t]:t instanceof NodeList?Array.from(t):t instanceof Array?t:[]}(e,o).map(((t,e)=>({index:e,direction:void 0,height:t.offsetHeight,node:t,observers:{},offset:i(t.dataset.offset),top:n(t),progress:0,state:void 0}))),d.length?(g=p,m=y,v=_,f=Math.max(1,+u),l=i(c),h=x,b(),function(t){t.forEach((t=>t.node.setAttribute("data-scrollama-index",t.index)))}(d),w(!0),P):(t("no step elements"),P)),enable:()=>(w(!0),P),disable:()=>(w(!1),P),destroy:()=>(w(!1),b(),P),resize:()=>(O(),P),offset:t=>null==t?l.value:(l=i(t),O(),P),onStepEnter:e=>("function"==typeof e?c.stepEnter=e:t("onStepEnter requires a function"),P),onStepExit:e=>("function"==typeof e?c.stepExit=e:t("onStepExit requires a function"),P),onStepProgress:e=>("function"==typeof e?c.stepProgress=e:t("onStepProgress requires a function"),P)};return P}}()},379:t=>{"use strict";var e=[];function i(t){for(var i=-1,n=0;n<e.length;n++)if(e[n].identifier===t){i=n;break}return i}function n(t,n){for(var s={},o=[],a=0;a<t.length;a++){var l=t[a],h=n.base?l[0]+n.base:l[0],c=s[h]||0,u="".concat(h," ").concat(c);s[h]=c+1;var d=i(u),f={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==d)e[d].references++,e[d].updater(f);else{var p=r(f,n);n.byIndex=a,e.splice(a,0,{identifier:u,updater:p,references:1})}o.push(u)}return o}function r(t,e){var i=e.domAPI(e);return i.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;i.update(t=e)}else i.remove()}}t.exports=function(t,r){var s=n(t=t||[],r=r||{});return function(t){t=t||[];for(var o=0;o<s.length;o++){var a=i(s[o]);e[a].references--}for(var l=n(t,r),h=0;h<s.length;h++){var c=i(s[h]);0===e[c].references&&(e[c].updater(),e.splice(c,1))}s=l}}},569:t=>{"use strict";var e={};t.exports=function(t,i){var n=function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}e[t]=i}return e[t]}(t);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(i)}},216:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},565:(t,e,i)=>{"use strict";t.exports=function(t){var e=i.nc;e&&t.setAttribute("nonce",e)}},795:t=>{"use strict";t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(i){!function(t,e,i){var n="";i.supports&&(n+="@supports (".concat(i.supports,") {")),i.media&&(n+="@media ".concat(i.media," {"));var r=void 0!==i.layer;r&&(n+="@layer".concat(i.layer.length>0?" ".concat(i.layer):""," {")),n+=i.css,r&&(n+="}"),i.media&&(n+="}"),i.supports&&(n+="}");var s=i.sourceMap;s&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleTagTransform(n,t,e.options)}(e,t,i)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},589:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},933:(t,e,i)=>{var n;!function(){function r(t,e,i){return t.call.apply(t.bind,arguments)}function s(t,e,i){if(!t)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,n),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function o(t,e,i){return(o=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?r:s).apply(null,arguments)}var a=Date.now||function(){return+new Date};function l(t,e){this.a=t,this.o=e||t,this.c=this.o.document}var h=!!window.FontFace;function c(t,e,i,n){if(e=t.c.createElement(e),i)for(var r in i)i.hasOwnProperty(r)&&("style"==r?e.style.cssText=i[r]:e.setAttribute(r,i[r]));return n&&e.appendChild(t.c.createTextNode(n)),e}function u(t,e,i){(t=t.c.getElementsByTagName(e)[0])||(t=document.documentElement),t.insertBefore(i,t.lastChild)}function d(t){t.parentNode&&t.parentNode.removeChild(t)}function f(t,e,i){e=e||[],i=i||[];for(var n=t.className.split(/\s+/),r=0;r<e.length;r+=1){for(var s=!1,o=0;o<n.length;o+=1)if(e[r]===n[o]){s=!0;break}s||n.push(e[r])}for(e=[],r=0;r<n.length;r+=1){for(s=!1,o=0;o<i.length;o+=1)if(n[r]===i[o]){s=!0;break}s||e.push(n[r])}t.className=e.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function p(t,e){for(var i=t.className.split(/\s+/),n=0,r=i.length;n<r;n++)if(i[n]==e)return!0;return!1}function g(t,e,i){function n(){a&&r&&s&&(a(o),a=null)}e=c(t,"link",{rel:"stylesheet",href:e,media:"all"});var r=!1,s=!0,o=null,a=i||null;h?(e.onload=function(){r=!0,n()},e.onerror=function(){r=!0,o=Error("Stylesheet failed to load"),n()}):setTimeout((function(){r=!0,n()}),0),u(t,"head",e)}function v(t,e,i,n){var r=t.c.getElementsByTagName("head")[0];if(r){var s=c(t,"script",{src:e}),o=!1;return s.onload=s.onreadystatechange=function(){o||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(o=!0,i&&i(null),s.onload=s.onreadystatechange=null,"HEAD"==s.parentNode.tagName&&r.removeChild(s))},r.appendChild(s),setTimeout((function(){o||(o=!0,i&&i(Error("Script load timeout")))}),n||5e3),s}return null}function m(){this.a=0,this.c=null}function y(t){return t.a++,function(){t.a--,w(t)}}function b(t,e){t.c=e,w(t)}function w(t){0==t.a&&t.c&&(t.c(),t.c=null)}function _(t){this.a=t||"-"}function x(t,e){this.c=t,this.f=4,this.a="n";var i=(e||"n4").match(/^([nio])([1-9])$/i);i&&(this.a=i[1],this.f=parseInt(i[2],10))}function k(t){var e=[];t=t.split(/,\s*/);for(var i=0;i<t.length;i++){var n=t[i].replace(/['"]/g,"");-1!=n.indexOf(" ")||/^\d/.test(n)?e.push("'"+n+"'"):e.push(n)}return e.join(",")}function C(t){return t.a+t.f}function S(t){var e="normal";return"o"===t.a?e="oblique":"i"===t.a&&(e="italic"),e}function E(t){var e=4,i="n",n=null;return t&&((n=t.match(/(normal|oblique|italic)/i))&&n[1]&&(i=n[1].substr(0,1).toLowerCase()),(n=t.match(/([1-9]00|normal|bold)/i))&&n[1]&&(/bold/i.test(n[1])?e=7:/[1-9]00/.test(n[1])&&(e=parseInt(n[1].substr(0,1),10)))),i+e}function A(t,e){this.c=t,this.f=t.o.document.documentElement,this.h=e,this.a=new _("-"),this.j=!1!==e.events,this.g=!1!==e.classes}function T(t){if(t.g){var e=p(t.f,t.a.c("wf","active")),i=[],n=[t.a.c("wf","loading")];e||i.push(t.a.c("wf","inactive")),f(t.f,i,n)}M(t,"inactive")}function M(t,e,i){t.j&&t.h[e]&&(i?t.h[e](i.c,C(i)):t.h[e]())}function O(){this.c={}}function P(t,e){this.c=t,this.f=e,this.a=c(this.c,"span",{"aria-hidden":"true"},this.f)}function R(t){u(t.c,"body",t.a)}function L(t){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+k(t.c)+";font-style:"+S(t)+";font-weight:"+t.f+"00;"}function I(t,e,i,n,r,s){this.g=t,this.j=e,this.a=n,this.c=i,this.f=r||3e3,this.h=s||void 0}function $(t,e,i,n,r,s,o){this.v=t,this.B=e,this.c=i,this.a=n,this.s=o||"BESbswy",this.f={},this.w=r||3e3,this.u=s||null,this.m=this.j=this.h=this.g=null,this.g=new P(this.c,this.s),this.h=new P(this.c,this.s),this.j=new P(this.c,this.s),this.m=new P(this.c,this.s),t=L(t=new x(this.a.c+",serif",C(this.a))),this.g.a.style.cssText=t,t=L(t=new x(this.a.c+",sans-serif",C(this.a))),this.h.a.style.cssText=t,t=L(t=new x("serif",C(this.a))),this.j.a.style.cssText=t,t=L(t=new x("sans-serif",C(this.a))),this.m.a.style.cssText=t,R(this.g),R(this.h),R(this.j),R(this.m)}_.prototype.c=function(t){for(var e=[],i=0;i<arguments.length;i++)e.push(arguments[i].replace(/[\W_]+/g,"").toLowerCase());return e.join(this.a)},I.prototype.start=function(){var t=this.c.o.document,e=this,i=a(),n=new Promise((function(n,r){!function s(){a()-i>=e.f?r():t.fonts.load(function(t){return S(t)+" "+t.f+"00 300px "+k(t.c)}(e.a),e.h).then((function(t){1<=t.length?n():setTimeout(s,25)}),(function(){r()}))}()})),r=null,s=new Promise((function(t,i){r=setTimeout(i,e.f)}));Promise.race([s,n]).then((function(){r&&(clearTimeout(r),r=null),e.g(e.a)}),(function(){e.j(e.a)}))};var D={D:"serif",C:"sans-serif"},N=null;function j(){if(null===N){var t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);N=!!t&&(536>parseInt(t[1],10)||536===parseInt(t[1],10)&&11>=parseInt(t[2],10))}return N}function B(t,e,i){for(var n in D)if(D.hasOwnProperty(n)&&e===t.f[D[n]]&&i===t.f[D[n]])return!0;return!1}function F(t){var e,i=t.g.a.offsetWidth,n=t.h.a.offsetWidth;(e=i===t.f.serif&&n===t.f["sans-serif"])||(e=j()&&B(t,i,n)),e?a()-t.A>=t.w?j()&&B(t,i,n)&&(null===t.u||t.u.hasOwnProperty(t.a.c))?z(t,t.v):z(t,t.B):function(t){setTimeout(o((function(){F(this)}),t),50)}(t):z(t,t.v)}function z(t,e){setTimeout(o((function(){d(this.g.a),d(this.h.a),d(this.j.a),d(this.m.a),e(this.a)}),t),0)}function U(t,e,i){this.c=t,this.a=e,this.f=0,this.m=this.j=!1,this.s=i}$.prototype.start=function(){this.f.serif=this.j.a.offsetWidth,this.f["sans-serif"]=this.m.a.offsetWidth,this.A=a(),F(this)};var G=null;function H(t){0==--t.f&&t.j&&(t.m?((t=t.a).g&&f(t.f,[t.a.c("wf","active")],[t.a.c("wf","loading"),t.a.c("wf","inactive")]),M(t,"active")):T(t.a))}function V(t){this.j=t,this.a=new O,this.h=0,this.f=this.g=!0}function q(t,e,i,n,r){var s=0==--t.h;(t.f||t.g)&&setTimeout((function(){var t=r||null,a=n||{};if(0===i.length&&s)T(e.a);else{e.f+=i.length,s&&(e.j=s);var l,h=[];for(l=0;l<i.length;l++){var c=i[l],u=a[c.c],d=e.a,p=c;if(d.g&&f(d.f,[d.a.c("wf",p.c,C(p).toString(),"loading")]),M(d,"fontloading",p),d=null,null===G)if(window.FontFace){p=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent);var g=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);G=p?42<parseInt(p[1],10):!g}else G=!1;d=G?new I(o(e.g,e),o(e.h,e),e.c,c,e.s,u):new $(o(e.g,e),o(e.h,e),e.c,c,e.s,t,u),h.push(d)}for(l=0;l<h.length;l++)h[l].start()}}),0)}function W(t,e){this.c=t,this.a=e}function Y(t,e){this.c=t,this.a=e}function X(t,e){this.c=t||K,this.a=[],this.f=[],this.g=e||""}U.prototype.g=function(t){var e=this.a;e.g&&f(e.f,[e.a.c("wf",t.c,C(t).toString(),"active")],[e.a.c("wf",t.c,C(t).toString(),"loading"),e.a.c("wf",t.c,C(t).toString(),"inactive")]),M(e,"fontactive",t),this.m=!0,H(this)},U.prototype.h=function(t){var e=this.a;if(e.g){var i=p(e.f,e.a.c("wf",t.c,C(t).toString(),"active")),n=[],r=[e.a.c("wf",t.c,C(t).toString(),"loading")];i||n.push(e.a.c("wf",t.c,C(t).toString(),"inactive")),f(e.f,n,r)}M(e,"fontinactive",t),H(this)},V.prototype.load=function(t){this.c=new l(this.j,t.context||this.j),this.g=!1!==t.events,this.f=!1!==t.classes,function(t,e,i){var n=[],r=i.timeout;!function(t){t.g&&f(t.f,[t.a.c("wf","loading")]),M(t,"loading")}(e),n=function(t,e,i){var n,r=[];for(n in e)if(e.hasOwnProperty(n)){var s=t.c[n];s&&r.push(s(e[n],i))}return r}(t.a,i,t.c);var s=new U(t.c,e,r);for(t.h=n.length,e=0,i=n.length;e<i;e++)n[e].load((function(e,i,n){q(t,s,e,i,n)}))}(this,new A(this.c,t),t)},W.prototype.load=function(t){function e(){if(s["__mti_fntLst"+n]){var i,r=s["__mti_fntLst"+n](),o=[];if(r)for(var a=0;a<r.length;a++){var l=r[a].fontfamily;null!=r[a].fontStyle&&null!=r[a].fontWeight?(i=r[a].fontStyle+r[a].fontWeight,o.push(new x(l,i))):o.push(new x(l))}t(o)}else setTimeout((function(){e()}),50)}var i=this,n=i.a.projectId,r=i.a.version;if(n){var s=i.c.o;v(this.c,(i.a.api||"https://fast.fonts.net/jsapi")+"/"+n+".js"+(r?"?v="+r:""),(function(r){r?t([]):(s["__MonotypeConfiguration__"+n]=function(){return i.a},e())})).id="__MonotypeAPIScript__"+n}else t([])},Y.prototype.load=function(t){var e,i,n=this.a.urls||[],r=this.a.families||[],s=this.a.testStrings||{},o=new m;for(e=0,i=n.length;e<i;e++)g(this.c,n[e],y(o));var a=[];for(e=0,i=r.length;e<i;e++)if((n=r[e].split(":"))[1])for(var l=n[1].split(","),h=0;h<l.length;h+=1)a.push(new x(n[0],l[h]));else a.push(new x(n[0]));b(o,(function(){t(a,s)}))};var K="https://fonts.googleapis.com/css";function Q(t){this.f=t,this.a=[],this.c={}}var Z={latin:"BESbswy","latin-ext":"çöüğş",cyrillic:"йяЖ",greek:"αβΣ",khmer:"កខគ",Hanuman:"កខគ"},J={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},tt={i:"i",italic:"i",n:"n",normal:"n"},et=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;function it(t,e){this.c=t,this.a=e}var nt={Arimo:!0,Cousine:!0,Tinos:!0};function rt(t,e){this.c=t,this.a=e}function st(t,e){this.c=t,this.f=e,this.a=[]}it.prototype.load=function(t){var e=new m,i=this.c,n=new X(this.a.api,this.a.text),r=this.a.families;!function(t,e){for(var i=e.length,n=0;n<i;n++){var r=e[n].split(":");3==r.length&&t.f.push(r.pop());var s="";2==r.length&&""!=r[1]&&(s=":"),t.a.push(r.join(s))}}(n,r);var s=new Q(r);!function(t){for(var e=t.f.length,i=0;i<e;i++){var n=t.f[i].split(":"),r=n[0].replace(/\+/g," "),s=["n4"];if(2<=n.length){var o;if(o=[],a=n[1])for(var a,l=(a=a.split(",")).length,h=0;h<l;h++){var c;if((c=a[h]).match(/^[\w-]+$/))if(null==(u=et.exec(c.toLowerCase())))c="";else{if(c=null==(c=u[2])||""==c?"n":tt[c],null==(u=u[1])||""==u)u="4";else var u=J[u]||(isNaN(u)?"4":u.substr(0,1));c=[c,u].join("")}else c="";c&&o.push(c)}0<o.length&&(s=o),3==n.length&&(o=[],0<(n=(n=n[2])?n.split(","):o).length&&(n=Z[n[0]])&&(t.c[r]=n))}for(t.c[r]||(n=Z[r])&&(t.c[r]=n),n=0;n<s.length;n+=1)t.a.push(new x(r,s[n]))}}(s),g(i,function(t){if(0==t.a.length)throw Error("No fonts to load!");if(-1!=t.c.indexOf("kit="))return t.c;for(var e=t.a.length,i=[],n=0;n<e;n++)i.push(t.a[n].replace(/ /g,"+"));return e=t.c+"?family="+i.join("%7C"),0<t.f.length&&(e+="&subset="+t.f.join(",")),0<t.g.length&&(e+="&text="+encodeURIComponent(t.g)),e}(n),y(e)),b(e,(function(){t(s.a,s.c,nt)}))},rt.prototype.load=function(t){var e=this.a.id,i=this.c.o;e?v(this.c,(this.a.api||"https://use.typekit.net")+"/"+e+".js",(function(e){if(e)t([]);else if(i.Typekit&&i.Typekit.config&&i.Typekit.config.fn){e=i.Typekit.config.fn;for(var n=[],r=0;r<e.length;r+=2)for(var s=e[r],o=e[r+1],a=0;a<o.length;a++)n.push(new x(s,o[a]));try{i.Typekit.load({events:!1,classes:!1,async:!0})}catch(t){}t(n)}}),2e3):t([])},st.prototype.load=function(t){var e=this.f.id,i=this.c.o,n=this;e?(i.__webfontfontdeckmodule__||(i.__webfontfontdeckmodule__={}),i.__webfontfontdeckmodule__[e]=function(e,i){for(var r=0,s=i.fonts.length;r<s;++r){var o=i.fonts[r];n.a.push(new x(o.name,E("font-weight:"+o.weight+";font-style:"+o.style)))}t(n.a)},v(this.c,(this.f.api||"https://f.fontdeck.com/s/css/js/")+function(t){return t.o.location.hostname||t.a.location.hostname}(this.c)+"/"+e+".js",(function(e){e&&t([])}))):t([])};var ot=new V(window);ot.a.c.custom=function(t,e){return new Y(e,t)},ot.a.c.fontdeck=function(t,e){return new st(e,t)},ot.a.c.monotype=function(t,e){return new W(e,t)},ot.a.c.typekit=function(t,e){return new rt(e,t)},ot.a.c.google=function(t,e){return new it(e,t)};var at={load:o(ot.load,ot)};void 0===(n=function(){return at}.call(e,i,e,t))||(t.exports=n)}()}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var s=e[i]={id:i,exports:{}};return t[i].call(s.exports,s,s.exports,n),s.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};return(()=>{"use strict";n.r(r);var t={};n.r(t),n.d(t,{default:()=>og,dependencies:()=>ag,name:()=>rg,register:()=>hg,template:()=>sg});var e={};n.r(e),n.d(e,{default:()=>yg,dependencies:()=>bg,name:()=>vg,register:()=>_g,template:()=>mg});var s={};n.r(s),n.d(s,{default:()=>pC,dependencies:()=>gC,name:()=>dC,register:()=>mC,template:()=>fC});var o={};n.r(o),n.d(o,{default:()=>MC,dependencies:()=>OC,name:()=>AC,register:()=>RC,template:()=>TC});var a={};n.r(a),n.d(a,{default:()=>$C,dependencies:()=>DC,name:()=>LC,register:()=>jC,template:()=>IC});var l={};n.r(l),n.d(l,{default:()=>GC,dependencies:()=>HC,name:()=>zC,register:()=>qC,template:()=>UC});var h={};n.r(h),n.d(h,{Vis03:()=>nS});var c={};n.r(c),n.d(c,{default:()=>oS,dependencies:()=>aS,name:()=>rS,register:()=>hS,template:()=>sS});var u={};n.r(u),n.d(u,{default:()=>dS,dependencies:()=>fS,name:()=>cS,register:()=>gS,template:()=>uS});var d={};n.r(d),n.d(d,{default:()=>wS,dependencies:()=>_S,name:()=>yS,register:()=>kS,template:()=>bS});var f={};n.r(f),n.d(f,{Vis04:()=>IS});var p={};n.r(p),n.d(p,{default:()=>NS,dependencies:()=>jS,name:()=>$S,register:()=>FS,template:()=>DS});var g={};n.r(g),n.d(g,{default:()=>GS,dependencies:()=>HS,name:()=>zS,register:()=>qS,template:()=>US});var v={};n.r(v),n.d(v,{default:()=>QS,dependencies:()=>ZS,name:()=>XS,register:()=>tE,template:()=>KS});var m={};n.r(m),n.d(m,{Vis05:()=>uE});var y={};n.r(y),n.d(y,{default:()=>pE,dependencies:()=>gE,name:()=>dE,register:()=>mE,template:()=>fE});var b={};n.r(b),n.d(b,{default:()=>wE,dependencies:()=>_E,name:()=>yE,register:()=>kE,template:()=>bE});var w={};n.r(w),n.d(w,{default:()=>TE,dependencies:()=>ME,name:()=>EE,register:()=>PE,template:()=>AE});var _={};n.r(_),n.d(_,{Vis06:()=>UE});var x={};n.r(x),n.d(x,{default:()=>VE,dependencies:()=>qE,name:()=>GE,register:()=>YE,template:()=>HE});var k={};n.r(k),n.d(k,{default:()=>QE,dependencies:()=>ZE,name:()=>XE,register:()=>tA,template:()=>KE});var C={};n.r(C),n.d(C,{default:()=>sA,dependencies:()=>oA,name:()=>nA,register:()=>lA,template:()=>rA});var S={};n.r(S),n.d(S,{Vis07:()=>bA});var E={};n.r(E),n.d(E,{default:()=>xA,dependencies:()=>kA,name:()=>wA,register:()=>SA,template:()=>_A});var A={};n.r(A),n.d(A,{default:()=>TA,dependencies:()=>MA,name:()=>EA,register:()=>PA,template:()=>AA});var T={};n.r(T),n.d(T,{default:()=>DA,dependencies:()=>NA,name:()=>IA,register:()=>BA,template:()=>$A});var M={};n.r(M),n.d(M,{Vis08:()=>KA});var O={};n.r(O),n.d(O,{default:()=>JA,dependencies:()=>tT,name:()=>QA,register:()=>iT,template:()=>ZA});var P={};function R(t){return"object"==typeof t&&null!==t||"function"==typeof t}function L(t){return null==t}n.r(P),n.d(P,{default:()=>bO,dependencies:()=>wO,name:()=>mO,register:()=>xO,template:()=>yO});const I=new WeakMap;function $(t,e,i,n,r){return new TypeError(`${t}(${e.map(String).join(",")}) - Expected '${i}' to be of type ${r}, but got: ${Object.prototype.toString.call(n)} (${String(n)})`)}function D(t){switch(typeof t){case"undefined":case"string":case"symbol":return t;default:return`${t}`}}function N(t,e,i){let n=I.get(t);if(void 0===n){if(!i)return;n=new Map,I.set(t,n)}let r=n.get(e);if(void 0===r){if(!i)return;r=new Map,n.set(e,r)}return r}function j(t,e,i){const n=N(e,i,!1);return void 0!==n&&n.has(t)}function B(t,e,i){if(j(t,e,i))return!0;const n=Object.getPrototypeOf(e);return null!==n&&B(t,n,i)}function F(t,e,i){const n=N(e,i,!1);if(void 0!==n)return n.get(t)}function z(t,e,i){if(j(t,e,i))return F(t,e,i);const n=Object.getPrototypeOf(e);return null!==n?z(t,n,i):void 0}function U(t,e,i,n){N(i,n,!0).set(t,e)}function G(t,e){const i=[],n=N(t,e,!1);if(void 0===n)return i;const r=n.keys();let s=0;for(const t of r)i[s]=t,++s;return i}function H(t,e){const i=G(t,e),n=Object.getPrototypeOf(t);if(null===n)return i;const r=H(n,e),s=i.length;if(0===s)return r;const o=r.length;if(0===o)return i;const a=new Set,l=[];let h,c=0;for(let t=0;t<s;++t)h=i[t],a.has(h)||(a.add(h),l[c]=h,++c);for(let t=0;t<o;++t)h=r[t],a.has(h)||(a.add(h),l[c]=h,++c);return l}function V(t,e){return function(i,n){if(!R(i))throw $("@metadata",[t,e,i,n],"target",i,"Object or Function");U(t,e,i,function(t){switch(typeof t){case"undefined":case"string":case"symbol":return t;default:throw new TypeError(`Invalid metadata propertyKey: ${t}.`)}}(n))}}function q(t,e,i,n){if(void 0!==i){if(!Array.isArray(t))throw $("Metadata.decorate",[t,e,i,n],"decorators",t,"Array");if(!R(e))throw $("Metadata.decorate",[t,e,i,n],"target",e,"Object or Function");if(!R(n)&&!L(n))throw $("Metadata.decorate",[t,e,i,n],"attributes",n,"Object, Function, null, or undefined");return null===n&&(n=void 0),i=function(t){switch(typeof t){case"string":case"symbol":return t;default:return`${t}`}}(i),function(t,e,i,n){for(let r=t.length-1;r>=0;--r){const s=(0,t[r])(e,i,n);if(!L(s)){if(!R(s))throw $("DecorateProperty",[t,e,i,n],"decorated",s,"Object, Function, null, or undefined");n=s}}return n}(t,e,i,n)}if(!Array.isArray(t))throw $("Metadata.decorate",[t,e,i,n],"decorators",t,"Array");if("function"!=typeof e)throw $("Metadata.decorate",[t,e,i,n],"target",e,"Function");return function(t,e){for(let i=t.length-1;i>=0;--i){const n=(0,t[i])(e);if(!L(n)){if("function"!=typeof n)throw $("DecorateConstructor",[t,e],"decorated",n,"Function, null, or undefined");e=n}}return e}(t,e)}function W(t,e,i,n){if(!R(i))throw $("Metadata.define",[t,e,i,n],"target",i,"Object or Function");return U(t,e,i,D(n))}function Y(t,e,i){if(!R(e))throw $("Metadata.has",[t,e,i],"target",e,"Object or Function");return B(t,e,D(i))}function X(t,e,i){if(!R(e))throw $("Metadata.hasOwn",[t,e,i],"target",e,"Object or Function");return j(t,e,D(i))}function K(t,e,i){if(!R(e))throw $("Metadata.get",[t,e,i],"target",e,"Object or Function");return z(t,e,D(i))}function Q(t,e,i){if(!R(e))throw $("Metadata.getOwn",[t,e,i],"target",e,"Object or Function");return F(t,e,D(i))}function Z(t,e){if(!R(t))throw $("Metadata.getKeys",[t,e],"target",t,"Object or Function");return H(t,D(e))}function J(t,e){if(!R(t))throw $("Metadata.getOwnKeys",[t,e],"target",t,"Object or Function");return G(t,D(e))}function tt(t,e,i){if(!R(e))throw $("Metadata.delete",[t,e,i],"target",e,"Object or Function");return function(t,e,i){const n=N(t,i,!1);return void 0!==n&&n.delete(e)}(e,t,D(i))}const et={define:W,has:Y,hasOwn:X,get:K,getOwn:Q,getKeys:Z,getOwnKeys:J,delete:tt};function it(t,e,i,n,r){if(!Reflect.defineProperty(t,e,{writable:n,enumerable:!1,configurable:r,value:i}))throw new Error(`Unable to apply metadata polyfill: could not add property '${e}' to the global Reflect object`)}const nt="[[$au]]";function rt(t,e,i){it(t,nt,I,e,i),it(t,"metadata",V,e,i),it(t,"decorate",q,e,i),it(t,"defineMetadata",W,e,i),it(t,"hasMetadata",Y,e,i),it(t,"hasOwnMetadata",X,e,i),it(t,"getMetadata",K,e,i),it(t,"getOwnMetadata",Q,e,i),it(t,"getMetadataKeys",Z,e,i),it(t,"getOwnMetadataKeys",J,e,i),it(t,"deleteMetadata",tt,e,i)}const st=new Map;function ot(t){return function(){throw new Error(`The PLATFORM did not receive a valid reference to the global function '${t}'.`)}}class at{constructor(t,e={}){var i,n,r,s,o,a,l,h,c,u,d,f,p;this.macroTaskRequested=!1,this.macroTaskHandle=-1,this.globalThis=t,this.decodeURI="decodeURI"in e?e.decodeURI:t.decodeURI,this.decodeURIComponent="decodeURIComponent"in e?e.decodeURIComponent:t.decodeURIComponent,this.encodeURI="encodeURI"in e?e.encodeURI:t.encodeURI,this.encodeURIComponent="encodeURIComponent"in e?e.encodeURIComponent:t.encodeURIComponent,this.Date="Date"in e?e.Date:t.Date,this.Reflect="Reflect"in e?e.Reflect:t.Reflect,this.clearInterval="clearInterval"in e?e.clearInterval:null!==(n=null===(i=t.clearInterval)||void 0===i?void 0:i.bind(t))&&void 0!==n?n:ot("clearInterval"),this.clearTimeout="clearTimeout"in e?e.clearTimeout:null!==(s=null===(r=t.clearTimeout)||void 0===r?void 0:r.bind(t))&&void 0!==s?s:ot("clearTimeout"),this.queueMicrotask="queueMicrotask"in e?e.queueMicrotask:null!==(a=null===(o=t.queueMicrotask)||void 0===o?void 0:o.bind(t))&&void 0!==a?a:ot("queueMicrotask"),this.setInterval="setInterval"in e?e.setInterval:null!==(h=null===(l=t.setInterval)||void 0===l?void 0:l.bind(t))&&void 0!==h?h:ot("setInterval"),this.setTimeout="setTimeout"in e?e.setTimeout:null!==(u=null===(c=t.setTimeout)||void 0===c?void 0:c.bind(t))&&void 0!==u?u:ot("setTimeout"),this.console="console"in e?e.console:t.console,this.performanceNow="performanceNow"in e?e.performanceNow:null!==(p=null===(f=null===(d=t.performance)||void 0===d?void 0:d.now)||void 0===f?void 0:f.bind(t.performance))&&void 0!==p?p:ot("performance.now"),this.flushMacroTask=this.flushMacroTask.bind(this),this.taskQueue=new ht(this,this.requestMacroTask.bind(this),this.cancelMacroTask.bind(this))}static getOrCreate(t,e={}){let i=st.get(t);return void 0===i&&st.set(t,i=new at(t,e)),i}static set(t,e){st.set(t,e)}requestMacroTask(){this.macroTaskRequested=!0,-1===this.macroTaskHandle&&(this.macroTaskHandle=this.setTimeout(this.flushMacroTask,0))}cancelMacroTask(){this.macroTaskRequested=!1,this.macroTaskHandle>-1&&(this.clearTimeout(this.macroTaskHandle),this.macroTaskHandle=-1)}flushMacroTask(){this.macroTaskHandle=-1,!0===this.macroTaskRequested&&(this.macroTaskRequested=!1,this.taskQueue.flush())}}function lt(t){return t.persistent}class ht{constructor(t,e,i){this.platform=t,this.$request=e,this.$cancel=i,this.t=void 0,this.i=0,this.processing=[],this.pending=[],this.delayed=[],this.flushRequested=!1,this.h=void 0,this.taskPool=[],this.u=0,this.T=0,this.$=0,this.I=()=>{this.flushRequested||(this.flushRequested=!0,this.T=this.platform.performanceNow(),this.$request())},this.M=new gt(t.console)}get isEmpty(){return 0===this.i&&0===this.processing.length&&0===this.pending.length&&0===this.delayed.length}get P(){return 0===this.i&&this.processing.every(lt)&&this.pending.every(lt)&&this.delayed.every(lt)}flush(t=this.platform.performanceNow()){if(this.flushRequested=!1,this.$=t,void 0===this.t){if(this.pending.length>0&&(this.processing.push(...this.pending),this.pending.length=0),this.delayed.length>0){let e=-1;for(;++e<this.delayed.length&&this.delayed[e].queueTime<=t;);this.processing.push(...this.delayed.splice(0,e))}let e;for(;this.processing.length>0;)if((e=this.processing.shift()).run(),1===e.status){if(!0===e.suspend)return this.t=e,void this.I();++this.i}if(this.pending.length>0&&(this.processing.push(...this.pending),this.pending.length=0),this.delayed.length>0){let e=-1;for(;++e<this.delayed.length&&this.delayed[e].queueTime<=t;);this.processing.push(...this.delayed.splice(0,e))}if((this.processing.length>0||this.delayed.length>0||this.i>0)&&this.I(),void 0!==this.h&&this.P){const t=this.h;this.h=void 0,t.resolve()}}else this.I()}cancel(){this.flushRequested&&(this.$cancel(),this.flushRequested=!1)}async yield(){this.isEmpty||(void 0===this.h&&(this.h=wt()),await this.h)}queueTask(t,e){const{delay:i,preempt:n,persistent:r,reusable:s,suspend:o}={...vt,...e};if(n){if(i>0)throw new Error("Invalid arguments: preempt cannot be combined with a greater-than-zero delay");if(r)throw new Error("Invalid arguments: preempt cannot be combined with persistent")}0===this.processing.length&&this.I();const a=this.platform.performanceNow();let l;if(s){const e=this.taskPool,h=this.u-1;h>=0?(l=e[h],e[h]=void 0,this.u=h,l.reuse(a,i,n,r,o,t)):l=new pt(this.M,this,a,a+i,n,r,o,s,t)}else l=new pt(this.M,this,a,a+i,n,r,o,s,t);return n?this.processing[this.processing.length]=l:0===i?this.pending[this.pending.length]=l:this.delayed[this.delayed.length]=l,l}remove(t){let e=this.processing.indexOf(t);if(e>-1)this.processing.splice(e,1);else if(e=this.pending.indexOf(t),e>-1)this.pending.splice(e,1);else{if(e=this.delayed.indexOf(t),!(e>-1))throw new Error(`Task #${t.id} could not be found`);this.delayed.splice(e,1)}}returnToPool(t){this.taskPool[this.u++]=t}resetPersistentTask(t){t.reset(this.platform.performanceNow()),t.createdTime===t.queueTime?this.pending[this.pending.length]=t:this.delayed[this.delayed.length]=t}completeAsyncTask(t){var e;if(!0===t.suspend){if(this.t!==t)throw new Error(`Async task completion mismatch: suspenderTask=${null===(e=this.t)||void 0===e?void 0:e.id}, task=${t.id}`);this.t=void 0}else--this.i;if(void 0!==this.h&&this.P){const t=this.h;this.h=void 0,t.resolve()}this.isEmpty&&this.cancel()}}class ct extends Error{constructor(t){super("Task was canceled."),this.task=t}}let ut=0;var dt,ft;!function(t){t[t.pending=0]="pending",t[t.running=1]="running",t[t.completed=2]="completed",t[t.canceled=3]="canceled"}(dt||(dt={}));class pt{constructor(t,e,i,n,r,s,o,a,l){this.taskQueue=e,this.createdTime=i,this.queueTime=n,this.preempt=r,this.persistent=s,this.suspend=o,this.reusable=a,this.callback=l,this.id=++ut,this.R=void 0,this.A=void 0,this.q=void 0,this.C=0,this.M=t}get result(){const t=this.q;if(void 0===t)switch(this.C){case 0:{const t=this.q=wt();return this.R=t.resolve,this.A=t.reject,t}case 1:throw new Error("Trying to await task from within task will cause a deadlock.");case 2:return this.q=Promise.resolve();case 3:return this.q=Promise.reject(new ct(this))}return t}get status(){return this.C}run(t=this.taskQueue.platform.performanceNow()){if(0!==this.C)throw new Error(`Cannot run task in ${this.C} state`);const{persistent:e,reusable:i,taskQueue:n,callback:r,R:s,A:o,createdTime:a}=this;let l;this.C=1;try{l=r(t-a),l instanceof Promise?l.then((t=>{this.persistent?n.resetPersistentTask(this):(this.C=e?3:2,this.dispose()),n.completeAsyncTask(this),void 0!==s&&s(t),!this.persistent&&i&&n.returnToPool(this)})).catch((t=>{if(this.persistent||this.dispose(),n.completeAsyncTask(this),void 0===o)throw t;o(t)})):(this.persistent?n.resetPersistentTask(this):(this.C=e?3:2,this.dispose()),void 0!==s&&s(l),!this.persistent&&i&&n.returnToPool(this))}catch(t){if(this.persistent||this.dispose(),void 0===o)throw t;o(t)}}cancel(){if(0===this.C){const t=this.taskQueue,e=this.reusable,i=this.A;return t.remove(this),t.isEmpty&&t.cancel(),this.C=3,this.dispose(),e&&t.returnToPool(this),void 0!==i&&i(new ct(this)),!0}return!(1!==this.C||!this.persistent||(this.persistent=!1,0))}reset(t){const e=this.queueTime-this.createdTime;this.createdTime=t,this.queueTime=t+e,this.C=0,this.R=void 0,this.A=void 0,this.q=void 0}reuse(t,e,i,n,r,s){this.createdTime=t,this.queueTime=t+e,this.preempt=i,this.persistent=n,this.suspend=r,this.callback=s,this.C=0}dispose(){this.callback=void 0,this.R=void 0,this.A=void 0,this.q=void 0}}class gt{constructor(t){this.console=t,this.enabled=!1,this.depth=0}enter(t,e){this.log(`${"  ".repeat(this.depth++)}> `,t,e)}leave(t,e){this.log(`${"  ".repeat(--this.depth)}< `,t,e)}trace(t,e){this.log(`${"  ".repeat(this.depth)}- `,t,e)}log(t,e,i){if(e instanceof ht){const n=`processing=${e.processing.length} pending=${e.pending.length} delayed=${e.delayed.length} flushReq=${e.flushRequested} susTask=${!!e.t}`;this.console.log(`${t}[Q.${i}] ${n}`)}else{const n=e.id,r=Math.round(10*e.createdTime)/10,s=Math.round(10*e.queueTime)/10,o=e.preempt,a=e.reusable,l=e.persistent,h=e.suspend,c=function(t){switch(t){case 0:return"pending";case 1:return"running";case 3:return"canceled";case 2:return"completed"}}(e.C),u=`id=${n} created=${r} queue=${s} preempt=${o} persistent=${l} reusable=${a} status=${c} suspend=${h}`;this.console.log(`${t}[T.${i}] ${u}`)}}}!function(t){t[t.render=0]="render",t[t.macroTask=1]="macroTask",t[t.postRender=2]="postRender"}(ft||(ft={}));const vt={delay:0,preempt:!1,persistent:!1,reusable:!0,suspend:!1};let mt,yt;function bt(t,e){mt=t,yt=e}function wt(){const t=new Promise(bt);return t.resolve=mt,t.reject=yt,t}const _t={};function xt(t){switch(typeof t){case"number":return t>=0&&(0|t)===t;case"string":{const e=_t[t];if(void 0!==e)return e;const i=t.length;if(0===i)return _t[t]=!1;let n=0,r=0;for(;r<i;++r)if(n=t.charCodeAt(r),0===r&&48===n&&i>1||n<48||n>57)return _t[t]=!1;return _t[t]=!0}default:return!1}}function kt(t){switch(typeof t){case"number":case"bigint":return!0;default:return!1}}function Ct(t){switch(typeof t){case"string":return!0;case"object":return t instanceof Date;default:return!1}}const St=function(){let t;!function(t){t[t.none=0]="none",t[t.digit=1]="digit",t[t.upper=2]="upper",t[t.lower=3]="lower"}(t||(t={}));const e=Object.assign(Object.create(null),{0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0});function i(t){return""===t?0:t!==t.toUpperCase()?3:t!==t.toLowerCase()?2:!0===e[t]?1:0}return function(t,e){const n=t.length;if(0===n)return t;let r,s=!1,o="",a="",l=0,h=t.charAt(0),c=i(h),u=0;for(;u<n;++u)r=l,a=h,l=c,h=t.charAt(u+1),c=i(h),0===l?o.length>0&&(s=!0):(!s&&o.length>0&&2===l&&(s=3===r||3===c),o+=e(a,s),s=!1);return o}}(),Et=function(){const t=Object.create(null);function e(t,e){return e?t.toUpperCase():t.toLowerCase()}return function(i){let n=t[i];return void 0===n&&(n=t[i]=St(i,e)),n}}(),At=function(){const t=Object.create(null);return function(e){let i=t[e];return void 0===i&&(i=Et(e),i.length>0&&(i=i[0].toUpperCase()+i.slice(1)),t[e]=i),i}}(),Tt=function(){const t=Object.create(null);function e(t,e){return e?`-${t.toLowerCase()}`:t.toLowerCase()}return function(i){let n=t[i];return void 0===n&&(n=t[i]=St(i,e)),n}}();function Mt(t){const{length:e}=t,i=Array(e);let n=0;for(;n<e;++n)i[n]=t[n];return i}const Ot={};function Pt(t){return void 0===Ot[t]&&(Ot[t]=0),++Ot[t]}function Rt(t,e){return t-e}function Lt(t,e,i){return{configurable:!0,enumerable:i.enumerable,get(){const t=i.value.bind(this);return Reflect.defineProperty(this,e,{value:t,writable:!0,configurable:!0,enumerable:i.enumerable}),t}}}function It(...t){const e=[];let i=0;const n=t.length;let r,s=0,o=0;for(;o<n;++o)if(r=t[o],void 0!==r){s=r.length;let t=0;for(;t<s;++t)e[i++]=r[t]}return e}function $t(...t){const e=t.length;let i,n=0;for(;e>n;++n)if(i=t[n],void 0!==i)return i;throw new Error("No default value found")}const Dt=function(){const t=Function.prototype,e=Object.getPrototypeOf,i=new WeakMap;let n,r=t,s=0;return function(o){if(n=i.get(o),void 0===n)for(i.set(o,n=[r=o]),s=0;(r=e(r))!==t;)n[++s]=r;return n}}();function Nt(...t){return Object.assign(Object.create(null),...t)}const jt=function(){const t=new WeakMap;let e=!1,i="",n=0;return function(r){return e=t.get(r),void 0===e&&(i=r.toString(),n=i.length,e=n>=29&&n<=100&&125===i.charCodeAt(n-1)&&i.charCodeAt(n-2)<=32&&93===i.charCodeAt(n-3)&&101===i.charCodeAt(n-4)&&100===i.charCodeAt(n-5)&&111===i.charCodeAt(n-6)&&99===i.charCodeAt(n-7)&&32===i.charCodeAt(n-8)&&101===i.charCodeAt(n-9)&&118===i.charCodeAt(n-10)&&105===i.charCodeAt(n-11)&&116===i.charCodeAt(n-12)&&97===i.charCodeAt(n-13)&&110===i.charCodeAt(n-14)&&88===i.charCodeAt(n-15),t.set(r,e)),e}}();function Bt(t,e){return t instanceof Promise?t.then(e):e(t)}function Ft(...t){let e,i,n,r=0,s=t.length;for(;r<s;++r)e=t[r],(e=t[r])instanceof Promise&&(void 0===i?i=e:void 0===n?n=[i,e]:n.push(e));return void 0===n?i:Promise.all(n)}const zt=et.getOwn,Ut=et.hasOwn,Gt=et.define,Ht=t=>"function"==typeof t,Vt=t=>"string"==typeof t,qt="au:annotation",Wt=(t,e)=>void 0===e?`${qt}:${t}`:`${qt}:${t}:${e}`,Yt=(t,e)=>{const i=zt(qt,t);void 0===i?Gt(qt,[e],t):i.push(e)},Xt=Object.freeze({name:"au:annotation",appendTo:Yt,set(t,e,i){Gt(Wt(e),i,t)},get:(t,e)=>zt(Wt(e),t),getKeys(t){let e=zt(qt,t);return void 0===e&&Gt(qt,e=[],t),e},isKey:t=>t.startsWith(qt),keyFor:Wt}),Kt="au:resource",Qt=Object.freeze({name:Kt,appendTo(t,e){const i=zt(Kt,t);void 0===i?Gt(Kt,[e],t):i.push(e)},has:t=>Ut(Kt,t),getAll(t){const e=zt(Kt,t);return void 0===e?ze:e.map((e=>zt(e,t)))},getKeys(t){let e=zt(Kt,t);return void 0===e&&Gt(Kt,e=[],t),e},isKey:t=>t.startsWith(Kt),keyFor:(t,e)=>void 0===e?`${Kt}:${t}`:`${Kt}:${t}:${e}`}),Zt={annotation:Xt,resource:Qt},Jt=Object.prototype.hasOwnProperty;function te(t,e,i,n){let r=zt(Wt(t),i);return void 0===r?(r=e[t],void 0===r?(r=i[t],void 0!==r&&Jt.call(i,t)?r:n()):r):r}function ee(t,e,i){let n=zt(Wt(t),e);return void 0===n?(n=e[t],void 0!==n&&Jt.call(e,t)?n:i()):n}function ie(t,e,i){const n=e[t];return void 0===n?i():n}!function(t,e=!0,i=!1,n=!0,r=!0){if(function(t){return nt in t}(t)){if(t[nt]===I)return;throw new Error("Conflicting @aurelia/metadata module import detected. Please make sure you have the same version of all Aurelia packages in your dependency tree.")}const s=["metadata","decorate","defineMetadata","hasMetadata","hasOwnMetadata","getMetadata","getOwnMetadata","getMetadataKeys","getOwnMetadataKeys","deleteMetadata"].filter((function(t){return t in Reflect}));if(s.length>0){if(e){const t=s.map((function(t){return`${t}:\n${Reflect[t].toString().slice(0,100)}...`})).join("\n\n");throw new Error(`Conflicting reflect.metadata polyfill found. If you have 'reflect-metadata' or any other reflect polyfill imported, please remove it, if not (or if you must use a specific polyfill) please file an issue at https://github.com/aurelia/aurelia/issues so that we can look into compatibility options for this scenario. Implementation summary:\n\n${t}`)}i&&rt(t,n,r)}else rt(t,n,r)}(Reflect,!1,!1);class ne{constructor(t,e){this.container=t,this.key=e}instance(t){return this.registerResolver(0,t)}singleton(t){return this.registerResolver(1,t)}transient(t){return this.registerResolver(2,t)}callback(t){return this.registerResolver(3,t)}cachedCallback(t){return this.registerResolver(3,$e(t))}aliasTo(t){return this.registerResolver(5,t)}registerResolver(t,e){const{container:i,key:n}=this;return this.container=this.key=void 0,i.registerResolver(n,new xe(n,t,e))}}function re(t){const e=t.slice(),i=Object.keys(t),n=i.length;let r;for(let s=0;s<n;++s)r=i[s],xt(r)||(e[r]=t[r]);return e}const se={none(t){throw Error(`AUR0002:${t.toString()}`)},singleton:t=>new xe(t,1,t),transient:t=>new xe(t,2,t)};class oe{constructor(t,e){this.inheritParentResources=t,this.defaultResolver=e}static from(t){var e,i;return void 0===t||t===oe.DEFAULT?oe.DEFAULT:new oe(null!==(e=t.inheritParentResources)&&void 0!==e&&e,null!==(i=t.defaultResolver)&&void 0!==i?i:se.singleton)}}oe.DEFAULT=oe.from({});const ae={createContainer:t=>new Re(null,oe.from(t)),getDesignParamtypes:t=>zt("design:paramtypes",t),getAnnotationParamtypes(t){const e=Wt("di:paramtypes");return zt(e,t)},getOrCreateAnnotationParamTypes:he,getDependencies:le,createInterface(t,e){const i=Ht(t)?t:e,n=Vt(t)?t:void 0,r=function(t,e,i){if(null==t||void 0!==new.target)throw new Error(`AUR0001:${r.friendlyName}`);he(t)[i]=r};return r.$isInterface=!0,r.friendlyName=null==n?"(anonymous)":n,null!=i&&(r.register=function(t,e){return i(new ne(t,null!=e?e:r))}),r.toString=function(){return`InterfaceSymbol<${r.friendlyName}>`},r},inject:(...t)=>function(e,i,n){if("number"==typeof n){const i=he(e),r=t[0];void 0!==r&&(i[n]=r)}else if(i){const n=he(e.constructor),r=t[0];void 0!==r&&(n[i]=r)}else if(n){const e=he(n.value);let i;for(let n=0;n<t.length;++n)i=t[n],void 0!==i&&(e[n]=i)}else{const i=he(e);let n;for(let e=0;e<t.length;++e)n=t[e],void 0!==n&&(i[e]=n)}},transient:t=>(t.register=function(e){return De.transient(t,t).register(e,t)},t.registerInRequestor=!1,t),singleton:(t,e=ve)=>(t.register=function(e){return De.singleton(t,t).register(e,t)},t.registerInRequestor=e.scoped,t)};function le(t){const e=Wt("di:dependencies");let i=zt(e,t);if(void 0===i){const n=t.inject;if(void 0===n){const e=ae.getDesignParamtypes(t),n=ae.getAnnotationParamtypes(t);if(void 0===e)if(void 0===n){const e=Object.getPrototypeOf(t);i=Ht(e)&&e!==Function.prototype?re(le(e)):[]}else i=re(n);else if(void 0===n)i=re(e);else{i=re(e);let t,r=n.length,s=0;for(;s<r;++s)t=n[s],void 0!==t&&(i[s]=t);const o=Object.keys(n);let a;for(s=0,r=o.length,s=0;s<r;++s)a=o[s],xt(a)||(i[a]=n[a])}}else i=re(n);Gt(e,i,t),Yt(t,e)}return i}function he(t){const e=Wt("di:paramtypes");let i=zt(e,t);return void 0===i&&(Gt(e,i=[],t),Yt(t,e)),i}const ce=ae.createInterface("IContainer"),ue=ce;function de(t){return function(e){const i=function(t,e,n){ae.inject(i)(t,e,n)};return i.$isResolver=!0,i.resolve=function(i,n){return t(e,i,n)},i}}const fe=ae.inject;function pe(t){return ae.transient(t)}function ge(t){return null==t?pe:pe(t)}const ve={scoped:!1},me=function(t,e){e=!!e;const i=function(t,e,n){ae.inject(i)(t,e,n)};return i.$isResolver=!0,i.resolve=function(i,n){return((t,e,i,n)=>i.getAll(t,n))(t,0,n,e)},i},ye=(de(((t,e,i)=>()=>i.get(t))),de(((t,e,i)=>i.has(t,!0)?i.get(t):void 0)));function be(t,e,i){ae.inject(be)(t,e,i)}function we(t,e,i){return e.getFactory(t).construct(i)}var _e;be.$isResolver=!0,be.resolve=()=>{},de(((t,e,i)=>(...n)=>e.getFactory(t).construct(i,n))),de(((t,e,i)=>{const n=we(t,e,i),r=new Ne(String(t),n);return i.registerResolver(t,r,!0),n})),de(((t,e,i)=>we(t,e,i))),function(t){t[t.instance=0]="instance",t[t.singleton=1]="singleton",t[t.transient=2]="transient",t[t.callback=3]="callback",t[t.array=4]="array",t[t.alias=5]="alias"}(_e||(_e={}));class xe{constructor(t,e,i){this.key=t,this.strategy=e,this.state=i,this.resolving=!1}get $isResolver(){return!0}register(t,e){return t.registerResolver(e||this.key,this)}resolve(t,e){switch(this.strategy){case 0:return this.state;case 1:if(this.resolving)throw new Error(`AUR0003:${this.state.name}`);return this.resolving=!0,this.state=t.getFactory(this.state).construct(e),this.strategy=0,this.resolving=!1,this.state;case 2:{const i=t.getFactory(this.state);if(null===i)throw new Error(`AUR0004:${String(this.key)}`);return i.construct(e)}case 3:return this.state(t,e,this);case 4:return this.state[0].resolve(t,e);case 5:return e.get(this.state);default:throw new Error(`AUR0005:${this.strategy}`)}}getFactory(t){var e,i,n;switch(this.strategy){case 1:case 2:return t.getFactory(this.state);case 5:return null!==(n=null===(i=null===(e=t.getResolver(this.state))||void 0===e?void 0:e.getFactory)||void 0===i?void 0:i.call(e,t))&&void 0!==n?n:null;default:return null}}}function ke(t){return this.get(t)}function Ce(t,e){return e(t)}class Se{constructor(t,e){this.Type=t,this.dependencies=e,this.transformers=null}construct(t,e){let i;return i=void 0===e?new this.Type(...this.dependencies.map(ke,t)):new this.Type(...this.dependencies.map(ke,t),...e),null==this.transformers?i:this.transformers.reduce(Ce,i)}registerTransformer(t){var e;(null!==(e=this.transformers)&&void 0!==e?e:this.transformers=[]).push(t)}}const Ee={$isResolver:!0,resolve:(t,e)=>e};function Ae(t){return Ht(t.register)}function Te(t){return function(t){return Ae(t)&&"boolean"==typeof t.registerInRequestor}(t)&&t.registerInRequestor}function Me(t){return void 0!==t.prototype}const Oe=new Set(["Array","ArrayBuffer","Boolean","DataView","Date","Error","EvalError","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Number","Object","Promise","RangeError","ReferenceError","RegExp","Set","SharedArrayBuffer","String","SyntaxError","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","URIError","WeakMap","WeakSet"]);let Pe=0;class Re{constructor(t,e){this.parent=t,this.config=e,this.id=++Pe,this.t=0,this.i=new Map,null===t?(this.root=this,this.u=new Map,this.h=new Map,this.res=Object.create(null)):(this.root=t.root,this.u=new Map,this.h=t.h,e.inheritParentResources?this.res=Object.assign(Object.create(null),t.res,this.root.res):this.res=Object.create(null)),this.u.set(ce,Ee)}get depth(){return null===this.parent?0:this.parent.depth+1}register(...t){if(100==++this.t)throw new Error(`AUR0006:${t.map(String)}`);let e,i,n,r,s,o=0,a=t.length;for(;o<a;++o)if(e=t[o],R(e))if(Ae(e))e.register(this);else if(Zt.resource.has(e)){const t=Zt.resource.getAll(e);if(1===t.length)t[0].register(this);else for(r=0,s=t.length;s>r;)t[r].register(this),++r}else if(Me(e))De.singleton(e,e).register(this);else for(i=Object.keys(e),r=0,s=i.length;r<s;++r)n=e[i[r]],R(n)&&(Ae(n)?n.register(this):this.register(n));return--this.t,this}registerResolver(t,e,i=!1){je(t);const n=this.u,r=n.get(t);if(null==r){if(n.set(t,e),function(t){return Vt(t)&&t.indexOf(":")>0}(t)){if(void 0!==this.res[t])throw new Error(`AUR0007:${t}`);this.res[t]=e}}else r instanceof xe&&4===r.strategy?r.state.push(e):n.set(t,new xe(t,4,[r,e]));return i&&this.i.set(t,e),e}registerTransformer(t,e){const i=this.getResolver(t);if(null==i)return!1;if(i.getFactory){const t=i.getFactory(this);return null!=t&&(t.registerTransformer(e),!0)}return!1}getResolver(t,e=!0){if(je(t),void 0!==t.resolve)return t;let i,n=this;for(;null!=n;){if(i=n.u.get(t),null!=i)return i;if(null==n.parent){const i=Te(t)?this:n;return e?this.R(t,i):null}n=n.parent}return null}has(t,e=!1){return!!this.u.has(t)||!(!e||null==this.parent)&&this.parent.has(t,!0)}get(t){if(je(t),t.$isResolver)return t.resolve(this,this);let e,i=this;for(;null!=i;){if(e=i.u.get(t),null!=e)return e.resolve(i,this);if(null==i.parent){const n=Te(t)?this:i;return e=this.R(t,n),e.resolve(i,this)}i=i.parent}throw new Error(`AUR0008:${t}`)}getAll(t,e=!1){je(t);const i=this;let n,r=i;if(e){let e=ze;for(;null!=r;)n=r.u.get(t),null!=n&&(e=e.concat(Be(n,r,i))),r=r.parent;return e}for(;null!=r;){if(n=r.u.get(t),null!=n)return Be(n,r,i);if(r=r.parent,null==r)return ze}return ze}invoke(t,e){if(jt(t))throw Fe(t);return void 0===e?new t(...le(t).map(ke,this)):new t(...le(t).map(ke,this),...e)}getFactory(t){let e=this.h.get(t);if(void 0===e){if(jt(t))throw Fe(t);this.h.set(t,e=new Se(t,le(t)))}return e}registerFactory(t,e){this.h.set(t,e)}createChild(t){return void 0===t&&this.config.inheritParentResources?this.config===oe.DEFAULT?new Re(this,this.config):new Re(this,oe.from({...this.config,inheritParentResources:!1})):new Re(this,oe.from(null!=t?t:this.config))}disposeResolvers(){const t=this.u,e=this.i;let i,n;for([n,i]of e.entries())i.dispose(),t.delete(n);e.clear()}find(t,e){const i=t.keyFrom(e);let n=this.res[i];if(void 0===n&&(n=this.root.res[i],void 0===n))return null;if(null===n)return null;if(Ht(n.getFactory)){const e=n.getFactory(this);if(null==e)return null;const i=zt(t.name,e.Type);return void 0===i?null:i}return null}create(t,e){var i,n;const r=t.keyFrom(e);let s=this.res[r];return void 0===s?(s=this.root.res[r],void 0===s?null:null!==(i=s.resolve(this.root,this))&&void 0!==i?i:null):null!==(n=s.resolve(this,this))&&void 0!==n?n:null}dispose(){this.i.size>0&&this.disposeResolvers(),this.u.clear()}R(t,e){if(!Ht(t))throw new Error(`AUR0009:${t}`);if(Oe.has(t.name))throw new Error(`AUR0010:${t.name}`);if(Ae(t)){const i=t.register(e,t);if(!(i instanceof Object)||null==i.resolve){const i=e.u.get(t);if(null!=i)return i;throw new Error("AUR0011")}return i}if(Zt.resource.has(t)){const i=Zt.resource.getAll(t);if(1===i.length)i[0].register(e);else{const t=i.length;for(let n=0;n<t;++n)i[n].register(e)}const n=e.u.get(t);if(null!=n)return n;throw new Error("AUR0011")}if(t.$isInterface)throw new Error(`AUR0012:${t.friendlyName}`);{const i=this.config.defaultResolver(t,e);return e.u.set(t,i),i}}}class Le{constructor(t,e){this.key=t,this.params=e}register(t){t.has(this.key,!0)?t.get(this.key).register(t,...this.params):t.register(...this.params.filter((t=>"object"==typeof t)))}}const Ie=new WeakMap;function $e(t){return function(e,i,n){let r=Ie.get(e);if(void 0===r&&Ie.set(e,r=new WeakMap),r.has(n))return r.get(n);const s=t(e,i,n);return r.set(n,s),s}}const De={instance:(t,e)=>new xe(t,0,e),singleton:(t,e)=>new xe(t,1,e),transient:(t,e)=>new xe(t,2,e),callback:(t,e)=>new xe(t,3,e),cachedCallback:(t,e)=>new xe(t,3,$e(e)),aliasTo:(t,e)=>new xe(e,5,t),defer:(t,...e)=>new Le(t,e)};class Ne{constructor(t,e){this.C=null,this.$=t,void 0!==e&&(this.C=e)}get friendlyName(){return this.$}prepare(t){this.C=t}get $isResolver(){return!0}resolve(){if(null==this.C)throw new Error(`AUR0013:${this.$}`);return this.C}dispose(){this.C=null}}function je(t){if(null==t)throw new Error("AUR0014")}function Be(t,e,i){if(t instanceof xe&&4===t.strategy){const n=t.state;let r=n.length;const s=new Array(r);for(;r--;)s[r]=n[r].resolve(e,i);return s}return[t.resolve(e,i)]}function Fe(t){return new Error(`AUR0015:${t.name}`)}const ze=Object.freeze([]),Ue=Object.freeze({});function Ge(){}const He=ae.createInterface("IPlatform");function Ve(t,e,i,n){var r,s=arguments.length,o=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,i,o):r(e,i))||o);return s>3&&o&&Object.defineProperty(e,i,o),o}function qe(t,e){return function(i,n){e(i,n,t)}}var We,Ye;!function(t){t[t.trace=0]="trace",t[t.debug=1]="debug",t[t.info=2]="info",t[t.warn=3]="warn",t[t.error=4]="error",t[t.fatal=5]="fatal",t[t.none=6]="none"}(We||(We={})),function(t){t[t.noColors=0]="noColors",t[t.colors=1]="colors"}(Ye||(Ye={}));const Xe=ae.createInterface("ILogConfig",(t=>t.instance(new ii(0,3)))),Ke=ae.createInterface("ISink"),Qe=ae.createInterface("ILogEventFactory",(t=>t.singleton(oi))),Ze=ae.createInterface("ILogger",(t=>t.singleton(li))),Je=ae.createInterface("ILogScope"),ti=Object.freeze({key:Wt("logger-sink-handles"),define(t,e){return Gt(this.key,e.handles,t.prototype),t},getHandles(t){return et.get(this.key,t)}}),ei=Nt({red:t=>`[31m${t}[39m`,green:t=>`[32m${t}[39m`,yellow:t=>`[33m${t}[39m`,blue:t=>`[34m${t}[39m`,magenta:t=>`[35m${t}[39m`,cyan:t=>`[36m${t}[39m`,white:t=>`[37m${t}[39m`,grey:t=>`[90m${t}[39m`});class ii{constructor(t,e){this.colorOptions=t,this.level=e}}const ni=function(){const t=[Nt({TRC:"TRC",DBG:"DBG",INF:"INF",WRN:"WRN",ERR:"ERR",FTL:"FTL",QQQ:"???"}),Nt({TRC:ei.grey("TRC"),DBG:ei.grey("DBG"),INF:ei.white("INF"),WRN:ei.yellow("WRN"),ERR:ei.red("ERR"),FTL:ei.red("FTL"),QQQ:ei.grey("???")})];return function(e,i){return e<=0?t[i].TRC:e<=1?t[i].DBG:e<=2?t[i].INF:e<=3?t[i].WRN:e<=4?t[i].ERR:e<=5?t[i].FTL:t[i].QQQ}}();function ri(t,e){return 0===e?new Date(t).toISOString():ei.grey(new Date(t).toISOString())}class si{constructor(t,e,i,n,r,s){this.severity=t,this.message=e,this.optionalParams=i,this.scope=n,this.colorOptions=r,this.timestamp=s}toString(){const{severity:t,message:e,scope:i,colorOptions:n,timestamp:r}=this;return 0===i.length?`${ri(r,n)} [${ni(t,n)}] ${e}`:`${ri(r,n)} [${ni(t,n)} ${function(t,e){return 0===e?t.join("."):t.map(ei.cyan).join(".")}(i,n)}] ${e}`}}let oi=class{constructor(t){this.config=t}createLogEvent(t,e,i,n){return new si(e,i,n,t.scope,this.config.colorOptions,Date.now())}};oi=Ve([qe(0,Xe)],oi);let ai=class t{constructor(t){const e=t.console;this.handleEvent=function(t){const i=t.optionalParams;if(void 0===i||0===i.length){const i=t.toString();switch(t.severity){case 0:case 1:return e.debug(i);case 2:return e.info(i);case 3:return e.warn(i);case 4:case 5:return e.error(i)}}else{let n=t.toString(),r=0;for(;n.includes("%s");)n=n.replace("%s",String(i[r++]));switch(t.severity){case 0:case 1:return e.debug(n,...i.slice(r));case 2:return e.info(n,...i.slice(r));case 3:return e.warn(n,...i.slice(r));case 4:case 5:return e.error(n,...i.slice(r))}}}}static register(e){De.singleton(Ke,t).register(e)}};ai=Ve([qe(0,He)],ai);let li=class t{constructor(t,e,i,n=[],r=null){var s,o,a,l,h,c;let u,d,f,p,g,v;if(this.config=t,this.factory=e,this.scope=n,this.scopedLoggers=Object.create(null),null===r){this.root=this,this.parent=this,u=this.traceSinks=[],d=this.debugSinks=[],f=this.infoSinks=[],p=this.warnSinks=[],g=this.errorSinks=[],v=this.fatalSinks=[];for(const t of i){const e=ti.getHandles(t);(null===(s=null==e?void 0:e.includes(0))||void 0===s||s)&&u.push(t),(null===(o=null==e?void 0:e.includes(1))||void 0===o||o)&&d.push(t),(null===(a=null==e?void 0:e.includes(2))||void 0===a||a)&&f.push(t),(null===(l=null==e?void 0:e.includes(3))||void 0===l||l)&&p.push(t),(null===(h=null==e?void 0:e.includes(4))||void 0===h||h)&&g.push(t),(null===(c=null==e?void 0:e.includes(5))||void 0===c||c)&&v.push(t)}}else this.root=r.root,this.parent=r,u=this.traceSinks=r.traceSinks,d=this.debugSinks=r.debugSinks,f=this.infoSinks=r.infoSinks,p=this.warnSinks=r.warnSinks,g=this.errorSinks=r.errorSinks,v=this.fatalSinks=r.fatalSinks}trace(t,...e){this.config.level<=0&&this.emit(this.traceSinks,0,t,e)}debug(t,...e){this.config.level<=1&&this.emit(this.debugSinks,1,t,e)}info(t,...e){this.config.level<=2&&this.emit(this.infoSinks,2,t,e)}warn(t,...e){this.config.level<=3&&this.emit(this.warnSinks,3,t,e)}error(t,...e){this.config.level<=4&&this.emit(this.errorSinks,4,t,e)}fatal(t,...e){this.config.level<=5&&this.emit(this.fatalSinks,5,t,e)}scopeTo(e){const i=this.scopedLoggers;let n=i[e];return void 0===n&&(n=i[e]=new t(this.config,this.factory,void 0,this.scope.concat(e),this)),n}emit(t,e,i,n){const r=Ht(i)?i():i,s=this.factory.createLogEvent(this,e,r,n);for(let e=0,i=t.length;e<i;++e)t[e].handleEvent(s)}};function hi(t){return t}Ve([Lt],li.prototype,"trace",null),Ve([Lt],li.prototype,"debug",null),Ve([Lt],li.prototype,"info",null),Ve([Lt],li.prototype,"warn",null),Ve([Lt],li.prototype,"error",null),Ve([Lt],li.prototype,"fatal",null),li=Ve([qe(0,Xe),qe(1,Qe),qe(2,me(Ke)),qe(3,ye(Je)),qe(4,be)],li),Nt({create:({level:t=3,colorOptions:e=0,sinks:i=[]}={})=>Nt({register(n){n.register(De.instance(Xe,new ii(e,t)));for(const t of i)Ht(t)?n.register(De.singleton(Ke,t)):n.register(t);return n}})}),ae.createInterface((t=>t.singleton(ui)));class ci{constructor(t){this.$transform=t,this.A=new Map,this.j=new Map}transform(t){if(t instanceof Promise)return this.O(t);if("object"==typeof t&&null!==t)return this.I(t);throw new Error(`Invalid input: ${String(t)}. Expected Promise or Object.`)}O(t){if(this.A.has(t))return this.A.get(t);const e=t.then((t=>this.I(t)));return this.A.set(t,e),e.then((e=>{this.A.set(t,e)})),e}I(t){if(this.j.has(t))return this.j.get(t);const e=this.$transform(this.M(t));return this.j.set(t,e),e instanceof Promise&&e.then((e=>{this.j.set(t,e)})),e}M(t){let e,i,n,r;const s=[];for(const o in t){switch(typeof(e=t[o])){case"object":if(null===e)continue;i=Ht(e.register),n=!1,r=ze;break;case"function":i=Ht(e.register),n=void 0!==e.prototype,r=Zt.resource.getAll(e);break;default:continue}s.push(new fi(o,e,i,n,r))}return new di(t,s)}}class ui{constructor(){this.transformers=new Map}load(t,e=hi){const i=this.transformers;let n=i.get(e);return void 0===n&&i.set(e,n=new ci(e)),n.transform(t)}dispose(){this.transformers.clear()}}class di{constructor(t,e){this.raw=t,this.items=e}}class fi{constructor(t,e,i,n,r){this.key=t,this.value=e,this.isRegistry=i,this.isConstructable=n,this.definitions=r}}class pi{constructor(t,e){this.messageType=t,this.callback=e}handle(t){t instanceof this.messageType&&this.callback.call(null,t)}}ae.createInterface("IEventAggregator",(t=>t.singleton(gi)));class gi{constructor(){this.eventLookup={},this.messageHandlers=[]}publish(t,e){if(!t)throw new Error(`Invalid channel name or instance: ${t}.`);if(Vt(t)){let i=this.eventLookup[t];if(void 0!==i){i=i.slice();let n=i.length;for(;n-- >0;)i[n](e,t)}}else{const e=this.messageHandlers.slice();let i=e.length;for(;i-- >0;)e[i].handle(t)}}subscribe(t,e){if(!t)throw new Error(`Invalid channel name or type: ${t}.`);let i,n;return Vt(t)?(void 0===this.eventLookup[t]&&(this.eventLookup[t]=[]),i=e,n=this.eventLookup[t]):(i=new pi(t,e),n=this.messageHandlers),n.push(i),{dispose(){const t=n.indexOf(i);-1!==t&&n.splice(t,1)}}}subscribeOnce(t,e){const i=this.subscribe(t,(function(t,n){i.dispose(),e(t,n)}));return i}}const vi=new Map;class mi extends at{constructor(t,e={}){super(t,e),this.t=!1,this.i=-1,this.h=!1,this.u=-1,"Node,Element,HTMLElement,CustomEvent,CSSStyleSheet,ShadowRoot,MutationObserver,window,document,location,history,navigator,customElements".split(",").forEach((i=>{this[i]=i in e?e[i]:t[i]})),"fetch,requestAnimationFrame,cancelAnimationFrame".split(",").forEach((i=>{var n,r;this[i]=i in e?e[i]:null!==(r=null===(n=t[i])||void 0===n?void 0:n.bind(t))&&void 0!==r?r:function(t){return function(){throw new Error(`The PLATFORM did not receive a valid reference to the global function '${t}'.`)}}(i)})),this.flushDomRead=this.flushDomRead.bind(this),this.flushDomWrite=this.flushDomWrite.bind(this),this.domReadQueue=new ht(this,this.requestDomRead.bind(this),this.cancelDomRead.bind(this)),this.domWriteQueue=new ht(this,this.requestDomWrite.bind(this),this.cancelDomWrite.bind(this))}static getOrCreate(t,e={}){let i=vi.get(t);return void 0===i&&vi.set(t,i=new mi(t,e)),i}static set(t,e){vi.set(t,e)}requestDomRead(){this.t=!0,-1===this.u&&(this.u=this.requestAnimationFrame(this.flushDomWrite))}cancelDomRead(){this.t=!1,this.i>-1&&(this.clearTimeout(this.i),this.i=-1),!1===this.h&&this.u>-1&&(this.cancelAnimationFrame(this.u),this.u=-1)}flushDomRead(){this.i=-1,!0===this.t&&(this.t=!1,this.domReadQueue.flush())}requestDomWrite(){this.h=!0,-1===this.u&&(this.u=this.requestAnimationFrame(this.flushDomWrite))}cancelDomWrite(){this.h=!1,this.u>-1&&(!1===this.t||this.i>-1)&&(this.cancelAnimationFrame(this.u),this.u=-1)}flushDomWrite(){this.u=-1,!0===this.h&&(this.h=!1,this.domWriteQueue.flush()),!0===this.t&&-1===this.i&&(this.i=this.setTimeout(this.flushDomRead,0))}}const yi=Object.prototype.hasOwnProperty,bi=Reflect.defineProperty,wi=t=>"function"==typeof t,_i=t=>"string"==typeof t;function xi(t,e,i){return bi(t,e,{enumerable:!1,configurable:!0,writable:!0,value:i}),i}function ki(t,e,i,n=!1){!n&&yi.call(t,e)||xi(t,e,i)}const Ci=()=>Object.create(null),Si=et.getOwn,Ei=et.hasOwn,Ai=et.define,Ti=Zt.annotation.keyFor,Mi=Zt.resource.keyFor,Oi=Zt.resource.appendTo;function Pi(t,e,i,n){for(let r=0,s=t.length;r<s;++r)De.aliasTo(i,e.keyFrom(t[r])).register(n)}const Ri=Object.freeze({});class Li{constructor(t,e){if(void 0!==t)if(void 0!==e)this[t]=e;else for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&(this[e]=t[e])}static create(t,e){return new Li(t,e)}static get(t,e,i,n){var r,s;if(null==t)throw new Error(`AUR0203:${t}`);let o=t.overrideContext,a=t;if(i>0){for(;i>0;)if(i--,a=a.parentScope,null==(null==a?void 0:a.overrideContext))return;return o=a.overrideContext,e in o?o:o.bindingContext}for(;!((null==a?void 0:a.isBoundary)||null==o||e in o||o.bindingContext&&e in o.bindingContext);)a=null!==(r=a.parentScope)&&void 0!==r?r:null,o=null!==(s=null==a?void 0:a.overrideContext)&&void 0!==s?s:null;return o?e in o?o:o.bindingContext:16&n?Ri:t.bindingContext||t.overrideContext}}class Ii{constructor(t,e,i,n){this.parentScope=t,this.bindingContext=e,this.overrideContext=i,this.isBoundary=n}static create(t,e,i){return new Ii(null,t,null==e?$i.create(t):e,null!=i&&i)}static fromOverride(t){if(null==t)throw new Error(`AUR0204:${t}`);return new Ii(null,t.bindingContext,t,!1)}static fromParent(t,e){if(null==t)throw new Error(`AUR0205:${t}`);return new Ii(t,e,$i.create(e),!1)}}class $i{constructor(t){this.bindingContext=t}static create(t){return new $i(t)}}const Di=ae.createInterface("ISignaler",(t=>t.singleton(Ni)));class Ni{constructor(){this.signals=Ci()}dispatchSignal(t,e){const i=this.signals[t];if(void 0===i)return;let n;for(n of i.keys())n.handleChange(void 0,void 0,e)}addSignalListener(t,e){const i=this.signals,n=i[t];void 0===n?i[t]=new Set([e]):n.add(e)}removeSignalListener(t,e){const i=this.signals[t];i&&i.delete(e)}}var ji;function Bi(t){return function(e){return Vi.define(t,e)}}!function(t){t[t.singleton=1]="singleton",t[t.interceptor=2]="interceptor"}(ji||(ji={}));class Fi{constructor(t,e,i,n,r){this.Type=t,this.name=e,this.aliases=i,this.key=n,this.strategy=r}static create(t,e){let i,n;_i(t)?(i=t,n={name:i}):(i=t.name,n=t);const r=Object.getPrototypeOf(e)===Ui;return new Fi(e,$t(Hi(e,"name"),i),It(Hi(e,"aliases"),n.aliases,e.aliases),Vi.keyFrom(i),te("strategy",n,e,(()=>r?2:1)))}register(t){const{Type:e,key:i,aliases:n,strategy:r}=this;switch(r){case 1:De.singleton(i,e).register(t);break;case 2:De.instance(i,new zi(t,e)).register(t)}De.aliasTo(i,e).register(t),Pi(n,Vi,i,t)}}class zi{constructor(t,e){this.ctn=t,this.Type=e,this.deps=ae.getDependencies(e)}construct(t,e){const i=this.ctn,n=this.deps;switch(n.length){case 0:return new this.Type(t,e);case 1:return new this.Type(i.get(n[0]),t,e);case 2:return new this.Type(i.get(n[0]),i.get(n[1]),t,e);default:return new this.Type(...n.map((t=>i.get(t))),t,e)}}}class Ui{constructor(t,e){let i;for(this.binding=t,this.expr=e,this.interceptor=this;t.interceptor!==this;)i=t.interceptor,t.interceptor=this,t=i}get oL(){return this.binding.oL}get locator(){return this.binding.locator}get $scope(){return this.binding.$scope}get isBound(){return this.binding.isBound}get obs(){return this.binding.obs}get sourceExpression(){return this.binding.sourceExpression}updateTarget(t,e){this.binding.updateTarget(t,e)}updateSource(t,e){this.binding.updateSource(t,e)}callSource(t){return this.binding.callSource(t)}handleChange(t,e,i){this.binding.handleChange(t,e,i)}handleCollectionChange(t,e){this.binding.handleCollectionChange(t,e)}observe(t,e){this.binding.observe(t,e)}observeCollection(t){this.binding.observeCollection(t)}$bind(t,e){this.binding.$bind(t,e)}$unbind(t){this.binding.$unbind(t)}}const Gi=Mi("binding-behavior"),Hi=(t,e)=>Si(Ti(e),t),Vi=Object.freeze({name:Gi,keyFrom:t=>`${Gi}:${t}`,isType:t=>wi(t)&&Ei(Gi,t),define(t,e){const i=Fi.create(t,e);return Ai(Gi,i,i.Type),Ai(Gi,i,i),Oi(e,Gi),i.Type},getDefinition(t){const e=Si(Gi,t);if(void 0===e)throw new Error(`AUR0151:${t.name}`);return e},annotate(t,e,i){Ai(Ti(e),i,t)},getAnnotation:Hi});function qi(t){return function(e){return Ki.define(t,e)}}class Wi{constructor(t,e,i,n){this.Type=t,this.name=e,this.aliases=i,this.key=n}static create(t,e){let i,n;return _i(t)?(i=t,n={name:i}):(i=t.name,n=t),new Wi(e,$t(Xi(e,"name"),i),It(Xi(e,"aliases"),n.aliases,e.aliases),Ki.keyFrom(i))}register(t){const{Type:e,key:i,aliases:n}=this;De.singleton(i,e).register(t),De.aliasTo(i,e).register(t),Pi(n,Ki,i,t)}}const Yi=Mi("value-converter"),Xi=(t,e)=>Si(Ti(e),t),Ki=Object.freeze({name:Yi,keyFrom:t=>`${Yi}:${t}`,isType:t=>wi(t)&&Ei(Yi,t),define(t,e){const i=Wi.create(t,e);return Ai(Yi,i,i.Type),Ai(Yi,i,i),Oi(e,Yi),i.Type},getDefinition(t){const e=Si(Yi,t);if(void 0===e)throw new Error(`AUR0152:${t.name}`);return e},annotate(t,e,i){Ai(Ti(e),i,t)},getAnnotation:Xi});var Qi;!function(t){t[t.CallsFunction=128]="CallsFunction",t[t.HasAncestor=256]="HasAncestor",t[t.IsPrimary=512]="IsPrimary",t[t.IsLeftHandSide=1024]="IsLeftHandSide",t[t.HasBind=2048]="HasBind",t[t.HasUnbind=4096]="HasUnbind",t[t.IsAssignable=8192]="IsAssignable",t[t.IsLiteral=16384]="IsLiteral",t[t.IsResource=32768]="IsResource",t[t.IsForDeclaration=65536]="IsForDeclaration",t[t.Type=31]="Type",t[t.AccessThis=1793]="AccessThis",t[t.AccessScope=10082]="AccessScope",t[t.ArrayLiteral=17955]="ArrayLiteral",t[t.ObjectLiteral=17956]="ObjectLiteral",t[t.PrimitiveLiteral=17925]="PrimitiveLiteral",t[t.Template=17958]="Template",t[t.Unary=39]="Unary",t[t.CallScope=1448]="CallScope",t[t.CallMember=1161]="CallMember",t[t.CallFunction=1162]="CallFunction",t[t.AccessMember=9323]="AccessMember",t[t.AccessKeyed=9324]="AccessKeyed",t[t.TaggedTemplate=1197]="TaggedTemplate",t[t.Binary=46]="Binary",t[t.Conditional=63]="Conditional",t[t.Assign=8208]="Assign",t[t.ValueConverter=36913]="ValueConverter",t[t.BindingBehavior=38962]="BindingBehavior",t[t.HtmlLiteral=51]="HtmlLiteral",t[t.ArrayBindingPattern=65556]="ArrayBindingPattern",t[t.ObjectBindingPattern=65557]="ObjectBindingPattern",t[t.BindingIdentifier=65558]="BindingIdentifier",t[t.ForOfStatement=6199]="ForOfStatement",t[t.Interpolation=24]="Interpolation",t[t.ArrayDestructuring=90137]="ArrayDestructuring",t[t.ObjectDestructuring=106521]="ObjectDestructuring",t[t.DestructuringAssignmentLeaf=139289]="DestructuringAssignmentLeaf"}(Qi||(Qi={}));class Zi{constructor(){this.text=""}static unparse(t){const e=new Zi;return t.accept(e),e.text}visitAccessMember(t){t.object.accept(this),this.text+=`.${t.name}`}visitAccessKeyed(t){t.object.accept(this),this.text+="[",t.key.accept(this),this.text+="]"}visitAccessThis(t){if(0===t.ancestor)return void(this.text+="$this");this.text+="$parent";let e=t.ancestor-1;for(;e--;)this.text+=".$parent"}visitAccessScope(t){let e=t.ancestor;for(;e--;)this.text+="$parent.";this.text+=t.name}visitArrayLiteral(t){const e=t.elements;this.text+="[";for(let t=0,i=e.length;t<i;++t)0!==t&&(this.text+=","),e[t].accept(this);this.text+="]"}visitObjectLiteral(t){const e=t.keys,i=t.values;this.text+="{";for(let t=0,n=e.length;t<n;++t)0!==t&&(this.text+=","),this.text+=`'${e[t]}':`,i[t].accept(this);this.text+="}"}visitPrimitiveLiteral(t){if(this.text+="(",_i(t.value)){const e=t.value.replace(/'/g,"\\'");this.text+=`'${e}'`}else this.text+=`${t.value}`;this.text+=")"}visitCallFunction(t){this.text+="(",t.func.accept(this),this.writeArgs(t.args),this.text+=")"}visitCallMember(t){this.text+="(",t.object.accept(this),this.text+=`.${t.name}`,this.writeArgs(t.args),this.text+=")"}visitCallScope(t){this.text+="(";let e=t.ancestor;for(;e--;)this.text+="$parent.";this.text+=t.name,this.writeArgs(t.args),this.text+=")"}visitTemplate(t){const{cooked:e,expressions:i}=t,n=i.length;this.text+="`",this.text+=e[0];for(let t=0;t<n;t++)i[t].accept(this),this.text+=e[t+1];this.text+="`"}visitTaggedTemplate(t){const{cooked:e,expressions:i}=t,n=i.length;t.func.accept(this),this.text+="`",this.text+=e[0];for(let t=0;t<n;t++)i[t].accept(this),this.text+=e[t+1];this.text+="`"}visitUnary(t){this.text+=`(${t.operation}`,t.operation.charCodeAt(0)>=97&&(this.text+=" "),t.expression.accept(this),this.text+=")"}visitBinary(t){this.text+="(",t.left.accept(this),105===t.operation.charCodeAt(0)?this.text+=` ${t.operation} `:this.text+=t.operation,t.right.accept(this),this.text+=")"}visitConditional(t){this.text+="(",t.condition.accept(this),this.text+="?",t.yes.accept(this),this.text+=":",t.no.accept(this),this.text+=")"}visitAssign(t){this.text+="(",t.target.accept(this),this.text+="=",t.value.accept(this),this.text+=")"}visitValueConverter(t){const e=t.args;t.expression.accept(this),this.text+=`|${t.name}`;for(let t=0,i=e.length;t<i;++t)this.text+=":",e[t].accept(this)}visitBindingBehavior(t){const e=t.args;t.expression.accept(this),this.text+=`&${t.name}`;for(let t=0,i=e.length;t<i;++t)this.text+=":",e[t].accept(this)}visitArrayBindingPattern(t){const e=t.elements;this.text+="[";for(let t=0,i=e.length;t<i;++t)0!==t&&(this.text+=","),e[t].accept(this);this.text+="]"}visitObjectBindingPattern(t){const e=t.keys,i=t.values;this.text+="{";for(let t=0,n=e.length;t<n;++t)0!==t&&(this.text+=","),this.text+=`'${e[t]}':`,i[t].accept(this);this.text+="}"}visitBindingIdentifier(t){this.text+=t.name}visitHtmlLiteral(t){throw new Error("visitHtmlLiteral")}visitForOfStatement(t){t.declaration.accept(this),this.text+=" of ",t.iterable.accept(this)}visitInterpolation(t){const{parts:e,expressions:i}=t,n=i.length;this.text+="${",this.text+=e[0];for(let t=0;t<n;t++)i[t].accept(this),this.text+=e[t+1];this.text+="}"}visitDestructuringAssignmentExpression(t){const e=106521===t.$kind;this.text+=e?"{":"[";const i=t.list,n=i.length;let r,s;for(r=0;r<n;r++)switch(s=i[r],s.$kind){case 139289:s.accept(this);break;case 90137:case 106521:{const t=s.source;t&&(t.accept(this),this.text+=":"),s.accept(this);break}}this.text+=e?"}":"]"}visitDestructuringAssignmentSingleExpression(t){t.source.accept(this),this.text+=":",t.target.accept(this);const e=t.initializer;void 0!==e&&(this.text+="=",e.accept(this))}visitDestructuringAssignmentRestExpression(t){this.text+="...",t.accept(this)}writeArgs(t){this.text+="(";for(let e=0,i=t.length;e<i;++e)0!==e&&(this.text+=","),t[e].accept(this);this.text+=")"}}class Ji{constructor(t){this.value=t}evaluate(t,e,i,n){return this.value}}class tn{constructor(t,e,i){this.expression=t,this.name=e,this.args=i,this.behaviorKey=Vi.keyFrom(e)}get $kind(){return 38962}get hasBind(){return!0}get hasUnbind(){return!0}evaluate(t,e,i,n){return this.expression.evaluate(t,e,i,n)}assign(t,e,i,n){return this.expression.assign(t,e,i,n)}bind(t,e,i){this.expression.hasBind&&this.expression.bind(t,e,i);const n=i.locator.get(this.behaviorKey);if(null==n)throw new Error(`AUR0101:${this.name}`);if(!(n instanceof zi)){if(void 0!==i[this.behaviorKey])throw new Error(`AUR0102:${this.name}`);i[this.behaviorKey]=n,n.bind.call(n,t,e,i,...this.args.map((n=>n.evaluate(t,e,i.locator,null))))}}unbind(t,e,i){const n=this.behaviorKey,r=i;void 0!==r[n]&&(wi(r[n].unbind)&&r[n].unbind(t,e,i),r[n]=void 0),this.expression.hasUnbind&&this.expression.unbind(t,e,i)}accept(t){return t.visitBindingBehavior(this)}toString(){return Zi.unparse(this)}}class en{constructor(t,e,i){this.expression=t,this.name=e,this.args=i,this.converterKey=Ki.keyFrom(e)}get $kind(){return 36913}get hasBind(){return!1}get hasUnbind(){return!0}evaluate(t,e,i,n){const r=i.get(this.converterKey);if(null==r)throw new Error(`AUR0103:${this.name}`);if(null!==n&&"handleChange"in n){const t=r.signals;if(null!=t){const e=i.get(Di);for(let i=0,r=t.length;i<r;++i)e.addSignalListener(t[i],n)}}return"toView"in r?r.toView(this.expression.evaluate(t,e,i,n),...this.args.map((r=>r.evaluate(t,e,i,n)))):this.expression.evaluate(t,e,i,n)}assign(t,e,i,n){const r=i.get(this.converterKey);if(null==r)throw new Error(`AUR0104:${this.name}`);return"fromView"in r&&(n=r.fromView(n,...this.args.map((n=>n.evaluate(t,e,i,null))))),this.expression.assign(t,e,i,n)}unbind(t,e,i){const n=i.locator.get(this.converterKey);if(void 0===n.signals)return;const r=i.locator.get(Di);for(let t=0;t<n.signals.length;++t)r.removeSignalListener(n.signals[t],i)}accept(t){return t.visitValueConverter(this)}toString(){return Zi.unparse(this)}}class nn{constructor(t,e){this.target=t,this.value=e}get $kind(){return 8208}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(t,e,i,n){return this.target.assign(t,e,i,this.value.evaluate(t,e,i,n))}assign(t,e,i,n){return this.value.assign(t,e,i,n),this.target.assign(t,e,i,n)}accept(t){return t.visitAssign(this)}toString(){return Zi.unparse(this)}}class rn{constructor(t,e,i){this.condition=t,this.yes=e,this.no=i}get $kind(){return 63}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(t,e,i,n){return this.condition.evaluate(t,e,i,n)?this.yes.evaluate(t,e,i,n):this.no.evaluate(t,e,i,n)}assign(t,e,i,n){}accept(t){return t.visitConditional(this)}toString(){return Zi.unparse(this)}}class sn{constructor(t=0){this.ancestor=t}get $kind(){return 1793}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(t,e,i,n){var r;let s=e.overrideContext,o=e,a=this.ancestor;for(;a--&&s;)o=o.parentScope,s=null!==(r=null==o?void 0:o.overrideContext)&&void 0!==r?r:null;return a<1&&s?s.bindingContext:void 0}assign(t,e,i,n){}accept(t){return t.visitAccessThis(this)}toString(){return Zi.unparse(this)}}sn.$this=new sn(0),sn.$parent=new sn(1);class on{constructor(t,e=0){this.name=t,this.ancestor=e}get $kind(){return 10082}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(t,e,i,n){const r=Li.get(e,this.name,this.ancestor,t);null!==n&&n.observe(r,this.name);const s=r[this.name];if(null==s&&"$host"===this.name)throw new Error("AUR0105");return 1&t?s:null==s?"":s}assign(t,e,i,n){var r;if("$host"===this.name)throw new Error("AUR0106");const s=Li.get(e,this.name,this.ancestor,t);if(s instanceof Object)return void 0!==(null===(r=s.$observers)||void 0===r?void 0:r[this.name])?(s.$observers[this.name].setValue(n,t),n):s[this.name]=n}accept(t){return t.visitAccessScope(this)}toString(){return Zi.unparse(this)}}class an{constructor(t,e){this.object=t,this.name=e}get $kind(){return 9323}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(t,e,i,n){const r=this.object.evaluate(t,e,i,(128&t)>0?null:n);return 1&t?null==r?r:(null!==n&&n.observe(r,this.name),r[this.name]):(null!==n&&r instanceof Object&&n.observe(r,this.name),r?r[this.name]:"")}assign(t,e,i,n){const r=this.object.evaluate(t,e,i,null);return r instanceof Object?void 0!==r.$observers&&void 0!==r.$observers[this.name]?r.$observers[this.name].setValue(n,t):r[this.name]=n:this.object.assign(t,e,i,{[this.name]:n}),n}accept(t){return t.visitAccessMember(this)}toString(){return Zi.unparse(this)}}class ln{constructor(t,e){this.object=t,this.key=e}get $kind(){return 9324}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(t,e,i,n){const r=this.object.evaluate(t,e,i,(128&t)>0?null:n);if(r instanceof Object){const s=this.key.evaluate(t,e,i,(128&t)>0?null:n);return null!==n&&n.observe(r,s),r[s]}}assign(t,e,i,n){return this.object.evaluate(t,e,i,null)[this.key.evaluate(t,e,i,null)]=n}accept(t){return t.visitAccessKeyed(this)}toString(){return Zi.unparse(this)}}class hn{constructor(t,e,i=0){this.name=t,this.args=e,this.ancestor=i}get $kind(){return 1448}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(t,e,i,n){const r=this.args.map((r=>r.evaluate(t,e,i,n))),s=Li.get(e,this.name,this.ancestor,t),o=An(t,s,this.name);if(o)return o.apply(s,r)}assign(t,e,i,n){}accept(t){return t.visitCallScope(this)}toString(){return Zi.unparse(this)}}class cn{constructor(t,e,i){this.object=t,this.name=e,this.args=i}get $kind(){return 1161}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(t,e,i,n){const r=this.object.evaluate(t,e,i,(128&t)>0?null:n),s=this.args.map((r=>r.evaluate(t,e,i,n))),o=An(t,r,this.name);if(o)return o.apply(r,s)}assign(t,e,i,n){}accept(t){return t.visitCallMember(this)}toString(){return Zi.unparse(this)}}class un{constructor(t,e){this.func=t,this.args=e}get $kind(){return 1162}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(t,e,i,n){const r=this.func.evaluate(t,e,i,n);if(wi(r))return r(...this.args.map((r=>r.evaluate(t,e,i,n))));if(8&t||null!=r)throw new Error("AUR0107")}assign(t,e,i,n){}accept(t){return t.visitCallFunction(this)}toString(){return Zi.unparse(this)}}class dn{constructor(t,e,i){this.operation=t,this.left=e,this.right=i}get $kind(){return 46}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(t,e,i,n){switch(this.operation){case"&&":return this.left.evaluate(t,e,i,n)&&this.right.evaluate(t,e,i,n);case"||":return this.left.evaluate(t,e,i,n)||this.right.evaluate(t,e,i,n);case"==":return this.left.evaluate(t,e,i,n)==this.right.evaluate(t,e,i,n);case"===":return this.left.evaluate(t,e,i,n)===this.right.evaluate(t,e,i,n);case"!=":return this.left.evaluate(t,e,i,n)!=this.right.evaluate(t,e,i,n);case"!==":return this.left.evaluate(t,e,i,n)!==this.right.evaluate(t,e,i,n);case"instanceof":{const r=this.right.evaluate(t,e,i,n);return!!wi(r)&&this.left.evaluate(t,e,i,n)instanceof r}case"in":{const r=this.right.evaluate(t,e,i,n);return r instanceof Object&&this.left.evaluate(t,e,i,n)in r}case"+":{const r=this.left.evaluate(t,e,i,n),s=this.right.evaluate(t,e,i,n);if((1&t)>0)return r+s;if(!r||!s){if(kt(r)||kt(s))return(r||0)+(s||0);if(Ct(r)||Ct(s))return(r||"")+(s||"")}return r+s}case"-":return this.left.evaluate(t,e,i,n)-this.right.evaluate(t,e,i,n);case"*":return this.left.evaluate(t,e,i,n)*this.right.evaluate(t,e,i,n);case"/":return this.left.evaluate(t,e,i,n)/this.right.evaluate(t,e,i,n);case"%":return this.left.evaluate(t,e,i,n)%this.right.evaluate(t,e,i,n);case"<":return this.left.evaluate(t,e,i,n)<this.right.evaluate(t,e,i,n);case">":return this.left.evaluate(t,e,i,n)>this.right.evaluate(t,e,i,n);case"<=":return this.left.evaluate(t,e,i,n)<=this.right.evaluate(t,e,i,n);case">=":return this.left.evaluate(t,e,i,n)>=this.right.evaluate(t,e,i,n);default:throw new Error(`AUR0108:${this.operation}`)}}assign(t,e,i,n){}accept(t){return t.visitBinary(this)}toString(){return Zi.unparse(this)}}class fn{constructor(t,e){this.operation=t,this.expression=e}get $kind(){return 39}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(t,e,i,n){switch(this.operation){case"void":return void this.expression.evaluate(t,e,i,n);case"typeof":return typeof this.expression.evaluate(1|t,e,i,n);case"!":return!this.expression.evaluate(t,e,i,n);case"-":return-this.expression.evaluate(t,e,i,n);case"+":return+this.expression.evaluate(t,e,i,n);default:throw new Error(`AUR0109:${this.operation}`)}}assign(t,e,i,n){}accept(t){return t.visitUnary(this)}toString(){return Zi.unparse(this)}}class pn{constructor(t){this.value=t}get $kind(){return 17925}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(t,e,i,n){return this.value}assign(t,e,i,n){}accept(t){return t.visitPrimitiveLiteral(this)}toString(){return Zi.unparse(this)}}pn.$undefined=new pn(void 0),pn.$null=new pn(null),pn.$true=new pn(!0),pn.$false=new pn(!1),pn.$empty=new pn("");class gn{constructor(t){this.elements=t}get $kind(){return 17955}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(t,e,i,n){return this.elements.map((r=>r.evaluate(t,e,i,n)))}assign(t,e,i,n){}accept(t){return t.visitArrayLiteral(this)}toString(){return Zi.unparse(this)}}gn.$empty=new gn(ze);class vn{constructor(t,e){this.keys=t,this.values=e}get $kind(){return 17956}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(t,e,i,n){const r={};for(let s=0;s<this.keys.length;++s)r[this.keys[s]]=this.values[s].evaluate(t,e,i,n);return r}assign(t,e,i,n){}accept(t){return t.visitObjectLiteral(this)}toString(){return Zi.unparse(this)}}vn.$empty=new vn(ze,ze);class mn{constructor(t,e=ze){this.cooked=t,this.expressions=e}get $kind(){return 17958}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(t,e,i,n){let r=this.cooked[0];for(let s=0;s<this.expressions.length;++s)r+=String(this.expressions[s].evaluate(t,e,i,n)),r+=this.cooked[s+1];return r}assign(t,e,i,n){}accept(t){return t.visitTemplate(this)}toString(){return Zi.unparse(this)}}mn.$empty=new mn([""]);class yn{constructor(t,e,i,n=ze){this.cooked=t,this.func=i,this.expressions=n,t.raw=e}get $kind(){return 1197}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(t,e,i,n){const r=this.expressions.map((r=>r.evaluate(t,e,i,n))),s=this.func.evaluate(t,e,i,n);if(!wi(s))throw new Error("AUR0110");return s(this.cooked,...r)}assign(t,e,i,n){}accept(t){return t.visitTaggedTemplate(this)}toString(){return Zi.unparse(this)}}class bn{constructor(t){this.elements=t}get $kind(){return 65556}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(t,e,i,n){}assign(t,e,i,n){}accept(t){return t.visitArrayBindingPattern(this)}toString(){return Zi.unparse(this)}}class wn{constructor(t,e){this.keys=t,this.values=e}get $kind(){return 65557}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(t,e,i,n){}assign(t,e,i,n){}accept(t){return t.visitObjectBindingPattern(this)}toString(){return Zi.unparse(this)}}class _n{constructor(t){this.name=t}get $kind(){return 65558}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(t,e,i,n){return this.name}accept(t){return t.visitBindingIdentifier(this)}toString(){return Zi.unparse(this)}}const xn=Object.prototype.toString;class kn{constructor(t,e){this.declaration=t,this.iterable=e}get $kind(){return 6199}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(t,e,i,n){return this.iterable.evaluate(t,e,i,n)}assign(t,e,i,n){}count(t,e){switch(xn.call(e)){case"[object Array]":return e.length;case"[object Map]":case"[object Set]":return e.size;case"[object Number]":return e;case"[object Null]":case"[object Undefined]":return 0;default:throw new Error(`Cannot count ${xn.call(e)}`)}}iterate(t,e,i){switch(xn.call(e)){case"[object Array]":return Tn(e,i);case"[object Map]":return function(t,e){const i=Array(t.size);let n=-1;for(const e of t.entries())i[++n]=e;Tn(i,e)}(e,i);case"[object Set]":return function(t,e){const i=Array(t.size);let n=-1;for(const e of t.keys())i[++n]=e;Tn(i,e)}(e,i);case"[object Number]":return function(t,e){const i=Array(t);for(let e=0;e<t;++e)i[e]=e;Tn(i,e)}(e,i);case"[object Null]":case"[object Undefined]":return;default:throw new Error(`Cannot iterate over ${xn.call(e)}`)}}bind(t,e,i){this.iterable.hasBind&&this.iterable.bind(t,e,i)}unbind(t,e,i){this.iterable.hasUnbind&&this.iterable.unbind(t,e,i)}accept(t){return t.visitForOfStatement(this)}toString(){return Zi.unparse(this)}}class Cn{constructor(t,e=ze){this.parts=t,this.expressions=e,this.isMulti=e.length>1,this.firstExpression=e[0]}get $kind(){return 24}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(t,e,i,n){if(this.isMulti){let r=this.parts[0];for(let s=0;s<this.expressions.length;++s)r+=String(this.expressions[s].evaluate(t,e,i,n)),r+=this.parts[s+1];return r}return`${this.parts[0]}${this.firstExpression.evaluate(t,e,i,n)}${this.parts[1]}`}assign(t,e,i,n){}accept(t){return t.visitInterpolation(this)}toString(){return Zi.unparse(this)}}class Sn{constructor(t,e,i,n){this.$kind=t,this.list=e,this.source=i,this.initializer=n}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(t,e,i,n){}assign(t,e,i,n){var r;const s=this.list,o=s.length;let a,l;for(a=0;a<o;a++)switch(l=s[a],l.$kind){case 139289:l.assign(t,e,i,n);break;case 90137:case 106521:{if("object"!=typeof n||null===n)throw new Error("AUR0112");let s=l.source.evaluate(t,Ii.create(n),i,null);void 0===s&&(s=null===(r=l.initializer)||void 0===r?void 0:r.evaluate(t,e,i,null)),l.assign(t,e,i,s);break}}}accept(t){return t.visitDestructuringAssignmentExpression(this)}toString(){return Zi.unparse(this)}}class En{constructor(t,e,i){this.target=t,this.source=e,this.initializer=i}get $kind(){return 139289}evaluate(t,e,i,n){}assign(t,e,i,n){var r;if(null==n)return;if("object"!=typeof n)throw new Error("AUR0112");let s=this.source.evaluate(t,Ii.create(n),i,null);void 0===s&&(s=null===(r=this.initializer)||void 0===r?void 0:r.evaluate(t,e,i,null)),this.target.assign(t,e,i,s)}accept(t){return t.visitDestructuringAssignmentSingleExpression(this)}toString(){return Zi.unparse(this)}}function An(t,e,i){const n=null==e?null:e[i];if(wi(n))return n;if(!(8&t)&&null==n)return null;throw new Error(`AUR0111:${i}`)}function Tn(t,e){for(let i=0,n=t.length;i<n;++i)e(t,i,t[i])}const Mn=ae.createInterface("ICoercionConfiguration");var On,Pn,Rn,Ln,In,$n;function Dn(t=0){const e=Array(t);let i=0;for(;i<t;)e[i]=i++;return e.deletedItems=[],e.isIndexMap=!0,e}function Nn(t){return null==t?jn:jn(t)}function jn(t){const e=t.prototype;bi(e,"subs",{get:Fn}),ki(e,"subscribe",zn),ki(e,"unsubscribe",Un)}!function(t){t[t.oneTime=1]="oneTime",t[t.toView=2]="toView",t[t.fromView=4]="fromView",t[t.twoWay=6]="twoWay",t[t.default=8]="default"}(On||(On={})),function(t){t[t.none=0]="none",t[t.persistentBindingFlags=961]="persistentBindingFlags",t[t.allowParentScopeTraversal=64]="allowParentScopeTraversal",t[t.observeLeafPropertiesOnly=128]="observeLeafPropertiesOnly",t[t.targetObserverFlags=769]="targetObserverFlags",t[t.noFlush=256]="noFlush",t[t.persistentTargetObserverQueue=512]="persistentTargetObserverQueue",t[t.bindingStrategy=1]="bindingStrategy",t[t.isStrictBindingStrategy=1]="isStrictBindingStrategy",t[t.fromBind=2]="fromBind",t[t.fromUnbind=4]="fromUnbind",t[t.mustEvaluate=8]="mustEvaluate",t[t.isTraversingParentScope=16]="isTraversingParentScope",t[t.dispose=32]="dispose"}(Pn||(Pn={})),function(t){t[t.None=0]="None",t[t.Subscriber0=1]="Subscriber0",t[t.Subscriber1=2]="Subscriber1",t[t.Subscriber2=4]="Subscriber2",t[t.SubscribersRest=8]="SubscribersRest",t[t.Any=15]="Any"}(Rn||(Rn={})),function(t){t[t.none=0]="none",t[t.capturing=1]="capturing",t[t.bubbling=2]="bubbling"}(Ln||(Ln={})),function(t){t[t.indexed=8]="indexed",t[t.keyed=4]="keyed",t[t.array=9]="array",t[t.map=6]="map",t[t.set=7]="set"}(In||(In={})),function(t){t[t.None=0]="None",t[t.Observer=1]="Observer",t[t.Node=2]="Node",t[t.Layout=4]="Layout",t[t.Primtive=8]="Primtive",t[t.Array=18]="Array",t[t.Set=34]="Set",t[t.Map=66]="Map"}($n||($n={}));class Bn{constructor(){this.sf=0,this.count=0}add(t){if(this.has(t))return!1;const e=this.sf;return 0==(1&e)?(this.s0=t,this.sf|=1):0==(2&e)?(this.s1=t,this.sf|=2):0==(4&e)?(this.s2=t,this.sf|=4):0==(8&e)?(this.sr=[t],this.sf|=8):this.sr.push(t),++this.count,!0}has(t){const e=this.sf;if((1&e)>0&&this.s0===t)return!0;if((2&e)>0&&this.s1===t)return!0;if((4&e)>0&&this.s2===t)return!0;if((8&e)>0){const e=this.sr,i=e.length;let n=0;for(;n<i;++n)if(e[n]===t)return!0}return!1}any(){return 0!==this.sf}remove(t){const e=this.sf;if((1&e)>0&&this.s0===t)return this.s0=void 0,this.sf=1^(1|this.sf),--this.count,!0;if((2&e)>0&&this.s1===t)return this.s1=void 0,this.sf=2^(2|this.sf),--this.count,!0;if((4&e)>0&&this.s2===t)return this.s2=void 0,this.sf=4^(4|this.sf),--this.count,!0;if((8&e)>0){const e=this.sr,i=e.length;let n=0;for(;n<i;++n)if(e[n]===t)return e.splice(n,1),1===i&&(this.sf=8^(8|this.sf)),--this.count,!0}return!1}notify(t,e,i){const n=this.s0,r=this.s1,s=this.s2;let o=this.sr;if(void 0!==o&&(o=o.slice()),void 0!==n&&n.handleChange(t,e,i),void 0!==r&&r.handleChange(t,e,i),void 0!==s&&s.handleChange(t,e,i),void 0!==o){const n=o.length;let r,s=0;for(;s<n;++s)r=o[s],void 0!==r&&r.handleChange(t,e,i)}}notifyCollection(t,e){const i=this.s0,n=this.s1,r=this.s2;let s=this.sr;if(void 0!==s&&(s=s.slice()),void 0!==i&&i.handleCollectionChange(t,e),void 0!==n&&n.handleCollectionChange(t,e),void 0!==r&&r.handleCollectionChange(t,e),void 0!==s){const i=s.length;let n,r=0;for(;r<i;++r)n=s[r],void 0!==n&&n.handleCollectionChange(t,e)}}}function Fn(){return xi(this,"subs",new Bn)}function zn(t){return this.subs.add(t)}function Un(t){return this.subs.remove(t)}function Gn(t){return null==t?Hn:Hn(t)}function Hn(t){const e=t.prototype;bi(e,"queue",{get:qn})}class Vn{constructor(){this.t=!1,this.i=new Set}get count(){return this.i.size}add(t){if(this.i.add(t),!this.t){this.t=!0;try{this.i.forEach(Wn)}finally{this.t=!1}}}clear(){this.i.clear(),this.t=!1}}function qn(){return Vn.instance}function Wn(t,e,i){i.delete(t),t.flush()}Vn.instance=new Vn;class Yn{constructor(t){this.owner=t,this.type=18,this.f=0,this.v=this.h=(this.o=t.collection).length}getValue(){return this.o.length}setValue(t,e){const i=this.v;t!==i&&xt(t)&&(0==(256&e)&&(this.o.length=t),this.v=t,this.h=i,this.f=e,this.queue.add(this))}handleCollectionChange(t,e){const i=this.v,n=this.o.length;(this.v=n)!==i&&(this.h=i,this.f=e,this.queue.add(this))}flush(){Jn=this.h,this.h=this.v,this.subs.notify(this.v,Jn,this.f)}}class Xn{constructor(t){this.owner=t,this.f=0,this.v=this.h=(this.o=t.collection).size,this.type=this.o instanceof Map?66:34}getValue(){return this.o.size}setValue(){throw new Error("AUR02")}handleCollectionChange(t,e){const i=this.v,n=this.o.size;(this.v=n)!==i&&(this.h=i,this.f=e,this.queue.add(this))}flush(){Jn=this.h,this.h=this.v,this.subs.notify(this.v,Jn,this.f)}}function Kn(t){const e=t.prototype;ki(e,"subscribe",Qn,!0),ki(e,"unsubscribe",Zn,!0),Gn(t),Nn(t)}function Qn(t){this.subs.add(t)&&1===this.subs.count&&this.owner.subscribe(this)}function Zn(t){this.subs.remove(t)&&0===this.subs.count&&this.owner.subscribe(this)}let Jn;Kn(Yn),Kn(Xn);const tr=new WeakMap;function er(t,e){return t===e?0:(t=null===t?"null":t.toString())<(e=null===e?"null":e.toString())?-1:1}function ir(t,e){return void 0===t?void 0===e?0:1:void 0===e?-1:0}function nr(t,e,i,n,r){let s,o,a,l,h,c,u;for(c=i+1;c<n;c++){for(s=t[c],o=e[c],u=c-1;u>=i&&(a=t[u],l=e[u],h=r(a,s),h>0);u--)t[u+1]=a,e[u+1]=l;t[u+1]=s,e[u+1]=o}}function rr(t,e,i,n,r){let s,o,a,l,h,c,u,d,f,p,g,v,m,y,b,w,_,x,k,C=0,S=0;for(;;){if(n-i<=10)return void nr(t,e,i,n,r);C=i+(n-i>>1),s=t[i],l=e[i],o=t[n-1],h=e[n-1],a=t[C],c=e[C],u=r(s,o),u>0&&(p=s,g=l,s=o,l=h,o=p,h=g),d=r(s,a),d>=0?(p=s,g=l,s=a,l=c,a=o,c=h,o=p,h=g):(f=r(o,a),f>0&&(p=o,g=h,o=a,h=c,a=p,c=g)),t[i]=s,e[i]=l,t[n-1]=a,e[n-1]=c,v=o,m=h,y=i+1,b=n-1,t[C]=t[y],e[C]=e[y],t[y]=v,e[y]=m;t:for(S=y+1;S<b;S++)if(w=t[S],_=e[S],x=r(w,v),x<0)t[S]=t[y],e[S]=e[y],t[y]=w,e[y]=_,y++;else if(x>0){do{if(b--,b==S)break t;k=t[b],x=r(k,v)}while(x>0);t[S]=t[b],e[S]=e[b],t[b]=w,e[b]=_,x<0&&(w=t[S],_=e[S],t[S]=t[y],e[S]=e[y],t[y]=w,e[y]=_,y++)}n-b<y-i?(rr(t,e,b,n,r),n=y):(rr(t,e,i,y,r),i=b)}}const sr=Array.prototype,or=sr.push,ar=sr.unshift,lr=sr.pop,hr=sr.shift,cr=sr.splice,ur=sr.reverse,dr=sr.sort,fr=["push","unshift","pop","shift","splice","reverse","sort"],pr={push:function(...t){const e=tr.get(this);if(void 0===e)return or.apply(this,t);const i=this.length,n=t.length;if(0===n)return i;this.length=e.indexMap.length=i+n;let r=i;for(;r<this.length;)this[r]=t[r-i],e.indexMap[r]=-2,r++;return e.notify(),this.length},unshift:function(...t){const e=tr.get(this);if(void 0===e)return ar.apply(this,t);const i=t.length,n=new Array(i);let r=0;for(;r<i;)n[r++]=-2;ar.apply(e.indexMap,n);const s=ar.apply(this,t);return e.notify(),s},pop:function(){const t=tr.get(this);if(void 0===t)return lr.call(this);const e=t.indexMap,i=lr.call(this),n=e.length-1;return e[n]>-1&&e.deletedItems.push(e[n]),lr.call(e),t.notify(),i},shift:function(){const t=tr.get(this);if(void 0===t)return hr.call(this);const e=t.indexMap,i=hr.call(this);return e[0]>-1&&e.deletedItems.push(e[0]),hr.call(e),t.notify(),i},splice:function(...t){const e=t[0],i=t[1],n=tr.get(this);if(void 0===n)return cr.apply(this,t);const r=this.length,s=0|e,o=s<0?Math.max(r+s,0):Math.min(s,r),a=n.indexMap,l=t.length,h=0===l?0:1===l?r-o:i;if(h>0){let t=o;const e=t+h;for(;t<e;)a[t]>-1&&a.deletedItems.push(a[t]),t++}if(l>2){const t=l-2,n=new Array(t);let r=0;for(;r<t;)n[r++]=-2;cr.call(a,e,i,...n)}else cr.apply(a,t);const c=cr.apply(this,t);return n.notify(),c},reverse:function(){const t=tr.get(this);if(void 0===t)return ur.call(this),this;const e=this.length,i=e/2|0;let n=0;for(;n!==i;){const i=e-n-1,r=this[n],s=t.indexMap[n],o=this[i],a=t.indexMap[i];this[n]=o,t.indexMap[n]=a,this[i]=r,t.indexMap[i]=s,n++}return t.notify(),this},sort:function(t){const e=tr.get(this);if(void 0===e)return dr.call(this,t),this;const i=this.length;if(i<2)return this;rr(this,e.indexMap,0,i,ir);let n=0;for(;n<i&&void 0!==this[n];)n++;return void 0!==t&&wi(t)||(t=er),rr(this,e.indexMap,0,n,t),e.notify(),this}};for(const t of fr)bi(pr[t],"observing",{value:!0,writable:!1,configurable:!1,enumerable:!1});let gr=!1;class vr{constructor(t){this.type=18,gr||(gr=!0,function(){for(const t of fr)!0!==sr[t].observing&&xi(sr,t,pr[t])}()),this.indexObservers={},this.collection=t,this.indexMap=Dn(t.length),this.lenObs=void 0,tr.set(t,this)}notify(){const t=this.indexMap,e=this.collection.length;this.indexMap=Dn(e),this.subs.notifyCollection(t,0)}getLengthObserver(){var t;return null!==(t=this.lenObs)&&void 0!==t?t:this.lenObs=new Yn(this)}getIndexObserver(t){var e,i;return null!==(e=(i=this.indexObservers)[t])&&void 0!==e?e:i[t]=new mr(this,t)}}class mr{constructor(t,e){this.owner=t,this.index=e,this.doNotCache=!0,this.value=this.getValue()}getValue(){return this.owner.collection[this.index]}setValue(t,e){if(t===this.getValue())return;const i=this.owner,n=this.index,r=i.indexMap;r[n]>-1&&r.deletedItems.push(r[n]),r[n]=-2,i.collection[n]=t,i.notify()}handleCollectionChange(t,e){const i=this.index;if(t[i]===i)return;const n=this.value,r=this.value=this.getValue();n!==r&&this.subs.notify(r,n,e)}subscribe(t){this.subs.add(t)&&1===this.subs.count&&this.owner.subscribe(this)}unsubscribe(t){this.subs.remove(t)&&0===this.subs.count&&this.owner.unsubscribe(this)}}function yr(t){let e=tr.get(t);return void 0===e&&(e=new vr(t)),e}Nn(vr),Nn(mr);const br=new WeakMap,wr=Set.prototype,_r=wr.add,xr=wr.clear,kr=wr.delete,Cr=["add","clear","delete"],Sr={add:function(t){const e=br.get(this);if(void 0===e)return _r.call(this,t),this;const i=this.size;return _r.call(this,t),this.size===i||(e.indexMap[i]=-2,e.notify()),this},clear:function(){const t=br.get(this);if(void 0===t)return xr.call(this);if(this.size>0){const e=t.indexMap;let i=0;for(const t of this.keys())e[i]>-1&&e.deletedItems.push(e[i]),i++;xr.call(this),e.length=0,t.notify()}},delete:function(t){const e=br.get(this);if(void 0===e)return kr.call(this,t);if(0===this.size)return!1;let i=0;const n=e.indexMap;for(const r of this.keys()){if(r===t){n[i]>-1&&n.deletedItems.push(n[i]),n.splice(i,1);const r=kr.call(this,t);return!0===r&&e.notify(),r}i++}return!1}},Er={writable:!0,enumerable:!1,configurable:!0};for(const t of Cr)bi(Sr[t],"observing",{value:!0,writable:!1,configurable:!1,enumerable:!1});let Ar=!1;class Tr{constructor(t){this.type=34,Ar||(Ar=!0,function(){for(const t of Cr)!0!==wr[t].observing&&bi(wr,t,{...Er,value:Sr[t]})}()),this.collection=t,this.indexMap=Dn(t.size),this.lenObs=void 0,br.set(t,this)}notify(){const t=this.indexMap,e=this.collection.size;this.indexMap=Dn(e),this.subs.notifyCollection(t,0)}getLengthObserver(){var t;return null!==(t=this.lenObs)&&void 0!==t?t:this.lenObs=new Xn(this)}}function Mr(t){let e=br.get(t);return void 0===e&&(e=new Tr(t)),e}Nn(Tr);const Or=new WeakMap,Pr=Map.prototype,Rr=Pr.set,Lr=Pr.clear,Ir=Pr.delete,$r=["set","clear","delete"],Dr={set:function(t,e){const i=Or.get(this);if(void 0===i)return Rr.call(this,t,e),this;const n=this.get(t),r=this.size;if(Rr.call(this,t,e),this.size===r){let e=0;for(const r of this.entries()){if(r[0]===t)return r[1]!==n&&(i.indexMap.deletedItems.push(i.indexMap[e]),i.indexMap[e]=-2,i.notify()),this;e++}return this}return i.indexMap[r]=-2,i.notify(),this},clear:function(){const t=Or.get(this);if(void 0===t)return Lr.call(this);if(this.size>0){const e=t.indexMap;let i=0;for(const t of this.keys())e[i]>-1&&e.deletedItems.push(e[i]),i++;Lr.call(this),e.length=0,t.notify()}},delete:function(t){const e=Or.get(this);if(void 0===e)return Ir.call(this,t);if(0===this.size)return!1;let i=0;const n=e.indexMap;for(const r of this.keys()){if(r===t){n[i]>-1&&n.deletedItems.push(n[i]),n.splice(i,1);const r=Ir.call(this,t);return!0===r&&e.notify(),r}++i}return!1}},Nr={writable:!0,enumerable:!1,configurable:!0};for(const t of $r)bi(Dr[t],"observing",{value:!0,writable:!1,configurable:!1,enumerable:!1});let jr=!1;class Br{constructor(t){this.type=66,jr||(jr=!0,function(){for(const t of $r)!0!==Pr[t].observing&&bi(Pr,t,{...Nr,value:Dr[t]})}()),this.collection=t,this.indexMap=Dn(t.size),this.lenObs=void 0,Or.set(t,this)}notify(){const t=this.indexMap,e=this.collection.size;this.indexMap=Dn(e),this.subs.notifyCollection(t,0)}getLengthObserver(){var t;return null!==(t=this.lenObs)&&void 0!==t?t:this.lenObs=new Xn(this)}}function Fr(t){let e=Or.get(t);return void 0===e&&(e=new Br(t)),e}function zr(t,e){const i=this.oL.getObserver(t,e);this.obs.add(i)}function Ur(){return xi(this,"obs",new Wr(this))}function Gr(t){let e;if(t instanceof Array)e=yr(t);else if(t instanceof Set)e=Mr(t);else{if(!(t instanceof Map))throw new Error("AUR0210");e=Fr(t)}this.obs.add(e)}function Hr(t){this.obs.add(t)}function Vr(){throw new Error("AUR2011:handleChange")}function qr(){throw new Error("AUR2012:handleCollectionChange")}Nn(Br);class Wr{constructor(t){this.version=0,this.count=0,this.o=new Map,this.b=t}handleChange(t,e,i){return this.b.interceptor.handleChange(t,e,i)}handleCollectionChange(t,e){this.b.interceptor.handleCollectionChange(t,e)}add(t){this.o.has(t)||(t.subscribe(this),++this.count),this.o.set(t,this.version)}clear(){this.o.forEach(Xr,this),this.count=this.o.size}clearAll(){this.o.forEach(Yr,this),this.o.clear(),this.count=0}}function Yr(t,e){e.unsubscribe(this)}function Xr(t,e){this.version!==t&&(e.unsubscribe(this),this.o.delete(e))}function Kr(t){const e=t.prototype;return ki(e,"observe",zr,!0),ki(e,"observeCollection",Gr,!0),ki(e,"subscribeTo",Hr,!0),bi(e,"obs",{get:Ur}),ki(e,"handleChange",Vr),ki(e,"handleCollectionChange",qr),t}function Qr(t){return null==t?Kr:Kr(t)}Kr(class{constructor(t,e,i,n){this.key=t,this.binding=e,this.oL=i,this.locator=n,this.interceptor=this}$bind(){throw new Error("AUR0213:$bind")}$unbind(){throw new Error("AUR0214:$unbind")}handleChange(t,e,i){this.binding[this.key](t,e,i)}});const Zr=ae.createInterface("IExpressionParser",(t=>t.singleton(Jr)));class Jr{constructor(){this.u=Ci(),this.A=Ci(),this.U=Ci()}parse(t,e){let i;switch(e){case 16:return new Ji(t);case 1:return i=this.U[t],void 0===i&&(i=this.U[t]=this.$parse(t,e)),i;case 2:return i=this.A[t],void 0===i&&(i=this.A[t]=this.$parse(t,e)),i;default:if(0===t.length){if((12&e)>0)return pn.$empty;throw new Error("AUR0169")}return i=this.u[t],void 0===i&&(i=this.u[t]=this.$parse(t,e)),i}}$parse(t,e){return ds.ip=t,ds.length=t.length,ds.index=0,ds.O=t.charCodeAt(0),fs(ds,0,61,void 0===e?8:e)}}var ts,es,is,ns;function rs(t){switch(t){case 98:return 8;case 116:return 9;case 110:return 10;case 118:return 11;case 102:return 12;case 114:return 13;case 34:return 34;case 39:return 39;case 92:return 92;default:return t}}!function(t){t[t.Null=0]="Null",t[t.Backspace=8]="Backspace",t[t.Tab=9]="Tab",t[t.LineFeed=10]="LineFeed",t[t.VerticalTab=11]="VerticalTab",t[t.FormFeed=12]="FormFeed",t[t.CarriageReturn=13]="CarriageReturn",t[t.Space=32]="Space",t[t.Exclamation=33]="Exclamation",t[t.DoubleQuote=34]="DoubleQuote",t[t.Dollar=36]="Dollar",t[t.Percent=37]="Percent",t[t.Ampersand=38]="Ampersand",t[t.SingleQuote=39]="SingleQuote",t[t.OpenParen=40]="OpenParen",t[t.CloseParen=41]="CloseParen",t[t.Asterisk=42]="Asterisk",t[t.Plus=43]="Plus",t[t.Comma=44]="Comma",t[t.Minus=45]="Minus",t[t.Dot=46]="Dot",t[t.Slash=47]="Slash",t[t.Semicolon=59]="Semicolon",t[t.Backtick=96]="Backtick",t[t.OpenBracket=91]="OpenBracket",t[t.Backslash=92]="Backslash",t[t.CloseBracket=93]="CloseBracket",t[t.Caret=94]="Caret",t[t.Underscore=95]="Underscore",t[t.OpenBrace=123]="OpenBrace",t[t.Bar=124]="Bar",t[t.CloseBrace=125]="CloseBrace",t[t.Colon=58]="Colon",t[t.LessThan=60]="LessThan",t[t.Equals=61]="Equals",t[t.GreaterThan=62]="GreaterThan",t[t.Question=63]="Question",t[t.Zero=48]="Zero",t[t.One=49]="One",t[t.Two=50]="Two",t[t.Three=51]="Three",t[t.Four=52]="Four",t[t.Five=53]="Five",t[t.Six=54]="Six",t[t.Seven=55]="Seven",t[t.Eight=56]="Eight",t[t.Nine=57]="Nine",t[t.UpperA=65]="UpperA",t[t.UpperB=66]="UpperB",t[t.UpperC=67]="UpperC",t[t.UpperD=68]="UpperD",t[t.UpperE=69]="UpperE",t[t.UpperF=70]="UpperF",t[t.UpperG=71]="UpperG",t[t.UpperH=72]="UpperH",t[t.UpperI=73]="UpperI",t[t.UpperJ=74]="UpperJ",t[t.UpperK=75]="UpperK",t[t.UpperL=76]="UpperL",t[t.UpperM=77]="UpperM",t[t.UpperN=78]="UpperN",t[t.UpperO=79]="UpperO",t[t.UpperP=80]="UpperP",t[t.UpperQ=81]="UpperQ",t[t.UpperR=82]="UpperR",t[t.UpperS=83]="UpperS",t[t.UpperT=84]="UpperT",t[t.UpperU=85]="UpperU",t[t.UpperV=86]="UpperV",t[t.UpperW=87]="UpperW",t[t.UpperX=88]="UpperX",t[t.UpperY=89]="UpperY",t[t.UpperZ=90]="UpperZ",t[t.LowerA=97]="LowerA",t[t.LowerB=98]="LowerB",t[t.LowerC=99]="LowerC",t[t.LowerD=100]="LowerD",t[t.LowerE=101]="LowerE",t[t.LowerF=102]="LowerF",t[t.LowerG=103]="LowerG",t[t.LowerH=104]="LowerH",t[t.LowerI=105]="LowerI",t[t.LowerJ=106]="LowerJ",t[t.LowerK=107]="LowerK",t[t.LowerL=108]="LowerL",t[t.LowerM=109]="LowerM",t[t.LowerN=110]="LowerN",t[t.LowerO=111]="LowerO",t[t.LowerP=112]="LowerP",t[t.LowerQ=113]="LowerQ",t[t.LowerR=114]="LowerR",t[t.LowerS=115]="LowerS",t[t.LowerT=116]="LowerT",t[t.LowerU=117]="LowerU",t[t.LowerV=118]="LowerV",t[t.LowerW=119]="LowerW",t[t.LowerX=120]="LowerX",t[t.LowerY=121]="LowerY",t[t.LowerZ=122]="LowerZ"}(ts||(ts={})),function(t){t[t.Reset=0]="Reset",t[t.Ancestor=511]="Ancestor",t[t.This=512]="This",t[t.Scope=1024]="Scope",t[t.Member=2048]="Member",t[t.Keyed=4096]="Keyed"}(es||(es={})),function(t){t[t.Variadic=61]="Variadic",t[t.Assign=62]="Assign",t[t.Conditional=63]="Conditional",t[t.LogicalOR=64]="LogicalOR",t[t.LogicalAND=128]="LogicalAND",t[t.Equality=192]="Equality",t[t.Relational=256]="Relational",t[t.Additive=320]="Additive",t[t.Multiplicative=384]="Multiplicative",t[t.Binary=448]="Binary",t[t.LeftHandSide=449]="LeftHandSide",t[t.Primary=450]="Primary",t[t.Unary=451]="Unary"}(is||(is={})),function(t){t[t.EOF=1572864]="EOF",t[t.ExpressionTerminal=1048576]="ExpressionTerminal",t[t.AccessScopeTerminal=524288]="AccessScopeTerminal",t[t.ClosingToken=262144]="ClosingToken",t[t.OpeningToken=131072]="OpeningToken",t[t.BinaryOp=65536]="BinaryOp",t[t.UnaryOp=32768]="UnaryOp",t[t.LeftHandSide=16384]="LeftHandSide",t[t.StringOrNumericLiteral=12288]="StringOrNumericLiteral",t[t.NumericLiteral=8192]="NumericLiteral",t[t.StringLiteral=4096]="StringLiteral",t[t.IdentifierName=3072]="IdentifierName",t[t.Keyword=2048]="Keyword",t[t.Identifier=1024]="Identifier",t[t.Contextual=512]="Contextual",t[t.Precedence=448]="Precedence",t[t.Type=63]="Type",t[t.FalseKeyword=2048]="FalseKeyword",t[t.TrueKeyword=2049]="TrueKeyword",t[t.NullKeyword=2050]="NullKeyword",t[t.UndefinedKeyword=2051]="UndefinedKeyword",t[t.ThisScope=3076]="ThisScope",t[t.ParentScope=3078]="ParentScope",t[t.OpenParen=671751]="OpenParen",t[t.OpenBrace=131080]="OpenBrace",t[t.Dot=16393]="Dot",t[t.CloseBrace=1835018]="CloseBrace",t[t.CloseParen=1835019]="CloseParen",t[t.Comma=1572876]="Comma",t[t.OpenBracket=671757]="OpenBracket",t[t.CloseBracket=1835022]="CloseBracket",t[t.Colon=1572879]="Colon",t[t.Question=1572880]="Question",t[t.Ampersand=1572883]="Ampersand",t[t.Bar=1572884]="Bar",t[t.BarBar=1638549]="BarBar",t[t.AmpersandAmpersand=1638614]="AmpersandAmpersand",t[t.EqualsEquals=1638679]="EqualsEquals",t[t.ExclamationEquals=1638680]="ExclamationEquals",t[t.EqualsEqualsEquals=1638681]="EqualsEqualsEquals",t[t.ExclamationEqualsEquals=1638682]="ExclamationEqualsEquals",t[t.LessThan=1638747]="LessThan",t[t.GreaterThan=1638748]="GreaterThan",t[t.LessThanEquals=1638749]="LessThanEquals",t[t.GreaterThanEquals=1638750]="GreaterThanEquals",t[t.InKeyword=1640799]="InKeyword",t[t.InstanceOfKeyword=1640800]="InstanceOfKeyword",t[t.Plus=623009]="Plus",t[t.Minus=623010]="Minus",t[t.TypeofKeyword=34851]="TypeofKeyword",t[t.VoidKeyword=34852]="VoidKeyword",t[t.Asterisk=1638885]="Asterisk",t[t.Percent=1638886]="Percent",t[t.Slash=1638887]="Slash",t[t.Equals=1048616]="Equals",t[t.Exclamation=32809]="Exclamation",t[t.TemplateTail=540714]="TemplateTail",t[t.TemplateContinuation=540715]="TemplateContinuation",t[t.OfKeyword=1051180]="OfKeyword"}(ns||(ns={}));const ss=pn.$false,os=pn.$true,as=pn.$null,ls=pn.$undefined,hs=sn.$this,cs=sn.$parent;var us;!function(t){t[t.None=0]="None",t[t.Interpolation=1]="Interpolation",t[t.IsIterator=2]="IsIterator",t[t.IsFunction=4]="IsFunction",t[t.IsProperty=8]="IsProperty",t[t.IsCustom=16]="IsCustom"}(us||(us={}));const ds=new class{constructor(t){this.ip=t,this.index=0,this.C=0,this.B=0,this.$=1572864,this.L="",this.R=!0,this.length=t.length,this.O=t.charCodeAt(0)}get P(){return this.ip.slice(this.C,this.index)}}("");function fs(t,e,i,n){if(16===n)return new Ji(t.ip);if(0===t.index){if(1&n)return function(t){const e=[],i=[],n=t.length;let r="";for(;t.index<n;){switch(t.O){case 36:if(123===t.ip.charCodeAt(t.index+1)){e.push(r),r="",t.index+=2,t.O=t.ip.charCodeAt(t.index),gs(t);const n=fs(t,0,61,1);i.push(n);continue}r+="$";break;case 92:r+=String.fromCharCode(rs(vs(t)));break;default:r+=String.fromCharCode(t.O)}vs(t)}return i.length?(e.push(r),new Cn(e,i)):null}(t);if(gs(t),1048576&t.$)throw new Error(`AUR0151:${t.ip}`)}let r;if(t.R=448>i,32768&t.$){const i=xs[63&t.$];gs(t),r=new fn(i,fs(t,e,449,n)),t.R=!1}else{t:switch(t.$){case 3078:t.R=!1;do{if(gs(t),e++,!ws(t,16393)){if(524288&t.$){const t=511&e;r=0===t?hs:1===t?cs:new sn(t),e=512;break t}throw new Error(`AUR0154:${t.ip}`)}if(16393===t.$)throw new Error(`AUR0152:${t.ip}`);if(1572864===t.$)throw new Error(`AUR0153:${t.ip}`)}while(3078===t.$);case 1024:2&n?r=new _n(t.L):(r=new on(t.L,511&e),e=1024),t.R=!0,gs(t);break;case 3076:t.R=!1,gs(t),r=hs,e=512;break;case 671751:gs(t),r=fs(t,0,62,n),_s(t,1835019),e=0;break;case 671757:r=t.ip.search(/\s+of\s+/)>t.index?function(t){const e=[],i=new Sn(90137,e,void 0,void 0);let n="",r=!0,s=0;for(;r;)switch(gs(t),t.$){case 1835022:r=!1,o();break;case 1572876:o();break;case 1024:n=t.P;break;default:throw new Error(`AUR0170:${t.ip}`)}return _s(t,1835022),i;function o(){""!==n?(e.push(new En(new an(hs,n),new ln(hs,new pn(s++)),void 0)),n=""):s++}}(t):function(t,e,i){gs(t);const n=new Array;for(;1835022!==t.$;)if(ws(t,1572876)){if(n.push(ls),1835022===t.$)break}else{if(n.push(fs(t,e,62,-3&i)),!ws(t,1572876))break;if(1835022===t.$)break}return _s(t,1835022),2&i?new bn(n):(t.R=!1,new gn(n))}(t,e,n),e=0;break;case 131080:r=function(t,e){const i=new Array,n=new Array;for(gs(t);1835018!==t.$;){if(i.push(t.L),12288&t.$)gs(t),_s(t,1572879),n.push(fs(t,0,62,-3&e));else{if(!(3072&t.$))throw new Error(`AUR0164:${t.ip}`);{const{O:i,$:r,index:s}=t;gs(t),ws(t,1572879)?n.push(fs(t,0,62,-3&e)):(t.O=i,t.$=r,t.index=s,n.push(fs(t,0,450,-3&e)))}}1835018!==t.$&&_s(t,1572876)}return _s(t,1835018),2&e?new wn(i,n):(t.R=!1,new vn(i,n))}(t,n),e=0;break;case 540714:r=new mn([t.L]),t.R=!1,gs(t),e=0;break;case 540715:r=ps(t,e,n,r,!1),e=0;break;case 4096:case 8192:r=new pn(t.L),t.R=!1,gs(t),e=0;break;case 2050:case 2051:case 2049:case 2048:r=xs[63&t.$],t.R=!1,gs(t),e=0;break;default:throw t.index>=t.length?new Error(`AUR0155:${t.ip}`):new Error(`AUR0156:${t.ip}`)}if(2&n)return function(t,e){if(0==(65536&e.$kind))throw new Error(`AUR0163:${t.ip}`);if(1051180!==t.$)throw new Error(`AUR0163:${t.ip}`);gs(t);const i=e,n=fs(t,0,61,0);return new kn(i,n)}(t,r);if(449<i)return r;let s=t.L;for(;(16384&t.$)>0;){const i=[];let o;switch(t.$){case 16393:if(t.R=!0,gs(t),0==(3072&t.$))throw new Error(`AUR0153:${t.ip}`);if(s=t.L,gs(t),e=(1536&e)<<1|2048&e|(4096&e)>>1,671751===t.$){0===e&&(e=2048);continue}r=1024&e?new on(s,r.ancestor):new an(r,s);continue;case 671757:t.R=!0,gs(t),e=4096,r=new ln(r,fs(t,0,62,n)),_s(t,1835022);break;case 671751:for(t.R=!1,gs(t);1835019!==t.$&&(i.push(fs(t,0,62,n)),ws(t,1572876)););_s(t,1835019),r=1024&e?new hn(s,i,r.ancestor):2048&e?new cn(r,s,i):new un(r,i),e=0;break;case 540714:t.R=!1,o=[t.L],r=new yn(o,o,r),gs(t);break;case 540715:r=ps(t,e,n,r,!0)}}}if(448<i)return r;for(;(65536&t.$)>0;){const s=t.$;if((448&s)<=i)break;gs(t),r=new dn(xs[63&s],r,fs(t,e,448&s,n)),t.R=!1}if(63<i)return r;if(ws(t,1572880)){const i=fs(t,e,62,n);_s(t,1572879),r=new rn(r,i,fs(t,e,62,n)),t.R=!1}if(62<i)return r;if(ws(t,1048616)){if(!t.R)throw new Error(`AUR0158:${t.ip}`);r=new nn(r,fs(t,e,62,n))}if(61<i)return r;for(;ws(t,1572884);){if(1572864===t.$)throw new Error(`AUR0159:${t.ip}`);const i=t.L;gs(t);const s=new Array;for(;ws(t,1572879);)s.push(fs(t,e,62,n));r=new en(r,i,s)}for(;ws(t,1572883);){if(1572864===t.$)throw new Error(`AUR0160:${t.ip}`);const i=t.L;gs(t);const s=new Array;for(;ws(t,1572879);)s.push(fs(t,e,62,n));r=new tn(r,i,s)}if(1572864!==t.$){if(1&n)return r;if("of"===t.P)throw new Error(`AUR0161:${t.ip}`);throw new Error(`AUR0162:${t.ip}`)}return r}function ps(t,e,i,n,r){const s=[t.L];_s(t,540715);const o=[fs(t,e,62,i)];for(;540714!==(t.$=bs(t));)s.push(t.L),_s(t,540715),o.push(fs(t,e,62,i));return s.push(t.L),t.R=!1,r?(gs(t),new yn(s,s,n,o)):(gs(t),new mn(s,o))}function gs(t){for(;t.index<t.length;)if(t.C=t.index,null!=(t.$=Os[t.O](t)))return;t.$=1572864}function vs(t){return t.O=t.ip.charCodeAt(++t.index)}function ms(t,e){let i=t.O;if(!1===e){do{i=vs(t)}while(i<=57&&i>=48);if(46!==i)return t.L=parseInt(t.P,10),8192;if(i=vs(t),t.index>=t.length)return t.L=parseInt(t.P.slice(0,-1),10),8192}if(i<=57&&i>=48)do{i=vs(t)}while(i<=57&&i>=48);else t.O=t.ip.charCodeAt(--t.index);return t.L=parseFloat(t.P),8192}function ys(t){let e=!0,i="";for(;96!==vs(t);)if(36===t.O){if(t.index+1<t.length&&123===t.ip.charCodeAt(t.index+1)){t.index++,e=!1;break}i+="$"}else if(92===t.O)i+=String.fromCharCode(rs(vs(t)));else{if(t.index>=t.length)throw new Error(`AUR0166:${t.ip}`);i+=String.fromCharCode(t.O)}return vs(t),t.L=i,e?540714:540715}function bs(t){if(t.index>=t.length)throw new Error(`AUR0166:${t.ip}`);return t.index--,ys(t)}function ws(t,e){return t.$===e&&(gs(t),!0)}function _s(t,e){if(t.$!==e)throw new Error(`AUR0167:${t.ip}<${e}`);gs(t)}const xs=[ss,os,as,ls,"$this",null,"$parent","(","{",".","}",")",",","[","]",":","?","'",'"',"&","|","||","&&","==","!=","===","!==","<",">","<=",">=","in","instanceof","+","-","typeof","void","*","%","/","=","!",540714,540715,"of"],ks=Ci();ks.true=2049,ks.null=2050,ks.false=2048,ks.undefined=2051,ks.$this=3076,ks.$parent=3078,ks.in=1640799,ks.instanceof=1640800,ks.typeof=34851,ks.void=34852,ks.of=1051180;const Cs=[36,0,65,91,95,0,97,123,170,0,186,0,192,215,216,247,248,697,736,741,7424,7462,7468,7517,7522,7526,7531,7544,7545,7615,7680,7936,8305,0,8319,0,8336,8349,8490,8492,8498,0,8526,0,8544,8585,11360,11392,42786,42888,42891,42927,42928,42936,42999,43008,43824,43867,43868,43877,64256,64263,65313,65339,65345,65371],Ss=[48,58];function Es(t,e,i,n){const r=i.length;for(let s=0;s<r;s+=2){const r=i[s];let o=i[s+1];if(o=o>0?o:r+1,t&&t.fill(n,r,o),e)for(let t=r;t<o;t++)e.add(t)}}function As(t){return e=>(vs(e),t)}const Ts=t=>{throw new Error(`AUR0168:${t.ip}`)};Ts.notMapped=!0,Es(null,new Set,[36,0,48,58,65,91,95,0,97,123],!0);const Ms=new Uint8Array(65535);Es(Ms,null,Cs,1),Es(Ms,null,Ss,1);const Os=new Array(65535);Os.fill(Ts,0,65535),Es(Os,null,[0,33,127,161],(t=>(vs(t),null))),Es(Os,null,Cs,(function(t){for(;Ms[vs(t)];);const e=ks[t.L=t.P];return void 0===e?1024:e})),Es(Os,null,Ss,(t=>ms(t,!1))),Os[34]=Os[39]=t=>function(t){const e=t.O;vs(t);let i=0;const n=new Array;let r=t.index;for(;t.O!==e;)if(92===t.O)n.push(t.ip.slice(r,t.index)),vs(t),i=rs(t.O),vs(t),n.push(String.fromCharCode(i)),r=t.index;else{if(t.index>=t.length)throw new Error(`AUR0165:${t.ip}`);vs(t)}const s=t.ip.slice(r,t.index);vs(t),n.push(s);const o=n.join("");return t.L=o,4096}(t),Os[96]=t=>ys(t),Os[33]=t=>61!==vs(t)?32809:61!==vs(t)?1638680:(vs(t),1638682),Os[61]=t=>61!==vs(t)?1048616:61!==vs(t)?1638679:(vs(t),1638681),Os[38]=t=>38!==vs(t)?1572883:(vs(t),1638614),Os[124]=t=>124!==vs(t)?1572884:(vs(t),1638549),Os[46]=t=>vs(t)<=57&&t.O>=48?ms(t,!0):16393,Os[60]=t=>61!==vs(t)?1638747:(vs(t),1638749),Os[62]=t=>61!==vs(t)?1638748:(vs(t),1638750),Os[37]=As(1638886),Os[40]=As(671751),Os[41]=As(1835019),Os[42]=As(1638885),Os[43]=As(623009),Os[44]=As(1572876),Os[45]=As(623010),Os[47]=As(1638887),Os[58]=As(1572879),Os[63]=As(1572880),Os[91]=As(671757),Os[93]=As(1835022),Os[123]=As(131080),Os[125]=As(1835018);let Ps=null;const Rs=[];let Ls=!1;function Is(){return Ps}function $s(t){if(null==t)throw new Error("AUR0206");if(null==Ps)return Ps=t,Rs[0]=Ps,void(Ls=!0);if(Ps===t)throw new Error("AUR0207");Rs.push(t),Ps=t,Ls=!0}function Ds(t){if(null==t)throw new Error("AUR0208");if(Ps!==t)throw new Error("AUR0209");Rs.pop(),Ps=Rs.length>0?Rs[Rs.length-1]:null,Ls=null!=Ps}const Ns=Object.freeze({get current(){return Ps},get connecting(){return Ls},enter:$s,exit:Ds,pause:function(){Ls=!1},resume:function(){Ls=!0}}),js=Reflect.get,Bs=Object.prototype.toString,Fs=new WeakMap;function zs(t){switch(Bs.call(t)){case"[object Object]":case"[object Array]":case"[object Map]":case"[object Set]":return!0;default:return!1}}const Us="__raw__";function Gs(t){return zs(t)?Hs(t):t}function Hs(t){var e;return null!==(e=Fs.get(t))&&void 0!==e?e:function(t){const e=t instanceof Array?Xs:t instanceof Map||t instanceof Set?bo:Ys,i=new Proxy(t,e);return Fs.set(t,i),i}(t)}function Vs(t){var e;return null!==(e=t[Us])&&void 0!==e?e:t}function qs(t){return zs(t)&&t[Us]||t}function Ws(t){return"constructor"===t||"__proto__"===t||"$observers"===t||t===Symbol.toPrimitive||t===Symbol.toStringTag}const Ys={get(t,e,i){if(e===Us)return t;const n=Is();return!Ls||Ws(e)||null==n?js(t,e,i):(n.observe(t,e),Gs(js(t,e,i)))}},Xs={get(t,e,i){if(e===Us)return t;const n=Is();if(!Ls||Ws(e)||null==n)return js(t,e,i);switch(e){case"length":return n.observe(t,"length"),t.length;case"map":return Ks;case"includes":return Js;case"indexOf":return to;case"lastIndexOf":return eo;case"every":return Qs;case"filter":return Zs;case"find":return no;case"findIndex":return io;case"flat":return ro;case"flatMap":return so;case"join":return oo;case"push":return lo;case"pop":return ao;case"reduce":return mo;case"reduceRight":return yo;case"reverse":return fo;case"shift":return ho;case"unshift":return co;case"slice":return vo;case"splice":return uo;case"some":return po;case"sort":return go;case"keys":return Ao;case"values":case Symbol.iterator:return To;case"entries":return Mo}return n.observe(t,e),Gs(js(t,e,i))},ownKeys(t){var e;return null===(e=Is())||void 0===e||e.observe(t,"length"),Reflect.ownKeys(t)}};function Ks(t,e){var i;const n=Vs(this),r=n.map(((i,n)=>qs(t.call(e,Gs(i),n,this))));return null===(i=Is())||void 0===i||i.observeCollection(n),Gs(r)}function Qs(t,e){var i;const n=Vs(this),r=n.every(((i,n)=>t.call(e,Gs(i),n,this)));return null===(i=Is())||void 0===i||i.observeCollection(n),r}function Zs(t,e){var i;const n=Vs(this),r=n.filter(((i,n)=>qs(t.call(e,Gs(i),n,this))));return null===(i=Is())||void 0===i||i.observeCollection(n),Gs(r)}function Js(t){var e;const i=Vs(this),n=i.includes(qs(t));return null===(e=Is())||void 0===e||e.observeCollection(i),n}function to(t){var e;const i=Vs(this),n=i.indexOf(qs(t));return null===(e=Is())||void 0===e||e.observeCollection(i),n}function eo(t){var e;const i=Vs(this),n=i.lastIndexOf(qs(t));return null===(e=Is())||void 0===e||e.observeCollection(i),n}function io(t,e){var i;const n=Vs(this),r=n.findIndex(((i,n)=>qs(t.call(e,Gs(i),n,this))));return null===(i=Is())||void 0===i||i.observeCollection(n),r}function no(t,e){var i;const n=Vs(this),r=n.find(((e,i)=>t(Gs(e),i,this)),e);return null===(i=Is())||void 0===i||i.observeCollection(n),Gs(r)}function ro(){var t;const e=Vs(this);return null===(t=Is())||void 0===t||t.observeCollection(e),Gs(e.flat())}function so(t,e){var i;const n=Vs(this);return null===(i=Is())||void 0===i||i.observeCollection(n),Hs(n.flatMap(((i,n)=>Gs(t.call(e,Gs(i),n,this)))))}function oo(t){var e;const i=Vs(this);return null===(e=Is())||void 0===e||e.observeCollection(i),i.join(t)}function ao(){return Gs(Vs(this).pop())}function lo(...t){return Vs(this).push(...t)}function ho(){return Gs(Vs(this).shift())}function co(...t){return Vs(this).unshift(...t)}function uo(...t){return Gs(Vs(this).splice(...t))}function fo(...t){var e;const i=Vs(this),n=i.reverse();return null===(e=Is())||void 0===e||e.observeCollection(i),Gs(n)}function po(t,e){var i;const n=Vs(this),r=n.some(((i,n)=>qs(t.call(e,Gs(i),n,this))));return null===(i=Is())||void 0===i||i.observeCollection(n),r}function go(t){var e;const i=Vs(this),n=i.sort(t);return null===(e=Is())||void 0===e||e.observeCollection(i),Gs(n)}function vo(t,e){var i;const n=Vs(this);return null===(i=Is())||void 0===i||i.observeCollection(n),Hs(n.slice(t,e))}function mo(t,e){var i;const n=Vs(this),r=n.reduce(((e,i,n)=>t(e,Gs(i),n,this)),e);return null===(i=Is())||void 0===i||i.observeCollection(n),Gs(r)}function yo(t,e){var i;const n=Vs(this),r=n.reduceRight(((e,i,n)=>t(e,Gs(i),n,this)),e);return null===(i=Is())||void 0===i||i.observeCollection(n),Gs(r)}const bo={get(t,e,i){if(e===Us)return t;const n=Is();if(!Ls||Ws(e)||null==n)return js(t,e,i);switch(e){case"size":return n.observe(t,"size"),t.size;case"clear":return So;case"delete":return Eo;case"forEach":return wo;case"add":if(t instanceof Set)return Co;break;case"get":if(t instanceof Map)return xo;break;case"set":if(t instanceof Map)return ko;break;case"has":return _o;case"keys":return Ao;case"values":return To;case"entries":return Mo;case Symbol.iterator:return t instanceof Map?Mo:To}return Gs(js(t,e,i))}};function wo(t,e){var i;const n=Vs(this);return null===(i=Is())||void 0===i||i.observeCollection(n),n.forEach(((i,n)=>{t.call(e,Gs(i),Gs(n),this)}))}function _o(t){var e;const i=Vs(this);return null===(e=Is())||void 0===e||e.observeCollection(i),i.has(qs(t))}function xo(t){var e;const i=Vs(this);return null===(e=Is())||void 0===e||e.observeCollection(i),Gs(i.get(qs(t)))}function ko(t,e){return Gs(Vs(this).set(qs(t),qs(e)))}function Co(t){return Gs(Vs(this).add(qs(t)))}function So(){return Gs(Vs(this).clear())}function Eo(t){return Gs(Vs(this).delete(qs(t)))}function Ao(){var t;const e=Vs(this);null===(t=Is())||void 0===t||t.observeCollection(e);const i=e.keys();return{next(){const t=i.next(),e=t.value,n=t.done;return n?{value:void 0,done:n}:{value:Gs(e),done:n}},[Symbol.iterator](){return this}}}function To(){var t;const e=Vs(this);null===(t=Is())||void 0===t||t.observeCollection(e);const i=e.values();return{next(){const t=i.next(),e=t.value,n=t.done;return n?{value:void 0,done:n}:{value:Gs(e),done:n}},[Symbol.iterator](){return this}}}function Mo(){var t;const e=Vs(this);null===(t=Is())||void 0===t||t.observeCollection(e);const i=e.entries();return{next(){const t=i.next(),e=t.value,n=t.done;return n?{value:void 0,done:n}:{value:[Gs(e[0]),Gs(e[1])],done:n}},[Symbol.iterator](){return this}}}const Oo=Object.freeze({getProxy:Hs,getRaw:Vs,wrap:Gs,unwrap:qs,rawKey:Us});class Po{constructor(t,e,i,n,r){this.interceptor=this,this.type=1,this.v=void 0,this.ov=void 0,this.ir=!1,this.D=!1,this.o=t,this.get=e,this.set=i,this.up=n,this.oL=r}static create(t,e,i,n,r){const s=i.get,o=i.set,a=new Po(t,s,o,r,n),l=()=>a.getValue();return l.getObserver=()=>a,bi(t,e,{enumerable:i.enumerable,configurable:!0,get:l,set:t=>{a.setValue(t,0)}}),a}getValue(){return 0===this.subs.count?this.get.call(this.o,this):(this.D&&(this.compute(),this.D=!1),this.v)}setValue(t,e){if(!wi(this.set))throw new Error("AUR0221");t!==this.v&&(this.ir=!0,this.set.call(this.o,t),this.ir=!1,this.run())}handleChange(){this.D=!0,this.subs.count>0&&this.run()}handleCollectionChange(){this.D=!0,this.subs.count>0&&this.run()}subscribe(t){this.subs.add(t)&&1===this.subs.count&&(this.compute(),this.D=!1)}unsubscribe(t){this.subs.remove(t)&&0===this.subs.count&&(this.D=!0,this.obs.clearAll())}flush(){Ro=this.ov,this.ov=this.v,this.subs.notify(this.v,Ro,0)}run(){if(this.ir)return;const t=this.v,e=this.compute();this.D=!1,Object.is(e,t)||(this.ov=t,this.queue.add(this))}compute(){this.ir=!0,this.obs.version++;try{return $s(this),this.v=qs(this.get.call(this.up?Gs(this.o):this.o,this))}finally{this.obs.clear(),this.ir=!1,Ds(this)}}}let Ro;Qr(Po),Nn(Po),Gn(Po);const Lo=ae.createInterface("IDirtyChecker",(t=>t.singleton(Do))),Io={timeoutsPerCheck:25,disabled:!1,throw:!1,resetToDefault(){this.timeoutsPerCheck=6,this.disabled=!1,this.throw=!1}},$o={persistent:!0};class Do{constructor(t){this.p=t,this.tracked=[],this.T=null,this.j=0,this.check=()=>{if(Io.disabled)return;if(++this.j<Io.timeoutsPerCheck)return;this.j=0;const t=this.tracked,e=t.length;let i,n=0;for(;n<e;++n)i=t[n],i.isDirty()&&this.queue.add(i)}}createProperty(t,e){if(Io.throw)throw new Error(`AUR0222:${e}`);return new No(this,t,e)}addProperty(t){this.tracked.push(t),1===this.tracked.length&&(this.T=this.p.taskQueue.queueTask(this.check,$o))}removeProperty(t){this.tracked.splice(this.tracked.indexOf(t),1),0===this.tracked.length&&(this.T.cancel(),this.T=null)}}Do.inject=[He],Gn(Do);class No{constructor(t,e,i){this.obj=e,this.key=i,this.type=0,this.ov=void 0,this.I=t}getValue(){return this.obj[this.key]}setValue(t,e){throw new Error(`Trying to set value for property ${this.key} in dirty checker`)}isDirty(){return this.ov!==this.obj[this.key]}flush(){const t=this.ov,e=this.getValue();this.ov=e,this.subs.notify(e,t,0)}subscribe(t){this.subs.add(t)&&1===this.subs.count&&(this.ov=this.obj[this.key],this.I.addProperty(this))}unsubscribe(t){this.subs.remove(t)&&0===this.subs.count&&this.I.removeProperty(this)}}Nn(No);class jo{constructor(t,e){this.type=0,this.o=t,this.k=e}get doNotCache(){return!0}getValue(){return this.o[this.k]}setValue(){}subscribe(){}unsubscribe(){}}class Bo{constructor(){this.type=0}getValue(t,e){return t[e]}setValue(t,e,i,n){i[n]=t}}let Fo;class zo{constructor(t,e){this.type=1,this.v=void 0,this.ov=void 0,this.iO=!1,this.f=0,this.o=t,this.k=e}getValue(){return this.v}setValue(t,e){if(this.iO){if(Object.is(t,this.v))return;this.ov=this.v,this.v=t,this.f=e,this.queue.add(this)}else this.o[this.k]=t}subscribe(t){!1===this.iO&&this.start(),this.subs.add(t)}flush(){Fo=this.ov,this.ov=this.v,this.subs.notify(this.v,Fo,this.f)}start(){return!1===this.iO&&(this.iO=!0,this.v=this.o[this.k],bi(this.o,this.k,{enumerable:!0,configurable:!0,get:()=>this.getValue(),set:t=>{this.setValue(t,0)}})),this}stop(){return this.iO&&(bi(this.o,this.k,{enumerable:!0,configurable:!0,writable:!0,value:this.v}),this.iO=!1),this}}class Uo{constructor(t,e,i,n){this.type=1,this.v=void 0,this.ov=void 0,this.f=0,this.o=t,this.S=i,this.hs=wi(i);const r=t[e];this.cb=wi(r)?r:void 0,this.v=n}getValue(){return this.v}setValue(t,e){var i;this.hs&&(t=this.S(t,null)),Object.is(t,this.v)||(this.ov=this.v,this.v=t,this.f=e,null===(i=this.cb)||void 0===i||i.call(this.o,this.v,this.ov,e),this.queue.add(this))}flush(){Fo=this.ov,this.ov=this.v,this.subs.notify(this.v,Fo,this.f)}}Nn(zo),Nn(Uo),Gn(zo),Gn(Uo);const Go=new Bo,Ho=ae.createInterface("IObserverLocator",(t=>t.singleton(Wo))),Vo=ae.createInterface("INodeObserverLocator",(t=>t.cachedCallback((t=>(t.getAll(Ze).forEach((t=>{t.error("Using default INodeObserverLocator implementation. Will not be able to observe nodes (HTML etc...).")})),new qo)))));class qo{handles(){return!1}getObserver(){return Go}getAccessor(){return Go}}class Wo{constructor(t,e){this.I=t,this.M=e,this.F=[]}addAdapter(t){this.F.push(t)}getObserver(t,e){var i,n;return null!==(n=null===(i=t.$observers)||void 0===i?void 0:i[e])&&void 0!==n?n:this.V(t,e,this.createObserver(t,e))}getAccessor(t,e){var i;const n=null===(i=t.$observers)||void 0===i?void 0:i[e];return void 0!==n?n:this.M.handles(t,e,this)?this.M.getAccessor(t,e,this):Go}getArrayObserver(t){return yr(t)}getMapObserver(t){return Fr(t)}getSetObserver(t){return Mr(t)}createObserver(t,e){var i,n,r,s;if(!(t instanceof Object))return new jo(t,e);if(this.M.handles(t,e,this))return this.M.getObserver(t,e,this);switch(e){case"length":if(t instanceof Array)return yr(t).getLengthObserver();break;case"size":if(t instanceof Map)return Fr(t).getLengthObserver();if(t instanceof Set)return Mr(t).getLengthObserver();break;default:if(t instanceof Array&&xt(e))return yr(t).getIndexObserver(Number(e))}let o=Xo(t,e);if(void 0===o){let i=Yo(t);for(;null!==i&&(o=Xo(i,e),void 0===o);)i=Yo(i)}if(void 0!==o&&!yi.call(o,"value")){let a=this.N(t,e,o);return null==a&&(a=null===(s=null!==(n=null===(i=o.get)||void 0===i?void 0:i.getObserver)&&void 0!==n?n:null===(r=o.set)||void 0===r?void 0:r.getObserver)||void 0===s?void 0:s(t,this)),null==a?o.configurable?Po.create(t,e,o,this,!0):this.I.createProperty(t,e):a}return new zo(t,e)}N(t,e,i){if(this.F.length>0)for(const n of this.F){const r=n.getObserver(t,e,i,this);if(null!=r)return r}return null}V(t,e,i){return!0===i.doNotCache?i:void 0===t.$observers?(bi(t,"$observers",{value:{[e]:i}}),i):t.$observers[e]=i}}Wo.inject=[Lo,Vo];const Yo=Object.getPrototypeOf,Xo=Object.getOwnPropertyDescriptor;ae.createInterface("IObservation",(t=>t.singleton(Ko)));class Ko{constructor(t){this.oL=t}static get inject(){return[Ho]}run(t){const e=new Qo(this.oL,t);return e.run(),e}}class Qo{constructor(t,e){this.oL=t,this.fn=e,this.interceptor=this,this.maxRunCount=10,this.queued=!1,this.running=!1,this.runCount=0,this.stopped=!1}handleChange(){this.queued=!0,this.run()}handleCollectionChange(){this.queued=!0,this.run()}run(){if(this.stopped)throw new Error("AUR0225");if(!this.running){++this.runCount,this.running=!0,this.queued=!1,++this.obs.version;try{$s(this),this.fn(this)}finally{this.obs.clear(),this.running=!1,Ds(this)}if(this.queued){if(this.runCount>this.maxRunCount)throw this.runCount=0,new Error("AUR0226");this.run()}else this.runCount=0}}stop(){this.stopped=!0,this.obs.clearAll()}}function Zo(t,e,i,n){var r,s=arguments.length,o=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,i,o):r(e,i))||o);return s>3&&o&&Object.defineProperty(e,i,o),o}function Jo(t,e){return function(i,n){e(i,n,t)}}Qr(Qo);const ta=et.getOwn,ea=et.hasOwn,ia=et.define,{annotation:na,resource:ra}=Zt,sa=na.keyFor,oa=ra.keyFor,aa=ra.appendTo,la=na.appendTo,ha=na.getKeys,ca=()=>Object.create(null),ua=Object.prototype.hasOwnProperty,da=ca(),fa=(t,e,i)=>{if(!0===da[e])return!0;if(!va(e))return!1;const n=e.slice(0,5);return da[e]="aria-"===n||"data-"===n||i.isStandardSvgAttribute(t,e)},pa=t=>t instanceof Promise,ga=t=>"function"==typeof t,va=t=>"string"==typeof t;function ma(t,e){let i;function n(t,e){arguments.length>1&&(i.property=e),ia(ba,_a.create(e,t,i),t.constructor,e),la(t.constructor,wa.keyFrom(e))}return arguments.length>1?(i={},void n(t,e)):va(t)?(i={},n):(i=void 0===t?{}:t,n)}function ya(t){return t.startsWith(ba)}const ba=sa("bindable"),wa=Object.freeze({name:ba,keyFrom:t=>`${ba}:${t}`,from(t,...e){const i={},n=Array.isArray;function r(e){i[e]=_a.create(e,t)}function s(e,n){i[e]=n instanceof _a?n:_a.create(e,t,n)}return e.forEach((function(t){n(t)?t.forEach(r):t instanceof _a?i[t.property]=t:void 0!==t&&Object.keys(t).forEach((e=>s(e,t[e])))})),i},for(t){let e;const i={add(n){let r,s;return va(n)?(r=n,s={property:r}):(r=n.property,s=n),e=_a.create(r,t,s),ea(ba,t,r)||la(t,wa.keyFrom(r)),ia(ba,e,t,r),i},mode:t=>(e.mode=t,i),callback:t=>(e.callback=t,i),attribute:t=>(e.attribute=t,i),primary:()=>(e.primary=!0,i),set:t=>(e.set=t,i)};return i},getAll(t){const e=ba.length+1,i=[],n=Dt(t);let r,s,o,a,l=n.length,h=0;for(;--l>=0;)for(o=n[l],r=ha(o).filter(ya),s=r.length,a=0;a<s;++a)i[h++]=ta(ba,o,r[a].slice(e));return i}});class _a{constructor(t,e,i,n,r,s){this.attribute=t,this.callback=e,this.mode=i,this.primary=n,this.property=r,this.set=s}static create(t,e,i={}){return new _a($t(i.attribute,Tt(t)),$t(i.callback,`${t}Changed`),$t(i.mode,On.toView),$t(i.primary,!1),$t(i.property,t),$t(i.set,function(t,e,i={}){var n,r,s;const o=null!==(r=null!==(n=i.type)&&void 0!==n?n:Reflect.getMetadata("design:type",e,t))&&void 0!==r?r:null;if(null==o)return Ge;let a;switch(o){case Number:case Boolean:case String:case BigInt:a=o;break;default:{const t=o.coerce;a="function"==typeof t?t.bind(o):null!==(s=xa.for(o))&&void 0!==s?s:Ge;break}}return a===Ge?a:function(t,e){return function(i,n){var r;return(null==n?void 0:n.enableCoercion)?(null!=e?e:null===(r=null==n?void 0:n.coerceNullish)||void 0===r||!r)&&null==i?i:t(i,n):i}}(a,i.nullable)}(t,e,i)))}}const xa={key:sa("coercer"),define(t,e){ia(xa.key,t[e].bind(t),t)},for:t=>ta(xa.key,t)};class ka{constructor(t,e,i,n,r,s){this.set=n,this.$controller=r,this.t=s,this.v=void 0,this.ov=void 0,this.f=0;const o=t[i],a=t.propertyChanged,l=this.i=ga(o),h=this.u=ga(a),c=this.hs=n!==Ge;let u;this.o=t,this.k=e,this.cb=l?o:Ge,this.C=h?a:Ge,void 0!==this.cb||h||c?(this.iO=!0,u=t[e],this.v=c&&void 0!==u?n(u,this.t):u,this.A()):this.iO=!1}get type(){return 1}getValue(){return this.v}setValue(t,e){this.hs&&(t=this.set(t,this.t));const i=this.v;if(this.iO){if(Object.is(t,i))return;this.v=t,this.ov=i,this.f=e,(null==this.$controller||this.$controller.isBound)&&(this.i&&this.cb.call(this.o,t,i,e),this.u&&this.C.call(this.o,this.k,t,i,e)),this.queue.add(this)}else this.o[this.k]=t}subscribe(t){0==!this.iO&&(this.iO=!0,this.v=this.hs?this.set(this.o[this.k],this.t):this.o[this.k],this.A()),this.subs.add(t)}flush(){Ca=this.ov,this.ov=this.v,this.subs.notify(this.v,Ca,this.f)}A(){Reflect.defineProperty(this.o,this.k,{enumerable:!0,configurable:!0,get:()=>this.v,set:t=>{this.setValue(t,0)}})}}let Ca;Nn(ka),Gn(ka);class Sa{constructor(t,e,i,n){if(this.chars=t,this.repeat=e,this.isSymbol=i,this.isInverted=n,n)switch(t.length){case 0:this.has=this.R;break;case 1:this.has=this.B;break;default:this.has=this.I}else switch(t.length){case 0:this.has=this.T;break;case 1:this.has=this.P;break;default:this.has=this.O}}equals(t){return this.chars===t.chars&&this.repeat===t.repeat&&this.isSymbol===t.isSymbol&&this.isInverted===t.isInverted}O(t){return this.chars.includes(t)}P(t){return this.chars===t}T(t){return!1}I(t){return!this.chars.includes(t)}B(t){return this.chars!==t}R(t){return!0}}class Ea{constructor(){this.parts=ze,this.$="",this.L={},this.q={}}get pattern(){const t=this.$;return""===t?null:t}set pattern(t){null==t?(this.$="",this.parts=ze):(this.$=t,this.parts=this.q[t])}append(t,e){const i=this.L;void 0===i[t]?i[t]=e:i[t]+=e}next(t){const e=this.L;let i;void 0!==e[t]&&(i=this.q,void 0===i[t]?i[t]=[e[t]]:i[t].push(e[t]),e[t]=void 0)}}class Aa{constructor(t,...e){this.charSpec=t,this.nextStates=[],this.types=null,this.isEndpoint=!1,this.patterns=e}get pattern(){return this.isEndpoint?this.patterns[0]:null}findChild(t){const e=this.nextStates,i=e.length;let n=null,r=0;for(;r<i;++r)if(n=e[r],t.equals(n.charSpec))return n;return null}append(t,e){const i=this.patterns;i.includes(e)||i.push(e);let n=this.findChild(t);return null==n&&(n=new Aa(t,e),this.nextStates.push(n),t.repeat&&n.nextStates.push(n)),n}findMatches(t,e){const i=[],n=this.nextStates,r=n.length;let s=0,o=null,a=0,l=0;for(;a<r;++a)if(o=n[a],o.charSpec.has(t))if(i.push(o),s=o.patterns.length,l=0,o.charSpec.isSymbol)for(;l<s;++l)e.next(o.patterns[l]);else for(;l<s;++l)e.append(o.patterns[l],t);return i}}class Ta{constructor(t){this.text=t;const e=this.len=t.length,i=this.specs=[];let n=0;for(;e>n;++n)i.push(new Sa(t[n],!1,!1,!1))}eachChar(t){const e=this.len,i=this.specs;let n=0;for(;e>n;++n)t(i[n])}}class Ma{constructor(t){this.text="PART",this.spec=new Sa(t,!0,!1,!0)}eachChar(t){t(this.spec)}}class Oa{constructor(t){this.text=t,this.spec=new Sa(t,!1,!0,!1)}eachChar(t){t(this.spec)}}class Pa{constructor(){this.statics=0,this.dynamics=0,this.symbols=0}}const Ra=ae.createInterface("ISyntaxInterpreter",(t=>t.singleton(La)));class La{constructor(){this.rootState=new Aa(null),this.initialStates=[this.rootState]}add(t){t=t.slice(0).sort(((t,e)=>t.pattern>e.pattern?1:-1));const e=t.length;let i,n,r,s,o,a,l,h,c=0;for(;e>c;){for(i=this.rootState,n=t[c],r=n.pattern,s=new Pa,o=this.parse(n,s),a=o.length,l=t=>{i=i.append(t,r)},h=0;a>h;++h)o[h].eachChar(l);i.types=s,i.isEndpoint=!0,++c}}interpret(t){const e=new Ea,i=t.length;let n,r=this.initialStates,s=0;for(;s<i&&(r=this.getNextStates(r,t.charAt(s),e),0!==r.length);++s);return r=r.filter(Ia),r.length>0&&(r.sort($a),n=r[0],n.charSpec.isSymbol||e.next(n.pattern),e.pattern=n.pattern),e}getNextStates(t,e,i){const n=[];let r=null;const s=t.length;let o=0;for(;o<s;++o)r=t[o],n.push(...r.findMatches(e,i));return n}parse(t,e){const i=[],n=t.pattern,r=n.length,s=t.symbols;let o=0,a=0,l="";for(;o<r;)l=n.charAt(o),0!==s.length&&s.includes(l)?o!==a?(i.push(new Ta(n.slice(a,o))),++e.statics,a=o):(i.push(new Oa(n.slice(a,o+1))),++e.symbols,a=++o):o===a&&"P"===l&&"PART"===n.slice(o,o+4)?(a=o+=4,i.push(new Ma(s)),++e.dynamics):++o;return a!==o&&(i.push(new Ta(n.slice(a,o))),++e.statics),i}}function Ia(t){return t.isEndpoint}function $a(t,e){const i=t.types,n=e.types;return i.statics!==n.statics?n.statics-i.statics:i.dynamics!==n.dynamics?n.dynamics-i.dynamics:i.symbols!==n.symbols?n.symbols-i.symbols:0}class Da{constructor(t,e,i,n){this.rawName=t,this.rawValue=e,this.target=i,this.command=n}}const Na=ae.createInterface("IAttributePattern"),ja=ae.createInterface("IAttributeParser",(t=>t.singleton(Ba)));class Ba{constructor(t,e){this.M={},this.U=t;const i=this.F={},n=e.reduce(((t,e)=>{const n=Ha(e.constructor);return n.forEach((t=>i[t.pattern]=e)),t.concat(n)}),ze);t.add(n)}parse(t,e){let i=this.M[t];null==i&&(i=this.M[t]=this.U.interpret(t));const n=i.pattern;return null==n?new Da(t,e,t,null):this.F[n][n](t,e,i.parts)}}function Fa(...t){return function(e){return Va.define(t,e)}}Ba.inject=[Ra,me(Na)];class za{constructor(t){this.Type=t,this.name=void 0}register(t){De.singleton(Na,this.Type).register(t)}}const Ua=oa("attribute-pattern"),Ga="attribute-pattern-definitions",Ha=t=>Zt.annotation.get(t,Ga),Va=Object.freeze({name:Ua,definitionAnnotationKey:Ga,define(t,e){const i=new za(e);return ia(Ua,i,e),aa(e,Ua),Zt.annotation.set(e,Ga,t),la(e,Ga),e},getPatternDefinitions:Ha});let qa=class{"PART.PART"(t,e,i){return new Da(t,e,i[0],i[1])}"PART.PART.PART"(t,e,i){return new Da(t,e,i[0],i[2])}};qa=Zo([Fa({pattern:"PART.PART",symbols:"."},{pattern:"PART.PART.PART",symbols:"."})],qa);let Wa=class{ref(t,e,i){return new Da(t,e,"element","ref")}"PART.ref"(t,e,i){return new Da(t,e,i[0],"ref")}};Wa=Zo([Fa({pattern:"ref",symbols:""},{pattern:"PART.ref",symbols:"."})],Wa);let Ya=class{":PART"(t,e,i){return new Da(t,e,i[0],"bind")}};Ya=Zo([Fa({pattern:":PART",symbols:":"})],Ya);let Xa=class{"@PART"(t,e,i){return new Da(t,e,i[0],"trigger")}};Xa=Zo([Fa({pattern:"@PART",symbols:"@"})],Xa);let Ka=class{"...$attrs"(t,e,i){return new Da(t,e,"","...$attrs")}};Ka=Zo([Fa({pattern:"...$attrs",symbols:""})],Ka);const Qa=He,Za=ae.createInterface("ISVGAnalyzer",(t=>t.singleton(Ja)));class Ja{isStandardSvgAttribute(t,e){return!1}}const tl=ae.createInterface("IAttrMapper",(t=>t.singleton(el)));class el{constructor(t){this.svg=t,this.fns=[],this.N=ca(),this.W=ca(),this.useMapping({LABEL:{for:"htmlFor"},IMG:{usemap:"useMap"},INPUT:{maxlength:"maxLength",minlength:"minLength",formaction:"formAction",formenctype:"formEncType",formmethod:"formMethod",formnovalidate:"formNoValidate",formtarget:"formTarget",inputmode:"inputMode"},TEXTAREA:{maxlength:"maxLength"},TD:{rowspan:"rowSpan",colspan:"colSpan"},TH:{rowspan:"rowSpan",colspan:"colSpan"}}),this.useGlobalMapping({accesskey:"accessKey",contenteditable:"contentEditable",tabindex:"tabIndex",textcontent:"textContent",innerhtml:"innerHTML",scrolltop:"scrollTop",scrollleft:"scrollLeft",readonly:"readOnly"})}static get inject(){return[Za]}useMapping(t){var e,i;let n,r,s,o;for(s in t)for(o in n=t[s],r=null!==(e=(i=this.N)[s])&&void 0!==e?e:i[s]=ca(),n){if(void 0!==r[o])throw il(o,s);r[o]=n[o]}}useGlobalMapping(t){const e=this.W;for(const i in t){if(void 0!==e[i])throw il(i,"*");e[i]=t[i]}}useTwoWay(t){this.fns.push(t)}isTwoWay(t,e){return function(t,e){switch(t.nodeName){case"INPUT":switch(t.type){case"checkbox":case"radio":return"checked"===e;default:return"value"===e||"files"===e||"value-as-number"===e||"value-as-date"===e}case"TEXTAREA":case"SELECT":return"value"===e;default:switch(e){case"textcontent":case"innerhtml":return t.hasAttribute("contenteditable");case"scrolltop":case"scrollleft":return!0;default:return!1}}}(t,e)||this.fns.length>0&&this.fns.some((i=>i(t,e)))}map(t,e){var i,n,r;return null!==(r=null!==(n=null===(i=this.N[t.nodeName])||void 0===i?void 0:i[e])&&void 0!==n?n:this.W[e])&&void 0!==r?r:fa(t,e,this.svg)?e:null}}function il(t,e){return new Error(`Attribute ${t} has been already registered for ${"*"===e?"all elements":`<${e}/>`}`)}class nl{constructor(t,e,i,n,r){this.sourceExpression=t,this.target=e,this.targetProperty=i,this.locator=r,this.interceptor=this,this.isBound=!1,this.targetObserver=n.getAccessor(e,i)}callSource(t){const e=this.$scope.overrideContext;e.$event=t;const i=this.sourceExpression.evaluate(8,this.$scope,this.locator,null);return Reflect.deleteProperty(e,"$event"),i}$bind(t,e){if(this.isBound){if(this.$scope===e)return;this.interceptor.$unbind(2|t)}this.$scope=e,this.sourceExpression.hasBind&&this.sourceExpression.bind(t,e,this.interceptor),this.targetObserver.setValue((t=>this.interceptor.callSource(t)),t,this.target,this.targetProperty),this.isBound=!0}$unbind(t){this.isBound&&(this.sourceExpression.hasUnbind&&this.sourceExpression.unbind(t,this.$scope,this.interceptor),this.$scope=void 0,this.targetObserver.setValue(null,t,this.target,this.targetProperty),this.isBound=!1)}observe(t,e){}handleChange(t,e,i){}}class rl{constructor(t,e,i){this.type=7,this.v=null,this.ov=null,this.H=!1,this.f=0,this.o=t,this.G=e,this.X=i}getValue(){return this.v}setValue(t,e){this.v=t,this.H=t!==this.ov,0==(256&e)&&this.K()}K(){if(this.H)switch(this.H=!1,this.ov=this.v,this.X){case"class":this.o.classList.toggle(this.G,!!this.v);break;case"style":{let t="",e=this.v;va(e)&&e.includes("!important")&&(t="important",e=e.replace("!important","")),this.o.style.setProperty(this.G,e,t);break}default:null==this.v?this.o.removeAttribute(this.X):this.o.setAttribute(this.X,String(this.v))}}handleMutation(t){let e=!1;for(let i=0,n=t.length;n>i;++i){const n=t[i];if("attributes"===n.type&&n.attributeName===this.G){e=!0;break}}if(e){let t;switch(this.X){case"class":t=this.o.classList.contains(this.G);break;case"style":t=this.o.style.getPropertyValue(this.G);break;default:throw new Error(`AUR0651:${this.X}`)}t!==this.v&&(this.ov=this.v,this.v=t,this.H=!1,this.f=0,this.queue.add(this))}}subscribe(t){this.subs.add(t)&&1===this.subs.count&&(this.v=this.ov=this.o.getAttribute(this.G),sl(this.o.ownerDocument.defaultView.MutationObserver,this.o,this))}unsubscribe(t){this.subs.remove(t)&&0===this.subs.count&&ol(this.o,this)}flush(){hl=this.ov,this.ov=this.v,this.subs.notify(this.v,hl,this.f)}}Nn(rl),Gn(rl);const sl=(t,e,i)=>{void 0===e.$eMObs&&(e.$eMObs=new Set),void 0===e.$mObs&&(e.$mObs=new t(al)).observe(e,{attributes:!0}),e.$eMObs.add(i)},ol=(t,e)=>{const i=t.$eMObs;return!(!i||!i.delete(e)||(0===i.size&&(t.$mObs.disconnect(),t.$mObs=void 0),0))},al=t=>{t[0].target.$eMObs.forEach(ll,t)};function ll(t){t.handleMutation(this)}let hl;class cl{constructor(t){this.b=t}handleChange(t,e,i){const n=this.b;t!==n.sourceExpression.evaluate(i,n.$scope,n.locator,null)&&n.updateSource(t,i)}}const{oneTime:ul,toView:dl,fromView:fl}=On,pl=dl|ul,gl={reusable:!1,preempt:!0};class vl{constructor(t,e,i,n,r,s,o){this.sourceExpression=t,this.targetAttribute=i,this.targetProperty=n,this.mode=r,this.locator=o,this.interceptor=this,this.isBound=!1,this.$scope=null,this.task=null,this.targetSubscriber=null,this.persistentFlags=0,this.value=void 0,this.target=e,this.p=o.get(Qa),this.oL=s}updateTarget(t,e){e|=this.persistentFlags,this.targetObserver.setValue(t,e,this.target,this.targetProperty)}updateSource(t,e){e|=this.persistentFlags,this.sourceExpression.assign(e,this.$scope,this.locator,t)}handleChange(t,e,i){if(!this.isBound)return;i|=this.persistentFlags;const n=this.mode,r=this.interceptor,s=this.sourceExpression,o=this.$scope,a=this.locator,l=this.targetObserver,h=0==(2&i)&&(4&l.type)>0;let c,u=!1;(10082!==s.$kind||this.obs.count>1)&&(u=0==(n&ul),u&&this.obs.version++,t=s.evaluate(i,o,a,r),u&&this.obs.clear()),t!==this.value&&(this.value=t,h?(c=this.task,this.task=this.p.domWriteQueue.queueTask((()=>{this.task=null,r.updateTarget(t,i)}),gl),null==c||c.cancel()):r.updateTarget(t,i))}$bind(t,e){var i;if(this.isBound){if(this.$scope===e)return;this.interceptor.$unbind(2|t)}this.persistentFlags=961&t,this.$scope=e;let n=this.sourceExpression;n.hasBind&&n.bind(t,e,this.interceptor);let r=this.targetObserver;r||(r=this.targetObserver=new rl(this.target,this.targetProperty,this.targetAttribute)),n=this.sourceExpression;const s=this.mode,o=this.interceptor;let a=!1;s&pl&&(a=(s&dl)>0,o.updateTarget(this.value=n.evaluate(t,e,this.locator,a?o:null),t)),s&fl&&r.subscribe(null!==(i=this.targetSubscriber)&&void 0!==i?i:this.targetSubscriber=new cl(o)),this.isBound=!0}$unbind(t){var e;this.isBound&&(this.persistentFlags=0,this.sourceExpression.hasUnbind&&this.sourceExpression.unbind(t,this.$scope,this.interceptor),this.$scope=null,this.value=void 0,this.targetSubscriber&&this.targetObserver.unsubscribe(this.targetSubscriber),null===(e=this.task)||void 0===e||e.cancel(),this.task=null,this.obs.clearAll(),this.isBound=!1)}}Qr(vl);const{toView:ml}=On,yl={reusable:!1,preempt:!0};class bl{constructor(t,e,i,n,r,s,o){this.interpolation=e,this.target=i,this.targetProperty=n,this.mode=r,this.locator=s,this.taskQueue=o,this.interceptor=this,this.isBound=!1,this.$scope=void 0,this.task=null,this.oL=t,this.targetObserver=t.getAccessor(i,n);const a=e.expressions,l=this.partBindings=Array(a.length),h=a.length;let c=0;for(;h>c;++c)l[c]=new wl(a[c],i,n,s,t,this)}updateTarget(t,e){const i=this.partBindings,n=this.interpolation.parts,r=i.length;let s="",o=0;if(1===r)s=n[0]+i[0].value+n[1];else for(s=n[0];r>o;++o)s+=i[o].value+n[o+1];const a=this.targetObserver;let l;0==(2&e)&&(4&a.type)>0?(l=this.task,this.task=this.taskQueue.queueTask((()=>{this.task=null,a.setValue(s,e,this.target,this.targetProperty)}),yl),null==l||l.cancel(),l=null):a.setValue(s,e,this.target,this.targetProperty)}$bind(t,e){if(this.isBound){if(this.$scope===e)return;this.interceptor.$unbind(t)}this.isBound=!0,this.$scope=e;const i=this.partBindings,n=i.length;let r=0;for(;n>r;++r)i[r].$bind(t,e);this.updateTarget(void 0,t)}$unbind(t){var e;if(!this.isBound)return;this.isBound=!1,this.$scope=void 0;const i=this.partBindings,n=i.length;let r=0;for(;n>r;++r)i[r].interceptor.$unbind(t);null===(e=this.task)||void 0===e||e.cancel(),this.task=null}}class wl{constructor(t,e,i,n,r,s){this.sourceExpression=t,this.target=e,this.targetProperty=i,this.locator=n,this.owner=s,this.interceptor=this,this.mode=On.toView,this.value="",this.task=null,this.isBound=!1,this.oL=r}handleChange(t,e,i){if(!this.isBound)return;const n=this.sourceExpression,r=this.obs;let s=!1;10082===n.$kind&&1===r.count||(s=(this.mode&ml)>0,s&&r.version++,t=n.evaluate(i,this.$scope,this.locator,s?this.interceptor:null),s&&r.clear()),t!=this.value&&(this.value=t,t instanceof Array&&this.observeCollection(t),this.owner.updateTarget(t,i))}handleCollectionChange(t,e){this.owner.updateTarget(void 0,e)}$bind(t,e){if(this.isBound){if(this.$scope===e)return;this.interceptor.$unbind(t)}this.isBound=!0,this.$scope=e,this.sourceExpression.hasBind&&this.sourceExpression.bind(t,e,this.interceptor),this.value=this.sourceExpression.evaluate(t,e,this.locator,(this.mode&ml)>0?this.interceptor:null),this.value instanceof Array&&this.observeCollection(this.value)}$unbind(t){this.isBound&&(this.isBound=!1,this.sourceExpression.hasUnbind&&this.sourceExpression.unbind(t,this.$scope,this.interceptor),this.$scope=void 0,this.obs.clearAll())}}Qr(wl);class _l{constructor(t,e,i,n,r,s){this.sourceExpression=t,this.target=e,this.locator=i,this.p=r,this.strict=s,this.interceptor=this,this.mode=On.toView,this.value="",this.task=null,this.isBound=!1,this.oL=n}updateTarget(t,e){var i,n;const r=this.target,s=this.p.Node,o=this.value;this.value=t,o instanceof s&&(null===(i=o.parentNode)||void 0===i||i.removeChild(o)),t instanceof s?(r.textContent="",null===(n=r.parentNode)||void 0===n||n.insertBefore(t,r)):r.textContent=String(t)}handleChange(t,e,i){var n;if(!this.isBound)return;const r=this.sourceExpression,s=this.obs;let o=!1;if(10082===r.$kind&&1===s.count||(o=(this.mode&ml)>0,o&&s.version++,i|=this.strict?1:0,t=r.evaluate(i,this.$scope,this.locator,o?this.interceptor:null),o&&s.clear()),t===this.value)return null===(n=this.task)||void 0===n||n.cancel(),void(this.task=null);0==(2&i)?this.queueUpdate(t,i):this.updateTarget(t,i)}handleCollectionChange(){this.queueUpdate(this.value,0)}$bind(t,e){if(this.isBound){if(this.$scope===e)return;this.interceptor.$unbind(t)}this.isBound=!0,this.$scope=e,this.sourceExpression.hasBind&&this.sourceExpression.bind(t,e,this.interceptor),t|=this.strict?1:0;const i=this.value=this.sourceExpression.evaluate(t,e,this.locator,(this.mode&ml)>0?this.interceptor:null);i instanceof Array&&this.observeCollection(i),this.updateTarget(i,t)}$unbind(t){var e;this.isBound&&(this.isBound=!1,this.sourceExpression.hasUnbind&&this.sourceExpression.unbind(t,this.$scope,this.interceptor),this.$scope=void 0,this.obs.clearAll(),null===(e=this.task)||void 0===e||e.cancel(),this.task=null)}queueUpdate(t,e){const i=this.task;this.task=this.p.domWriteQueue.queueTask((()=>{this.task=null,this.updateTarget(t,e)}),yl),null==i||i.cancel()}}Qr(_l);class xl{constructor(t,e,i,n,r=!1){this.sourceExpression=t,this.targetProperty=e,this.locator=n,this.interceptor=this,this.isBound=!1,this.$scope=void 0,this.task=null,this.target=null,this.oL=i,this.Y=r}handleChange(t,e,i){if(!this.isBound)return;const n=this.target,r=this.targetProperty,s=n[r];this.obs.version++,t=this.sourceExpression.evaluate(i,this.$scope,this.locator,this.interceptor),this.obs.clear(),t!==s&&(n[r]=t)}$bind(t,e){if(this.isBound){if(this.$scope===e)return;this.interceptor.$unbind(2|t)}this.$scope=e,this.target=this.Y?e.bindingContext:e.overrideContext;const i=this.sourceExpression;i.hasBind&&i.bind(t,e,this.interceptor),this.target[this.targetProperty]=this.sourceExpression.evaluate(2|t,e,this.locator,this.interceptor),this.isBound=!0}$unbind(t){if(!this.isBound)return;const e=this.sourceExpression;e.hasUnbind&&e.unbind(t,this.$scope,this.interceptor),this.$scope=void 0,this.obs.clearAll(),this.isBound=!1}}Qr(xl);const{oneTime:kl,toView:Cl,fromView:Sl}=On,El=Cl|kl,Al={reusable:!1,preempt:!0};class Tl{constructor(t,e,i,n,r,s,o){this.sourceExpression=t,this.target=e,this.targetProperty=i,this.mode=n,this.locator=s,this.taskQueue=o,this.interceptor=this,this.isBound=!1,this.$scope=void 0,this.targetObserver=void 0,this.persistentFlags=0,this.task=null,this.targetSubscriber=null,this.oL=r}updateTarget(t,e){e|=this.persistentFlags,this.targetObserver.setValue(t,e,this.target,this.targetProperty)}updateSource(t,e){e|=this.persistentFlags,this.sourceExpression.assign(e,this.$scope,this.locator,t)}handleChange(t,e,i){if(!this.isBound)return;const n=0==(2&(i|=this.persistentFlags))&&(4&this.targetObserver.type)>0,r=this.obs;let s=!1;(10082!==this.sourceExpression.$kind||r.count>1)&&(s=this.mode>kl,s&&r.version++,t=this.sourceExpression.evaluate(i,this.$scope,this.locator,this.interceptor),s&&r.clear()),n?(Ml=this.task,this.task=this.taskQueue.queueTask((()=>{this.interceptor.updateTarget(t,i),this.task=null}),Al),null==Ml||Ml.cancel(),Ml=null):this.interceptor.updateTarget(t,i)}$bind(t,e){var i;if(this.isBound){if(this.$scope===e)return;this.interceptor.$unbind(2|t)}t|=1,this.persistentFlags=961&t,this.$scope=e;let n=this.sourceExpression;n.hasBind&&n.bind(t,e,this.interceptor);const r=this.oL,s=this.mode;let o=this.targetObserver;o||(o=s&Sl?r.getObserver(this.target,this.targetProperty):r.getAccessor(this.target,this.targetProperty),this.targetObserver=o),n=this.sourceExpression;const a=this.interceptor,l=(s&Cl)>0;s&El&&a.updateTarget(n.evaluate(t,e,this.locator,l?a:null),t),s&Sl&&(o.subscribe(null!==(i=this.targetSubscriber)&&void 0!==i?i:this.targetSubscriber=new cl(a)),l||a.updateSource(o.getValue(this.target,this.targetProperty),t)),this.isBound=!0}$unbind(t){this.isBound&&(this.persistentFlags=0,this.sourceExpression.hasUnbind&&this.sourceExpression.unbind(t,this.$scope,this.interceptor),this.$scope=void 0,Ml=this.task,this.targetSubscriber&&this.targetObserver.unsubscribe(this.targetSubscriber),null!=Ml&&(Ml.cancel(),Ml=this.task=null),this.obs.clearAll(),this.isBound=!1)}}Qr(Tl);let Ml=null;class Ol{constructor(t,e,i){this.sourceExpression=t,this.target=e,this.locator=i,this.interceptor=this,this.isBound=!1,this.$scope=void 0}$bind(t,e){if(this.isBound){if(this.$scope===e)return;this.interceptor.$unbind(2|t)}this.$scope=e,this.sourceExpression.hasBind&&this.sourceExpression.bind(t,e,this),this.sourceExpression.assign(t,this.$scope,this.locator,this.target),this.isBound=!0}$unbind(t){if(!this.isBound)return;let e=this.sourceExpression;e.evaluate(t,this.$scope,this.locator,null)===this.target&&e.assign(t,this.$scope,this.locator,null),e=this.sourceExpression,e.hasUnbind&&e.unbind(t,this.$scope,this.interceptor),this.$scope=void 0,this.isBound=!1}observe(t,e){}handleChange(t,e,i){}}const Pl=ae.createInterface("IAppTask");class Rl{constructor(t,e,i){this.c=void 0,this.slot=t,this.k=e,this.cb=i}register(t){return this.c=t.register(De.instance(Pl,this))}run(){const t=this.k,e=this.cb;return null===t?e():e(this.c.get(t))}}const Ll=Object.freeze({beforeCreate:Il("beforeCreate"),hydrating:Il("hydrating"),hydrated:Il("hydrated"),beforeActivate:Il("beforeActivate"),afterActivate:Il("afterActivate"),beforeDeactivate:Il("beforeDeactivate"),afterDeactivate:Il("afterDeactivate")});function Il(t){return function(e,i){return ga(i)?new Rl(t,e,i):new Rl(t,null,e)}}function $l(t){return t.startsWith(Dl)}const Dl=sa("children-observer"),Nl=Object.freeze({name:Dl,keyFrom:t=>`${Dl}:${t}`,from(...t){const e={},i=Array.isArray;function n(t){e[t]=Bl.create(t)}function r(t,i){e[t]=Bl.create(t,i)}return t.forEach((function(t){i(t)?t.forEach(n):t instanceof Bl?e[t.property]=t:void 0!==t&&Object.keys(t).forEach((e=>r(e,t)))})),e},getAll(t){const e=Dl.length+1,i=[],n=Dt(t);let r,s,o,a=n.length,l=0;for(;--a>=0;){o=n[a],r=ha(o).filter($l),s=r.length;for(let t=0;t<s;++t)i[l++]=ta(Dl,o,r[t].slice(e))}return i}}),jl={childList:!0};class Bl{constructor(t,e,i,n,r,s){this.callback=t,this.property=e,this.options=i,this.query=n,this.filter=r,this.map=s}static create(t,e={}){var i;return new Bl($t(e.callback,`${t}Changed`),$t(e.property,t),null!==(i=e.options)&&void 0!==i?i:jl,e.query,e.filter,e.map)}}class Fl{constructor(t,e,i,n,r=zl,s=Ul,o=Gl,a){this.controller=t,this.obj=e,this.propertyKey=i,this.query=r,this.filter=s,this.map=o,this.options=a,this.observing=!1,this.children=void 0,this.observer=void 0,this.callback=e[n],Reflect.defineProperty(this.obj,this.propertyKey,{enumerable:!0,configurable:!0,get:()=>this.getValue(),set:()=>{}})}getValue(){return this.observing?this.children:this.get()}setValue(t){}start(){var t;this.observing||(this.observing=!0,this.children=this.get(),(null!==(t=this.observer)&&void 0!==t?t:this.observer=new this.controller.host.ownerDocument.defaultView.MutationObserver((()=>{this.Z()}))).observe(this.controller.host,this.options))}stop(){this.observing&&(this.observing=!1,this.observer.disconnect(),this.children=ze)}Z(){this.children=this.get(),void 0!==this.callback&&this.callback.call(this.obj),this.subs.notify(this.children,void 0,0)}get(){return function(t,e,i,n){var r;const s=e(t),o=s.length,a=[];let l,h,c,u=0;for(;u<o;++u)l=s[u],h=fh.for(l,Hl),c=null!==(r=null==h?void 0:h.viewModel)&&void 0!==r?r:null,i(l,h,c)&&a.push(n(l,h,c));return a}(this.controller,this.query,this.filter,this.map)}}function zl(t){return t.host.childNodes}function Ul(t,e,i){return!!i}function Gl(t,e,i){return i}Nn()(Fl);const Hl={optional:!0};function Vl(t){return function(e){return Ql.define(t,e)}}function ql(t){return function(e){return Ql.define(va(t)?{isTemplateController:!0,name:t}:{isTemplateController:!0,...t},e)}}class Wl{constructor(t,e,i,n,r,s,o,a,l){this.Type=t,this.name=e,this.aliases=i,this.key=n,this.defaultBindingMode=r,this.isTemplateController=s,this.bindables=o,this.noMultiBindings=a,this.watches=l}get type(){return 2}static create(t,e){let i,n;return va(t)?(i=t,n={name:i}):(i=t.name,n=t),new Wl(e,$t(Kl(e,"name"),i),It(Kl(e,"aliases"),n.aliases,e.aliases),Ql.keyFrom(i),$t(Kl(e,"defaultBindingMode"),n.defaultBindingMode,e.defaultBindingMode,On.toView),$t(Kl(e,"isTemplateController"),n.isTemplateController,e.isTemplateController,!1),wa.from(e,...wa.getAll(e),Kl(e,"bindables"),e.bindables,n.bindables),$t(Kl(e,"noMultiBindings"),n.noMultiBindings,e.noMultiBindings,!1),It(th.getAnnotation(e),e.watches))}register(t){const{Type:e,key:i,aliases:n}=this;De.transient(i,e).register(t),De.aliasTo(i,e).register(t),Pi(n,Ql,i,t)}}const Yl=oa("custom-attribute"),Xl=t=>`${Yl}:${t}`,Kl=(t,e)=>ta(sa(e),t),Ql=Object.freeze({name:Yl,keyFrom:Xl,isType:t=>ga(t)&&ea(Yl,t),for(t,e){var i;return null!==(i=bc(t,Xl(e)))&&void 0!==i?i:void 0},define(t,e){const i=Wl.create(t,e);return ia(Yl,i,i.Type),ia(Yl,i,i),aa(e,Yl),i.Type},getDefinition(t){const e=ta(Yl,t);if(void 0===e)throw new Error(`AUR0759:${t.name}`);return e},annotate(t,e,i){ia(sa(e),i,t)},getAnnotation:Kl}),Zl=ze,Jl=sa("watch"),th=Object.freeze({name:Jl,add(t,e){let i=ta(Jl,t);null==i&&ia(Jl,i=[],t),i.push(e)},getAnnotation(t){var e;return null!==(e=ta(Jl,t))&&void 0!==e?e:Zl}});function eh(t){return function(e){return fh.define(t,e)}}const ih=new WeakMap;class nh{constructor(t,e,i,n,r,s,o,a,l,h,c,u,d,f,p,g,v,m,y,b,w){this.Type=t,this.name=e,this.aliases=i,this.key=n,this.cache=r,this.capture=s,this.template=o,this.instructions=a,this.dependencies=l,this.injectable=h,this.needsCompile=c,this.surrogates=u,this.bindables=d,this.childrenObservers=f,this.containerless=p,this.isStrictBinding=g,this.shadowOptions=v,this.hasSlots=m,this.enhance=y,this.watches=b,this.processContent=w}get type(){return 1}static create(t,e=null){if(null===e){const i=t;if(va(i))throw new Error(`AUR0761:${t}`);const n=ie("name",i,uh);return e=ga(i.Type)?i.Type:fh.generateType(At(n)),new nh(e,n,It(i.aliases),ie("key",i,(()=>fh.keyFrom(n))),ie("cache",i,sh),ie("capture",i,ah),ie("template",i,oh),It(i.instructions),It(i.dependencies),ie("injectable",i,oh),ie("needsCompile",i,lh),It(i.surrogates),wa.from(e,i.bindables),Nl.from(i.childrenObservers),ie("containerless",i,ah),ie("isStrictBinding",i,ah),ie("shadowOptions",i,oh),ie("hasSlots",i,ah),ie("enhance",i,ah),ie("watches",i,hh),ee("processContent",e,oh))}if(va(t))return new nh(e,t,It(dh(e,"aliases"),e.aliases),fh.keyFrom(t),ee("cache",e,sh),ee("capture",e,ah),ee("template",e,oh),It(dh(e,"instructions"),e.instructions),It(dh(e,"dependencies"),e.dependencies),ee("injectable",e,oh),ee("needsCompile",e,lh),It(dh(e,"surrogates"),e.surrogates),wa.from(e,...wa.getAll(e),dh(e,"bindables"),e.bindables),Nl.from(...Nl.getAll(e),dh(e,"childrenObservers"),e.childrenObservers),ee("containerless",e,ah),ee("isStrictBinding",e,ah),ee("shadowOptions",e,oh),ee("hasSlots",e,ah),ee("enhance",e,ah),It(th.getAnnotation(e),e.watches),ee("processContent",e,oh));const i=ie("name",t,uh);return new nh(e,i,It(dh(e,"aliases"),t.aliases,e.aliases),fh.keyFrom(i),te("cache",t,e,sh),te("capture",t,e,ah),te("template",t,e,oh),It(dh(e,"instructions"),t.instructions,e.instructions),It(dh(e,"dependencies"),t.dependencies,e.dependencies),te("injectable",t,e,oh),te("needsCompile",t,e,lh),It(dh(e,"surrogates"),t.surrogates,e.surrogates),wa.from(e,...wa.getAll(e),dh(e,"bindables"),e.bindables,t.bindables),Nl.from(...Nl.getAll(e),dh(e,"childrenObservers"),e.childrenObservers,t.childrenObservers),te("containerless",t,e,ah),te("isStrictBinding",t,e,ah),te("shadowOptions",t,e,oh),te("hasSlots",t,e,ah),te("enhance",t,e,ah),It(t.watches,th.getAnnotation(e),e.watches),te("processContent",t,e,oh))}static getOrCreate(t){if(t instanceof nh)return t;if(ih.has(t))return ih.get(t);const e=nh.create(t);return ih.set(t,e),ia(ch,e,e.Type),e}register(t){const{Type:e,key:i,aliases:n}=this;t.has(i,!1)||(De.transient(i,e).register(t),De.aliasTo(i,e).register(t),Pi(n,fh,i,t))}}const rh={name:void 0,searchParents:!1,optional:!1},sh=()=>0,oh=()=>null,ah=()=>!1,lh=()=>!0,hh=()=>ze,ch=oa("custom-element"),uh=(()=>{let t=0;return()=>"unnamed-"+ ++t})(),dh=(t,e)=>ta(sa(e),t),fh=Object.freeze({name:ch,keyFrom:t=>`${ch}:${t}`,isType:t=>ga(t)&&ea(ch,t),for(t,e=rh){if(void 0===e.name&&!0!==e.searchParents){const i=bc(t,ch);if(null===i){if(!0===e.optional)return null;throw new Error("AUR0762")}return i}if(void 0!==e.name){if(!0!==e.searchParents){const i=bc(t,ch);if(null===i)throw new Error("AUR0763");return i.is(e.name)?i:void 0}let i=t,n=!1;for(;null!==i;){const t=bc(i,ch);if(null!==t&&(n=!0,t.is(e.name)))return t;i=Ec(i)}if(n)return;throw new Error("AUR0764")}let i=t;for(;null!==i;){const t=bc(i,ch);if(null!==t)return t;i=Ec(i)}throw new Error("AUR0765")},define(t,e){const i=nh.create(t,e);return ia(ch,i,i.Type),ia(ch,i,i),aa(i.Type,ch),i.Type},getDefinition(t){const e=ta(ch,t);if(void 0===e)throw new Error(`AUR0760:${t.name}`);return e},annotate:(t,e,i)=>{ia(sa(e),i,t)},getAnnotation:dh,generateName:uh,createInjectable(){const t=function(e,i,n){return ae.getOrCreateAnnotationParamTypes(e)[n]=t,e};return t.register=function(e){return{resolve:(e,i)=>i.has(t,!0)?i.get(t):null}},t},generateType:function(){const t={value:"",writable:!1,enumerable:!1,configurable:!0},e={};return function(i,n=e){const r=class{};return t.value=i,Reflect.defineProperty(r,"name",t),n!==e&&Object.assign(r.prototype,n),r}}()});sa("processContent");class ph{constructor(t){this.obj=t,this.type=6,this.value="",this.ov="",this.J={},this.tt=0,this.H=!1}get doNotCache(){return!0}getValue(){return this.value}setValue(t,e){this.value=t,this.H=t!==this.ov,0==(256&e)&&this.K()}K(){if(this.H){this.H=!1;const t=this.value,e=this.J,i=gh(t);let n=this.tt;if(this.ov=t,i.length>0&&this.et(i),this.tt+=1,0===n)return;n-=1;for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&e[t]===n&&this.obj.classList.remove(t)}}et(t){const e=this.obj,i=t.length;let n,r=0;for(;r<i;r++)n=t[r],0!==n.length&&(this.J[n]=this.tt,e.classList.add(n))}}function gh(t){if(va(t))return vh(t);if("object"!=typeof t)return ze;if(t instanceof Array){const e=t.length;if(e>0){const i=[];let n=0;for(;e>n;++n)i.push(...gh(t[n]));return i}return ze}const e=[];let i;for(i in t)Boolean(t[i])&&(i.includes(" ")?e.push(...vh(i)):e.push(i));return e}function vh(t){const e=t.match(/\S+/g);return null===e?ze:e}ae.createInterface("IShadowDOMStyleFactory",(t=>t.cachedCallback((t=>_h.supported(t.get(Qa))?t.get(mh):t.get(yh)))));class mh{constructor(t){this.p=t,this.cache=new Map}createStyles(t,e){return new _h(this.p,t,this.cache,e)}}mh.inject=[Qa];class yh{constructor(t){this.p=t}createStyles(t,e){return new xh(this.p,t,e)}}yh.inject=[Qa];const bh=ae.createInterface("IShadowDOMStyles"),wh=ae.createInterface("IShadowDOMGlobalStyles",(t=>t.instance({applyTo:Ge})));class _h{constructor(t,e,i,n=null){this.sharedStyles=n,this.styleSheets=e.map((e=>{let n;return e instanceof t.CSSStyleSheet?n=e:(n=i.get(e),void 0===n&&(n=new t.CSSStyleSheet,n.replaceSync(e),i.set(e,n))),n}))}static supported(t){return"adoptedStyleSheets"in t.ShadowRoot.prototype}applyTo(t){null!==this.sharedStyles&&this.sharedStyles.applyTo(t),t.adoptedStyleSheets=[...t.adoptedStyleSheets,...this.styleSheets]}}class xh{constructor(t,e,i=null){this.p=t,this.localStyles=e,this.sharedStyles=i}applyTo(t){const e=this.localStyles,i=this.p;for(let n=e.length-1;n>-1;--n){const r=i.document.createElement("style");r.innerHTML=e[n],t.prepend(r)}null!==this.sharedStyles&&this.sharedStyles.applyTo(t)}}const{enter:kh,exit:Ch}=Ns,{wrap:Sh,unwrap:Eh}=Oo;class Ah{constructor(t,e,i,n,r){this.obj=t,this.get=i,this.cb=n,this.useProxy=r,this.interceptor=this,this.value=void 0,this.isBound=!1,this.running=!1,this.oL=e}handleChange(){this.run()}handleCollectionChange(){this.run()}$bind(){this.isBound||(this.isBound=!0,this.compute())}$unbind(){this.isBound&&(this.isBound=!1,this.obs.clearAll())}run(){if(!this.isBound||this.running)return;const t=this.obj,e=this.value,i=this.compute();Object.is(i,e)||this.cb.call(t,i,e,t)}compute(){this.running=!0,this.obs.version++;try{return kh(this),this.value=Eh(this.get.call(void 0,this.useProxy?Sh(this.obj):this.obj,this))}finally{this.obs.clear(),this.running=!1,Ch(this)}}}class Th{constructor(t,e,i,n,r){this.scope=t,this.locator=e,this.oL=i,this.expression=n,this.callback=r,this.interceptor=this,this.isBound=!1,this.obj=t.bindingContext}handleChange(t){const e=this.expression,i=this.obj,n=this.value;10082===e.$kind&&1===this.obs.count||(this.obs.version++,t=e.evaluate(0,this.scope,this.locator,this),this.obs.clear()),Object.is(t,n)||(this.value=t,this.callback.call(i,t,n,i))}$bind(){this.isBound||(this.isBound=!0,this.obs.version++,this.value=this.expression.evaluate(0,this.scope,this.locator,this),this.obs.clear())}$unbind(){this.isBound&&(this.isBound=!1,this.obs.clearAll(),this.value=void 0)}}Qr(Ah),Qr(Th);const Mh=ae.createInterface("ILifecycleHooks");class Oh{constructor(t,e){this.definition=t,this.instance=e}}class Ph{constructor(t,e){this.Type=t,this.propertyNames=e}static create(t,e){const i=new Set;let n=e.prototype;for(;n!==Object.prototype;){for(const t of Object.getOwnPropertyNames(n))"constructor"!==t&&i.add(t);n=Object.getPrototypeOf(n)}return new Ph(e,i)}register(t){De.singleton(Mh,this.Type).register(t)}}const Rh=new WeakMap,Lh=sa("lifecycle-hooks"),Ih=Object.freeze({name:Lh,define(t,e){const i=Ph.create(t,e);return ia(Lh,i,e),aa(e,Lh),i.Type},resolve(t){let e=Rh.get(t);if(void 0===e){e=new $h;const i=t.root,n=i.id===t.id?t.getAll(Mh):t.has(Mh,!1)?[...i.getAll(Mh),...t.getAll(Mh)]:i.getAll(Mh);let r,s,o,a,l;for(r of n)for(a of(s=ta(Lh,r.constructor),o=new Oh(s,r),s.propertyNames))l=e[a],void 0===l?e[a]=[o]:l.push(o)}return e}});class $h{}const Dh=ae.createInterface("IViewFactory");class Nh{constructor(t,e){this.isCaching=!1,this.cache=null,this.cacheSize=-1,this.name=e.name,this.container=t,this.def=e}setCacheSize(t,e){t&&("*"===t?t=Nh.maxCacheSize:va(t)&&(t=parseInt(t,10)),-1!==this.cacheSize&&e||(this.cacheSize=t)),this.cacheSize>0?this.cache=[]:this.cache=null,this.isCaching=this.cacheSize>0}canReturnToCache(t){return null!=this.cache&&this.cache.length<this.cacheSize}tryReturnToCache(t){return!!this.canReturnToCache(t)&&(this.cache.push(t),!0)}create(t){const e=this.cache;let i;return null!=e&&e.length>0?(i=e.pop(),i):(i=Kh.$view(this,t),i)}}Nh.maxCacheSize=65535;const jh=new WeakSet;function Bh(t){return!jh.has(t)}function Fh(t){return jh.add(t),nh.create(t)}const zh=oa("views"),Uh=Object.freeze({name:zh,has:t=>ga(t)&&(ea(zh,t)||"$views"in t),get(t){if(ga(t)&&"$views"in t){const e=t.$views.filter(Bh).map(Fh);for(const i of e)Uh.add(t,i)}let e=ta(zh,t);return void 0===e&&ia(zh,e=[],t),e},add(t,e){const i=nh.create(e);let n=ta(zh,t);return void 0===n?ia(zh,n=[i],t):n.push(i),n}}),Gh=ae.createInterface("IViewLocator",(t=>t.singleton(Hh)));class Hh{constructor(){this.it=new WeakMap,this.st=new Map}getViewComponentForObject(t,e){if(t){const i=Uh.has(t.constructor)?Uh.get(t.constructor):[],n=ga(e)?e(t,i):this.nt(i,e);return this.rt(t,i,n)}return null}rt(t,e,i){let n,r=this.it.get(t);if(void 0===r?(r={},this.it.set(t,r)):n=r[i],void 0===n){const s=this.ot(t,e,i);n=fh.define(fh.getDefinition(s),class extends s{constructor(){super(t)}}),r[i]=n}return n}ot(t,e,i){let n,r=this.st.get(t.constructor);if(void 0===r?(r={},this.st.set(t.constructor,r)):n=r[i],void 0===n){n=fh.define(this.lt(e,i),class{constructor(t){this.viewModel=t}define(t,e,i){const n=this.viewModel;if(t.scope=Ii.fromParent(t.scope,n),void 0!==n.define)return n.define(t,e,i)}});const s=n.prototype;"hydrating"in t&&(s.hydrating=function(t){this.viewModel.hydrating(t)}),"hydrated"in t&&(s.hydrated=function(t){this.viewModel.hydrated(t)}),"created"in t&&(s.created=function(t){this.viewModel.created(t)}),"binding"in t&&(s.binding=function(t,e,i){return this.viewModel.binding(t,e,i)}),"bound"in t&&(s.bound=function(t,e,i){return this.viewModel.bound(t,e,i)}),"attaching"in t&&(s.attaching=function(t,e,i){return this.viewModel.attaching(t,e,i)}),"attached"in t&&(s.attached=function(t,e){return this.viewModel.attached(t,e)}),"detaching"in t&&(s.detaching=function(t,e,i){return this.viewModel.detaching(t,e,i)}),"unbinding"in t&&(s.unbinding=function(t,e,i){return this.viewModel.unbinding(t,e,i)}),"dispose"in t&&(s.dispose=function(){this.viewModel.dispose()}),r[i]=n}return n}nt(t,e){return e||(1===t.length?t[0].name:"default-view")}lt(t,e){const i=t.find((t=>t.name===e));if(void 0===i)throw new Error(`Could not find view: ${e}`);return i}}const Vh=ae.createInterface("IRendering",(t=>t.singleton(qh)));class qh{constructor(t){this.ht=new WeakMap,this.at=new WeakMap,this.ct=(this.ut=t.root).get(Qa),this.ft=new Mc(this.ct,this.ct.document.createDocumentFragment())}get renderers(){return null==this.rs?this.rs=this.ut.getAll(cu,!1).reduce(((t,e)=>(t[e.instructionType]=e,t)),ca()):this.rs}compile(t,e,i){if(!1!==t.needsCompile){const n=this.ht,r=e.get(hu);let s=n.get(t);return null==s?n.set(t,s=r.compile(t,e,i)):e.register(...s.dependencies),s}return t}getViewFactory(t,e){return new Nh(e,nh.getOrCreate(t))}createNodes(t){if(!0===t.enhance)return new Mc(this.ct,t.template);let e;const i=this.at;if(i.has(t))e=i.get(t);else{const n=this.ct,r=n.document,s=t.template;let o;null===s?e=null:s instanceof n.Node?"TEMPLATE"===s.nodeName?e=r.adoptNode(s.content):(e=r.adoptNode(r.createDocumentFragment())).appendChild(s.cloneNode(!0)):(o=r.createElement("template"),va(s)&&(o.innerHTML=s),r.adoptNode(e=o.content)),i.set(t,e)}return null==e?this.ft:new Mc(this.ct,e.cloneNode(!0))}render(t,e,i,n){const r=i.instructions,s=this.renderers,o=e.length;if(e.length!==r.length)throw new Error(`AUR0757:${o}<>${r.length}`);let a,l,h,c=0,u=0,d=0;if(o>0)for(;o>c;){for(a=r[c],h=e[c],u=0,d=a.length;d>u;)l=a[u],s[l.type].render(t,h,l),++u;++c}if(null!=n&&(a=i.surrogates,(d=a.length)>0))for(u=0;d>u;)l=a[u],s[l.type].render(t,n,l),++u}}var Wh;qh.inject=[ce],function(t){t[t.none=0]="none",t[t.host=1]="host",t[t.shadowRoot=2]="shadowRoot",t[t.location=3]="location"}(Wh||(Wh={}));const Yh={optional:!0},Xh=new WeakMap;class Kh{constructor(t,e,i,n,r,s){switch(this.container=t,this.vmKind=e,this.definition=i,this.viewFactory=n,this.viewModel=r,this.host=s,this.id=Pt("au$component"),this.head=null,this.tail=null,this.next=null,this.parent=null,this.bindings=null,this.children=null,this.hasLockedScope=!1,this.isStrictBinding=!1,this.scope=null,this.isBound=!1,this.hostController=null,this.mountTarget=0,this.shadowRoot=null,this.nodes=null,this.location=null,this.lifecycleHooks=null,this.state=0,this.dt=!1,this.vt=ze,this.flags=0,this.$initiator=null,this.$flags=0,this.$resolve=void 0,this.$reject=void 0,this.$promise=void 0,this.gt=0,this.wt=0,this.bt=0,this.r=t.root.get(Vh),e){case 1:case 0:this.hooks=new ic(r);break;case 2:this.hooks=ic.none}}get isActive(){return(3&this.state)>0&&0==(4&this.state)}get name(){var t;if(null===this.parent)switch(this.vmKind){case 1:return`[${this.definition.name}]`;case 0:return this.definition.name;case 2:return this.viewFactory.name}switch(this.vmKind){case 1:return`${this.parent.name}>[${this.definition.name}]`;case 0:return`${this.parent.name}>${this.definition.name}`;case 2:return this.viewFactory.name===(null===(t=this.parent.definition)||void 0===t?void 0:t.name)?`${this.parent.name}[view]`:`${this.parent.name}[view:${this.viewFactory.name}]`}}static getCached(t){return Xh.get(t)}static getCachedOrThrow(t){const e=Kh.getCached(t);if(void 0===e)throw new Error(`AUR0500:${t}`);return e}static $el(t,e,i,n,r){if(Xh.has(e))return Xh.get(e);r=null!=r?r:fh.getDefinition(e.constructor);const s=new Kh(t,0,r,null,e,i),o=t.get(ye(lc));return r.dependencies.length>0&&t.register(...r.dependencies),t.registerResolver(lc,new Ne("IHydrationContext",new hc(s,n,o))),Xh.set(e,s),null!=n&&!1===n.hydrate||s.xt(n,o),s}static $attr(t,e,i,n){if(Xh.has(e))return Xh.get(e);n=null!=n?n:Ql.getDefinition(e.constructor);const r=new Kh(t,1,n,null,e,i);return Xh.set(e,r),r.yt(),r}static $view(t,e){const i=new Kh(t.container,2,null,t,null,null);return i.parent=null!=e?e:null,i.kt(),i}xt(t,e){const i=this.container,n=(this.flags,this.viewModel);let r=this.definition;if(this.scope=Ii.create(n,null,!0),r.watches.length>0&&ec(this,i,r,n),Zh(this,r,0,n),this.vt=function(t,e,i){const n=e.childrenObservers,r=Object.getOwnPropertyNames(n),s=r.length;if(s>0){const e=Qh(i),o=[];let a,l,h=0;for(;h<s;++h)a=r[h],null==e[a]&&(l=n[a],o[o.length]=e[a]=new Fl(t,i,a,l.callback,l.query,l.filter,l.map,l.options));return o}return ze}(this,r,n),this.hooks.hasDefine){const t=n.define(this,e,r);void 0!==t&&t!==r&&(r=nh.getOrCreate(t))}this.lifecycleHooks=Ih.resolve(i),r.register(i),null!==r.injectable&&i.registerResolver(r.injectable,new Ne("definition.injectable",n)),null!=t&&!1===t.hydrate||(this.Ct(t),this.At())}Ct(t){this.hooks.hasHydrating&&this.viewModel.hydrating(this);const e=this.St=this.r.compile(this.definition,this.container,t),{shadowOptions:i,isStrictBinding:n,hasSlots:r,containerless:s}=e;if(this.isStrictBinding=n,null!==(this.hostController=fh.for(this.host,Yh))&&(this.host=this.container.root.get(Qa).document.createElement(this.definition.name)),wc(this.host,fh.name,this),wc(this.host,this.definition.key,this),null!==i||r){if(s)throw new Error("AUR0501");wc(this.shadowRoot=this.host.attachShadow(null!=i?i:nc),fh.name,this),wc(this.shadowRoot,this.definition.key,this),this.mountTarget=2}else s?(wc(this.location=Ac(this.host),fh.name,this),wc(this.location,this.definition.key,this),this.mountTarget=3):this.mountTarget=1;this.viewModel.$controller=this,this.nodes=this.r.createNodes(e),this.hooks.hasHydrated&&this.viewModel.hydrated(this)}At(){this.r.render(this,this.nodes.findTargets(),this.St,this.host),this.hooks.hasCreated&&this.viewModel.created(this)}yt(){const t=this.definition,e=this.viewModel;t.watches.length>0&&ec(this,this.container,t,e),Zh(this,t,this.flags,e),e.$controller=this,this.lifecycleHooks=Ih.resolve(this.container),this.hooks.hasCreated&&this.viewModel.created(this)}kt(){this.St=this.r.compile(this.viewFactory.def,this.container,null),this.isStrictBinding=this.St.isStrictBinding,this.r.render(this,(this.nodes=this.r.createNodes(this.St)).findTargets(),this.St,void 0)}activate(t,e,i,n){switch(this.state){case 0:case 8:if(null!==e&&!e.isActive)return;this.state=1;break;case 2:return;case 32:throw new Error(`AUR0502:${this.name}`);default:throw new Error(`AUR0503:${this.name} ${oc(this.state)}`)}switch(this.parent=e,i|=2,this.vmKind){case 0:this.scope.parentScope=null!=n?n:null;break;case 1:this.scope=null!=n?n:null;break;case 2:if(null==n)throw new Error("AUR0504");this.hasLockedScope||(this.scope=n)}if(this.isStrictBinding&&(i|=1),this.$initiator=t,this.$flags=i,this.Rt(),this.hooks.hasBinding){const t=this.viewModel.binding(this.$initiator,this.parent,this.$flags);if(t instanceof Promise)return this.Et(),t.then((()=>{this.bind()})).catch((t=>{this.Bt(t)})),this.$promise}return this.bind(),this.$promise}bind(){let t,e=0,i=this.vt.length;if(i>0)for(;i>e;)this.vt[e].start(),++e;if(null!==this.bindings)for(e=0,i=this.bindings.length;i>e;)this.bindings[e].$bind(this.$flags,this.scope),++e;if(this.hooks.hasBound&&(t=this.viewModel.bound(this.$initiator,this.parent,this.$flags),t instanceof Promise))return this.Et(),void t.then((()=>{this.isBound=!0,this.It()})).catch((t=>{this.Bt(t)}));this.isBound=!0,this.It()}Tt(...t){switch(this.mountTarget){case 1:this.host.append(...t);break;case 2:this.shadowRoot.append(...t);break;case 3:{let e=0;for(;e<t.length;++e)this.location.parentNode.insertBefore(t[e],this.location);break}}}It(){if(null!==this.hostController)switch(this.mountTarget){case 1:case 2:this.hostController.Tt(this.host);break;case 3:this.hostController.Tt(this.location.$start,this.location)}switch(this.mountTarget){case 1:this.nodes.appendTo(this.host,null!=this.definition&&this.definition.enhance);break;case 2:{const t=this.container;(t.has(bh,!1)?t.get(bh):t.get(wh)).applyTo(this.shadowRoot),this.nodes.appendTo(this.shadowRoot);break}case 3:this.nodes.insertBefore(this.location)}if(this.hooks.hasAttaching){const t=this.viewModel.attaching(this.$initiator,this.parent,this.$flags);t instanceof Promise&&(this.Et(),this.Rt(),t.then((()=>{this.Dt()})).catch((t=>{this.Bt(t)})))}if(null!==this.children){let t=0;for(;t<this.children.length;++t)this.children[t].activate(this.$initiator,this,this.$flags,this.scope)}this.Dt()}deactivate(t,e,i){switch(-17&this.state){case 2:this.state=4;break;case 0:case 8:case 32:case 40:return;default:throw new Error(`AUR0505:${this.name} ${oc(this.state)}`)}this.$initiator=t,this.$flags=i,t===this&&this.Pt();let n=0;if(this.vt.length)for(;n<this.vt.length;++n)this.vt[n].stop();if(null!==this.children)for(n=0;n<this.children.length;++n)this.children[n].deactivate(t,this,i);if(this.hooks.hasDetaching){const e=this.viewModel.detaching(this.$initiator,this.parent,this.$flags);e instanceof Promise&&(this.Et(),t.Pt(),e.then((()=>{t.Ot()})).catch((e=>{t.Bt(e)})))}if(null===t.head?t.head=this:t.tail.next=this,t.tail=this,t===this)return this.Ot(),this.$promise}removeNodes(){switch(this.vmKind){case 0:case 2:this.nodes.remove(),this.nodes.unlink()}if(null!==this.hostController)switch(this.mountTarget){case 1:case 2:this.host.remove();break;case 3:this.location.$start.remove(),this.location.remove()}}unbind(){const t=4|this.$flags;let e=0;if(null!==this.bindings)for(;e<this.bindings.length;++e)this.bindings[e].$unbind(t);switch(this.parent=null,this.vmKind){case 1:this.scope=null;break;case 2:this.hasLockedScope||(this.scope=null),16!=(16&this.state)||this.viewFactory.tryReturnToCache(this)||this.$initiator!==this||this.dispose();break;case 0:this.scope.parentScope=null}32==(32&t)&&this.$initiator===this&&this.dispose(),this.state=32&this.state|8,this.$initiator=null,this.$t()}Et(){void 0===this.$promise&&(this.$promise=new Promise(((t,e)=>{this.$resolve=t,this.$reject=e})),this.$initiator!==this&&this.parent.Et())}$t(){void 0!==this.$promise&&(uc=this.$resolve,this.$resolve=this.$reject=this.$promise=void 0,uc(),uc=void 0)}Bt(t){void 0!==this.$promise&&(dc=this.$reject,this.$resolve=this.$reject=this.$promise=void 0,dc(t),dc=void 0),this.$initiator!==this&&this.parent.Bt(t)}Rt(){++this.gt,this.$initiator!==this&&this.parent.Rt()}Dt(){if(0==--this.gt){if(this.hooks.hasAttached){if(fc=this.viewModel.attached(this.$initiator,this.$flags),fc instanceof Promise)return this.Et(),fc.then((()=>{this.state=2,this.$t(),this.$initiator!==this&&this.parent.Dt()})).catch((t=>{this.Bt(t)})),void(fc=void 0);fc=void 0}this.state=2,this.$t()}this.$initiator!==this&&this.parent.Dt()}Pt(){++this.wt}Ot(){if(0==--this.wt){this.Lt(),this.removeNodes();let t=this.$initiator.head;for(;null!==t;)t!==this&&(t.debug&&t.logger.trace("detach()"),t.removeNodes()),t.hooks.hasUnbinding&&(t.debug&&t.logger.trace("unbinding()"),fc=t.viewModel.unbinding(t.$initiator,t.parent,t.$flags),fc instanceof Promise&&(this.Et(),this.Lt(),fc.then((()=>{this.qt()})).catch((t=>{this.Bt(t)}))),fc=void 0),t=t.next;this.qt()}}Lt(){++this.bt}qt(){if(0==--this.bt){let t=this.$initiator.head,e=null;for(;null!==t;)t!==this&&(t.isBound=!1,t.unbind()),e=t.next,t.next=null,t=e;this.head=this.tail=null,this.isBound=!1,this.unbind()}}addBinding(t){null===this.bindings?this.bindings=[t]:this.bindings[this.bindings.length]=t}addChild(t){null===this.children?this.children=[t]:this.children[this.children.length]=t}is(t){switch(this.vmKind){case 1:return Ql.getDefinition(this.viewModel.constructor).name===t;case 0:return fh.getDefinition(this.viewModel.constructor).name===t;case 2:return this.viewFactory.name===t}}lockScope(t){this.scope=t,this.hasLockedScope=!0}setHost(t){return 0===this.vmKind&&(wc(t,fh.name,this),wc(t,this.definition.key,this)),this.host=t,this.mountTarget=1,this}setShadowRoot(t){return 0===this.vmKind&&(wc(t,fh.name,this),wc(t,this.definition.key,this)),this.shadowRoot=t,this.mountTarget=2,this}setLocation(t){return 0===this.vmKind&&(wc(t,fh.name,this),wc(t,this.definition.key,this)),this.location=t,this.mountTarget=3,this}release(){this.state|=16}dispose(){32!=(32&this.state)&&(this.state|=32,this.hooks.hasDispose&&this.viewModel.dispose(),null!==this.children&&(this.children.forEach(cc),this.children=null),this.hostController=null,this.scope=null,this.nodes=null,this.location=null,this.viewFactory=null,null!==this.viewModel&&(Xh.delete(this.viewModel),this.viewModel=null),this.viewModel=null,this.host=null,this.shadowRoot=null,this.container.disposeResolvers())}accept(t){if(!0===t(this))return!0;if(this.hooks.hasAccept&&!0===this.viewModel.accept(t))return!0;if(null!==this.children){const{children:e}=this;for(let i=0,n=e.length;i<n;++i)if(!0===e[i].accept(t))return!0}}}function Qh(t){let e=t.$observers;return void 0===e&&Reflect.defineProperty(t,"$observers",{enumerable:!1,value:e={}}),e}function Zh(t,e,i,n){const r=e.bindables,s=Object.getOwnPropertyNames(r),o=s.length;if(o>0){let e,i,a=0;const l=Qh(n),h=t.container,c=h.has(Mn,!0)?h.get(Mn):null;for(;a<o;++a)e=s[a],void 0===l[e]&&(i=r[e],l[e]=new ka(n,e,i.callback,i.set,t,c))}}const Jh=new Map,tc=t=>{let e=Jh.get(t);return null==e&&(e=new on(t,0),Jh.set(t,e)),e};function ec(t,e,i,n){const r=e.get(Ho),s=e.get(Zr),o=i.watches,a=0===t.vmKind?t.scope:Ii.create(n,null,!0),l=o.length;let h,c,u,d=0;for(;l>d;++d){if(({expression:h,callback:c}=o[d]),c=ga(c)?c:Reflect.get(n,c),!ga(c))throw new Error(`AUR0506:${String(c)}`);ga(h)?t.addBinding(new Ah(n,r,h,c,!0)):(u=va(h)?s.parse(h,8):tc(h),t.addBinding(new Th(a,e,r,u,c)))}}class ic{constructor(t){this.hasDefine="define"in t,this.hasHydrating="hydrating"in t,this.hasHydrated="hydrated"in t,this.hasCreated="created"in t,this.hasBinding="binding"in t,this.hasBound="bound"in t,this.hasAttaching="attaching"in t,this.hasAttached="attached"in t,this.hasDetaching="detaching"in t,this.hasUnbinding="unbinding"in t,this.hasDispose="dispose"in t,this.hasAccept="accept"in t}}ic.none=new ic({});const nc={mode:"open"};var rc,sc;function oc(t){const e=[];return 1==(1&t)&&e.push("activating"),2==(2&t)&&e.push("activated"),4==(4&t)&&e.push("deactivating"),8==(8&t)&&e.push("deactivated"),16==(16&t)&&e.push("released"),32==(32&t)&&e.push("disposed"),0===e.length?"none":e.join("|")}!function(t){t[t.customElement=0]="customElement",t[t.customAttribute=1]="customAttribute",t[t.synthetic=2]="synthetic"}(rc||(rc={})),function(t){t[t.none=0]="none",t[t.activating=1]="activating",t[t.activated=2]="activated",t[t.deactivating=4]="deactivating",t[t.deactivated=8]="deactivated",t[t.released=16]="released",t[t.disposed=32]="disposed"}(sc||(sc={}));const ac=ae.createInterface("IController"),lc=ae.createInterface("IHydrationContext");class hc{constructor(t,e,i){this.instruction=e,this.parent=i,this.controller=t}}function cc(t){t.dispose()}let uc,dc,fc;const pc=ae.createInterface("IAppRoot"),gc=ae.createInterface("IWorkTracker",(t=>t.singleton(vc)));class vc{constructor(t){this.Mt=0,this.Ut=null,this.$t=null,this.Ft=t.scopeTo("WorkTracker")}start(){this.Ft.trace(`start(stack:${this.Mt})`),++this.Mt}finish(){if(this.Ft.trace(`finish(stack:${this.Mt})`),0==--this.Mt){const t=this.$t;null!==t&&(this.$t=this.Ut=null,t())}}wait(){if(this.Ft.trace(`wait(stack:${this.Mt})`),null===this.Ut){if(0===this.Mt)return Promise.resolve();this.Ut=new Promise((t=>{this.$t=t}))}return this.Ut}}vc.inject=[Ze];class mc{constructor(t,e,i,n){this.config=t,this.platform=e,this.container=i,this.controller=void 0,this.Vt=void 0,this.host=t.host,this.work=i.get(gc),n.prepare(this),i.registerResolver(e.HTMLElement,i.registerResolver(e.Element,i.registerResolver(_c,new Ne("ElementResolver",t.host)))),this.Vt=Bt(this._t("beforeCreate"),(()=>{const e=t.component,n=i.createChild();let r;r=fh.isType(e)?this.container.get(e):t.component;const s={hydrate:!1,projections:null},o=this.controller=Kh.$el(n,r,this.host,s);return o.xt(s,null),Bt(this._t("hydrating"),(()=>(o.Ct(null),Bt(this._t("hydrated"),(()=>{o.At(),this.Vt=void 0})))))}))}activate(){return Bt(this.Vt,(()=>Bt(this._t("beforeActivate"),(()=>Bt(this.controller.activate(this.controller,null,2,void 0),(()=>this._t("afterActivate")))))))}deactivate(){return Bt(this._t("beforeDeactivate"),(()=>Bt(this.controller.deactivate(this.controller,null,0),(()=>this._t("afterDeactivate")))))}_t(t){return Ft(...this.container.getAll(Pl).reduce(((e,i)=>(i.slot===t&&e.push(i.run()),e)),[]))}dispose(){var t;null===(t=this.controller)||void 0===t||t.dispose()}}class yc{}function bc(t,e){var i,n;return null!==(n=null===(i=t.$au)||void 0===i?void 0:i[e])&&void 0!==n?n:null}function wc(t,e,i){var n,r;(null!==(n=(r=t).$au)&&void 0!==n?n:r.$au=new yc)[e]=i}const _c=ae.createInterface("INode"),xc=ae.createInterface("IEventTarget",(t=>t.cachedCallback((t=>t.has(pc,!0)?t.get(pc).host:t.get(Qa).document)))),kc=ae.createInterface("IRenderLocation");var Cc;!function(t){t[t.Element=1]="Element",t[t.Attr=2]="Attr",t[t.Text=3]="Text",t[t.CDATASection=4]="CDATASection",t[t.EntityReference=5]="EntityReference",t[t.Entity=6]="Entity",t[t.ProcessingInstruction=7]="ProcessingInstruction",t[t.Comment=8]="Comment",t[t.Document=9]="Document",t[t.DocumentType=10]="DocumentType",t[t.DocumentFragment=11]="DocumentFragment",t[t.Notation=12]="Notation"}(Cc||(Cc={}));const Sc=new WeakMap;function Ec(t){if(Sc.has(t))return Sc.get(t);let e=0,i=t.nextSibling;for(;null!==i;){if(8===i.nodeType)switch(i.textContent){case"au-start":++e;break;case"au-end":if(0==e--)return i}i=i.nextSibling}if(null===t.parentNode&&11===t.nodeType){const e=fh.for(t);if(void 0===e)return null;if(2===e.mountTarget)return Ec(e.host)}return t.parentNode}function Ac(t){if(Tc(t))return t;const e=t.ownerDocument.createComment("au-end"),i=t.ownerDocument.createComment("au-start");return null!==t.parentNode&&(t.parentNode.replaceChild(e,t),e.parentNode.insertBefore(i,e)),e.$start=i,e}function Tc(t){return"au-end"===t.textContent}class Mc{constructor(t,e){this.platform=t,this.fragment=e,this.isMounted=!1,this.isLinked=!1,this.next=void 0,this.refNode=void 0;const i=e.querySelectorAll(".au");let n,r=0,s=i.length,o=this.targets=Array(s);for(;s>r;)n=i[r],"AU-M"===n.nodeName?o[r]=Ac(n):o[r]=n,++r;const a=e.childNodes,l=this.childNodes=Array(s=a.length);for(r=0;s>r;)l[r]=a[r],++r;this.firstChild=e.firstChild,this.lastChild=e.lastChild}findTargets(){return this.targets}insertBefore(t){if(this.isLinked&&this.refNode)this.addToLinked();else{const e=t.parentNode;if(this.isMounted){let i,n=this.firstChild;const r=this.lastChild;for(;null!=n&&(i=n.nextSibling,e.insertBefore(n,t),n!==r);)n=i}else this.isMounted=!0,t.parentNode.insertBefore(this.fragment,t)}}appendTo(t,e=!1){if(this.isMounted){let e,i=this.firstChild;const n=this.lastChild;for(;null!=i&&(e=i.nextSibling,t.appendChild(i),i!==n);)i=e}else this.isMounted=!0,e||t.appendChild(this.fragment)}remove(){if(this.isMounted){this.isMounted=!1;const t=this.fragment,e=this.lastChild;let i,n=this.firstChild;for(;null!==n&&(i=n.nextSibling,t.appendChild(n),n!==e);)n=i}}addToLinked(){const t=this.refNode,e=t.parentNode;if(this.isMounted){let i,n=this.firstChild;const r=this.lastChild;for(;null!=n&&(i=n.nextSibling,e.insertBefore(n,t),n!==r);)n=i}else this.isMounted=!0,e.insertBefore(this.fragment,t)}unlink(){this.isLinked=!1,this.next=void 0,this.refNode=void 0}link(t){this.isLinked=!0,Tc(t)?this.refNode=t:(this.next=t,this.obtainRefNode())}obtainRefNode(){void 0!==this.next?this.refNode=this.next.firstChild:this.refNode=void 0}}const Oc=ae.createInterface("IWindow",(t=>t.callback((t=>t.get(Qa).window)))),Pc=(ae.createInterface("ILocation",(t=>t.callback((t=>t.get(Oc).location)))),ae.createInterface("IHistory",(t=>t.callback((t=>t.get(Oc).history)))),{[Ln.capturing]:{capture:!0},[Ln.bubbling]:{capture:!1}});class Rc{constructor(t,e,i,n,r,s,o,a){this.platform=t,this.targetEvent=e,this.delegationStrategy=i,this.sourceExpression=n,this.target=r,this.preventDefault=s,this.eventDelegator=o,this.locator=a,this.interceptor=this,this.isBound=!1,this.handler=null}callSource(t){const e=this.$scope.overrideContext;e.$event=t;const i=this.sourceExpression.evaluate(8,this.$scope,this.locator,null);return Reflect.deleteProperty(e,"$event"),!0!==i&&this.preventDefault&&t.preventDefault(),i}handleEvent(t){this.interceptor.callSource(t)}$bind(t,e){if(this.isBound){if(this.$scope===e)return;this.interceptor.$unbind(2|t)}this.$scope=e;const i=this.sourceExpression;i.hasBind&&i.bind(t,e,this.interceptor),this.delegationStrategy===Ln.none?this.target.addEventListener(this.targetEvent,this):this.handler=this.eventDelegator.addEventListener(this.locator.get(xc),this.target,this.targetEvent,this,Pc[this.delegationStrategy]),this.isBound=!0}$unbind(t){if(!this.isBound)return;const e=this.sourceExpression;e.hasUnbind&&e.unbind(t,this.$scope,this.interceptor),this.$scope=null,this.delegationStrategy===Ln.none?this.target.removeEventListener(this.targetEvent,this):(this.handler.dispose(),this.handler=null),this.isBound=!1}observe(t,e){}handleChange(t,e,i){}}const Lc={capture:!1};class Ic{constructor(t,e,i=Lc){this.jt=t,this.Nt=e,this.Wt=i,this.Ht=0,this.zt=new Map,this.Gt=new Map}Xt(){1==++this.Ht&&this.jt.addEventListener(this.Nt,this,this.Wt)}Kt(){0==--this.Ht&&this.jt.removeEventListener(this.Nt,this,this.Wt)}dispose(){this.Ht>0&&(this.Ht=0,this.jt.removeEventListener(this.Nt,this,this.Wt)),this.zt.clear(),this.Gt.clear()}Yt(t){const e=!0===this.Wt.capture?this.zt:this.Gt;let i=e.get(t);return void 0===i&&e.set(t,i=ca()),i}handleEvent(t){const e=!0===this.Wt.capture?this.zt:this.Gt,i=t.composedPath();!0===this.Wt.capture&&i.reverse();for(const n of i){const i=e.get(n);if(void 0===i)continue;const r=i[this.Nt];if(void 0!==r&&(ga(r)?r(t):r.handleEvent(t),!0===t.cancelBubble))return}}}class $c{constructor(t,e,i,n){this.Qt=t,this.Zt=e,this.Nt=i,t.Xt(),e[i]=n}dispose(){this.Qt.Kt(),this.Zt[this.Nt]=void 0}}class Dc{constructor(t){this.config=t,this.target=null,this.handler=null}subscribe(t,e){let i;for(i of(this.target=t,this.handler=e,this.config.events))t.addEventListener(i,e)}dispose(){const{target:t,handler:e}=this;let i;if(null!==t&&null!==e)for(i of this.config.events)t.removeEventListener(i,e);this.target=this.handler=null}}const Nc=ae.createInterface("IEventDelegator",(t=>t.singleton(jc)));class jc{constructor(){this.Jt=ca()}addEventListener(t,e,i,n,r){var s,o;const a=null!==(s=(o=this.Jt)[i])&&void 0!==s?s:o[i]=new Map;let l=a.get(t);return void 0===l&&a.set(t,l=new Ic(t,i,r)),new $c(l,l.Yt(e),i,n)}dispose(){for(const t in this.Jt){const e=this.Jt[t];for(const t of e.values())t.dispose();e.clear()}}}ae.createInterface("IProjections");const Bc=ae.createInterface("IAuSlotsInfo");class Fc{constructor(t){this.projectedSlots=t}}var zc;!function(t){t.hydrateElement="ra",t.hydrateAttribute="rb",t.hydrateTemplateController="rc",t.hydrateLetElement="rd",t.setProperty="re",t.interpolation="rf",t.propertyBinding="rg",t.callBinding="rh",t.letBinding="ri",t.refBinding="rj",t.iteratorBinding="rk",t.textBinding="ha",t.listenerBinding="hb",t.attributeBinding="hc",t.stylePropertyBinding="hd",t.setAttribute="he",t.setClassAttribute="hf",t.setStyleAttribute="hg",t.spreadBinding="hs",t.spreadElementProp="hp"}(zc||(zc={}));const Uc=ae.createInterface("Instruction");function Gc(t){const e=t.type;return va(e)&&2===e.length}class Hc{constructor(t,e){this.from=t,this.to=e}get type(){return"rf"}}class Vc{constructor(t,e,i){this.from=t,this.to=e,this.mode=i}get type(){return"rg"}}class qc{constructor(t,e){this.from=t,this.to=e}get type(){return"rk"}}class Wc{constructor(t,e){this.from=t,this.to=e}get type(){return"rh"}}class Yc{constructor(t,e){this.from=t,this.to=e}get type(){return"rj"}}class Xc{constructor(t,e){this.value=t,this.to=e}get type(){return"re"}}class Kc{constructor(t,e,i,n,r,s){this.res=t,this.alias=e,this.props=i,this.projections=n,this.containerless=r,this.captures=s,this.auSlot=null}get type(){return"ra"}}class Qc{constructor(t,e,i){this.res=t,this.alias=e,this.props=i}get type(){return"rb"}}class Zc{constructor(t,e,i,n){this.def=t,this.res=e,this.alias=i,this.props=n}get type(){return"rc"}}class Jc{constructor(t,e){this.instructions=t,this.toBindingContext=e}get type(){return"rd"}}class tu{constructor(t,e){this.from=t,this.to=e}get type(){return"ri"}}class eu{constructor(t,e){this.from=t,this.strict=e}get type(){return"ha"}}class iu{constructor(t,e,i,n){this.from=t,this.to=e,this.preventDefault=i,this.strategy=n}get type(){return"hb"}}class nu{constructor(t,e){this.value=t,this.to=e}get type(){return"he"}}class ru{constructor(t){this.value=t,this.type="hf"}}class su{constructor(t){this.value=t,this.type="hg"}}class ou{constructor(t,e,i){this.attr=t,this.from=e,this.to=i}get type(){return"hc"}}class au{get type(){return"hs"}}class lu{constructor(t){this.instructions=t}get type(){return"hp"}}const hu=ae.createInterface("ITemplateCompiler"),cu=ae.createInterface("IRenderer");function uu(t){return function(e){const i=function(...i){const n=new e(...i);return n.instructionType=t,n};i.register=function(t){De.singleton(cu,i).register(t)};const n=et.getOwnKeys(e);for(const t of n)ia(t,ta(t,e),i);const r=Object.getOwnPropertyDescriptors(e);return Object.keys(r).filter((t=>"prototype"!==t)).forEach((t=>{Reflect.defineProperty(i,t,r[t])})),i}}function du(t,e,i){return va(e)?t.parse(e,i):e}function fu(t){return null!=t.viewModel?t.viewModel:t}let pu=class{render(t,e,i){const n=fu(e);void 0!==n.$observers&&void 0!==n.$observers[i.to]?n.$observers[i.to].setValue(i.value,2):n[i.to]=i.value}};pu=Zo([uu("re")],pu);let gu=class{constructor(t,e){this.r=t,this.p=e}static get inject(){return[Vh,Qa]}render(t,e,i){let n,r,s,o;const a=i.res,l=i.projections,h=t.container,c=function(t,e,i,n,r,s){const o=e.container.createChild();return o.registerResolver(t.HTMLElement,o.registerResolver(t.Element,o.registerResolver(_c,new Ne("ElementResolver",i)))),o.registerResolver(ac,new Ne(Nu,e)),o.registerResolver(Uc,new Ne(ju,n)),o.registerResolver(kc,null==r?Gu:new Ne(Bu,r)),o.registerResolver(Dh,Hu),o.registerResolver(Bc,null==s?Vu:new Ne(Fu,s)),o}(this.p,t,e,i,e,null==l?void 0:new Fc(Object.keys(l)));if("string"==typeof a){if(n=h.find(fh,a),null==n)throw new Error(`AUR0752:${a}@${t.name}`)}else n=a;r=n.Type,s=c.invoke(r),c.registerResolver(r,new Ne(n.key,s)),o=Kh.$el(c,s,e,i,n),wc(e,n.key,o);const u=this.r.renderers,d=i.props,f=d.length;let p,g=0;for(;f>g;)p=d[g],u[p.type].render(t,o,p),++g;t.addChild(o)}};gu=Zo([uu("ra")],gu);let vu=class{constructor(t,e){this.r=t,this.p=e}static get inject(){return[Vh,Qa]}render(t,e,i){let n,r=t.container;if("string"==typeof i.res){if(n=r.find(Ql,i.res),null==n)throw new Error(`AUR0753:${i.res}@${t.name}`)}else n=i.res;const s=Uu(this.p,n,t,e,i,void 0,void 0),o=Kh.$attr(t.container,s,e,n);wc(e,n.key,o);const a=this.r.renderers,l=i.props,h=l.length;let c,u=0;for(;h>u;)c=l[u],a[c.type].render(t,o,c),++u;t.addChild(o)}};vu=Zo([uu("rb")],vu);let mu=class{constructor(t,e){this.r=t,this.p=e}static get inject(){return[Vh,Qa]}render(t,e,i){var n;let r,s=t.container;if("string"==typeof i.res){if(r=s.find(Ql,i.res),null==r)throw new Error(`AUR0754:${i.res}@${t.name}`)}else r=i.res;const o=this.r.getViewFactory(i.def,s),a=Ac(e),l=Uu(this.p,r,t,e,i,o,a),h=Kh.$attr(t.container,l,e,r);wc(a,r.key,h),null===(n=l.link)||void 0===n||n.call(l,t,h,e,i);const c=this.r.renderers,u=i.props,d=u.length;let f,p=0;for(;d>p;)f=u[p],c[f.type].render(t,h,f),++p;t.addChild(h)}};mu=Zo([uu("rc")],mu);let yu=class{constructor(t,e){this.ep=t,this.oL=e}render(t,e,i){e.remove();const n=i.instructions,r=i.toBindingContext,s=t.container,o=n.length;let a,l,h,c=0;for(;o>c;)a=n[c],l=du(this.ep,a.from,8),h=new xl(l,a.to,this.oL,s,r),t.addBinding(38962===l.$kind?Eu(h,l,s):h),++c}};yu.inject=[Zr,Ho],yu=Zo([uu("rd")],yu);let bu=class{constructor(t,e){this.ep=t,this.oL=e}render(t,e,i){const n=du(this.ep,i.from,12),r=new nl(n,fu(e),i.to,this.oL,t.container);t.addBinding(38962===n.$kind?Eu(r,n,t.container):r)}};bu.inject=[Zr,Ho],bu=Zo([uu("rh")],bu);let wu=class{constructor(t){this.ep=t}render(t,e,i){const n=du(this.ep,i.from,8),r=new Ol(n,function(t,e){if("element"===e)return t;switch(e){case"controller":return fh.for(t);case"view":throw new Error("AUR0750");case"view-model":return fh.for(t).viewModel;default:{const i=Ql.for(t,e);if(void 0!==i)return i.viewModel;const n=fh.for(t,{name:e});if(void 0===n)throw new Error(`AUR0751:${e}`);return n.viewModel}}}(e,i.to),t.container);t.addBinding(38962===n.$kind?Eu(r,n,t.container):r)}};wu.inject=[Zr],wu=Zo([uu("rj")],wu);let _u=class{constructor(t,e,i){this.ep=t,this.oL=e,this.p=i}render(t,e,i){const n=t.container,r=du(this.ep,i.from,1),s=new bl(this.oL,r,fu(e),i.to,On.toView,n,this.p.domWriteQueue),o=s.partBindings,a=o.length;let l,h=0;for(;a>h;++h)l=o[h],38962===l.sourceExpression.$kind&&(o[h]=Eu(l,l.sourceExpression,n));t.addBinding(s)}};_u.inject=[Zr,Ho,Qa],_u=Zo([uu("rf")],_u);let xu=class{constructor(t,e,i){this.ep=t,this.oL=e,this.p=i}render(t,e,i){const n=du(this.ep,i.from,8),r=new Tl(n,fu(e),i.to,i.mode,this.oL,t.container,this.p.domWriteQueue);t.addBinding(38962===n.$kind?Eu(r,n,t.container):r)}};xu.inject=[Zr,Ho,Qa],xu=Zo([uu("rg")],xu);let ku=class{constructor(t,e,i){this.ep=t,this.oL=e,this.p=i}render(t,e,i){const n=du(this.ep,i.from,2),r=new Tl(n,fu(e),i.to,On.toView,this.oL,t.container,this.p.domWriteQueue);t.addBinding(38962===n.iterable.$kind?Eu(r,n.iterable,t.container):r)}};ku.inject=[Zr,Ho,Qa],ku=Zo([uu("rk")],ku);let Cu=0;const Su=[];function Eu(t,e,i){for(;e instanceof tn;)Su[Cu++]=e,e=e.expression;for(;Cu>0;){const e=Su[--Cu],n=i.get(e.behaviorKey);n instanceof zi&&(t=n.construct(t,e))}return Su.length=0,t}let Au=class{constructor(t,e,i){this.ep=t,this.oL=e,this.p=i}render(t,e,i){const n=t.container,r=e.nextSibling,s=e.parentNode,o=this.p.document,a=du(this.ep,i.from,1),l=a.parts,h=a.expressions,c=h.length;let u,d,f=0,p=l[0];for(""!==p&&s.insertBefore(o.createTextNode(p),r);c>f;++f)d=h[f],u=new _l(d,s.insertBefore(o.createTextNode(""),r),n,this.oL,this.p,i.strict),t.addBinding(38962===d.$kind?Eu(u,d,n):u),p=l[f+1],""!==p&&s.insertBefore(o.createTextNode(p),r);"AU-M"===e.nodeName&&e.remove()}};Au.inject=[Zr,Ho,Qa],Au=Zo([uu("ha")],Au);let Tu=class{constructor(t,e,i){this.ep=t,this.te=e,this.p=i}render(t,e,i){const n=du(this.ep,i.from,4),r=new Rc(this.p,i.to,i.strategy,n,e,i.preventDefault,this.te,t.container);t.addBinding(38962===n.$kind?Eu(r,n,t.container):r)}};Tu.inject=[Zr,Nc,Qa],Tu=Zo([uu("hb")],Tu);let Mu=class{render(t,e,i){e.setAttribute(i.to,i.value)}};Mu=Zo([uu("he")],Mu);let Ou=class{render(t,e,i){!function(t,e){const i=e.length;let n=0;for(let r=0;r<i;++r)32===e.charCodeAt(r)?(r!==n&&t.add(e.slice(n,r)),n=r+1):r+1===i&&t.add(e.slice(n))}(e.classList,i.value)}};Ou=Zo([uu("hf")],Ou);let Pu=class{render(t,e,i){e.style.cssText+=i.value}};Pu=Zo([uu("hg")],Pu);let Ru=class{constructor(t,e,i){this.ep=t,this.oL=e,this.p=i}render(t,e,i){const n=du(this.ep,i.from,8),r=new Tl(n,e.style,i.to,On.toView,this.oL,t.container,this.p.domWriteQueue);t.addBinding(38962===n.$kind?Eu(r,n,t.container):r)}};Ru.inject=[Zr,Ho,Qa],Ru=Zo([uu("hd")],Ru);let Lu=class{constructor(t,e){this.ep=t,this.oL=e}render(t,e,i){const n=du(this.ep,i.from,8),r=new vl(n,e,i.attr,i.to,On.toView,this.oL,t.container);t.addBinding(38962===n.$kind?Eu(r,n,t.container):r)}};Lu.inject=[Zr,Ho],Lu=Zo([uu("hc")],Lu);let Iu=class{constructor(t,e){this.ee=t,this.r=e}static get inject(){return[hu,Vh]}render(t,e,i){const n=t.container.get(lc),r=this.r.renderers,s=t=>{let e=t,i=n;for(;null!=i&&e>0;)i=i.parent,--e;if(null==i)throw new Error("No scope context for spread binding.");return i},o=i=>{var n,a;const l=s(i),h=Du(l),c=this.ee.compileSpread(l.controller.definition,null!==(a=null===(n=l.instruction)||void 0===n?void 0:n.captures)&&void 0!==a?a:ze,l.controller.container,e);let u;for(u of c)switch(u.type){case"hs":o(i+1);break;case"hp":r[u.instructions.type].render(h,fh.for(e),u.instructions);break;default:r[u.type].render(h,e,u)}t.addBinding(h)};o(0)}};Iu=Zo([uu("hs")],Iu);class $u{constructor(t,e){this.ie=t,this.se=e,this.interceptor=this,this.isBound=!1,this.ctrl=e.controller,this.locator=this.ctrl.container}get container(){return this.locator}get definition(){return this.ctrl.definition}get isStrictBinding(){return this.ctrl.isStrictBinding}$bind(t,e){var i;if(this.isBound)return;this.isBound=!0;const n=this.$scope=null!==(i=this.se.controller.scope.parentScope)&&void 0!==i?i:void 0;if(null==n)throw new Error("Invalid spreading. Context scope is null/undefined");this.ie.forEach((e=>e.$bind(t,n)))}$unbind(t){this.ie.forEach((e=>e.$unbind(t))),this.isBound=!1}addBinding(t){this.ie.push(t)}addChild(t){if(1!==t.vmKind)throw new Error("Spread binding does not support spreading custom attributes/template controllers");this.ctrl.addChild(t)}}const Du=t=>new $u([],t),Nu="IController",ju="IInstruction",Bu="IRenderLocation",Fu="IAuSlotsInfo";class zu{constructor(t){this.f=t}get $isResolver(){return!0}resolve(){const t=this.f;if(null===t)throw new Error("AUR7055");if(!va(t.name)||0===t.name.length)throw new Error("AUR0756");return t}}function Uu(t,e,i,n,r,s,o,a){const l=i.container.createChild();return l.registerResolver(t.HTMLElement,l.registerResolver(t.Element,l.registerResolver(_c,new Ne("ElementResolver",n)))),i=i instanceof Kh?i:i.ctrl,l.registerResolver(ac,new Ne(Nu,i)),l.registerResolver(Uc,new Ne(ju,r)),l.registerResolver(kc,null==o?Gu:new Ne(Bu,o)),l.registerResolver(Dh,null==s?Hu:new zu(s)),l.registerResolver(Bc,null==a?Vu:new Ne(Fu,a)),l.invoke(e.Type)}const Gu=new Ne(Bu),Hu=new zu(null),Vu=new Ne(Fu,new Fc(ze));var qu;function Wu(t){return function(e){return Zu.define(t,e)}}!function(t){t[t.None=0]="None",t[t.IgnoreAttr=1]="IgnoreAttr"}(qu||(qu={}));class Yu{constructor(t,e,i,n,r){this.Type=t,this.name=e,this.aliases=i,this.key=n,this.type=r}static create(t,e){let i,n;return va(t)?(i=t,n={name:i}):(i=t.name,n=t),new Yu(e,$t(Qu(e,"name"),i),It(Qu(e,"aliases"),n.aliases,e.aliases),Ku(i),$t(Qu(e,"type"),n.type,e.type,null))}register(t){const{Type:e,key:i,aliases:n}=this;De.singleton(i,e).register(t),De.aliasTo(i,e).register(t),Pi(n,Zu,i,t)}}const Xu=oa("binding-command"),Ku=t=>`${Xu}:${t}`,Qu=(t,e)=>ta(sa(e),t),Zu=Object.freeze({name:Xu,keyFrom:Ku,define(t,e){const i=Yu.create(t,e);return ia(Xu,i,i.Type),ia(Xu,i,i),aa(e,Xu),i.Type},getAnnotation:Qu});let Ju=class{constructor(t,e){this.type=0,this.m=t,this.ep=e}get name(){return"one-time"}build(t){var e;let i=t.attr.target,n=t.attr.rawValue;return null==t.bindable?i=null!==(e=this.m.map(t.node,i))&&void 0!==e?e:Et(i):(""===n&&1===t.def.type&&(n=Et(i)),i=t.bindable.property),new Vc(this.ep.parse(n,8),i,On.oneTime)}};Ju.inject=[tl,Zr],Ju=Zo([Wu("one-time")],Ju);let td=class{constructor(t,e){this.type=0,this.m=t,this.ep=e}get name(){return"to-view"}build(t){var e;let i=t.attr.target,n=t.attr.rawValue;return null==t.bindable?i=null!==(e=this.m.map(t.node,i))&&void 0!==e?e:Et(i):(""===n&&1===t.def.type&&(n=Et(i)),i=t.bindable.property),new Vc(this.ep.parse(n,8),i,On.toView)}};td.inject=[tl,Zr],td=Zo([Wu("to-view")],td);let ed=class{constructor(t,e){this.type=0,this.m=t,this.ep=e}get name(){return"from-view"}build(t){var e;const i=t.attr;let n=i.target,r=i.rawValue;return null==t.bindable?n=null!==(e=this.m.map(t.node,n))&&void 0!==e?e:Et(n):(""===r&&1===t.def.type&&(r=Et(n)),n=t.bindable.property),new Vc(this.ep.parse(r,8),n,On.fromView)}};ed.inject=[tl,Zr],ed=Zo([Wu("from-view")],ed);let id=class{constructor(t,e){this.type=0,this.m=t,this.ep=e}get name(){return"two-way"}build(t){var e;const i=t.attr;let n=i.target,r=i.rawValue;return null==t.bindable?n=null!==(e=this.m.map(t.node,n))&&void 0!==e?e:Et(n):(""===r&&1===t.def.type&&(r=Et(n)),n=t.bindable.property),new Vc(this.ep.parse(r,8),n,On.twoWay)}};id.inject=[tl,Zr],id=Zo([Wu("two-way")],id);let nd=class{constructor(t,e){this.type=0,this.m=t,this.ep=e}get name(){return"bind"}build(t){var e;const i=t.attr,n=t.bindable;let r,s,o=i.target,a=i.rawValue;return null==n?(s=this.m.isTwoWay(t.node,o)?On.twoWay:On.toView,o=null!==(e=this.m.map(t.node,o))&&void 0!==e?e:Et(o)):(""===a&&1===t.def.type&&(a=Et(o)),r=t.def.defaultBindingMode,s=n.mode===On.default||null==n.mode?null==r||r===On.default?On.toView:r:n.mode,o=n.property),new Vc(this.ep.parse(a,8),o,s)}};nd.inject=[tl,Zr],nd=Zo([Wu("bind")],nd);let rd=class{constructor(t){this.type=0,this.ep=t}get name(){return"call"}build(t){const e=null===t.bindable?Et(t.attr.target):t.bindable.property;return new Wc(this.ep.parse(t.attr.rawValue,12),e)}};rd.inject=[Zr],rd=Zo([Wu("call")],rd);let sd=class{constructor(t){this.type=0,this.ep=t}get name(){return"for"}build(t){const e=null===t.bindable?Et(t.attr.target):t.bindable.property;return new qc(this.ep.parse(t.attr.rawValue,2),e)}};sd.inject=[Zr],sd=Zo([Wu("for")],sd);let od=class{constructor(t){this.type=1,this.ep=t}get name(){return"trigger"}build(t){return new iu(this.ep.parse(t.attr.rawValue,4),t.attr.target,!0,Ln.none)}};od.inject=[Zr],od=Zo([Wu("trigger")],od);let ad=class{constructor(t){this.type=1,this.ep=t}get name(){return"delegate"}build(t){return new iu(this.ep.parse(t.attr.rawValue,4),t.attr.target,!1,Ln.bubbling)}};ad.inject=[Zr],ad=Zo([Wu("delegate")],ad);let ld=class{constructor(t){this.type=1,this.ep=t}get name(){return"capture"}build(t){return new iu(this.ep.parse(t.attr.rawValue,4),t.attr.target,!1,Ln.capturing)}};ld.inject=[Zr],ld=Zo([Wu("capture")],ld);let hd=class{constructor(t){this.type=1,this.ep=t}get name(){return"attr"}build(t){return new ou(t.attr.target,this.ep.parse(t.attr.rawValue,8),t.attr.target)}};hd.inject=[Zr],hd=Zo([Wu("attr")],hd);let cd=class{constructor(t){this.type=1,this.ep=t}get name(){return"style"}build(t){return new ou("style",this.ep.parse(t.attr.rawValue,8),t.attr.target)}};cd.inject=[Zr],cd=Zo([Wu("style")],cd);let ud=class{constructor(t){this.type=1,this.ep=t}get name(){return"class"}build(t){return new ou("class",this.ep.parse(t.attr.rawValue,8),t.attr.target)}};ud.inject=[Zr],ud=Zo([Wu("class")],ud);let dd=class{constructor(t){this.type=1,this.ep=t}get name(){return"ref"}build(t){return new Yc(this.ep.parse(t.attr.rawValue,8),t.attr.target)}};dd.inject=[Zr],dd=Zo([Wu("ref")],dd);let fd=class{constructor(){this.type=1}get name(){return"...$attrs"}build(t){return new au}};fd=Zo([Wu("...$attrs")],fd);const pd=ae.createInterface("ITemplateElementFactory",(t=>t.singleton(vd))),gd={};class vd{constructor(t){this.p=t,this.ne=t.document.createElement("template")}createTemplate(t){var e;if(va(t)){let e=gd[t];if(void 0===e){const i=this.ne;i.innerHTML=t;const n=i.content.firstElementChild;null==n||"TEMPLATE"!==n.nodeName||null!=n.nextElementSibling?(this.ne=this.p.document.createElement("template"),e=i):(i.content.removeChild(n),e=n),gd[t]=e}return e.cloneNode(!0)}if("TEMPLATE"!==t.nodeName){const e=this.p.document.createElement("template");return e.content.appendChild(t),e}return null===(e=t.parentNode)||void 0===e||e.removeChild(t),t.cloneNode(!0)}}vd.inject=[Qa];class md{constructor(t,e,i,n,r,s){this.hasSlot=!1,this.Ce=ca();const o=null!==n;this.c=e,this.root=null===r?this:r,this.def=t,this.ci=i,this.parent=n,this.re=o?n.re:e.get(pd),this.de=o?n.de:e.get(ja),this.ep=o?n.ep:e.get(Zr),this.m=o?n.m:e.get(tl),this.Ft=o?n.Ft:e.get(Ze),this.p=o?n.p:e.get(Qa),this.localEls=o?n.localEls:new Set,this.rows=null!=s?s:[]}ke(t){var e,i;(null!==(e=(i=this.root).deps)&&void 0!==e?e:i.deps=[]).push(t),this.root.c.register(t)}h(t){const e=this.p.document.createElement(t);return"template"===t&&this.p.document.adoptNode(e.content),e}ae(t){return this.c.find(fh,t)}ue(t){return this.c.find(Ql,t)}xe(t){return new md(this.def,this.c,this.ci,this,this.root,t)}ce(t){if(this.root!==this)return this.root.ce(t);const e=t.command;if(null===e)return null;let i=this.Ce[e];if(void 0===i){if(i=this.c.create(Zu,e),null===i)throw new Error(`AUR0713:${e}`);this.Ce[e]=i}return i}}function yd(t){const e=t.length;let i=0,n=0;for(;e>n;){if(i=t.charCodeAt(n),92===i)++n;else{if(58===i)return!0;if(36===i&&123===t.charCodeAt(n+1))return!1}++n}return!1}function bd(){xd.node=xd.attr=xd.bindable=xd.def=null}const wd={projections:null},_d={name:"unnamed"},xd={node:null,attr:null,bindable:null,def:null},kd=Object.assign(ca(),{id:!0,name:!0,"au-slot":!0,"as-element":!0}),Cd={checkbox:1,radio:1},Sd=new WeakMap;class Ed{constructor(t,e,i){this.attrs=t,this.bindables=e,this.primary=i}static from(t,e){let i=Sd.get(t);if(null==i){const n=t.bindables,r=ca(),s=e?void 0===t.defaultBindingMode?On.default:t.defaultBindingMode:On.default;let o,a,l,h,c=!1;for(a in n){if(o=n[a],h=o.attribute,!0===o.primary){if(c)throw new Error(`AUR0714:${t.name}`);c=!0,l=o}else c||null!=l||(l=o);r[h]=_a.create(a,t.Type,o)}null==o&&e&&(l=r.value=_a.create("value",t.Type,{mode:s})),Sd.set(t,i=new Ed(r,n,l))}return i}}var Ad;!function(t){t.property="property",t.attribute="attribute",t.mode="mode"}(Ad||(Ad={}));const Td=Object.freeze(["property","attribute","mode"]),Md="as-custom-element";function Od(t,e){const i=t.getAttribute(Md);if(null===i||""===i)throw new Error("AUR0715");if(e.has(i))throw new Error(`AUR0716:${i}`);return e.add(i),t.removeAttribute(Md),i}function Pd(t){switch(t.getAttribute("mode")){case"oneTime":return On.oneTime;case"toView":return On.toView;case"fromView":return On.fromView;case"twoWay":return On.twoWay;default:return On.default}}const Rd=ae.createInterface("ITemplateCompilerHooks"),Ld=new WeakMap,Id=oa("compiler-hooks");Object.freeze({name:Id,define(t){let e=Ld.get(t);return void 0===e&&(Ld.set(t,e=new $d(t)),ia(Id,e,t),aa(t,Id)),t}});class $d{constructor(t){this.Type=t}get name(){return""}register(t){t.register(De.singleton(Rd,this.Type))}}const Dd=fh.generateName;class Nd{constructor(t){this.mode=t,this.Ae=new Map}bind(t,e,i){this.Ae.set(i,i.mode),i.mode=this.mode}unbind(t,e,i){i.mode=this.Ae.get(i),this.Ae.delete(i)}}class jd extends Nd{constructor(){super(On.oneTime)}}class Bd extends Nd{constructor(){super(On.toView)}}class Fd extends Nd{constructor(){super(On.fromView)}}class zd extends Nd{constructor(){super(On.twoWay)}}Bi("oneTime")(jd),Bi("toView")(Bd),Bi("fromView")(Fd),Bi("twoWay")(zd);class Ud extends Ui{constructor(t,e){super(t,e),this.opts={delay:200},this.firstArg=null,this.task=null,this.taskQueue=t.locator.get(He).taskQueue,e.args.length>0&&(this.firstArg=e.args[0])}callSource(t){this.queueTask((()=>this.binding.callSource(t)))}handleChange(t,e,i){null!==this.task&&(this.task.cancel(),this.task=null),this.binding.handleChange(t,e,i)}updateSource(t,e){this.queueTask((()=>this.binding.updateSource(t,e)))}queueTask(t){const e=this.task;this.task=this.taskQueue.queueTask((()=>(this.task=null,t())),this.opts),null==e||e.cancel()}$bind(t,e){if(null!==this.firstArg){const i=Number(this.firstArg.evaluate(t,e,this.locator,null));this.opts.delay=isNaN(i)?200:i}this.binding.$bind(t,e)}$unbind(t){var e;null===(e=this.task)||void 0===e||e.cancel(),this.task=null,this.binding.$unbind(t)}}Bi("debounce")(Ud);class Gd{constructor(t){this.Zt=new Map,this.Se=t}bind(t,e,i,...n){if(!("handleChange"in i))throw new Error("AUR0817");if(0===n.length)throw new Error("AUR0818");let r;for(r of(this.Zt.set(i,n),n))this.Se.addSignalListener(r,i)}unbind(t,e,i){const n=this.Zt.get(i);let r;for(r of(this.Zt.delete(i),n))this.Se.removeSignalListener(r,i)}}Gd.inject=[Di],Bi("signal")(Gd);class Hd extends Ui{constructor(t,e){super(t,e),this.opts={delay:200},this.firstArg=null,this.task=null,this.lastCall=0,this.delay=0,this.p=t.locator.get(He),this.Re=this.p.taskQueue,e.args.length>0&&(this.firstArg=e.args[0])}callSource(t){this.Ee((()=>this.binding.callSource(t)))}handleChange(t,e,i){null!==this.task&&(this.task.cancel(),this.task=null,this.lastCall=this.p.performanceNow()),this.binding.handleChange(t,e,i)}updateSource(t,e){this.Ee((()=>this.binding.updateSource(t,e)))}Ee(t){const e=this.opts,i=this.p,n=this.lastCall+e.delay-i.performanceNow();if(n>0){const r=this.task;e.delay=n,this.task=this.Re.queueTask((()=>{this.lastCall=i.performanceNow(),this.task=null,e.delay=this.delay,t()}),e),null==r||r.cancel()}else this.lastCall=i.performanceNow(),t()}$bind(t,e){if(null!==this.firstArg){const i=Number(this.firstArg.evaluate(t,e,this.locator,null));this.opts.delay=this.delay=isNaN(i)?200:i}this.binding.$bind(t,e)}$unbind(t){var e;null===(e=this.task)||void 0===e||e.cancel(),this.task=null,super.$unbind(t)}}Bi("throttle")(Hd);const Vd=new class{constructor(){this.type=6}getValue(t,e){return t.getAttribute(e)}setValue(t,e,i,n){null==t?i.removeAttribute(n):i.setAttribute(n,t)}};class qd{bind(t,e,i){i.targetObserver=Vd}unbind(t,e,i){}}function Wd(t){const e=t.composedPath()[0];if(this.target===e)return this.selfEventCallSource(t)}Bi("attr")(qd);class Yd{bind(t,e,i){if(!i.callSource||!i.targetEvent)throw new Error("AUR0801");i.selfEventCallSource=i.callSource,i.callSource=Wd}unbind(t,e,i){i.callSource=i.selfEventCallSource,i.selfEventCallSource=null}}Bi("self")(Yd);const Xd=ca();class Kd{constructor(t){this.ns=t,this.type=6}static forNs(t){var e;return null!==(e=Xd[t])&&void 0!==e?e:Xd[t]=new Kd(t)}getValue(t,e){return t.getAttributeNS(this.ns,e)}setValue(t,e,i,n){null==t?i.removeAttributeNS(this.ns,n):i.setAttributeNS(this.ns,n,t)}}function Qd(t,e){return t===e}class Zd{constructor(t,e,i,n){this.handler=i,this.type=7,this.v=void 0,this.ov=void 0,this.Be=void 0,this.Ie=void 0,this.f=0,this.o=t,this.oL=n}getValue(){return this.v}setValue(t,e){const i=this.v;t!==i&&(this.v=t,this.ov=i,this.f=e,this.Te(),this.De(),this.queue.add(this))}handleCollectionChange(t,e){this.De()}handleChange(t,e,i){this.De()}De(){const t=this.v,e=this.o,i=ua.call(e,"model")?e.model:e.value,n="radio"===e.type,r=void 0!==e.matcher?e.matcher:Qd;if(n)e.checked=!!r(t,i);else if(!0===t)e.checked=!0;else{let n=!1;if(t instanceof Array)n=-1!==t.findIndex((t=>!!r(t,i)));else if(t instanceof Set){for(const e of t)if(r(e,i)){n=!0;break}}else if(t instanceof Map)for(const e of t){const t=e[0],s=e[1];if(r(t,i)&&!0===s){n=!0;break}}e.checked=n}}handleEvent(){let t=this.ov=this.v;const e=this.o,i=ua.call(e,"model")?e.model:e.value,n=e.checked,r=void 0!==e.matcher?e.matcher:Qd;if("checkbox"===e.type){if(t instanceof Array){const e=t.findIndex((t=>!!r(t,i)));return void(n&&-1===e?t.push(i):n||-1===e||t.splice(e,1))}if(t instanceof Set){const e={};let s=e;for(const e of t)if(!0===r(e,i)){s=e;break}return void(n&&s===e?t.add(i):n||s===e||t.delete(s))}if(t instanceof Map){let e;for(const n of t){const t=n[0];if(!0===r(t,i)){e=t;break}}return void t.set(e,n)}t=n}else{if(!n)return;t=i}this.v=t,this.queue.add(this)}start(){this.handler.subscribe(this.o,this),this.Te()}stop(){var t,e;this.handler.dispose(),null===(t=this.Be)||void 0===t||t.unsubscribe(this),this.Be=void 0,null===(e=this.Ie)||void 0===e||e.unsubscribe(this)}subscribe(t){this.subs.add(t)&&1===this.subs.count&&this.start()}unsubscribe(t){this.subs.remove(t)&&0===this.subs.count&&this.stop()}flush(){Jd=this.ov,this.ov=this.v,this.subs.notify(this.v,Jd,this.f)}Te(){var t,e,i,n,r,s,o;const a=this.o;null===(r=null!==(t=this.Ie)&&void 0!==t?t:this.Ie=null!==(i=null===(e=a.$observers)||void 0===e?void 0:e.model)&&void 0!==i?i:null===(n=a.$observers)||void 0===n?void 0:n.value)||void 0===r||r.subscribe(this),null===(s=this.Be)||void 0===s||s.unsubscribe(this),this.Be=void 0,"checkbox"===a.type&&(null===(o=this.Be=function(t,e){return t instanceof Array?e.getArrayObserver(t):t instanceof Map?e.getMapObserver(t):t instanceof Set?e.getSetObserver(t):void 0}(this.v,this.oL))||void 0===o||o.subscribe(this))}}let Jd;Nn(Zd),Gn(Zd);const tf=Object.prototype.hasOwnProperty,ef={childList:!0,subtree:!0,characterData:!0};function nf(t,e){return t===e}class rf{constructor(t,e,i,n){this.type=7,this.v=void 0,this.ov=void 0,this.H=!1,this.Pe=void 0,this.Oe=void 0,this.iO=!1,this.o=t,this.oL=n,this.handler=i}getValue(){return this.iO?this.v:this.o.multiple?function(t){const e=[];if(0===t.length)return e;const i=t.length;let n,r=0;for(;i>r;)n=t[r],n.selected&&(e[e.length]=tf.call(n,"model")?n.model:n.value),++r;return e}(this.o.options):this.o.value}setValue(t,e){this.ov=this.v,this.v=t,this.H=t!==this.ov,this.$e(t instanceof Array?t:null),0==(256&e)&&this.K()}K(){this.H&&(this.H=!1,this.syncOptions())}handleCollectionChange(){this.syncOptions()}syncOptions(){var t;const e=this.v,i=this.o,n=Array.isArray(e),r=null!==(t=i.matcher)&&void 0!==t?t:nf,s=i.options;let o=s.length;for(;o-- >0;){const t=s[o],i=tf.call(t,"model")?t.model:t.value;t.selected=n?-1!==e.findIndex((t=>!!r(i,t))):!!r(i,e)}}syncValue(){const t=this.o,e=t.options,i=e.length,n=this.v;let r=0;if(t.multiple){if(!(n instanceof Array))return!0;let s;const o=t.matcher||nf,a=[];for(;r<i;)s=e[r],s.selected&&a.push(tf.call(s,"model")?s.model:s.value),++r;let l;for(r=0;r<n.length;)l=n[r],-1===a.findIndex((t=>!!o(l,t)))?n.splice(r,1):++r;for(r=0;r<a.length;)l=a[r],-1===n.findIndex((t=>!!o(l,t)))&&n.push(l),++r;return!1}let s,o=null;for(;r<i;){if(s=e[r],s.selected){o=tf.call(s,"model")?s.model:s.value;break}++r}return this.ov=this.v,this.v=o,!0}Le(){(this.Oe=new this.o.ownerDocument.defaultView.MutationObserver(this.qe.bind(this))).observe(this.o,ef),this.$e(this.v instanceof Array?this.v:null),this.iO=!0}Me(){var t;this.Oe.disconnect(),null===(t=this.Pe)||void 0===t||t.unsubscribe(this),this.Oe=this.Pe=void 0,this.iO=!1}$e(t){var e;if(null===(e=this.Pe)||void 0===e||e.unsubscribe(this),this.Pe=void 0,null!=t){if(!this.o.multiple)throw new Error("AUR0654");(this.Pe=this.oL.getArrayObserver(t)).subscribe(this)}}handleEvent(){this.syncValue()&&this.queue.add(this)}qe(t){this.syncOptions(),this.syncValue()&&this.queue.add(this)}subscribe(t){this.subs.add(t)&&1===this.subs.count&&(this.handler.subscribe(this.o,this),this.Le())}unsubscribe(t){this.subs.remove(t)&&0===this.subs.count&&(this.handler.dispose(),this.Me())}flush(){sf=this.ov,this.ov=this.v,this.subs.notify(this.v,sf,0)}}let sf,of;Nn(rf),Gn(rf);class af{constructor(t){this.obj=t,this.type=6,this.value="",this.ov="",this.styles={},this.version=0,this.H=!1}getValue(){return this.obj.style.cssText}setValue(t,e){this.value=t,this.H=t!==this.ov,0==(256&e)&&this.K()}Ue(t){const e=[],i=/url\([^)]+$/;let n,r,s,o,a=0,l="";for(;a<t.length;)n=t.indexOf(";",a),-1===n&&(n=t.length),l+=t.substring(a,n),a=n+1,i.test(l)?l+=";":(r=l.indexOf(":"),s=l.substring(0,r).trim(),o=l.substring(r+1).trim(),e.push([s,o]),l="");return e}Fe(t){let e,i;const n=[];for(i in t)if(e=t[i],null!=e)if(va(e)){if(i.startsWith("--")){n.push([i,e]);continue}n.push([Tt(i),e])}else n.push(...this.Ve(e));return n}_e(t){const e=t.length;if(e>0){const i=[];let n=0;for(;e>n;++n)i.push(...this.Ve(t[n]));return i}return ze}Ve(t){return va(t)?this.Ue(t):t instanceof Array?this._e(t):t instanceof Object?this.Fe(t):ze}K(){if(this.H){this.H=!1;const t=this.value,e=this.styles,i=this.Ve(t);let n,r,s,o,a=this.version;this.ov=t;let l=0;const h=i.length;for(;l<h;++l)r=i[l],s=r[0],o=r[1],this.setProperty(s,o),e[s]=a;if(this.styles=e,this.version+=1,0===a)return;for(n in a-=1,e)Object.prototype.hasOwnProperty.call(e,n)&&e[n]===a&&this.obj.style.removeProperty(n)}}setProperty(t,e){let i="";null!=e&&ga(e.indexOf)&&e.includes("!important")&&(i="important",e=e.replace("!important","")),this.obj.style.setProperty(t,e,i)}bind(t){this.value=this.ov=this.obj.style.cssText}}class lf{constructor(t,e,i){this.handler=i,this.type=7,this.v="",this.ov="",this.H=!1,this.o=t,this.k=e}getValue(){return this.v}setValue(t,e){Object.is(t,this.v)||(this.ov=this.v,this.v=t,this.H=!0,this.handler.config.readonly||0!=(256&e)||this.K(e))}K(t){var e;this.H&&(this.H=!1,this.o[this.k]=null!==(e=this.v)&&void 0!==e?e:this.handler.config.default,0==(2&t)&&this.queue.add(this))}handleEvent(){this.ov=this.v,this.v=this.o[this.k],this.ov!==this.v&&(this.H=!1,this.queue.add(this))}subscribe(t){this.subs.add(t)&&1===this.subs.count&&(this.handler.subscribe(this.o,this),this.v=this.ov=this.o[this.k])}unsubscribe(t){this.subs.remove(t)&&0===this.subs.count&&this.handler.dispose()}flush(){of=this.ov,this.ov=this.v,this.subs.notify(this.v,of,0)}}Nn(lf),Gn(lf);const hf="http://www.w3.org/1999/xlink",cf="http://www.w3.org/XML/1998/namespace",uf="http://www.w3.org/2000/xmlns/",df=Object.assign(ca(),{"xlink:actuate":["actuate",hf],"xlink:arcrole":["arcrole",hf],"xlink:href":["href",hf],"xlink:role":["role",hf],"xlink:show":["show",hf],"xlink:title":["title",hf],"xlink:type":["type",hf],"xml:lang":["lang",cf],"xml:space":["space",cf],xmlns:["xmlns",uf],"xmlns:xlink":["xlink",uf]}),ff=new Bo;ff.type=6;class pf{constructor(t){var e;this.type=null!==(e=t.type)&&void 0!==e?e:lf,this.events=t.events,this.readonly=t.readonly,this.default=t.default}}class gf{constructor(t,e,i,n){this.locator=t,this.platform=e,this.dirtyChecker=i,this.svgAnalyzer=n,this.allowDirtyCheck=!0,this.je=ca(),this.Ne=ca(),this.We=ca(),this.He=ca();const r=["change","input"],s={events:r,default:""};this.useConfig({INPUT:{value:s,valueAsNumber:{events:r,default:0},checked:{type:Zd,events:r},files:{events:r,readonly:!0}},SELECT:{value:{type:rf,events:["change"],default:""}},TEXTAREA:{value:s}});const o={events:["change","input","blur","keyup","paste"],default:""},a={events:["scroll"],default:0};this.useConfigGlobal({scrollTop:a,scrollLeft:a,textContent:o,innerHTML:o}),this.overrideAccessorGlobal("css","style","class"),this.overrideAccessor({INPUT:["value","checked","model"],SELECT:["value"],TEXTAREA:["value"]})}static register(t){De.aliasTo(Vo,gf).register(t),De.singleton(Vo,gf).register(t)}handles(t,e){return t instanceof this.platform.Node}useConfig(t,e,i){var n,r;const s=this.je;let o;if(va(t))o=null!==(n=s[t])&&void 0!==n?n:s[t]=ca(),null==o[e]?o[e]=new pf(i):vf(t,e);else for(const i in t){o=null!==(r=s[i])&&void 0!==r?r:s[i]=ca();const n=t[i];for(e in n)null==o[e]?o[e]=new pf(n[e]):vf(i,e)}}useConfigGlobal(t,e){const i=this.Ne;if("object"==typeof t)for(const e in t)null==i[e]?i[e]=new pf(t[e]):vf("*",e);else null==i[t]?i[t]=new pf(e):vf("*",t)}getAccessor(t,e,i){var n;if(e in this.He||e in(null!==(n=this.We[t.tagName])&&void 0!==n?n:Ue))return this.getObserver(t,e,i);switch(e){case"src":case"href":case"role":return Vd;default:{const i=df[e];return void 0!==i?Kd.forNs(i[1]):fa(t,e,this.svgAnalyzer)?Vd:ff}}}overrideAccessor(t,e){var i,n,r,s;let o;if(va(t))o=null!==(i=(r=this.We)[t])&&void 0!==i?i:r[t]=ca(),o[e]=!0;else for(const e in t)for(const i of t[e])o=null!==(n=(s=this.We)[e])&&void 0!==n?n:s[e]=ca(),o[i]=!0}overrideAccessorGlobal(...t){for(const e of t)this.He[e]=!0}getObserver(t,e,i){var n,r;switch(e){case"role":return Vd;case"class":return new ph(t);case"css":case"style":return new af(t)}const s=null!==(r=null===(n=this.je[t.tagName])||void 0===n?void 0:n[e])&&void 0!==r?r:this.Ne[e];if(null!=s)return new s.type(t,e,new Dc(s),i,this.locator);const o=df[e];if(void 0!==o)return Kd.forNs(o[1]);if(fa(t,e,this.svgAnalyzer))return Vd;if(e in t.constructor.prototype){if(this.allowDirtyCheck)return this.dirtyChecker.createProperty(t,e);throw new Error(`AUR0652:${String(e)}`)}return new zo(t,e)}}function vf(t,e){throw new Error(`AUR0653:${String(e)}@${t}`)}gf.inject=[ue,Qa,Lo,Za];class mf{constructor(t){this.oL=t}bind(t,e,i,...n){if(0===n.length)throw new Error("AUR0802");if(i.mode!==On.twoWay&&i.mode!==On.fromView)throw new Error("AUR0803");const r=this.oL.getObserver(i.target,i.targetProperty);if(!r.handler)throw new Error("AUR0804");i.targetObserver=r;const s=r.handler;r.originalHandler=s,r.handler=new Dc(new pf({default:s.config.default,events:n,readonly:s.config.readonly}))}unbind(t,e,i){i.targetObserver.handler.dispose(),i.targetObserver.handler=i.targetObserver.originalHandler,i.targetObserver.originalHandler=null}}mf.inject=[Ho],Bi("updateTrigger")(mf);class yf{constructor(t,e){this.ze=t,this.p=e,this.Ge=!1}binding(){this.valueChanged()}valueChanged(){this.$controller.isActive?this.Xe():this.Ge=!0}attached(){this.Ge&&(this.Ge=!1,this.Xe()),this.ze.addEventListener("focus",this),this.ze.addEventListener("blur",this)}afterDetachChildren(){const t=this.ze;t.removeEventListener("focus",this),t.removeEventListener("blur",this)}handleEvent(t){"focus"===t.type?this.value=!0:this.Ke||(this.value=!1)}Xe(){const t=this.ze,e=this.Ke,i=this.value;i&&!e?t.focus():!i&&e&&t.blur()}get Ke(){return this.ze===this.p.document.activeElement}}yf.inject=[_c,Qa],Zo([ma({mode:On.twoWay})],yf.prototype,"value",void 0),Vl("focus")(yf);let bf=class{constructor(t,e,i){this.el=t,this.p=e,this.Ye=!1,this.Qe=null,this.$val="",this.$prio="",this.update=()=>{this.Qe=null,Boolean(this.value)!==this.Ze&&(this.Ze===this.Je?(this.Ze=!this.Je,this.$val=this.el.style.getPropertyValue("display"),this.$prio=this.el.style.getPropertyPriority("display"),this.el.style.setProperty("display","none","important")):(this.Ze=this.Je,this.el.style.setProperty("display",this.$val,this.$prio),""===this.el.getAttribute("style")&&this.el.removeAttribute("style")))},this.Ze=this.Je="hide"!==i.alias}binding(){this.Ye=!0,this.update()}detaching(){var t;this.Ye=!1,null===(t=this.Qe)||void 0===t||t.cancel(),this.Qe=null}valueChanged(){this.Ye&&null===this.Qe&&(this.Qe=this.p.domWriteQueue.queueTask(this.update))}};Zo([ma],bf.prototype,"value",void 0),bf=Zo([Jo(0,_c),Jo(1,Qa),Jo(2,Uc)],bf),function(...t){return function(e){const i=Ti("aliases"),n=Si(i,e);void 0===n?Ai(i,t,e):n.push(...t)}}("hide")(bf),Vl("show")(bf);class wf{constructor(t,e,i){this.id=Pt("au$component"),this.strict=!1,this.p=i,this.ti=i.document.createElement("div"),this.view=t.create(),function(t,e){if(void 0===t.platform||t instanceof t.platform.Node)Sc.set(t,e);else{const i=t.childNodes;for(let t=0,n=i.length;t<n;++t)Sc.set(i[t],e)}}(this.view.nodes,e)}attaching(t,e,i){null==this.callbackContext&&(this.callbackContext=this.$controller.scope.bindingContext);const n=this.ti=this.ei();return this.view.setHost(n),this.ii(t,n,i)}detaching(t,e,i){return this.si(t,this.ti,i)}targetChanged(){const{$controller:t}=this;if(!t.isActive)return;const e=this.ti,i=this.ti=this.ei();if(e===i)return;this.view.setHost(i);const n=Bt(this.si(null,i,t.flags),(()=>this.ii(null,i,t.flags)));n instanceof Promise&&n.catch((t=>{throw t}))}ii(t,e,i){const{activating:n,callbackContext:r,view:s}=this;return s.setHost(e),Bt(null==n?void 0:n.call(r,e,s),(()=>this.ni(t,e,i)))}ni(t,e,i){const{$controller:n,view:r}=this;return null!==t?Bt(r.activate(null!=t?t:r,n,i,n.scope),(()=>this.ri(e))):(r.nodes.appendTo(e),this.ri(e))}ri(t){const{activated:e,callbackContext:i,view:n}=this;return null==e?void 0:e.call(i,t,n)}si(t,e,i){const{deactivating:n,callbackContext:r,view:s}=this;return Bt(null==n?void 0:n.call(r,e,s),(()=>this.oi(t,e,i)))}oi(t,e,i){const{$controller:n,view:r}=this;return null!==t?Bt(r.deactivate(t,n,i),(()=>this.li(e))):(r.nodes.remove(),this.li(e))}li(t){const{deactivated:e,callbackContext:i,view:n}=this;return null==e?void 0:e.call(i,t,n)}ei(){const t=this.p,e=t.document;let i=this.target,n=this.renderContext;if(""===i){if(this.strict)throw new Error("AUR0811");return e.body}if(va(i)){let r=e;va(n)&&(n=e.querySelector(n)),n instanceof t.Node&&(r=n),i=r.querySelector(i)}if(i instanceof t.Node)return i;if(null==i){if(this.strict)throw new Error("AUR0812");return e.body}return i}dispose(){this.view.dispose(),this.view=void 0,this.callbackContext=null}accept(t){var e;if(!0===(null===(e=this.view)||void 0===e?void 0:e.accept(t)))return!0}}wf.inject=[Dh,kc,Qa],Zo([ma({primary:!0})],wf.prototype,"target",void 0),Zo([ma({callback:"targetChanged"})],wf.prototype,"renderContext",void 0),Zo([ma()],wf.prototype,"strict",void 0),Zo([ma()],wf.prototype,"deactivating",void 0),Zo([ma()],wf.prototype,"activating",void 0),Zo([ma()],wf.prototype,"deactivated",void 0),Zo([ma()],wf.prototype,"activated",void 0),Zo([ma()],wf.prototype,"callbackContext",void 0),ql("portal")(wf);class _f{constructor(t,e,i){this.fs=i,this.id=Pt("au$component"),this.view=t.create().setLocation(e)}attaching(t,e,i){const{$controller:n}=this;return this.view.activate(t,n,i|this.fs,n.scope)}detaching(t,e,i){return this.view.deactivate(t,this.$controller,i)}dispose(){this.view.dispose(),this.view=void 0}accept(t){var e;if(!0===(null===(e=this.view)||void 0===e?void 0:e.accept(t)))return!0}}class xf extends _f{constructor(t,e){super(t,e,512)}}xf.inject=[Dh,kc];class kf extends _f{constructor(t,e){super(t,e,128)}}kf.inject=[Dh,kc],ql("frequent-mutations")(xf),ql("observe-shallow")(kf);class Cf{constructor(t,e,i){this.ifFactory=t,this.location=e,this.work=i,this.id=Pt("au$component"),this.elseFactory=void 0,this.elseView=void 0,this.ifView=void 0,this.view=void 0,this.value=!1,this.cache=!0,this.pending=void 0,this.hi=!1,this.ai=0}attaching(t,e,i){let n;const r=this.$controller,s=this.ai++,o=()=>!this.hi&&this.ai===s+1;return Bt(this.pending,(()=>{var e;o()&&(this.pending=void 0,n=this.value?this.view=this.ifView=this.cache&&null!=this.ifView?this.ifView:this.ifFactory.create():this.view=this.elseView=this.cache&&null!=this.elseView?this.elseView:null===(e=this.elseFactory)||void 0===e?void 0:e.create(),null!=n&&(n.setLocation(this.location),this.pending=Bt(n.activate(t,r,i,r.scope),(()=>{o()&&(this.pending=void 0)}))))}))}detaching(t,e,i){return this.hi=!0,Bt(this.pending,(()=>{var e;this.hi=!1,this.pending=void 0,null===(e=this.view)||void 0===e||e.deactivate(t,this.$controller,i)}))}valueChanged(t,e,i){if(!this.$controller.isActive)return;if((t=!!t)==(e=!!e))return;this.work.start();const n=this.view,r=this.$controller,s=this.ai++,o=()=>!this.hi&&this.ai===s+1;let a;return Bt(Bt(this.pending,(()=>this.pending=Bt(null==n?void 0:n.deactivate(n,r,i),(()=>{var e;if(o()&&(a=this.view=t?this.ifView=this.cache&&null!=this.ifView?this.ifView:this.ifFactory.create():this.elseView=this.cache&&null!=this.elseView?this.elseView:null===(e=this.elseFactory)||void 0===e?void 0:e.create(),null!=a))return a.setLocation(this.location),Bt(a.activate(a,r,i,r.scope),(()=>{o()&&(this.pending=void 0)}))})))),(()=>this.work.finish()))}dispose(){var t,e;null===(t=this.ifView)||void 0===t||t.dispose(),null===(e=this.elseView)||void 0===e||e.dispose(),this.ifView=this.elseView=this.view=void 0}accept(t){var e;if(!0===(null===(e=this.view)||void 0===e?void 0:e.accept(t)))return!0}}Cf.inject=[Dh,kc,gc],Zo([ma],Cf.prototype,"value",void 0),Zo([ma({set:t=>""===t||!!t&&"false"!==t})],Cf.prototype,"cache",void 0),ql("if")(Cf);class Sf{constructor(t){this.factory=t,this.id=Pt("au$component")}link(t,e,i,n){const r=t.children,s=r[r.length-1];if(s instanceof Cf)s.elseFactory=this.factory;else{if(!(s.viewModel instanceof Cf))throw new Error("AUR0810");s.viewModel.elseFactory=this.factory}}}function Ef(t){t.dispose()}Sf.inject=[Dh],ql({name:"else"})(Sf);const Af=[38962,36913];class Tf{constructor(t,e,i){this.l=t,this.ui=e,this.f=i,this.id=Pt("au$component"),this.views=[],this.key=void 0,this.fi=void 0,this.di=!1,this.mi=!1,this.vi=null,this.pi=void 0,this.gi=!1}binding(t,e,i){const n=this.ui.bindings,r=n.length;let s,o,a=0;for(;r>a;++a)if(s=n[a],s.target===this&&"items"===s.targetProperty){o=this.forOf=s.sourceExpression,this.wi=s;let t=o.iterable;for(;null!=t&&Af.includes(t.$kind);)t=t.expression,this.di=!0;this.vi=t;break}this.bi(i);const l=o.declaration;(this.gi=90137===l.$kind||106521===l.$kind)||(this.local=l.evaluate(i,this.$controller.scope,s.locator,null))}attaching(t,e,i){return this.xi(i),this.yi(t,i)}detaching(t,e,i){return this.bi(i),this.ki(t,i)}itemsChanged(t){const{$controller:e}=this;if(!e.isActive)return;t|=e.flags,this.bi(t),this.xi(t);const i=Bt(this.ki(null,t),(()=>this.yi(null,t)));i instanceof Promise&&i.catch((t=>{throw t}))}handleCollectionChange(t,e){const{$controller:i}=this;if(i.isActive){if(this.di){if(this.mi)return;return this.mi=!0,this.items=this.forOf.iterable.evaluate(e,i.scope,this.wi.locator,null),void(this.mi=!1)}if(e|=i.flags,this.xi(e),void 0===t){const t=Bt(this.ki(null,e),(()=>this.yi(null,e)));t instanceof Promise&&t.catch((t=>{throw t}))}else{const i=this.views.length;if(function(t){let e=0,i=0;const n=t.length;for(let r=0;r<n;++r){for(;t.deletedItems[i]<=r-e;)++i,--e;-2===t[r]?++e:t[r]+=e}}(t),t.deletedItems.length>0){t.deletedItems.sort(Rt);const n=Bt(this.Ci(t,e),(()=>this.Ai(i,t,e)));n instanceof Promise&&n.catch((t=>{throw t}))}else this.Ai(i,t,e)}}}bi(t){var e;const i=this.$controller.scope;let n=this.Si,r=this.di;r&&(n=this.Si=null!==(e=this.vi.evaluate(t,i,this.wi.locator,null))&&void 0!==e?e:null,r=this.di=!Object.is(this.items,n));const s=this.fi;if(4&t)void 0!==s&&s.unsubscribe(this);else if(this.$controller.isActive){const t=this.fi=function(t){let e;return t instanceof Array?e=yr(t):t instanceof Map?e=Fr(t):t instanceof Set&&(e=Mr(t)),e}(r?n:this.items);s!==t&&s&&s.unsubscribe(this),t&&t.subscribe(this)}}xi(t){const e=this.items;if(e instanceof Array)return void(this.pi=e);if(void 0===this.forOf)return;const i=[];this.forOf.iterate(t,e,((t,e,n)=>{i[e]=n})),this.pi=i}yi(t,e){let i,n,r,s;const{$controller:o,f:a,local:l,l:h,items:c}=this,u=o.scope,d=this.forOf,f=d.count(e,c),p=this.views=Array(f);if(d.iterate(e,c,((c,g,v)=>{r=p[g]=a.create().setLocation(h),r.nodes.unlink(),this.gi?d.declaration.assign(e,s=Ii.fromParent(u,Li.create()),this.wi.locator,v):s=Ii.fromParent(u,Li.create(l,v)),Rf(s.overrideContext,g,f),n=r.activate(null!=t?t:r,o,e,s),n instanceof Promise&&(null!=i?i:i=[]).push(n)})),void 0!==i)return 1===i.length?i[0]:Promise.all(i)}ki(t,e){let i,n,r,s=0;const{views:o,$controller:a}=this,l=o.length;for(;l>s;++s)r=o[s],r.release(),n=r.deactivate(null!=t?t:r,a,e),n instanceof Promise&&(null!=i?i:i=[]).push(n);if(void 0!==i)return 1===i.length?i[0]:Promise.all(i)}Ci(t,e){let i,n,r;const{$controller:s,views:o}=this,a=t.deletedItems,l=a.length;let h=0;for(;l>h;++h)r=o[a[h]],r.release(),n=r.deactivate(r,s,e),n instanceof Promise&&(null!=i?i:i=[]).push(n);h=0;let c=0;for(;l>h;++h)c=a[h]-h,o.splice(c,1);if(void 0!==i)return 1===i.length?i[0]:Promise.all(i)}Ai(t,e,i){var n;let r,s,o,a,l=0;const{$controller:h,f:c,local:u,pi:d,l:f,views:p}=this,g=e.length;for(;g>l;++l)-2===e[l]&&(o=c.create(),p.splice(l,0,o));if(p.length!==g)throw new Error(`AUR0814:${p.length}!=${g}`);const v=h.scope,m=e.length;!function(t,e){const i=t.slice(),n=e.length;let r=0,s=0;for(;r<n;)s=e[r],-2!==s&&(t[r]=i[s]),++r}(p,e);const y=function(t){const e=t.length;e>Mf&&(Mf=e,Of=new Int32Array(e),Pf=new Int32Array(e));let i=0,n=0,r=0,s=0,o=0,a=0,l=0,h=0;for(;s<e;s++)if(n=t[s],-2!==n){if(o=Of[i],r=t[o],-2!==r&&r<n){Pf[s]=o,Of[++i]=s;continue}for(a=0,l=i;a<l;)h=a+l>>1,r=t[Of[h]],-2!==r&&r<n?a=h+1:l=h;r=t[Of[a]],(n<r||-2===r)&&(a>0&&(Pf[s]=Of[a-1]),Of[a]=s)}s=++i;const c=new Int32Array(s);for(n=Of[i-1];i-- >0;)c[i]=n,n=Pf[n];for(;s-- >0;)Of[s]=0;return c}(e),b=y.length;let w,_=b-1;for(l=m-1;l>=0;--l)o=p[l],w=p[l+1],o.nodes.link(null!==(n=null==w?void 0:w.nodes)&&void 0!==n?n:f),-2===e[l]?(this.gi?this.forOf.declaration.assign(i,a=Ii.fromParent(v,Li.create()),this.wi.locator,d[l]):a=Ii.fromParent(v,Li.create(u,d[l])),Rf(a.overrideContext,l,m),o.setLocation(f),s=o.activate(o,h,i,a),s instanceof Promise&&(null!=r?r:r=[]).push(s)):_<0||1===b||l!==y[_]?(Rf(o.scope.overrideContext,l,m),o.nodes.insertBefore(o.location)):(t!==m&&Rf(o.scope.overrideContext,l,m),--_);if(void 0!==r)return 1===r.length?r[0]:Promise.all(r)}dispose(){this.views.forEach(Ef),this.views=void 0}accept(t){const{views:e}=this;if(void 0!==e)for(let i=0,n=e.length;i<n;++i)if(!0===e[i].accept(t))return!0}}Tf.inject=[kc,ac,Dh],Zo([ma],Tf.prototype,"items",void 0),ql("repeat")(Tf);let Mf=16,Of=new Int32Array(Mf),Pf=new Int32Array(Mf);function Rf(t,e,i){const n=0===e,r=e===i-1,s=e%2==0;t.$index=e,t.$first=n,t.$last=r,t.$middle=!n&&!r,t.$even=s,t.$odd=!s,t.$length=i}class Lf{constructor(t,e){this.id=Pt("au$component"),this.id=Pt("au$component"),this.view=t.create().setLocation(e)}valueChanged(t,e,i){const n=this.$controller,r=this.view.bindings;let s,o=0,a=0;if(n.isActive&&null!=r)for(s=Ii.fromParent(n.scope,void 0===t?{}:t),a=r.length;a>o;++o)r[o].$bind(2,s)}attaching(t,e,i){const{$controller:n,value:r}=this,s=Ii.fromParent(n.scope,void 0===r?{}:r);return this.view.activate(t,n,i,s)}detaching(t,e,i){return this.view.deactivate(t,this.$controller,i)}dispose(){this.view.dispose(),this.view=void 0}accept(t){var e;if(!0===(null===(e=this.view)||void 0===e?void 0:e.accept(t)))return!0}}Lf.inject=[Dh,kc],Zo([ma],Lf.prototype,"value",void 0),ql("with")(Lf);let If=class{constructor(t,e){this.f=t,this.l=e,this.id=Pt("au$component"),this.cases=[],this.activeCases=[],this.promise=void 0}link(t,e,i,n){this.view=this.f.create(this.$controller).setLocation(this.l)}attaching(t,e,i){const n=this.view,r=this.$controller;return this.queue((()=>n.activate(t,r,i,r.scope))),this.queue((()=>this.swap(t,i,this.value))),this.promise}detaching(t,e,i){return this.queue((()=>this.view.deactivate(t,this.$controller,i))),this.promise}dispose(){var t;null===(t=this.view)||void 0===t||t.dispose(),this.view=void 0}valueChanged(t,e,i){this.$controller.isActive&&this.queue((()=>this.swap(null,i,this.value)))}caseChanged(t,e){this.queue((()=>this.Ri(t,e)))}Ri(t,e){const i=t.isMatch(this.value,e),n=this.activeCases,r=n.length;if(!i)return r>0&&n[0].id===t.id?this.Ei(null,e):void 0;if(r>0&&n[0].id<t.id)return;const s=[];let o=t.fallThrough;if(o){const e=this.cases,i=e.indexOf(t);for(let t=i,n=e.length;t<n&&o;t++){const i=e[t];s.push(i),o=i.fallThrough}}else s.push(t);return Bt(this.Ei(null,e,s),(()=>(this.activeCases=s,this.Bi(null,e))))}swap(t,e,i){const n=[];let r=!1;for(const t of this.cases)if((r||t.isMatch(i,e))&&(n.push(t),r=t.fallThrough),n.length>0&&!r)break;const s=this.defaultCase;return 0===n.length&&void 0!==s&&n.push(s),Bt(this.activeCases.length>0?this.Ei(t,e,n):void 0,(()=>{if(this.activeCases=n,0!==n.length)return this.Bi(t,e)}))}Bi(t,e){const i=this.$controller;if(!i.isActive)return;const n=this.activeCases,r=n.length;if(0===r)return;const s=i.scope;return 1===r?n[0].activate(t,e,s):Ft(...n.map((i=>i.activate(t,e,s))))}Ei(t,e,i=[]){const n=this.activeCases,r=n.length;if(0!==r){if(1===r){const r=n[0];return i.includes(r)?void 0:(n.length=0,r.deactivate(t,e))}return Bt(Ft(...n.reduce(((n,r)=>(i.includes(r)||n.push(r.deactivate(t,e)),n)),[])),(()=>{n.length=0}))}}queue(t){const e=this.promise;let i;i=this.promise=Bt(Bt(e,t),(()=>{this.promise===i&&(this.promise=void 0)}))}accept(t){return!0===this.$controller.accept(t)||!!this.activeCases.some((e=>e.accept(t)))||void 0}};Zo([ma],If.prototype,"value",void 0),If=Zo([ql("switch"),Jo(0,Dh),Jo(1,kc)],If);let $f=class{constructor(t,e,i,n){this.Ii=e,this.id=Pt("au$component"),this.fallThrough=!1,this.Ti=n.config.level<=1,this.Ft=n.scopeTo(`${this.constructor.name}-#${this.id}`),this.view=t.create().setLocation(i)}link(t,e,i,n){const r=t.parent,s=null==r?void 0:r.viewModel;if(!(s instanceof If))throw new Error("AUR0815");this.$switch=s,this.linkToSwitch(s)}detaching(t,e,i){return this.deactivate(t,i)}isMatch(t,e){this.Ft.debug("isMatch()");const i=this.value;return Array.isArray(i)?(void 0===this.fi&&(this.fi=this.Di(e,i)),i.includes(t)):i===t}valueChanged(t,e,i){var n;Array.isArray(t)?(null===(n=this.fi)||void 0===n||n.unsubscribe(this),this.fi=this.Di(i,t)):void 0!==this.fi&&this.fi.unsubscribe(this),this.$switch.caseChanged(this,i)}handleCollectionChange(t,e){this.$switch.caseChanged(this,e)}activate(t,e,i){const n=this.view;if(!n.isActive)return n.activate(null!=t?t:n,this.$controller,e,i)}deactivate(t,e){const i=this.view;if(i.isActive)return i.deactivate(null!=t?t:i,this.$controller,e)}dispose(){var t,e;null===(t=this.fi)||void 0===t||t.unsubscribe(this),null===(e=this.view)||void 0===e||e.dispose(),this.view=void 0}linkToSwitch(t){t.cases.push(this)}Di(t,e){const i=this.Ii.getArrayObserver(e);return i.subscribe(this),i}accept(t){var e;return!0===this.$controller.accept(t)||(null===(e=this.view)||void 0===e?void 0:e.accept(t))}};$f.inject=[Dh,Ho,kc,Ze],Zo([ma],$f.prototype,"value",void 0),Zo([ma({set:t=>{switch(t){case"true":return!0;case"false":return!1;default:return!!t}},mode:On.oneTime})],$f.prototype,"fallThrough",void 0),$f=Zo([ql("case")],$f);let Df=class extends $f{linkToSwitch(t){if(void 0!==t.defaultCase)throw new Error("AUR0816");t.defaultCase=this}};Df=Zo([ql("default-case")],Df);let Nf=class{constructor(t,e,i,n){this.f=t,this.l=e,this.p=i,this.id=Pt("au$component"),this.preSettledTask=null,this.postSettledTask=null,this.logger=n.scopeTo("promise.resolve")}link(t,e,i,n){this.view=this.f.create(this.$controller).setLocation(this.l)}attaching(t,e,i){const n=this.view,r=this.$controller;return Bt(n.activate(t,r,i,this.viewScope=Ii.fromParent(r.scope,{})),(()=>this.swap(t,i)))}valueChanged(t,e,i){this.$controller.isActive&&this.swap(null,i)}swap(t,e){var i,n;const r=this.value;if(!(r instanceof Promise))return void this.logger.warn(`The value '${String(r)}' is not a promise. No change will be done.`);const s=this.p.domWriteQueue,o=this.fulfilled,a=this.rejected,l=this.pending,h=this.viewScope;let c;const u={reusable:!1},d=()=>{Ft(c=(this.preSettledTask=s.queueTask((()=>Ft(null==o?void 0:o.deactivate(t,e),null==a?void 0:a.deactivate(t,e),null==l?void 0:l.activate(t,e,h))),u)).result.catch((t=>{if(!(t instanceof ct))throw t})),r.then((i=>{if(this.value!==r)return;const n=()=>{this.postSettlePromise=(this.postSettledTask=s.queueTask((()=>Ft(null==l?void 0:l.deactivate(t,e),null==a?void 0:a.deactivate(t,e),null==o?void 0:o.activate(t,e,h,i))),u)).result};1===this.preSettledTask.status?c.then(n):(this.preSettledTask.cancel(),n())}),(i=>{if(this.value!==r)return;const n=()=>{this.postSettlePromise=(this.postSettledTask=s.queueTask((()=>Ft(null==l?void 0:l.deactivate(t,e),null==o?void 0:o.deactivate(t,e),null==a?void 0:a.activate(t,e,h,i))),u)).result};1===this.preSettledTask.status?c.then(n):(this.preSettledTask.cancel(),n())})))};1===(null===(i=this.postSettledTask)||void 0===i?void 0:i.status)?this.postSettlePromise.then(d):(null===(n=this.postSettledTask)||void 0===n||n.cancel(),d())}detaching(t,e,i){var n,r;return null===(n=this.preSettledTask)||void 0===n||n.cancel(),null===(r=this.postSettledTask)||void 0===r||r.cancel(),this.preSettledTask=this.postSettledTask=null,this.view.deactivate(t,this.$controller,i)}dispose(){var t;null===(t=this.view)||void 0===t||t.dispose(),this.view=void 0}};Zo([ma],Nf.prototype,"value",void 0),Nf=Zo([ql("promise"),Jo(0,Dh),Jo(1,kc),Jo(2,Qa),Jo(3,Ze)],Nf);let jf=class{constructor(t,e){this.factory=t,this.id=Pt("au$component"),this.view=this.factory.create().setLocation(e)}link(t,e,i,n){zf(t).pending=this}activate(t,e,i){const n=this.view;if(!n.isActive)return n.activate(n,this.$controller,e,i)}deactivate(t,e){const i=this.view;if(i.isActive)return i.deactivate(i,this.$controller,e)}detaching(t,e,i){return this.deactivate(t,i)}dispose(){var t;null===(t=this.view)||void 0===t||t.dispose(),this.view=void 0}};Zo([ma({mode:On.toView})],jf.prototype,"value",void 0),jf=Zo([ql("pending"),Jo(0,Dh),Jo(1,kc)],jf);let Bf=class{constructor(t,e){this.factory=t,this.id=Pt("au$component"),this.view=this.factory.create().setLocation(e)}link(t,e,i,n){zf(t).fulfilled=this}activate(t,e,i,n){this.value=n;const r=this.view;if(!r.isActive)return r.activate(r,this.$controller,e,i)}deactivate(t,e){const i=this.view;if(i.isActive)return i.deactivate(i,this.$controller,e)}detaching(t,e,i){return this.deactivate(t,i)}dispose(){var t;null===(t=this.view)||void 0===t||t.dispose(),this.view=void 0}};Zo([ma({mode:On.fromView})],Bf.prototype,"value",void 0),Bf=Zo([ql("then"),Jo(0,Dh),Jo(1,kc)],Bf);let Ff=class{constructor(t,e){this.factory=t,this.id=Pt("au$component"),this.view=this.factory.create().setLocation(e)}link(t,e,i,n){zf(t).rejected=this}activate(t,e,i,n){this.value=n;const r=this.view;if(!r.isActive)return r.activate(r,this.$controller,e,i)}deactivate(t,e){const i=this.view;if(i.isActive)return i.deactivate(i,this.$controller,e)}detaching(t,e,i){return this.deactivate(t,i)}dispose(){var t;null===(t=this.view)||void 0===t||t.dispose(),this.view=void 0}};function zf(t){const e=t.parent,i=null==e?void 0:e.viewModel;if(i instanceof Nf)return i;throw new Error("AUR0813")}Zo([ma({mode:On.fromView})],Ff.prototype,"value",void 0),Ff=Zo([ql("catch"),Jo(0,Dh),Jo(1,kc)],Ff);let Uf=class{"promise.resolve"(t,e,i){return new Da(t,e,"promise","bind")}};Uf=Zo([Fa({pattern:"promise.resolve",symbols:""})],Uf);let Gf=class{then(t,e,i){return new Da(t,e,"then","from-view")}};Gf=Zo([Fa({pattern:"then",symbols:""})],Gf);let Hf=class{catch(t,e,i){return new Da(t,e,"catch","from-view")}};Hf=Zo([Fa({pattern:"catch",symbols:""})],Hf);class Vf{constructor(t,e,i){this.node=t,this.instructions=e,this.Pi=i,this.Oi=void 0}get definition(){return void 0===this.Oi&&(this.Oi=nh.create({name:fh.generateName(),template:this.node,needsCompile:va(this.node),instructions:this.instructions,dependencies:this.Pi})),this.Oi}createView(t){return this.getViewFactory(t).create()}getViewFactory(t){return t.root.get(Vh).getViewFactory(this.definition,t.createChild().register(...this.Pi))}mergeInto(t,e,i){t.appendChild(this.node),e.push(...this.instructions),i.push(...this.Pi)}}function qf(t,e,i,n,r){for(let s=0,o=i.length;s<o;++s){const o=i[s];switch(typeof o){case"string":e.appendChild(t.document.createTextNode(o));break;case"object":o instanceof t.Node?e.appendChild(o):"mergeInto"in o&&o.mergeInto(e,n,r)}}}function Wf(t,e){const i=e.to;return void 0!==i&&"subject"!==i&&"composing"!==i&&(t[i]=e),t}class Yf{constructor(t,e,i,n){this.p=t,this.$i=e,this.Li=i,this.r=n,this.id=Pt("au$component"),this.component=void 0,this.composing=!1,this.view=void 0,this.qi=void 0,this.Mi=e.props.reduce(Wf,{})}attaching(t,e,i){const{component:n,view:r}=this;return void 0===r||this.qi!==n?(this.qi=n,this.composing=!0,this.compose(void 0,n,t,i)):this.compose(r,n,t,i)}detaching(t,e,i){return this.oi(this.view,t,i)}componentChanged(t,e,i){const{$controller:n}=this;if(!n.isActive)return;if(this.qi===t)return;this.qi=t,this.composing=!0,i|=n.flags;const r=Bt(this.oi(this.view,null,i),(()=>this.compose(void 0,t,null,i)));r instanceof Promise&&r.catch((t=>{throw t}))}compose(t,e,i,n){return Bt(void 0===t?Bt(e,(t=>this.Ui(t,n))):t,(t=>this.ni(this.view=t,i,n)))}oi(t,e,i){return null==t?void 0:t.deactivate(null!=e?e:t,this.$controller,i)}ni(t,e,i){const{$controller:n}=this;return Bt(null==t?void 0:t.activate(null!=e?e:t,n,i,n.scope),(()=>{this.composing=!1}))}Ui(t,e){const i=this.Fi(t,e);if(i)return i.setLocation(this.$controller.location),i.lockScope(this.$controller.scope),i}Fi(t,e){if(!t)return;const i=this.Li.controller.container;if("object"==typeof t){if(function(t){return"lockScope"in t}(t))return t;if("createView"in t)return t.createView(i);if("create"in t)return t.create();if("template"in t)return this.r.getViewFactory(nh.getOrCreate(t),i).create()}if(va(t)){const e=i.find(fh,t);if(null==e)throw new Error(`AUR0809:${t}`);t=e.Type}return function(t,e,i,n){if(va(e))return function(t,e,i,n){const r=[],s=[],o=[],a=t.document.createElement(e);let l=!1;return i&&Object.keys(i).forEach((t=>{const e=i[t];Gc(e)?(l=!0,r.push(e)):a.setAttribute(t,e)})),l&&(a.className="au",s.push(r)),n&&qf(t,a,n,s,o),new Vf(a,s,o)}(t,e,i,n);if(fh.isType(e))return function(t,e,i,n){const r=fh.getDefinition(e),s=[],o=[s],a=[],l=[],h=r.bindables,c=t.document.createElement(r.name);return c.className="au",a.includes(e)||a.push(e),s.push(new Kc(r,void 0,l,null,!1,void 0)),i&&Object.keys(i).forEach((t=>{const e=i[t];Gc(e)?l.push(e):void 0===h[t]?l.push(new nu(e,t)):l.push(new Xc(e,t))})),n&&qf(t,c,n,o,a),new Vf(c,o,a)}(t,e,i,n);throw new Error("Invalid Tag or Type.")}(this.p,t,this.Mi,this.$controller.host.childNodes).createView(i)}dispose(){var t;null===(t=this.view)||void 0===t||t.dispose(),this.view=void 0}accept(t){var e;if(!0===(null===(e=this.view)||void 0===e?void 0:e.accept(t)))return!0}}Yf.inject=[Qa,Uc,lc,Vh],Zo([ma],Yf.prototype,"component",void 0),Zo([ma({mode:On.fromView})],Yf.prototype,"composing",void 0),eh({name:"au-render",template:null,containerless:!0,capture:!0})(Yf);class Xf{constructor(t,e,i,n,r,s){this.c=t,this.parent=e,this.host=i,this.p=n,this.scopeBehavior="auto",this.Vi=void 0,this.l=r.containerless?Ac(this.host):void 0,this.r=t.get(Vh),this.$i=r,this._i=s}static get inject(){return[ce,ac,_c,Qa,Uc,ge(Qf)]}get pending(){return this.ji}get composition(){return this.Vi}attaching(t,e,i){return this.ji=Bt(this.queue(new Zf(this.view,this.viewModel,this.model,void 0),t),(t=>{this._i.isCurrent(t)&&(this.ji=void 0)}))}detaching(t){const e=this.Vi,i=this.ji;return this._i.invalidate(),this.Vi=this.ji=void 0,Bt(i,(()=>null==e?void 0:e.deactivate(t)))}propertyChanged(t){"model"!==t||null==this.Vi?this.ji=Bt(this.ji,(()=>Bt(this.queue(new Zf(this.view,this.viewModel,this.model,t),void 0),(t=>{this._i.isCurrent(t)&&(this.ji=void 0)})))):this.Vi.update(this.model)}queue(t,e){const i=this._i,n=this.Vi;return Bt(i.create(t),(t=>i.isCurrent(t)?Bt(this.compose(t),(r=>i.isCurrent(t)?Bt(r.activate(e),(()=>i.isCurrent(t)?(this.Vi=r,Bt(null==n?void 0:n.deactivate(e),(()=>t))):Bt(r.controller.deactivate(r.controller,this.$controller,4),(()=>(r.controller.dispose(),t))))):(r.controller.dispose(),t))):t))}compose(t){let e,i,n;const{view:r,viewModel:s,model:o}=t.change,{c:a,host:l,$controller:h,l:c}=this,u=this.getDef(s),d=a.createChild(),f=null==c?l.parentNode:c.parentNode;if(null!==u){if(u.containerless)throw new Error("AUR0806");null==c?(i=l,n=()=>{}):(i=f.insertBefore(this.p.document.createElement(u.name),c),n=()=>{i.remove()}),e=this.getVm(d,s,i)}else i=null==c?l:c,e=this.getVm(d,s,i);const p=()=>{if(null!==u){const r=Kh.$el(d,e,i,{projections:this.$i.projections},u);return new ep(r,(t=>r.activate(null!=t?t:r,h,2,h.scope.parentScope)),(t=>Bt(r.deactivate(null!=t?t:r,h,4),n)),(t=>{var i;return null===(i=e.activate)||void 0===i?void 0:i.call(e,t)}),t)}{const n=nh.create({name:fh.generateName(),template:r}),s=this.r.getViewFactory(n,d),o=Kh.$view(s,h),a="auto"===this.scopeBehavior?Ii.fromParent(this.parent.scope,e):Ii.create(e);return Tc(i)?o.setLocation(i):o.setHost(i),new ep(o,(t=>o.activate(null!=t?t:o,h,2,a)),(t=>o.deactivate(null!=t?t:o,h,4)),(t=>{var i;return null===(i=e.activate)||void 0===i?void 0:i.call(e,t)}),t)}};return"activate"in e?Bt(e.activate(o),(()=>p())):p()}getVm(t,e,i){if(null==e)return new Kf;if("object"==typeof e)return e;const n=this.p,r=Tc(i);t.registerResolver(n.Element,t.registerResolver(_c,new Ne("ElementResolver",r?null:i))),t.registerResolver(kc,new Ne("IRenderLocation",r?i:null));const s=t.invoke(e);return t.registerResolver(e,new Ne("au-compose.viewModel",s)),s}getDef(t){const e=ga(t)?t:null==t?void 0:t.constructor;return fh.isType(e)?fh.getDefinition(e):null}}Zo([ma],Xf.prototype,"view",void 0),Zo([ma],Xf.prototype,"viewModel",void 0),Zo([ma],Xf.prototype,"model",void 0),Zo([ma({set:t=>{if("scoped"===t||"auto"===t)return t;throw new Error("AUR0805")}})],Xf.prototype,"scopeBehavior",void 0),eh("au-compose")(Xf);class Kf{}class Qf{constructor(){this.id=0}isCurrent(t){return t.id===this.id}create(t){return Bt(t.load(),(t=>new tp(++this.id,t)))}invalidate(){this.id++}}class Zf{constructor(t,e,i,n){this.view=t,this.viewModel=e,this.model=i,this.src=n}load(){return pa(this.view)||pa(this.viewModel)?Promise.all([this.view,this.viewModel]).then((([t,e])=>new Jf(t,e,this.model,this.src))):new Jf(this.view,this.viewModel,this.model,this.src)}}class Jf{constructor(t,e,i,n){this.view=t,this.viewModel=e,this.model=i,this.src=n}}class tp{constructor(t,e){this.id=t,this.change=e}}class ep{constructor(t,e,i,n,r){this.controller=t,this.start=e,this.stop=i,this.update=n,this.context=r,this.state=0}activate(t){if(0!==this.state)throw new Error(`AUR0807:${this.controller.name}`);return this.state=1,this.start(t)}deactivate(t){switch(this.state){case 1:return this.state=-1,this.stop(t);case-1:throw new Error("AUR0808");default:this.state=-1}}}class ip{constructor(t,e,i,n){var r,s;let o;this.Ni=null,this.Wi=null;const a=e.auSlot,l=null===(s=null===(r=i.instruction)||void 0===r?void 0:r.projections)||void 0===s?void 0:s[a.name];null==l?(o=n.getViewFactory(a.fallback,i.controller.container),this.Hi=!1):(o=n.getViewFactory(l,i.parent.controller.container),this.Hi=!0),this.Li=i,this.view=o.create().setLocation(t)}static get inject(){return[kc,Uc,lc,Vh]}binding(t,e,i){var n;let r;this.Ni=this.$controller.scope.parentScope,this.Hi&&(r=this.Li.controller.scope.parentScope,(this.Wi=Ii.fromParent(r,r.bindingContext)).overrideContext.$host=null!==(n=this.expose)&&void 0!==n?n:this.Ni.bindingContext)}attaching(t,e,i){return this.view.activate(t,this.$controller,i,this.Hi?this.Wi:this.Ni)}detaching(t,e,i){return this.view.deactivate(t,this.$controller,i)}exposeChanged(t){this.Hi&&null!=this.Wi&&(this.Wi.overrideContext.$host=t)}dispose(){this.view.dispose(),this.view=void 0}accept(t){var e;if(!0===(null===(e=this.view)||void 0===e?void 0:e.accept(t)))return!0}}Zo([ma],ip.prototype,"expose",void 0),eh({name:"au-slot",template:null,containerless:!0})(ip);const np=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,rp=ae.createInterface("ISanitizer",(t=>t.singleton(class{sanitize(t){return t.replace(np,"")}})));let sp=class{constructor(t){this.zi=t}toView(t){return null==t?null:this.zi.sanitize(t)}};sp=Zo([Jo(0,rp)],sp),qi("sanitize")(sp);let op=class{constructor(t){this.Gi=t}toView(t,e){return this.Gi.getViewComponentForObject(t,e)}};op=Zo([Jo(0,Gh)],op),qi("view")(op);const ap=Ud,lp=jd,hp=Bd,cp=Fd,up=Gd,dp=Hd,fp=zd,pp=[class{constructor(){this.debug=!1,this.resolveResources=!0}static register(t){return De.singleton(hu,this).register(t)}compile(t,e,i){var n,r,s,o;const a=nh.getOrCreate(t);if(null===a.template||void 0===a.template)return a;if(!1===a.needsCompile)return a;null!=i||(i=wd);const l=new md(t,e,i,null,null,void 0),h=va(a.template)||!t.enhance?l.re.createTemplate(a.template):a.template,c="TEMPLATE"===h.nodeName&&null!=h.content,u=c?h.content:h,d=e.get(function(t){function e(t,i,n){ae.inject(e)(t,i,n)}return e.$isResolver=!0,e.resolve=function(e,i){return i.root===i?i.getAll(t,!1):i.has(t,!1)?i.getAll(t,!1).concat(i.root.getAll(t,!1)):i.root.getAll(t,!1)},e}(Rd)),f=d.length;let p=0;if(f>0)for(;f>p;)null===(r=(n=d[p]).compiling)||void 0===r||r.call(n,h),++p;if(h.hasAttribute(Md))throw new Error("AUR0701");return this.oe(u,l),this.le(u,l),nh.create({...t,name:t.name||Dd(),dependencies:(null!==(s=t.dependencies)&&void 0!==s?s:ze).concat(null!==(o=l.deps)&&void 0!==o?o:ze),instructions:l.rows,surrogates:c?this.he(h,l):ze,template:h,hasSlots:l.hasSlot,needsCompile:!1})}compileSpread(t,e,i,n){var r;const s=new md(t,i,wd,null,null,void 0),o=[],a=s.ae(n.nodeName.toLowerCase()),l=s.ep,h=e.length;let c,u,d,f,p,g,v,m,y,b,w=0,_=null,x=null;for(;h>w;++w)if(c=e[w],y=c.target,b=c.rawValue,x=s.ce(c),null!==x&&(1&x.type)>0)xd.node=n,xd.attr=c,xd.bindable=null,xd.def=null,o.push(x.build(xd));else if(_=s.ue(y),null===_)if(null===x){if(v=l.parse(b,1),null!==a&&(f=Ed.from(a,!1),p=f.attrs[y],void 0!==p)){v=l.parse(b,1),o.push(new lu(null==v?new Xc(b,p.property):new Hc(v,p.property)));continue}if(null!=v)o.push(new Hc(v,null!==(r=s.m.map(n,y))&&void 0!==r?r:Et(y)));else switch(y){case"class":o.push(new ru(b));break;case"style":o.push(new su(b));break;default:o.push(new nu(b,y))}}else{if(null!==a&&(f=Ed.from(a,!1),p=f.attrs[y],void 0!==p)){xd.node=n,xd.attr=c,xd.bindable=p,xd.def=a,o.push(new lu(x.build(xd)));continue}xd.node=n,xd.attr=c,xd.bindable=null,xd.def=null,o.push(x.build(xd))}else{if(_.isTemplateController)throw new Error(`AUR0703:${y}`);f=Ed.from(_,!0),m=!1===_.noMultiBindings&&null===x&&yd(b),m?d=this.fe(n,b,_,s):(g=f.primary,null===x?(v=l.parse(b,1),d=[null===v?new Xc(b,g.property):new Hc(v,g.property)]):(xd.node=n,xd.attr=c,xd.bindable=g,xd.def=_,d=[x.build(xd)])),(null!=u?u:u=[]).push(new Qc(this.resolveResources?_:_.name,null!=_.aliases&&_.aliases.includes(y)?y:void 0,d))}return bd(),null!=u?u.concat(o):o}he(t,e){var i;const n=[],r=t.attributes,s=e.ep;let o,a,l,h,c,u,d,f,p,g,v,m,y=r.length,b=0,w=null,_=null;for(;y>b;++b){if(o=r[b],a=o.name,l=o.value,h=e.de.parse(a,l),v=h.target,m=h.rawValue,kd[v])throw new Error(`AUR0702:${a}`);if(_=e.ce(h),null!==_&&(1&_.type)>0)xd.node=t,xd.attr=h,xd.bindable=null,xd.def=null,n.push(_.build(xd));else if(w=e.ue(v),null===w)if(null===_)if(p=s.parse(m,1),null!=p)t.removeAttribute(a),--b,--y,n.push(new Hc(p,null!==(i=e.m.map(t,v))&&void 0!==i?i:Et(v)));else switch(a){case"class":n.push(new ru(m));break;case"style":n.push(new su(m));break;default:n.push(new nu(m,a))}else xd.node=t,xd.attr=h,xd.bindable=null,xd.def=null,n.push(_.build(xd));else{if(w.isTemplateController)throw new Error(`AUR0703:${v}`);d=Ed.from(w,!0),g=!1===w.noMultiBindings&&null===_&&yd(m),g?u=this.fe(t,m,w,e):(f=d.primary,null===_?(p=s.parse(m,1),u=[null===p?new Xc(m,f.property):new Hc(p,f.property)]):(xd.node=t,xd.attr=h,xd.bindable=f,xd.def=w,u=[_.build(xd)])),t.removeAttribute(a),--b,--y,(null!=c?c:c=[]).push(new Qc(this.resolveResources?w:w.name,null!=w.aliases&&w.aliases.includes(v)?v:void 0,u))}}return bd(),null!=c?c.concat(n):n}le(t,e){switch(t.nodeType){case 1:return"LET"===t.nodeName?this.me(t,e):this.ve(t,e);case 3:return this.pe(t,e);case 11:{let i=t.firstChild;for(;null!==i;)i=this.le(i,e);break}}return t.nextSibling}me(t,e){const i=t.attributes,n=i.length,r=[],s=e.ep;let o,a,l,h,c,u,d,f,p=!1,g=0;for(;n>g;++g)if(o=i[g],l=o.name,h=o.value,"to-binding-context"!==l){if(a=e.de.parse(l,h),u=a.target,d=a.rawValue,c=e.ce(a),null!==c)switch(c.name){case"to-view":case"bind":r.push(new tu(s.parse(d,8),Et(u)));continue;default:throw new Error(`AUR0704:${a.command}`)}f=s.parse(d,1),r.push(new tu(null===f?new pn(d):f,Et(u)))}else p=!0;return e.rows.push([new Jc(r,p)]),this.ge(t).nextSibling}ve(t,e){var i,n,r,s,o,a,l,h;const c=t.nextSibling,u=(null!==(i=t.getAttribute("as-element"))&&void 0!==i?i:t.nodeName).toLowerCase(),d=e.ae(u),f=!!(null==d?void 0:d.capture),p=f?[]:ze,g=e.ep,v=this.debug?Ge:()=>{t.removeAttribute(b),--j,--N};let m,y,b,w,_,x,k,C,S,E,A,T,M,O,P,R,L,I,$,D=t.attributes,N=D.length,j=0,B=null,F=!1,z=null,U=!0,G=!1;if("slot"===u&&(e.root.hasSlot=!0),null!==d&&(U=null===(n=d.processContent)||void 0===n?void 0:n.call(d.Type,t,e.p),D=t.attributes,N=D.length),e.root.def.enhance&&t.classList.contains("au"))throw new Error("AUR0705");for(;N>j;++j){switch(y=D[j],b=y.name,w=y.value,b){case"as-element":case"containerless":v(),G||(G="containerless"===b);continue}if(_=e.de.parse(b,w),z=e.ce(_),L=_.target,I=_.rawValue,f){if(null!=z&&1&z.type){v(),p.push(_);continue}if("au-slot"!==L&&(P=Ed.from(d,!1),null==P.attrs[L]&&!(null===(r=e.ue(L))||void 0===r?void 0:r.isTemplateController))){v(),p.push(_);continue}}if(null!==z&&1&z.type)xd.node=t,xd.attr=_,xd.bindable=null,xd.def=null,(null!=x?x:x=[]).push(z.build(xd)),v();else if(B=e.ue(L),null===B)if(null!==z)v(),null===d||(P=Ed.from(d,!1),C=P.attrs[L],void 0===C)?(xd.node=t,xd.attr=_,xd.bindable=null,xd.def=null,(null!=x?x:x=[]).push(z.build(xd))):(xd.node=t,xd.attr=_,xd.bindable=C,xd.def=d,(null!=k?k:k=[]).push(z.build(xd)));else{if(null!==d&&(P=Ed.from(d,!1),C=P.attrs[L],void 0!==C)){M=g.parse(I,1),(null!=k?k:k=[]).push(null==M?new Xc(I,C.property):new Hc(M,C.property)),v();continue}M=g.parse(I,1),null!=M&&(v(),(null!=x?x:x=[]).push(new Hc(M,null!==(s=e.m.map(t,L))&&void 0!==s?s:Et(L))))}else P=Ed.from(B,!0),F=!1===B.noMultiBindings&&null===z&&yd(I),F?E=this.fe(t,I,B,e):(R=P.primary,null===z?(M=g.parse(I,1),E=[null===M?new Xc(I,R.property):new Hc(M,R.property)]):(xd.node=t,xd.attr=_,xd.bindable=R,xd.def=B,E=[z.build(xd)])),v(),B.isTemplateController?(null!=A?A:A=[]).push(new Zc(_d,this.resolveResources?B:B.name,void 0,E)):(null!=S?S:S=[]).push(new Qc(this.resolveResources?B:B.name,null!=B.aliases&&B.aliases.includes(L)?L:void 0,E))}if(bd(),this.we(t)&&null!=x&&x.length>1&&this.be(t,x),null!==d&&(O=new Kc(this.resolveResources?d:d.name,void 0,null!=k?k:ze,null,G,p),"au-slot"===u)){const i=t.getAttribute("name")||"default",n=e.h("template"),r=e.xe();let s=t.firstChild;for(;null!==s;)1===s.nodeType&&s.hasAttribute("au-slot")?t.removeChild(s):n.content.appendChild(s),s=t.firstChild;this.le(n.content,r),O.auSlot={name:i,fallback:nh.create({name:Dd(),template:n,instructions:r.rows,needsCompile:!1})},t=this.ye(t,e)}if(null==x&&null==O&&null==S||(m=ze.concat(null!=O?O:ze,null!=S?S:ze,null!=x?x:ze),this.ge(t)),null!=A){let i;N=A.length-1,j=N,T=A[j],this.ye(t,e),"TEMPLATE"===t.nodeName?i=t:(i=e.h("template"),i.content.appendChild(t));const n=i,r=e.xe(null==m?[]:[m]);let s,a,h,c,f,p,g,v,y=0,b=0,w=t.firstChild;if(!1!==U)for(;null!==w;)if(1===w.nodeType){if(s=w,w=w.nextSibling,a=s.getAttribute("au-slot"),null!==a){if(null===d)throw new Error(`AUR0706:${u}[${a}]`);""===a&&(a="default"),s.removeAttribute("au-slot"),t.removeChild(s),(null!==(o=(l=null!=c?c:c={})[a])&&void 0!==o?o:l[a]=[]).push(s)}}else w=w.nextSibling;if(null!=c){for(a in h={},c){for(i=e.h("template"),f=c[a],y=0,b=f.length;b>y;++y)p=f[y],"TEMPLATE"===p.nodeName?p.attributes.length>0?i.content.appendChild(p):i.content.appendChild(p.content):i.content.appendChild(p);v=e.xe(),this.le(i.content,v),h[a]=nh.create({name:Dd(),template:i,instructions:v.rows,needsCompile:!1,isStrictBinding:e.root.def.isStrictBinding})}O.projections=h}if(null!==d&&d.containerless&&this.ye(t,e),$=null===d||!d.containerless&&!G&&!1!==U,$)if("TEMPLATE"===t.nodeName)this.le(t.content,r);else for(w=t.firstChild;null!==w;)w=this.le(w,r);for(T.def=nh.create({name:Dd(),template:n,instructions:r.rows,needsCompile:!1,isStrictBinding:e.root.def.isStrictBinding});j-- >0;)T=A[j],i=e.h("template"),g=e.h("au-m"),g.classList.add("au"),i.content.appendChild(g),T.def=nh.create({name:Dd(),template:i,needsCompile:!1,instructions:[[A[j+1]]],isStrictBinding:e.root.def.isStrictBinding});e.rows.push([T])}else{null!=m&&e.rows.push(m);let i,n,r,s,o,l,c,u=t.firstChild,f=null,p=0,g=0;if(!1!==U)for(;null!==u;)if(1===u.nodeType){if(i=u,u=u.nextSibling,n=i.getAttribute("au-slot"),null!==n){if(null===d)throw new Error(`AUR0706:${t.nodeName}[${n}]`);""===n&&(n="default"),t.removeChild(i),i.removeAttribute("au-slot"),(null!==(a=(h=null!=r?r:r={})[n])&&void 0!==a?a:h[n]=[]).push(i)}}else u=u.nextSibling;if(null!=r){for(n in f={},r){for(l=e.h("template"),s=r[n],p=0,g=s.length;g>p;++p)o=s[p],"TEMPLATE"===o.nodeName?o.attributes.length>0?l.content.appendChild(o):l.content.appendChild(o.content):l.content.appendChild(o);c=e.xe(),this.le(l.content,c),f[n]=nh.create({name:Dd(),template:l,instructions:c.rows,needsCompile:!1,isStrictBinding:e.root.def.isStrictBinding})}O.projections=f}if(null!==d&&d.containerless&&this.ye(t,e),$=null===d||!d.containerless&&!G&&!1!==U,$&&t.childNodes.length>0)for(u=t.firstChild;null!==u;)u=this.le(u,e)}return c}pe(t,e){let i="",n=t;for(;null!==n&&3===n.nodeType;)i+=n.textContent,n=n.nextSibling;const r=e.ep.parse(i,1);if(null===r)return n;const s=t.parentNode;for(s.insertBefore(this.ge(e.h("au-m")),t),e.rows.push([new eu(r,!!e.def.isStrictBinding)]),t.textContent="",n=t.nextSibling;null!==n&&3===n.nodeType;)s.removeChild(n),n=t.nextSibling;return t.nextSibling}fe(t,e,i,n){const r=Ed.from(i,!0),s=e.length,o=[];let a,l,h,c,u,d,f=0,p=0;for(let g=0;g<s;++g)if(p=e.charCodeAt(g),92===p)++g;else if(58===p){for(a=e.slice(f,g);e.charCodeAt(++g)<=32;);for(f=g;g<s;++g)if(p=e.charCodeAt(g),92===p)++g;else if(59===p){l=e.slice(f,g);break}if(void 0===l&&(l=e.slice(f)),c=n.de.parse(a,l),u=n.ce(c),d=r.attrs[c.target],null==d)throw new Error(`AUR0707:${i.name}.${c.target}`);for(null===u?(h=n.ep.parse(l,1),o.push(null===h?new Xc(l,d.property):new Hc(h,d.property))):(xd.node=t,xd.attr=c,xd.bindable=d,xd.def=i,o.push(u.build(xd)));g<s&&e.charCodeAt(++g)<=32;);f=g,a=void 0,l=void 0}return bd(),o}oe(t,e){const i=t,n=Mt(i.querySelectorAll("template[as-custom-element]")),r=n.length;if(0===r)return;if(r===i.childElementCount)throw new Error("AUR0708");const s=new Set;for(const t of n){if(t.parentNode!==i)throw new Error("AUR0709");const n=Od(t,s),r=class{},o=t.content,a=Mt(o.querySelectorAll("bindable")),l=wa.for(r),h=new Set,c=new Set;for(const t of a){if(t.parentNode!==o)throw new Error("AUR0710");const e=t.getAttribute("property");if(null===e)throw new Error("AUR0711");const i=t.getAttribute("attribute");if(null!==i&&c.has(i)||h.has(e))throw new Error(`AUR0712:${e}+${i}`);null!==i&&c.add(i),h.add(e),l.add({property:e,attribute:null!=i?i:void 0,mode:Pd(t)}),t.getAttributeNames().filter((t=>!Td.includes(t))).length,o.removeChild(t)}e.ke(fh.define({name:n,template:t},r)),i.removeChild(t)}}we(t){return"INPUT"===t.nodeName&&1===Cd[t.type]}be(t,e){if("INPUT"===t.nodeName){const t=e;let i,n,r,s=0;for(let e=0;e<t.length&&s<3;e++)switch(r=t[e],r.to){case"model":case"value":case"matcher":i=e,s++;break;case"checked":n=e,s++}void 0!==n&&void 0!==i&&n<i&&([t[i],t[n]]=[t[n],t[i]])}}ge(t){return t.classList.add("au"),t}ye(t,e){const i=t.parentNode,n=e.h("au-m");return this.ge(i.insertBefore(n,t)),i.removeChild(t),n}},gf],gp=[Wa,qa,Ka],vp=[nd,Ju,ed,td,id,rd,sd,dd,od,ad,ld,ud,cd,hd,fd],mp=[ap,lp,hp,cp,up,dp,fp,sp,op,xf,kf,Cf,Sf,Tf,Lf,If,$f,Df,Nf,jf,Bf,Ff,Uf,Gf,Hf,qd,Yd,mf,Yf,Xf,wf,yf,bf,ip],yp=[xu,ku,bu,wu,_u,pu,gu,vu,mu,yu,Tu,Lu,Mu,Ou,Pu,Ru,Au,Iu],bp=function t(e){return{optionsProvider:e,register(t){const i={coercingOptions:{enableCoercion:!1,coerceNullish:!1}};return e(i),t.register(De.instance(Mn,i.coercingOptions),...pp,...mp,...gp,...vp,...yp)},customize:i=>t(null!=i?i:e)}}(Ge),wp=ae.createInterface("IAurelia");var _p;!function(t){t[t.Element=1]="Element",t[t.Attribute=2]="Attribute"}(_p||(_p={}));const xp=ae.createInterface("IDialogService"),kp=ae.createInterface("IDialogController"),Cp=ae.createInterface("IDialogDomRenderer"),Sp=ae.createInterface("IDialogDom"),Ep=ae.createInterface("IDialogGlobalSettings");class Ap{constructor(t,e){this.wasCancelled=t,this.dialog=e}static create(t,e){return new Ap(t,e)}}class Tp{constructor(t,e){this.status=t,this.value=e}static create(t,e){return new Tp(t,e)}}var Mp;!function(t){t.Ok="ok",t.Error="error",t.Cancel="cancel",t.Abort="abort"}(Mp||(Mp={}));class Op{constructor(t,e){this.p=t,this.ctn=e,this.closed=new Promise(((t,e)=>{this.$t=t,this.Bt=e}))}static get inject(){return[Qa,ce]}activate(t){var e;const i=this.ctn.createChild(),{model:n,template:r,rejectOnCancel:s}=t,o=i.get(Cp),a=null!==(e=t.host)&&void 0!==e?e:this.p.document.body,l=this.dom=o.render(a,t),h=i.has(xc,!0)?i.get(xc):null,c=l.contentHost;return this.settings=t,null!=h&&h.contains(a)||i.register(De.instance(xc,a)),i.register(De.instance(_c,c),De.instance(Sp,l)),new Promise((e=>{var r,s;const o=Object.assign(this.cmp=this.getOrCreateVm(i,t,c),{$dialog:this});e(null===(s=null===(r=o.canActivate)||void 0===r?void 0:r.call(o,n))||void 0===s||s)})).then((e=>{var o;if(!0!==e){if(l.dispose(),s)throw Rp(null,"Dialog activation rejected");return Ap.create(!0,this)}const a=this.cmp;return Bt(null===(o=a.activate)||void 0===o?void 0:o.call(a,n),(()=>{var e;const n=this.controller=Kh.$el(i,a,c,null,nh.create(null!==(e=this.getDefinition(a))&&void 0!==e?e:{name:fh.generateName(),template:r}));return Bt(n.activate(n,null,2),(()=>{var e;return l.overlay.addEventListener(null!==(e=t.mouseEvent)&&void 0!==e?e:"click",this),Ap.create(!1,this)}))}))}),(t=>{throw l.dispose(),t}))}deactivate(t,e){if(this.ss)return this.ss;let i=!0;const{controller:n,dom:r,cmp:s,settings:{mouseEvent:o,rejectOnCancel:a}}=this,l=Tp.create(t,e),h=new Promise((h=>{var c,u;h(Bt(null===(u=null===(c=s.canDeactivate)||void 0===c?void 0:c.call(s,l))||void 0===u||u,(h=>{var c;if(!0!==h){if(i=!1,this.ss=void 0,a)throw Rp(null,"Dialog cancellation rejected");return Tp.create("abort")}return Bt(null===(c=s.deactivate)||void 0===c?void 0:c.call(s,l),(()=>Bt(n.deactivate(n,null,4),(()=>(r.dispose(),r.overlay.removeEventListener(null!=o?o:"click",this),a||"error"===t?this.Bt(Rp(e,"Dialog cancelled with a rejection on cancel")):this.$t(l),l)))))})))})).catch((t=>{throw this.ss=void 0,t}));return this.ss=i?h:void 0,h}ok(t){return this.deactivate("ok",t)}cancel(t){return this.deactivate("cancel",t)}error(t){const e=function(t){const e=new Error;return e.wasCancelled=!1,e.value=t,e}(t);return new Promise((t=>{var i,n;return t(Bt(null===(n=(i=this.cmp).deactivate)||void 0===n?void 0:n.call(i,Tp.create("error",e)),(()=>Bt(this.controller.deactivate(this.controller,null,4),(()=>{this.dom.dispose(),this.Bt(e)})))))}))}handleEvent(t){this.settings.overlayDismiss&&!this.dom.contentHost.contains(t.target)&&this.cancel()}getOrCreateVm(t,e,i){const n=e.component;if(null==n)return new Pp;if("object"==typeof n)return n;const r=this.p;return t.registerResolver(r.HTMLElement,t.registerResolver(r.Element,t.registerResolver(_c,new Ne("ElementResolver",i)))),t.invoke(n)}getDefinition(t){const e=ga(t)?t:null==t?void 0:t.constructor;return fh.isType(e)?fh.getDefinition(e):null}}class Pp{}function Rp(t,e){const i=new Error(e);return i.wasCancelled=!0,i.value=t,i}class Lp{static from(...t){return Object.assign(new Lp,...t).cs().ls()}load(){const t=this,e=this.component,i=this.template,n=Ft(null==e?void 0:Bt(e(),(e=>{t.component=e})),ga(i)?Bt(i(),(e=>{t.template=e})):void 0);return n instanceof Promise?n.then((()=>t)):t}cs(){if(null==this.component&&null==this.template)throw new Error("AUR0903");return this}ls(){return null==this.keyboard&&(this.keyboard=this.lock?[]:["Enter","Escape"]),"boolean"!=typeof this.overlayDismiss&&(this.overlayDismiss=!this.lock),this}}function Ip(t,e){return this.then((i=>i.dialog.closed.then(t,e)),e)}const $p="position:absolute;width:100%;height:100%;top:0;left:0;";class Dp{constructor(t){this.p=t,this.wrapperCss=`${$p} display:flex;`,this.overlayCss=$p,this.hostCss="position:relative;margin:auto;"}static register(t){De.singleton(Cp,this).register(t)}render(t){const e=this.p.document,i=(t,i)=>{const n=e.createElement(t);return n.style.cssText=i,n},n=t.appendChild(i("au-dialog-container",this.wrapperCss)),r=n.appendChild(i("au-dialog-overlay",this.overlayCss)),s=n.appendChild(i("div",this.hostCss));return new Np(n,r,s)}}Dp.inject=[Qa];class Np{constructor(t,e,i){this.wrapper=t,this.overlay=e,this.contentHost=i}dispose(){this.wrapper.remove()}}function jp(t,e){return{settingsProvider:t,register:i=>i.register(...e,Ll.beforeCreate((()=>t(i.get(Ep))))),customize:(t,i)=>jp(t,null!=i?i:e)}}jp((()=>{throw new Error("AUR0904")}),[class{static register(t){t.register(De.singleton(Ep,this))}}]);const Bp=jp(Ge,[class{constructor(t,e,i){this.ut=t,this.p=e,this.os=i,this.dlgs=[]}get controllers(){return this.dlgs.slice(0)}get top(){const t=this.dlgs;return t.length>0?t[t.length-1]:null}static get inject(){return[ce,Qa,Ep]}static register(t){t.register(De.singleton(xp,this),Ll.beforeDeactivate(xp,(t=>Bt(t.closeAll(),(t=>{if(t.length>0)throw new Error(`AUR0901:${t.length}`)})))))}open(t){return function(t){return t.whenClosed=Ip,t}(new Promise((e=>{var i;const n=Lp.from(this.os,t),r=null!==(i=n.container)&&void 0!==i?i:this.ut.createChild();e(Bt(n.load(),(t=>{const e=r.invoke(Op);return r.register(De.instance(kp,e)),r.register(De.callback(Op,(()=>{throw new Error("AUR0902")}))),Bt(e.activate(t),(t=>{if(!t.wasCancelled){1===this.dlgs.push(e)&&this.p.window.addEventListener("keydown",this);const t=()=>this.remove(e);e.closed.then(t,t)}return t}))})))})))}closeAll(){return Promise.all(Array.from(this.dlgs).map((t=>t.settings.rejectOnCancel?t.cancel().then((()=>null)):t.cancel().then((e=>"cancel"===e.status?null:t))))).then((t=>t.filter((t=>!!t))))}remove(t){const e=this.dlgs,i=e.indexOf(t);i>-1&&this.dlgs.splice(i,1),0===e.length&&this.p.window.removeEventListener("keydown",this)}handleEvent(t){const e=function(t){return"Escape"===(t.code||t.key)||27===t.keyCode?"Escape":"Enter"===(t.code||t.key)||13===t.keyCode?"Enter":void 0}(t);if(null==e)return;const i=this.top;if(null===i||0===i.settings.keyboard.length)return;const n=i.settings.keyboard;"Escape"===e&&n.includes(e)?i.cancel():"Enter"===e&&n.includes(e)&&i.ok()}},class{constructor(){this.lock=!0,this.startingZIndex=1e3,this.rejectOnCancel=!1}static register(t){De.singleton(Ep,this).register(t)}},Dp]),Fp=ae.createInterface((t=>t.singleton(zp)));class zp{constructor(t,e,i){this.ctn=t,this.p=e,this.r=i}define(t,e,i){if(!t.includes("-"))throw new Error('Invalid web-components custom element name. It must include a "-"');let n;if(null==e)throw new Error("Invalid custom element definition");if(n="function"==typeof e?fh.isType(e)?fh.getDefinition(e):nh.create(fh.generateName(),e):nh.getOrCreate(e),n.containerless)throw new Error("Containerless custom element is not supported. Consider using buitl-in extends instead");const r=(null==i?void 0:i.extends)?this.p.document.createElement(i.extends).constructor:HTMLElement,s=this.ctn,o=this.r,a=n.bindables,l=this.p;class h extends r{auInit(){if(this.auInited)return;this.auInited=!0;const t=s.createChild();t.registerResolver(l.HTMLElement,t.registerResolver(l.Element,t.registerResolver(_c,new Ne("ElementProvider",this))));const e=o.compile(n,t,{projections:null}),i=t.invoke(e.Type),r=this.auCtrl=Kh.$el(t,i,this,null,e);wc(this,e.key,r)}connectedCallback(){this.auInit(),this.auCtrl.activate(this.auCtrl,null,0)}disconnectedCallback(){this.auCtrl.deactivate(this.auCtrl,null,0)}adoptedCallback(){this.auInit()}attributeChangedCallback(t,e,i){this.auInit(),this.auCtrl.viewModel[t]=i}}h.observedAttributes=Object.keys(a);for(const t in a)Object.defineProperty(h.prototype,t,{configurable:!0,enumerable:!1,get(){return this.auCtrl.viewModel[t]},set(e){this.auInited||this.auInit(),this.auCtrl.viewModel[t]=e}});return this.p.customElements.define(t,h,i),h}}zp.inject=[ce,Qa,Vh];const Up=mi.getOrCreate(globalThis);class Gp extends class{constructor(t=ae.createContainer()){if(this.container=t,this.ir=!1,this.Xi=!1,this.Ki=!1,this.Yi=void 0,this.next=void 0,this.Qi=void 0,this.Zi=void 0,t.has(wp,!0))throw new Error("AUR0768");t.registerResolver(wp,new Ne("IAurelia",this)),t.registerResolver(pc,this.Ji=new Ne("IAppRoot"))}get isRunning(){return this.ir}get isStarting(){return this.Xi}get isStopping(){return this.Ki}get root(){if(null==this.Yi){if(null==this.next)throw new Error("AUR0767");return this.next}return this.Yi}register(...t){return this.container.register(...t),this}app(t){return this.next=new mc(t,this.ts(t.host),this.container,this.Ji),this}enhance(t,e){var i;const n=null!==(i=t.container)&&void 0!==i?i:this.container.createChild(),r=t.host,s=this.ts(r),o=t.component;let a;ga(o)?(n.registerResolver(s.HTMLElement,n.registerResolver(s.Element,n.registerResolver(_c,new Ne("ElementResolver",r)))),a=n.invoke(o)):a=o,n.registerResolver(xc,new Ne("IEventTarget",r)),e=null!=e?e:null;const l=Kh.$el(n,a,r,null,nh.create({name:fh.generateName(),template:r,enhance:!0}));return Bt(l.activate(l,e,2),(()=>l))}async waitForIdle(){const t=this.root.platform;await t.domWriteQueue.yield(),await t.domReadQueue.yield(),await t.taskQueue.yield()}ts(t){let e;if(this.container.has(Qa,!1))e=this.container.get(Qa);else{if(null===t.ownerDocument.defaultView)throw new Error("AUR0769");e=new mi(t.ownerDocument.defaultView),this.container.register(De.instance(Qa,e))}return e}start(t=this.next){if(null==t)throw new Error("AUR0770");return this.Qi instanceof Promise?this.Qi:this.Qi=Bt(this.stop(),(()=>(Reflect.set(t.host,"$aurelia",this),this.Ji.prepare(this.Yi=t),this.Xi=!0,Bt(t.activate(),(()=>{this.ir=!0,this.Xi=!1,this.Qi=void 0,this.es(t,"au-started",t.host)})))))}stop(t=!1){if(this.Zi instanceof Promise)return this.Zi;if(!0===this.ir){const e=this.Yi;return this.ir=!1,this.Ki=!0,this.Zi=Bt(e.deactivate(),(()=>{Reflect.deleteProperty(e.host,"$aurelia"),t&&e.dispose(),this.Yi=void 0,this.Ji.dispose(),this.Ki=!1,this.es(e,"au-stopped",e.host)}))}}dispose(){if(this.ir||this.Ki)throw new Error("AUR0771");this.container.dispose()}es(t,e,i){const n=new t.platform.window.CustomEvent(e,{detail:this,bubbles:!0,cancelable:!0});i.dispatchEvent(n)}}{constructor(t=function(){return ae.createContainer().register(De.instance(Qa,Up),bp)}()){super(t)}static start(t){return(new Gp).start(t)}static app(t){return(new Gp).app(t)}static enhance(t,e){return(new Gp).enhance(t,e)}static register(...t){return(new Gp).register(...t)}app(t){if(fh.isType(t)){const e=fh.getDefinition(t);let i=document.querySelector(e.name);return null===i&&(i=document.body),super.app({host:i,component:t})}return super.app(t)}}var Hp=n(379),Vp=n.n(Hp),qp=n(795),Wp=n.n(qp),Yp=n(569),Xp=n.n(Yp),Kp=n(565),Qp=n.n(Kp),Zp=n(216),Jp=n.n(Zp),tg=n(589),eg=n.n(tg),ig=n(267),ng={};ng.styleTagTransform=eg(),ng.setAttributes=Qp(),ng.insert=Xp().bind(null,"head"),ng.domAPI=Wp(),ng.insertStyleElement=Jp(),Vp()(ig.Z,ng),ig.Z&&ig.Z.locals&&ig.Z.locals;const rg="my-app",sg="",og=sg,ag=[];let lg;function hg(t){lg||(lg=fh.define({name:rg,template:sg,dependencies:ag})),t.register(lg)}class cg{constructor(){this.data1=null,this.data2=null,this.hasInitalised=!1}async getData(){if(!this.hasInitalised){let t=await this.getData1().then((t=>this.data1=t)),e=await this.getData2().then((t=>this.data2=t));await Promise.all([t,e]),this.hasInitalised=!0}return{subgraphs:this.data1,counts:{men:this.data2.filter((t=>"M"===t.gender)).length,women:this.data2.filter((t=>"F"===t.gender)).length},elementsM:this.data2.filter((t=>"M"===t.gender)),elementsF:this.data2.filter((t=>"F"===t.gender)),elementsT:this.data2}}async getData1(){return await fetch("https://b2022-kg-story.ivanbacher.me/data/data-1.json").then((t=>t.json()))}async getData2(){return await fetch("https://b2022-kg-story.ivanbacher.me/data/data-2.json").then((t=>t.json()))}}class ug{constructor(){this.colors={BlueMuted:"#EFF3F4",BlueFull:"#0716D5",YellowFull:"#FFBF27",YellowMuted:"#F9F5F0",GreenMuted:"#E8F6F5",GreenFull:"#68D0C8",PinkMuted:"#FBECF9",PinkFull:"#C963BC",PurpleMuted:"#EEEFFE",PurpleFull:"#666DD9",FontDark:"#343c3c"}}getColors(){return this.colors}}var dg,fg=n(933),pg=n.n(fg);let gg=eh(t)(dg=fe(Element,gi,cg,ug)(dg=class{constructor(t,e,i,n){this.element=t,this.eventAggregator=e,this.dataService=i,this.colorService=n}async binding(){let t=new Promise((t=>{pg().load({google:{families:["Inter"]},fontloading:(e,i)=>{t()}})})),e=await this.dataService.getData().then((t=>this.data=t));await Promise.all([t,e]),this.colors=this.colorService.getColors()}})||dg)||dg;const vg="vis-01",mg='<div class="scrolly-vis">\n  <div class="scrollama-container">\n    <div class="sticky-container">\n      <div class="konva-container"></div>\n    </div>\n\n    <div class="steps-container">\n    \n      <div class="step" data-step="1">\n        <p class="my-0">\n          The largest circle represents our\n          <span class="pointer my-badge my-badge-light" mouseover.delegate="stepMouseover($event, 1)" mouseout.delegate="stepMouseout()">Modern Places</span>\n           subgraph. You can also see the\n          <span class="pointer my-badge my-badge-light" mouseover.delegate="stepMouseover($event, 2)" mouseout.delegate="stepMouseout()">Early Modern Places</span>\n           subgraph, the\n          <span class="pointer my-badge my-badge-light" mouseover.delegate="stepMouseover($event, 3)" mouseout.delegate="stepMouseout()">Medieval People</span>\n           subgraph and the\n          <span class="pointer my-badge my-badge-light" mouseover.delegate="stepMouseover($event, 4)" mouseout.delegate="stepMouseout()">Dictionary of Irish Biography (DIB)</span>\n           subgraph. As new data is added to the graph, it will continue to grow.\n        </p>\n      </div>\n    \n      <div class="step" data-step="2">\n        <p class="my-0">\n          Our case study explores data contained in the DIB subgraph. The DIB is one of the richest datasets within the\n          knowledge graph, containing information about nearly 11,000 individual people.\n        </p>\n      </div>\n    \n      <div class="step" data-step="3">\n        <p class="mt-0">\n          Each person in the DIB subgraph has information associated with them: names, locations, dates of birth or death,\n          religion, and so on. We can use this information to help us explore the overall dataset.\n        </p>\n        <p class="mb-0">\n          Here, we split the subgraph by gender. Now we can see that it contains\n          <span class="my-badge bg-purple-muted border-purple-full text-dark">\n            ${data.counts.men} men\n          </span>\n          and\n          <span class="my-badge bg-yellow-muted border-yellow-full text-dark">\n            ${data.counts.women} women\n          </span>.\n        </p>\n      </div>\n    </div>\n\n    <div style="height: 1px; width: 100%;"></div>\n  </div>\n</div>',yg=mg,bg=[];let wg;function _g(t){wg||(wg=fh.define({name:vg,template:mg,dependencies:bg})),t.register(wg)}var xg=Math.PI/180;const kg=void 0!==i.g?i.g:"undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope?self:{},Cg={_global:kg,version:"8.3.8",isBrowser:"undefined"!=typeof window&&("[object Window]"==={}.toString.call(window)||"[object global]"==={}.toString.call(window)),isUnminified:/param/.test(function(t){}.toString()),dblClickWindow:400,getAngle:t=>Cg.angleDeg?t*xg:t,enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,pixelRatio:"undefined"!=typeof window&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging:()=>Cg.DD.isDragging,isDragReady:()=>!!Cg.DD.node,document:kg.document,_injectGlobal(t){kg.Konva=t}},Sg=t=>{Cg[t.prototype.getClassName()]=t};Cg._injectGlobal(Cg);class Eg{constructor(t=[1,0,0,1,0,0]){this.dirty=!1,this.m=t&&t.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new Eg(this.m)}copyInto(t){t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5]}point(t){var e=this.m;return{x:e[0]*t.x+e[2]*t.y+e[4],y:e[1]*t.x+e[3]*t.y+e[5]}}translate(t,e){return this.m[4]+=this.m[0]*t+this.m[2]*e,this.m[5]+=this.m[1]*t+this.m[3]*e,this}scale(t,e){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=e,this.m[3]*=e,this}rotate(t){var e=Math.cos(t),i=Math.sin(t),n=this.m[0]*e+this.m[2]*i,r=this.m[1]*e+this.m[3]*i,s=this.m[0]*-i+this.m[2]*e,o=this.m[1]*-i+this.m[3]*e;return this.m[0]=n,this.m[1]=r,this.m[2]=s,this.m[3]=o,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(t,e){var i=this.m[0]+this.m[2]*e,n=this.m[1]+this.m[3]*e,r=this.m[2]+this.m[0]*t,s=this.m[3]+this.m[1]*t;return this.m[0]=i,this.m[1]=n,this.m[2]=r,this.m[3]=s,this}multiply(t){var e=this.m[0]*t.m[0]+this.m[2]*t.m[1],i=this.m[1]*t.m[0]+this.m[3]*t.m[1],n=this.m[0]*t.m[2]+this.m[2]*t.m[3],r=this.m[1]*t.m[2]+this.m[3]*t.m[3],s=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],o=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=e,this.m[1]=i,this.m[2]=n,this.m[3]=r,this.m[4]=s,this.m[5]=o,this}invert(){var t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),e=this.m[3]*t,i=-this.m[1]*t,n=-this.m[2]*t,r=this.m[0]*t,s=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),o=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=e,this.m[1]=i,this.m[2]=n,this.m[3]=r,this.m[4]=s,this.m[5]=o,this}getMatrix(){return this.m}decompose(){var t=this.m[0],e=this.m[1],i=this.m[2],n=this.m[3],r=t*n-e*i;let s={x:this.m[4],y:this.m[5],rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(0!=t||0!=e){var o=Math.sqrt(t*t+e*e);s.rotation=e>0?Math.acos(t/o):-Math.acos(t/o),s.scaleX=o,s.scaleY=r/o,s.skewX=(t*i+e*n)/r,s.skewY=0}else if(0!=i||0!=n){var a=Math.sqrt(i*i+n*n);s.rotation=Math.PI/2-(n>0?Math.acos(-i/a):-Math.acos(i/a)),s.scaleX=r/a,s.scaleY=a,s.skewX=0,s.skewY=(t*i+e*n)/r}return s.rotation=Ig._getRotation(s.rotation),s}}var Ag=Math.PI/180,Tg=180/Math.PI,Mg="Konva error: ",Og={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},Pg=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,Rg=[];const Lg="undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||function(t){setTimeout(t,60)},Ig={_isElement:t=>!(!t||1!=t.nodeType),_isFunction:t=>!!(t&&t.constructor&&t.call&&t.apply),_isPlainObject:t=>!!t&&t.constructor===Object,_isArray:t=>"[object Array]"===Object.prototype.toString.call(t),_isNumber:t=>"[object Number]"===Object.prototype.toString.call(t)&&!isNaN(t)&&isFinite(t),_isString:t=>"[object String]"===Object.prototype.toString.call(t),_isBoolean:t=>"[object Boolean]"===Object.prototype.toString.call(t),isObject:t=>t instanceof Object,isValidSelector(t){if("string"!=typeof t)return!1;var e=t[0];return"#"===e||"."===e||e===e.toUpperCase()},_sign:t=>0===t||t>0?1:-1,requestAnimFrame(t){Rg.push(t),1===Rg.length&&Lg((function(){const t=Rg;Rg=[],t.forEach((function(t){t()}))}))},createCanvasElement(){var t=document.createElement("canvas");try{t.style=t.style||{}}catch(t){}return t},createImageElement:()=>document.createElement("img"),_isInDocument(t){for(;t=t.parentNode;)if(t==document)return!0;return!1},_urlToImage(t,e){var i=Ig.createImageElement();i.onload=function(){e(i)},i.src=t},_rgbToHex:(t,e,i)=>((1<<24)+(t<<16)+(e<<8)+i).toString(16).slice(1),_hexToRgb(t){t=t.replace("#","");var e=parseInt(t,16);return{r:e>>16&255,g:e>>8&255,b:255&e}},getRandomColor(){for(var t=(16777215*Math.random()<<0).toString(16);t.length<6;)t="0"+t;return"#"+t},getRGB(t){var e;return t in Og?{r:(e=Og[t])[0],g:e[1],b:e[2]}:"#"===t[0]?this._hexToRgb(t.substring(1)):"rgb("===t.substr(0,4)?(e=Pg.exec(t.replace(/ /g,"")),{r:parseInt(e[1],10),g:parseInt(e[2],10),b:parseInt(e[3],10)}):{r:0,g:0,b:0}},colorToRGBA:t=>(t=t||"black",Ig._namedColorToRBA(t)||Ig._hex3ColorToRGBA(t)||Ig._hex6ColorToRGBA(t)||Ig._rgbColorToRGBA(t)||Ig._rgbaColorToRGBA(t)||Ig._hslColorToRGBA(t)),_namedColorToRBA(t){var e=Og[t.toLowerCase()];return e?{r:e[0],g:e[1],b:e[2],a:1}:null},_rgbColorToRGBA(t){if(0===t.indexOf("rgb(")){var e=(t=t.match(/rgb\(([^)]+)\)/)[1]).split(/ *, */).map(Number);return{r:e[0],g:e[1],b:e[2],a:1}}},_rgbaColorToRGBA(t){if(0===t.indexOf("rgba(")){var e=(t=t.match(/rgba\(([^)]+)\)/)[1]).split(/ *, */).map(((t,e)=>"%"===t.slice(-1)?3===e?parseInt(t)/100:parseInt(t)/100*255:Number(t)));return{r:e[0],g:e[1],b:e[2],a:e[3]}}},_hex6ColorToRGBA(t){if("#"===t[0]&&7===t.length)return{r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16),a:1}},_hex3ColorToRGBA(t){if("#"===t[0]&&4===t.length)return{r:parseInt(t[1]+t[1],16),g:parseInt(t[2]+t[2],16),b:parseInt(t[3]+t[3],16),a:1}},_hslColorToRGBA(t){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(t)){const[e,...i]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(t),n=Number(i[0])/360,r=Number(i[1])/100,s=Number(i[2])/100;let o,a,l;if(0===r)return l=255*s,{r:Math.round(l),g:Math.round(l),b:Math.round(l),a:1};o=s<.5?s*(1+r):s+r-s*r;const h=2*s-o,c=[0,0,0];for(let t=0;t<3;t++)a=n+1/3*-(t-1),a<0&&a++,a>1&&a--,l=6*a<1?h+6*(o-h)*a:2*a<1?o:3*a<2?h+(o-h)*(2/3-a)*6:h,c[t]=255*l;return{r:Math.round(c[0]),g:Math.round(c[1]),b:Math.round(c[2]),a:1}}},haveIntersection:(t,e)=>!(e.x>t.x+t.width||e.x+e.width<t.x||e.y>t.y+t.height||e.y+e.height<t.y),cloneObject(t){var e={};for(var i in t)this._isPlainObject(t[i])?e[i]=this.cloneObject(t[i]):this._isArray(t[i])?e[i]=this.cloneArray(t[i]):e[i]=t[i];return e},cloneArray:t=>t.slice(0),degToRad:t=>t*Ag,radToDeg:t=>t*Tg,_degToRad:t=>(Ig.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),Ig.degToRad(t)),_radToDeg:t=>(Ig.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),Ig.radToDeg(t)),_getRotation:t=>Cg.angleDeg?Ig.radToDeg(t):t,_capitalize:t=>t.charAt(0).toUpperCase()+t.slice(1),throw(t){throw new Error(Mg+t)},error(t){console.error(Mg+t)},warn(t){Cg.showWarnings&&console.warn("Konva warning: "+t)},each(t,e){for(var i in t)e(i,t[i])},_inRange:(t,e,i)=>e<=t&&t<i,_getProjectionToSegment(t,e,i,n,r,s){var o,a,l,h=(t-i)*(t-i)+(e-n)*(e-n);if(0==h)o=t,a=e,l=(r-i)*(r-i)+(s-n)*(s-n);else{var c=((r-t)*(i-t)+(s-e)*(n-e))/h;c<0?(o=t,a=e,l=(t-r)*(t-r)+(e-s)*(e-s)):c>1?(o=i,a=n,l=(i-r)*(i-r)+(n-s)*(n-s)):l=((o=t+c*(i-t))-r)*(o-r)+((a=e+c*(n-e))-s)*(a-s)}return[o,a,l]},_getProjectionToLine(t,e,i){var n=Ig.cloneObject(t),r=Number.MAX_VALUE;return e.forEach((function(s,o){if(i||o!==e.length-1){var a=e[(o+1)%e.length],l=Ig._getProjectionToSegment(s.x,s.y,a.x,a.y,t.x,t.y),h=l[0],c=l[1],u=l[2];u<r&&(n.x=h,n.y=c,r=u)}})),n},_prepareArrayForTween(t,e,i){var n,r=[],s=[];if(t.length>e.length){var o=e;e=t,t=o}for(n=0;n<t.length;n+=2)r.push({x:t[n],y:t[n+1]});for(n=0;n<e.length;n+=2)s.push({x:e[n],y:e[n+1]});var a=[];return s.forEach((function(t){var e=Ig._getProjectionToLine(t,r,i);a.push(e.x),a.push(e.y)})),a},_prepareToStringify(t){var e;for(var i in t.visitedByCircularReferenceRemoval=!0,t)if(t.hasOwnProperty(i)&&t[i]&&"object"==typeof t[i])if(e=Object.getOwnPropertyDescriptor(t,i),t[i].visitedByCircularReferenceRemoval||Ig._isElement(t[i])){if(!e.configurable)return null;delete t[i]}else if(null===Ig._prepareToStringify(t[i])){if(!e.configurable)return null;delete t[i]}return delete t.visitedByCircularReferenceRemoval,t},_assign(t,e){for(var i in e)t[i]=e[i];return t},_getFirstPointerId:t=>t.touches?t.changedTouches[0].identifier:t.pointerId||999};function $g(t){return Ig._isString(t)?'"'+t+'"':"[object Number]"===Object.prototype.toString.call(t)||Ig._isBoolean(t)?t:Object.prototype.toString.call(t)}function Dg(t){return t>255?255:t<0?0:Math.round(t)}function Ng(){if(Cg.isUnminified)return function(t,e){return Ig._isNumber(t)||Ig.warn($g(t)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),t}}function jg(t){if(Cg.isUnminified)return function(e,i){let n=Ig._isNumber(e),r=Ig._isArray(e)&&e.length==t;return n||r||Ig.warn($g(e)+' is a not valid value for "'+i+'" attribute. The value should be a number or Array<number>('+t+")"),e}}function Bg(){if(Cg.isUnminified)return function(t,e){return Ig._isNumber(t)||"auto"===t||Ig.warn($g(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),t}}function Fg(){if(Cg.isUnminified)return function(t,e){return Ig._isString(t)||Ig.warn($g(t)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),t}}function zg(){if(Cg.isUnminified)return function(t,e){const i=Ig._isString(t),n="[object CanvasGradient]"===Object.prototype.toString.call(t)||t&&t.addColorStop;return i||n||Ig.warn($g(t)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),t}}function Ug(){if(Cg.isUnminified)return function(t,e){return!0===t||!1===t||Ig.warn($g(t)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),t}}var Gg="get",Hg="set";const Vg={addGetterSetter(t,e,i,n,r){Vg.addGetter(t,e,i),Vg.addSetter(t,e,n,r),Vg.addOverloadedGetterSetter(t,e)},addGetter(t,e,i){var n=Gg+Ig._capitalize(e);t.prototype[n]=t.prototype[n]||function(){var t=this.attrs[e];return void 0===t?i:t}},addSetter(t,e,i,n){var r=Hg+Ig._capitalize(e);t.prototype[r]||Vg.overWriteSetter(t,e,i,n)},overWriteSetter(t,e,i,n){var r=Hg+Ig._capitalize(e);t.prototype[r]=function(t){return i&&null!=t&&(t=i.call(this,t,e)),this._setAttr(e,t),n&&n.call(this),this}},addComponentsGetterSetter(t,e,i,n,r){var s,o,a=i.length,l=Ig._capitalize,h=Gg+l(e),c=Hg+l(e);t.prototype[h]=function(){var t={};for(s=0;s<a;s++)t[o=i[s]]=this.getAttr(e+l(o));return t};var u=function(t){if(Cg.isUnminified)return function(e,i){return Ig.isObject(e)||Ig.warn($g(e)+' is a not valid value for "'+i+'" attribute. The value should be an object with properties '+t),e}}(i);t.prototype[c]=function(t){var i,s=this.attrs[e];for(i in n&&(t=n.call(this,t)),u&&u.call(this,t,e),t)t.hasOwnProperty(i)&&this._setAttr(e+l(i),t[i]);return this._fireChangeEvent(e,s,t),r&&r.call(this),this},Vg.addOverloadedGetterSetter(t,e)},addOverloadedGetterSetter(t,e){var i=Ig._capitalize(e),n=Hg+i,r=Gg+i;t.prototype[e]=function(){return arguments.length?(this[n](arguments[0]),this):this[r]()}},addDeprecatedGetterSetter(t,e,i,n){Ig.error("Adding deprecated "+e);var r=Gg+Ig._capitalize(e),s=e+" property is deprecated and will be removed soon. Look at Konva change log for more information.";t.prototype[r]=function(){Ig.error(s);var t=this.attrs[e];return void 0===t?i:t},Vg.addSetter(t,e,n,(function(){Ig.error(s)})),Vg.addOverloadedGetterSetter(t,e)},backCompat(t,e){Ig.each(e,(function(e,i){var n=t.prototype[i],r=Gg+Ig._capitalize(e),s=Hg+Ig._capitalize(e);function o(){n.apply(this,arguments),Ig.error('"'+e+'" method is deprecated and will be removed soon. Use ""'+i+'" instead.')}t.prototype[e]=o,t.prototype[r]=o,t.prototype[s]=o}))},afterSetFilter(){this._filterUpToDate=!1}};function qg(t){var e,i,n=[],r=t.length,s=Ig;for(e=0;e<r;e++)i=t[e],s._isNumber(i)?i=Math.round(1e3*i)/1e3:s._isString(i)||(i+=""),n.push(i);return n}var Wg,Yg=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"];class Xg{constructor(t){this.canvas=t,this._context=t._canvas.getContext("2d"),Cg.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,e){var i,n,r,s,o=this.traceArr,a=o.length,l="";for(i=0;i<a;i++)(r=(n=o[i]).method)?(s=n.args,l+=r,t?l+="()":Ig._isArray(s[0])?l+="(["+s.join(",")+"])":(e&&(s=s.map((t=>"number"==typeof t?Math.floor(t):t))),l+="("+s.join(",")+")")):(l+=n.property,t||(l+="="+n.val)),l+=";";return l}clearTrace(){this.traceArr=[]}_trace(t){var e=this.traceArr;e.push(t),e.length>=100&&e.shift()}reset(){var t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){var e=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,e.getWidth()/e.pixelRatio,e.getHeight()/e.pixelRatio)}_applyLineCap(t){var e=t.getLineCap();e&&this.setAttr("lineCap",e)}_applyOpacity(t){var e=t.getAbsoluteOpacity();1!==e&&this.setAttr("globalAlpha",e)}_applyLineJoin(t){var e=t.attrs.lineJoin;e&&this.setAttr("lineJoin",e)}setAttr(t,e){this._context[t]=e}arc(t,e,i,n,r,s){this._context.arc(t,e,i,n,r,s)}arcTo(t,e,i,n,r){this._context.arcTo(t,e,i,n,r)}beginPath(){this._context.beginPath()}bezierCurveTo(t,e,i,n,r,s){this._context.bezierCurveTo(t,e,i,n,r,s)}clearRect(t,e,i,n){this._context.clearRect(t,e,i,n)}clip(){this._context.clip()}closePath(){this._context.closePath()}createImageData(t,e){var i=arguments;return 2===i.length?this._context.createImageData(t,e):1===i.length?this._context.createImageData(t):void 0}createLinearGradient(t,e,i,n){return this._context.createLinearGradient(t,e,i,n)}createPattern(t,e){return this._context.createPattern(t,e)}createRadialGradient(t,e,i,n,r,s){return this._context.createRadialGradient(t,e,i,n,r,s)}drawImage(t,e,i,n,r,s,o,a,l){var h=arguments,c=this._context;3===h.length?c.drawImage(t,e,i):5===h.length?c.drawImage(t,e,i,n,r):9===h.length&&c.drawImage(t,e,i,n,r,s,o,a,l)}ellipse(t,e,i,n,r,s,o,a){this._context.ellipse(t,e,i,n,r,s,o,a)}isPointInPath(t,e){return this._context.isPointInPath(t,e)}fill(t){t?this._context.fill(t):this._context.fill()}fillRect(t,e,i,n){this._context.fillRect(t,e,i,n)}strokeRect(t,e,i,n){this._context.strokeRect(t,e,i,n)}fillText(t,e,i,n){n?this._context.fillText(t,e,i,n):this._context.fillText(t,e,i)}measureText(t){return this._context.measureText(t)}getImageData(t,e,i,n){return this._context.getImageData(t,e,i,n)}lineTo(t,e){this._context.lineTo(t,e)}moveTo(t,e){this._context.moveTo(t,e)}rect(t,e,i,n){this._context.rect(t,e,i,n)}putImageData(t,e,i){this._context.putImageData(t,e,i)}quadraticCurveTo(t,e,i,n){this._context.quadraticCurveTo(t,e,i,n)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,e){this._context.scale(t,e)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,e,i,n,r,s){this._context.setTransform(t,e,i,n,r,s)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,e,i,n){this._context.strokeText(t,e,i,n)}transform(t,e,i,n,r,s){this._context.transform(t,e,i,n,r,s)}translate(t,e){this._context.translate(t,e)}_enableTrace(){var t,e,i=this,n=Yg.length,r=this.setAttr,s=function(t){var n,r=i[t];i[t]=function(){return e=qg(Array.prototype.slice.call(arguments,0)),n=r.apply(i,arguments),i._trace({method:t,args:e}),n}};for(t=0;t<n;t++)s(Yg[t]);i.setAttr=function(){r.apply(i,arguments);var t=arguments[0],e=arguments[1];"shadowOffsetX"!==t&&"shadowOffsetY"!==t&&"shadowBlur"!==t||(e/=this.canvas.getPixelRatio()),i._trace({property:t,val:e})}}_applyGlobalCompositeOperation(t){const e=t.attrs.globalCompositeOperation;!e||"source-over"===e||this.setAttr("globalCompositeOperation",e)}}["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"].forEach((function(t){Object.defineProperty(Xg.prototype,t,{get(){return this._context[t]},set(e){this._context[t]=e}})}));class Kg extends Xg{_fillColor(t){var e=t.fill();this.setAttr("fillStyle",e),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){var e=t._getLinearGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fillRadialGradient(t){var e=t._getRadialGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fill(t){var e=t.fill(),i=t.getFillPriority();if(e&&"color"===i)this._fillColor(t);else{var n=t.getFillPatternImage();if(n&&"pattern"===i)this._fillPattern(t);else{var r=t.getFillLinearGradientColorStops();if(r&&"linear-gradient"===i)this._fillLinearGradient(t);else{var s=t.getFillRadialGradientColorStops();s&&"radial-gradient"===i?this._fillRadialGradient(t):e?this._fillColor(t):n?this._fillPattern(t):r?this._fillLinearGradient(t):s&&this._fillRadialGradient(t)}}}}_strokeLinearGradient(t){var e=t.getStrokeLinearGradientStartPoint(),i=t.getStrokeLinearGradientEndPoint(),n=t.getStrokeLinearGradientColorStops(),r=this.createLinearGradient(e.x,e.y,i.x,i.y);if(n){for(var s=0;s<n.length;s+=2)r.addColorStop(n[s],n[s+1]);this.setAttr("strokeStyle",r)}}_stroke(t){var e=t.dash(),i=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!i){this.save();var n=this.getCanvas().getPixelRatio();this.setTransform(n,0,0,n,0,0)}this._applyLineCap(t),e&&t.dashEnabled()&&(this.setLineDash(e),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),t.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),i||this.restore()}}_applyShadow(t){var e,i,n,r=null!==(e=t.getShadowRGBA())&&void 0!==e?e:"black",s=null!==(i=t.getShadowBlur())&&void 0!==i?i:5,o=null!==(n=t.getShadowOffset())&&void 0!==n?n:{x:0,y:0},a=t.getAbsoluteScale(),l=this.canvas.getPixelRatio(),h=a.x*l,c=a.y*l;this.setAttr("shadowColor",r),this.setAttr("shadowBlur",s*Math.min(Math.abs(h),Math.abs(c))),this.setAttr("shadowOffsetX",o.x*h),this.setAttr("shadowOffsetY",o.y*c)}}class Qg extends Xg{_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){var e=t.getStrokeScaleEnabled();if(!e){this.save();var i=this.getCanvas().getPixelRatio();this.setTransform(i,0,0,i,0,0)}this._applyLineCap(t);var n=t.hitStrokeWidth(),r="auto"===n?t.strokeWidth():n;this.setAttr("lineWidth",r),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),e||this.restore()}}}class Zg{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;var e=(t||{}).pixelRatio||Cg.pixelRatio||function(){if(Wg)return Wg;var t=Ig.createCanvasElement().getContext("2d");return Wg=(Cg._global.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}();this.pixelRatio=e,this._canvas=Ig.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){var e=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/e,this.getHeight()/e)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";var e=this.pixelRatio;this.getContext()._context.scale(e,e)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";var e=this.pixelRatio;this.getContext()._context.scale(e,e)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,e){this.setWidth(t||0),this.setHeight(e||0)}toDataURL(t,e){try{return this._canvas.toDataURL(t,e)}catch(t){try{return this._canvas.toDataURL()}catch(t){return Ig.error("Unable to get data URL. "+t.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}Vg.addGetterSetter(Zg,"pixelRatio",void 0,Ng());class Jg extends Zg{constructor(t={width:0,height:0}){super(t),this.context=new Kg(this),this.setSize(t.width,t.height)}}class tv extends Zg{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new Qg(this),this.setSize(t.width,t.height)}}const ev={get isDragging(){var t=!1;return ev._dragElements.forEach((e=>{"dragging"===e.dragStatus&&(t=!0)})),t},justDragged:!1,get node(){var t;return ev._dragElements.forEach((e=>{t=e.node})),t},_dragElements:new Map,_drag(t){const e=[];ev._dragElements.forEach(((i,n)=>{const{node:r}=i,s=r.getStage();s.setPointersPositions(t),void 0===i.pointerId&&(i.pointerId=Ig._getFirstPointerId(t));const o=s._changedPointerPositions.find((t=>t.id===i.pointerId));if(o){if("dragging"!==i.dragStatus){var a=r.dragDistance();if(Math.max(Math.abs(o.x-i.startPointerPos.x),Math.abs(o.y-i.startPointerPos.y))<a)return;if(r.startDrag({evt:t}),!r.isDragging())return}r._setDragPosition(t,i),e.push(r)}})),e.forEach((e=>{e.fire("dragmove",{type:"dragmove",target:e,evt:t},!0)}))},_endDragBefore(t){ev._dragElements.forEach((e=>{const{node:i}=e,n=i.getStage();if(t&&n.setPointersPositions(t),!n._changedPointerPositions.find((t=>t.id===e.pointerId)))return;"dragging"!==e.dragStatus&&"stopped"!==e.dragStatus||(ev.justDragged=!0,Cg._mouseListenClick=!1,Cg._touchListenClick=!1,Cg._pointerListenClick=!1,e.dragStatus="stopped");const r=e.node.getLayer()||e.node instanceof Cg.Stage&&e.node;r&&r.batchDraw()}))},_endDragAfter(t){ev._dragElements.forEach(((e,i)=>{"stopped"===e.dragStatus&&e.node.fire("dragend",{type:"dragend",target:e.node,evt:t},!0),"dragging"!==e.dragStatus&&ev._dragElements.delete(i)}))}};Cg.isBrowser&&(window.addEventListener("mouseup",ev._endDragBefore,!0),window.addEventListener("touchend",ev._endDragBefore,!0),window.addEventListener("mousemove",ev._drag),window.addEventListener("touchmove",ev._drag),window.addEventListener("mouseup",ev._endDragAfter,!1),window.addEventListener("touchend",ev._endDragAfter,!1));var iv="absoluteOpacity",nv="allEventListeners",rv="absoluteTransform",sv="absoluteScale",ov="canvas",av="listening",lv="mouseenter",hv="mouseleave",cv="Shape",uv=" ",dv="stage",fv="transform",pv="visible",gv=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(uv);let vv=1;class mv{constructor(t){this._id=vv++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){t!==fv&&t!==rv||!this._cache.get(t)?t?this._cache.delete(t):this._cache.clear():this._cache.get(t).dirty=!0}_getCache(t,e){var i=this._cache.get(t);return(void 0===i||(t===fv||t===rv)&&!0===i.dirty)&&(i=e.call(this),this._cache.set(t,i)),i}_calculate(t,e,i){if(!this._attachedDepsListeners.get(t)){const i=e.map((t=>t+"Change.konva")).join(uv);this.on(i,(()=>{this._clearCache(t)})),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,i)}_getCanvasCache(){return this._cache.get(ov)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===rv&&this.fire("absoluteTransformChange")}clearCache(){return this._cache.delete(ov),this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){var e=t||{},i={};void 0!==e.x&&void 0!==e.y&&void 0!==e.width&&void 0!==e.height||(i=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()}));var n=Math.ceil(e.width||i.width),r=Math.ceil(e.height||i.height),s=e.pixelRatio,o=void 0===e.x?Math.floor(i.x):e.x,a=void 0===e.y?Math.floor(i.y):e.y,l=e.offset||0,h=e.drawBorder||!1,c=e.hitCanvasPixelRatio||1;if(n&&r){o-=l,a-=l;var u=new Jg({pixelRatio:s,width:n+=2*l+1,height:r+=2*l+1}),d=new Jg({pixelRatio:s,width:0,height:0}),f=new tv({pixelRatio:c,width:n,height:r}),p=u.getContext(),g=f.getContext();return f.isCache=!0,u.isCache=!0,this._cache.delete(ov),this._filterUpToDate=!1,!1===e.imageSmoothingEnabled&&(u.getContext()._context.imageSmoothingEnabled=!1,d.getContext()._context.imageSmoothingEnabled=!1),p.save(),g.save(),p.translate(-o,-a),g.translate(-o,-a),this._isUnderCache=!0,this._clearSelfAndDescendantCache(iv),this._clearSelfAndDescendantCache(sv),this.drawScene(u,this),this.drawHit(f,this),this._isUnderCache=!1,p.restore(),g.restore(),h&&(p.save(),p.beginPath(),p.rect(0,0,n,r),p.closePath(),p.setAttr("strokeStyle","red"),p.setAttr("lineWidth",5),p.stroke(),p.restore()),this._cache.set(ov,{scene:u,filter:d,hit:f,x:o,y:a}),this._requestDraw(),this}Ig.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.")}isCached(){return this._cache.has(ov)}getClientRect(t){throw new Error('abstract "getClientRect" method call')}_transformedRect(t,e){var i,n,r,s,o=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}],a=this.getAbsoluteTransform(e);return o.forEach((function(t){var e=a.point(t);void 0===i&&(i=r=e.x,n=s=e.y),i=Math.min(i,e.x),n=Math.min(n,e.y),r=Math.max(r,e.x),s=Math.max(s,e.y)})),{x:i,y:n,width:r-i,height:s-n}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);const e=this._getCanvasCache();t.translate(e.x,e.y);var i=this._getCachedSceneCanvas(),n=i.pixelRatio;t.drawImage(i._canvas,0,0,i.width/n,i.height/n),t.restore()}_drawCachedHitCanvas(t){var e=this._getCanvasCache(),i=e.hit;t.save(),t.translate(e.x,e.y),t.drawImage(i._canvas,0,0,i.width/i.pixelRatio,i.height/i.pixelRatio),t.restore()}_getCachedSceneCanvas(){var t,e,i,n,r=this.filters(),s=this._getCanvasCache(),o=s.scene,a=s.filter,l=a.getContext();if(r){if(!this._filterUpToDate){var h=o.pixelRatio;a.setSize(o.width/o.pixelRatio,o.height/o.pixelRatio);try{for(t=r.length,l.clear(),l.drawImage(o._canvas,0,0,o.getWidth()/h,o.getHeight()/h),e=l.getImageData(0,0,a.getWidth(),a.getHeight()),i=0;i<t;i++)"function"==typeof(n=r[i])?(n.call(this,e),l.putImageData(e,0,0)):Ig.error("Filter should be type of function, but got "+typeof n+" instead. Please check correct filters")}catch(t){Ig.error("Unable to apply filter. "+t.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return a}return o}on(t,e){if(this._cache&&this._cache.delete(nv),3===arguments.length)return this._delegate.apply(this,arguments);var i,n,r,s,o=t.split(uv),a=o.length;for(i=0;i<a;i++)r=(n=o[i].split("."))[0],s=n[1]||"",this.eventListeners[r]||(this.eventListeners[r]=[]),this.eventListeners[r].push({name:s,handler:e});return this}off(t,e){var i,n,r,s,o,a=(t||"").split(uv),l=a.length;if(this._cache&&this._cache.delete(nv),!t)for(n in this.eventListeners)this._off(n);for(i=0;i<l;i++)if(s=(r=a[i].split("."))[0],o=r[1],s)this.eventListeners[s]&&this._off(s,o,e);else for(n in this.eventListeners)this._off(n,o,e);return this}dispatchEvent(t){var e={target:this,type:t.type,evt:t};return this.fire(t.type,e),this}addEventListener(t,e){return this.on(t,(function(t){e.call(this,t.evt)})),this}removeEventListener(t){return this.off(t),this}_delegate(t,e,i){var n=this;this.on(t,(function(t){for(var r=t.target.findAncestors(e,!0,n),s=0;s<r.length;s++)(t=Ig.cloneObject(t)).currentTarget=r[s],i.call(r[s],t)}))}remove(){return this.isDragging()&&this.stopDrag(),ev._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(rv),this._clearSelfAndDescendantCache(iv),this._clearSelfAndDescendantCache(sv),this._clearSelfAndDescendantCache(dv),this._clearSelfAndDescendantCache(pv),this._clearSelfAndDescendantCache(av)}_remove(){this._clearCaches();var t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this}getAttr(t){var e="get"+Ig._capitalize(t);return Ig._isFunction(this[e])?this[e]():this.attrs[t]}getAncestors(){for(var t=this.getParent(),e=[];t;)e.push(t),t=t.getParent();return e}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges((()=>{var e,i;if(!t)return this;for(e in t)"children"!==e&&(i="set"+Ig._capitalize(e),Ig._isFunction(this[i])?this[i](t[e]):this._setAttr(e,t[e]))})),this}isListening(){return this._getCache(av,this._isListening)}_isListening(t){if(!this.listening())return!1;const e=this.getParent();return!e||e===t||this===t||e._isListening(t)}isVisible(){return this._getCache(pv,this._isVisible)}_isVisible(t){if(!this.visible())return!1;const e=this.getParent();return!e||e===t||this===t||e._isVisible(t)}shouldDrawHit(t,e=!1){if(t)return this._isVisible(t)&&this._isListening(t);var i=this.getLayer(),n=!1;ev._dragElements.forEach((t=>{"dragging"===t.dragStatus&&("Stage"===t.node.nodeType||t.node.getLayer()===i)&&(n=!0)}));var r=!e&&!Cg.hitOnDragEnabled&&n;return this.isListening()&&this.isVisible()&&!r}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){var t,e,i,n,r=this.getDepth(),s=this,o=0;return"Stage"!==s.nodeType&&function a(l){for(t=[],e=l.length,i=0;i<e;i++)n=l[i],o++,n.nodeType!==cv&&(t=t.concat(n.getChildren().slice())),n._id===s._id&&(i=e);t.length>0&&t[0].getDepth()<=r&&a(t)}(s.getStage().getChildren()),o}getDepth(){for(var t=0,e=this.parent;e;)t++,e=e.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(fv),this._clearSelfAndDescendantCache(rv)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges((()=>{this.x(t.x),this.y(t.y)})),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){if(!this.getStage())return null;var t=this.getStage().getPointerPosition();if(!t)return null;var e=this.getAbsoluteTransform().copy();return e.invert(),e.point(t)}getAbsolutePosition(t){let e=!1,i=this.parent;for(;i;){if(i.isCached()){e=!0;break}i=i.parent}e&&!t&&(t=!0);var n=this.getAbsoluteTransform(t).getMatrix(),r=new Eg,s=this.offset();return r.m=n.slice(),r.translate(s.x,s.y),r.getTranslation()}setAbsolutePosition(t){var e=this._clearTransform();this.attrs.x=e.x,this.attrs.y=e.y,delete e.x,delete e.y,this._clearCache(fv);var i=this._getAbsoluteTransform().copy();return i.invert(),i.translate(t.x,t.y),t={x:this.attrs.x+i.getTranslation().x,y:this.attrs.y+i.getTranslation().y},this._setTransform(e),this.setPosition({x:t.x,y:t.y}),this._clearCache(fv),this._clearSelfAndDescendantCache(rv),this}_setTransform(t){var e;for(e in t)this.attrs[e]=t[e]}_clearTransform(){var t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){var e=t.x,i=t.y,n=this.x(),r=this.y();return void 0!==e&&(n+=e),void 0!==i&&(r+=i),this.setPosition({x:n,y:r}),this}_eachAncestorReverse(t,e){var i,n,r=[],s=this.getParent();if(!e||e._id!==this._id){for(r.unshift(this);s&&(!e||s._id!==e._id);)r.unshift(s),s=s.parent;for(i=r.length,n=0;n<i;n++)t(r[n])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return Ig.warn("Node has no parent. moveToTop function is ignored."),!1;var t=this.index;return t<this.parent.getChildren().length-1&&(this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0)}moveUp(){if(!this.parent)return Ig.warn("Node has no parent. moveUp function is ignored."),!1;var t=this.index;return t<this.parent.getChildren().length-1&&(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0)}moveDown(){if(!this.parent)return Ig.warn("Node has no parent. moveDown function is ignored."),!1;var t=this.index;return t>0&&(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0)}moveToBottom(){if(!this.parent)return Ig.warn("Node has no parent. moveToBottom function is ignored."),!1;var t=this.index;return t>0&&(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0)}setZIndex(t){if(!this.parent)return Ig.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&Ig.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");var e=this.index;return this.parent.children.splice(e,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(iv,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){var t=this.opacity(),e=this.getParent();return e&&!e._isUnderCache&&(t*=e.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){var t,e,i,n,r={},s=this.getAttrs();for(t in r.attrs={},s)e=s[t],Ig.isObject(e)&&!Ig._isPlainObject(e)&&!Ig._isArray(e)||(i="function"==typeof this[t]&&this[t],delete s[t],n=i?i.call(this):null,s[t]=e,n!==e&&(r.attrs[t]=e));return r.className=this.getClassName(),Ig._prepareToStringify(r)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,e,i){var n=[];e&&this._isMatch(t)&&n.push(this);for(var r=this.parent;r;){if(r===i)return n;r._isMatch(t)&&n.push(r),r=r.parent}return n}isAncestorOf(t){return!1}findAncestor(t,e,i){return this.findAncestors(t,e,i)[0]}_isMatch(t){if(!t)return!1;if("function"==typeof t)return t(this);var e,i,n=t.replace(/ /g,"").split(","),r=n.length;for(e=0;e<r;e++)if(i=n[e],Ig.isValidSelector(i)||(Ig.warn('Selector "'+i+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),Ig.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),Ig.warn("Konva is awesome, right?")),"#"===i.charAt(0)){if(this.id()===i.slice(1))return!0}else if("."===i.charAt(0)){if(this.hasName(i.slice(1)))return!0}else if(this.className===i||this.nodeType===i)return!0;return!1}getLayer(){var t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(dv,this._getStage)}_getStage(){var t=this.getParent();return t?t.getStage():void 0}fire(t,e={},i){return e.target=e.target||this,i?this._fireAndBubble(t,e):this._fire(t,e),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(rv,this._getAbsoluteTransform)}_getAbsoluteTransform(t){var e;if(t)return e=new Eg,this._eachAncestorReverse((function(t){var i=t.transformsEnabled();"all"===i?e.multiply(t.getTransform()):"position"===i&&e.translate(t.x()-t.offsetX(),t.y()-t.offsetY())}),t),e;e=this._cache.get(rv)||new Eg,this.parent?this.parent.getAbsoluteTransform().copyInto(e):e.reset();var i=this.transformsEnabled();if("all"===i)e.multiply(this.getTransform());else if("position"===i){const t=this.attrs.x||0,i=this.attrs.y||0,n=this.attrs.offsetX||0,r=this.attrs.offsetY||0;e.translate(t-n,i-r)}return e.dirty=!1,e}getAbsoluteScale(t){for(var e=this;e;)e._isUnderCache&&(t=e),e=e.getParent();const i=this.getAbsoluteTransform(t).decompose();return{x:i.scaleX,y:i.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(fv,this._getTransform)}_getTransform(){var t,e,i=this._cache.get(fv)||new Eg;i.reset();var n=this.x(),r=this.y(),s=Cg.getAngle(this.rotation()),o=null!==(t=this.attrs.scaleX)&&void 0!==t?t:1,a=null!==(e=this.attrs.scaleY)&&void 0!==e?e:1,l=this.attrs.skewX||0,h=this.attrs.skewY||0,c=this.attrs.offsetX||0,u=this.attrs.offsetY||0;return 0===n&&0===r||i.translate(n,r),0!==s&&i.rotate(s),0===l&&0===h||i.skew(l,h),1===o&&1===a||i.scale(o,a),0===c&&0===u||i.translate(-1*c,-1*u),i.dirty=!1,i}clone(t){var e,i,n,r,s,o=Ig.cloneObject(this.attrs);for(e in t)o[e]=t[e];var a=new this.constructor(o);for(e in this.eventListeners)for(n=(i=this.eventListeners[e]).length,r=0;r<n;r++)(s=i[r]).name.indexOf("konva")<0&&(a.eventListeners[e]||(a.eventListeners[e]=[]),a.eventListeners[e].push(s));return a}_toKonvaCanvas(t){t=t||{};var e=this.getClientRect(),i=this.getStage(),n=void 0!==t.x?t.x:Math.floor(e.x),r=void 0!==t.y?t.y:Math.floor(e.y),s=t.pixelRatio||1,o=new Jg({width:t.width||Math.ceil(e.width)||(i?i.width():0),height:t.height||Math.ceil(e.height)||(i?i.height():0),pixelRatio:s}),a=o.getContext();return!1===t.imageSmoothingEnabled&&(a._context.imageSmoothingEnabled=!1),a.save(),(n||r)&&a.translate(-1*n,-1*r),this.drawScene(o),a.restore(),o}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){var e=(t=t||{}).mimeType||null,i=t.quality||null,n=this._toKonvaCanvas(t).toDataURL(e,i);return t.callback&&t.callback(n),n}toImage(t){if(!t||!t.callback)throw"callback required for toImage method config argument";var e=t.callback;delete t.callback,Ig._urlToImage(this.toDataURL(t),(function(t){e(t)}))}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return void 0!==this.attrs.dragDistance?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():Cg.dragDistance}_off(t,e,i){var n,r,s,o=this.eventListeners[t];for(n=0;n<o.length;n++)if(r=o[n].name,s=o[n].handler,!("konva"===r&&"konva"!==e||e&&r!==e||i&&i!==s)){if(o.splice(n,1),0===o.length){delete this.eventListeners[t];break}n--}}_fireChangeEvent(t,e,i){this._fire(t+"Change",{oldVal:e,newVal:i})}addName(t){if(!this.hasName(t)){var e=this.name(),i=e?e+" "+t:t;this.name(i)}return this}hasName(t){if(!t)return!1;const e=this.name();return!!e&&-1!==(e||"").split(/\s/g).indexOf(t)}removeName(t){var e=(this.name()||"").split(/\s/g),i=e.indexOf(t);return-1!==i&&(e.splice(i,1),this.name(e.join(" "))),this}setAttr(t,e){var i=this["set"+Ig._capitalize(t)];return Ig._isFunction(i)?i.call(this,e):this._setAttr(t,e),this}_requestDraw(){if(Cg.autoDrawEnabled){const t=this.getLayer()||this.getStage();null==t||t.batchDraw()}}_setAttr(t,e){var i=this.attrs[t];(i!==e||Ig.isObject(e))&&(null==e?delete this.attrs[t]:this.attrs[t]=e,this._shouldFireChangeEvents&&this._fireChangeEvent(t,i,e),this._requestDraw())}_setComponentAttr(t,e,i){var n;void 0!==i&&((n=this.attrs[t])||(this.attrs[t]=this.getAttr(t)),this.attrs[t][e]=i,this._fireChangeEvent(t,n,i))}_fireAndBubble(t,e,i){if(e&&this.nodeType===cv&&(e.target=this),t!==lv&&t!==hv||!(i&&(this===i||this.isAncestorOf&&this.isAncestorOf(i))||"Stage"===this.nodeType&&!i)){this._fire(t,e);var n=(t===lv||t===hv)&&i&&i.isAncestorOf&&i.isAncestorOf(this)&&!i.isAncestorOf(this.parent);(e&&!e.cancelBubble||!e)&&this.parent&&this.parent.isListening()&&!n&&(i&&i.parent?this._fireAndBubble.call(this.parent,t,e,i):this._fireAndBubble.call(this.parent,t,e))}}_getProtoListeners(t){let e=this._cache.get(nv);if(!e){e={};let t=Object.getPrototypeOf(this);for(;t;)if(t.eventListeners){for(var i in t.eventListeners){const n=t.eventListeners[i],r=e[i]||[];e[i]=n.concat(r)}t=Object.getPrototypeOf(t)}else t=Object.getPrototypeOf(t);this._cache.set(nv,e)}return e[t]}_fire(t,e){(e=e||{}).currentTarget=this,e.type=t;const i=this._getProtoListeners(t);if(i)for(var n=0;n<i.length;n++)i[n].handler.call(this,e);const r=this.eventListeners[t];if(r)for(n=0;n<r.length;n++)r[n].handler.call(this,e)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){var e=t?t.pointerId:void 0,i=this.getStage(),n=this.getAbsolutePosition(),r=i._getPointerById(e)||i._changedPointerPositions[0]||n;ev._dragElements.set(this._id,{node:this,startPointerPos:r,offset:{x:r.x-n.x,y:r.y-n.y},dragStatus:"ready",pointerId:e})}startDrag(t,e=!0){ev._dragElements.has(this._id)||this._createDragElement(t),ev._dragElements.get(this._id).dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},e)}_setDragPosition(t,e){const i=this.getStage()._getPointerById(e.pointerId);if(i){var n={x:i.x-e.offset.x,y:i.y-e.offset.y},r=this.dragBoundFunc();if(void 0!==r){const e=r.call(this,n,t);e?n=e:Ig.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}this._lastPos&&this._lastPos.x===n.x&&this._lastPos.y===n.y||(this.setAbsolutePosition(n),this._requestDraw()),this._lastPos=n}}stopDrag(t){const e=ev._dragElements.get(this._id);e&&(e.dragStatus="stopped"),ev._endDragBefore(t),ev._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){const t=ev._dragElements.get(this._id);return!!t&&"dragging"===t.dragStatus}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",(function(t){if((void 0===t.evt.button||Cg.dragButtons.indexOf(t.evt.button)>=0)&&!this.isDragging()){var e=!1;ev._dragElements.forEach((t=>{this.isAncestorOf(t.node)&&(e=!0)})),e||this._createDragElement(t)}}))}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const t=ev._dragElements.get(this._id),e=t&&"dragging"===t.dragStatus,i=t&&"ready"===t.dragStatus;e?this.stopDrag():i&&ev._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){const e=this.getStage();if(!e)return!1;const i={x:-t.x,y:-t.y,width:e.width()+2*t.x,height:e.height()+2*t.y};return Ig.haveIntersection(i,this.getClientRect())}static create(t,e){return Ig._isString(t)&&(t=JSON.parse(t)),this._createNode(t,e)}static _createNode(t,e){var i,n,r,s=mv.prototype.getClassName.call(t),o=t.children;if(e&&(t.attrs.container=e),Cg[s]||(Ig.warn('Can not find a node with class name "'+s+'". Fallback to "Shape".'),s="Shape"),i=new(0,Cg[s])(t.attrs),o)for(n=o.length,r=0;r<n;r++)i.add(mv._createNode(o[r]));return i}}mv.prototype.nodeType="Node",mv.prototype._attrsAffectingSize=[],mv.prototype.eventListeners={},mv.prototype.on.call(mv.prototype,gv,(function(){this._batchingTransformChange?this._needClearTransformCache=!0:(this._clearCache(fv),this._clearSelfAndDescendantCache(rv))})),mv.prototype.on.call(mv.prototype,"visibleChange.konva",(function(){this._clearSelfAndDescendantCache(pv)})),mv.prototype.on.call(mv.prototype,"listeningChange.konva",(function(){this._clearSelfAndDescendantCache(av)})),mv.prototype.on.call(mv.prototype,"opacityChange.konva",(function(){this._clearSelfAndDescendantCache(iv)}));const yv=Vg.addGetterSetter;yv(mv,"zIndex"),yv(mv,"absolutePosition"),yv(mv,"position"),yv(mv,"x",0,Ng()),yv(mv,"y",0,Ng()),yv(mv,"globalCompositeOperation","source-over",Fg()),yv(mv,"opacity",1,Ng()),yv(mv,"name","",Fg()),yv(mv,"id","",Fg()),yv(mv,"rotation",0,Ng()),Vg.addComponentsGetterSetter(mv,"scale",["x","y"]),yv(mv,"scaleX",1,Ng()),yv(mv,"scaleY",1,Ng()),Vg.addComponentsGetterSetter(mv,"skew",["x","y"]),yv(mv,"skewX",0,Ng()),yv(mv,"skewY",0,Ng()),Vg.addComponentsGetterSetter(mv,"offset",["x","y"]),yv(mv,"offsetX",0,Ng()),yv(mv,"offsetY",0,Ng()),yv(mv,"dragDistance",null,Ng()),yv(mv,"width",0,Ng()),yv(mv,"height",0,Ng()),yv(mv,"listening",!0,Ug()),yv(mv,"preventDefault",!0,Ug()),yv(mv,"filters",null,(function(t){return this._filterUpToDate=!1,t})),yv(mv,"visible",!0,Ug()),yv(mv,"transformsEnabled","all",Fg()),yv(mv,"size"),yv(mv,"dragBoundFunc"),yv(mv,"draggable",!1,Ug()),Vg.backCompat(mv,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});class bv extends mv{constructor(){super(...arguments),this.children=[]}getChildren(t){if(!t)return this.children||[];const e=this.children||[];var i=[];return e.forEach((function(e){t(e)&&i.push(e)})),i}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach((t=>{t.parent=null,t.index=0,t.remove()})),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach((t=>{t.parent=null,t.index=0,t.destroy()})),this.children=[],this._requestDraw(),this}add(...t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}var i=t[0];return i.getParent()?(i.moveTo(this),this):(this._validateAdd(i),i.index=this.getChildren().length,i.parent=this,i._clearCaches(),this.getChildren().push(i),this._fire("add",{child:i}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){var e=this._generalFind(t,!0);return e.length>0?e[0]:void 0}_generalFind(t,e){var i=[];return this._descendants((n=>{const r=n._isMatch(t);return r&&i.push(n),!(!r||!e)})),i}_descendants(t){let e=!1;const i=this.getChildren();for(const n of i){if(e=t(n),e)return!0;if(n.hasChildren()&&(e=n._descendants(t),e))return!0}return!1}toObject(){var t=mv.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach((e=>{t.children.push(e.toObject())})),t}isAncestorOf(t){for(var e=t.getParent();e;){if(e._id===this._id)return!0;e=e.getParent()}return!1}clone(t){var e=mv.prototype.clone.call(this,t);return this.getChildren().forEach((function(t){e.add(t.clone())})),e}getAllIntersections(t){var e=[];return this.find("Shape").forEach((function(i){i.isVisible()&&i.intersects(t)&&e.push(i)})),e}_clearSelfAndDescendantCache(t){var e;super._clearSelfAndDescendantCache(t),this.isCached()||null===(e=this.children)||void 0===e||e.forEach((function(e){e._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;null===(t=this.children)||void 0===t||t.forEach((function(t,e){t.index=e})),this._requestDraw()}drawScene(t,e){var i=this.getLayer(),n=t||i&&i.getCanvas(),r=n&&n.getContext(),s=this._getCanvasCache(),o=s&&s.scene,a=n&&n.isCache;if(!this.isVisible()&&!a)return this;if(o){r.save();var l=this.getAbsoluteTransform(e).getMatrix();r.transform(l[0],l[1],l[2],l[3],l[4],l[5]),this._drawCachedSceneCanvas(r),r.restore()}else this._drawChildren("drawScene",n,e);return this}drawHit(t,e){if(!this.shouldDrawHit(e))return this;var i=this.getLayer(),n=t||i&&i.hitCanvas,r=n&&n.getContext(),s=this._getCanvasCache();if(s&&s.hit){r.save();var o=this.getAbsoluteTransform(e).getMatrix();r.transform(o[0],o[1],o[2],o[3],o[4],o[5]),this._drawCachedHitCanvas(r),r.restore()}else this._drawChildren("drawHit",n,e);return this}_drawChildren(t,e,i){var n,r=e&&e.getContext(),s=this.clipWidth(),o=this.clipHeight(),a=this.clipFunc(),l=s&&o||a;const h=i===this;if(l){r.save();var c=this.getAbsoluteTransform(i),u=c.getMatrix();if(r.transform(u[0],u[1],u[2],u[3],u[4],u[5]),r.beginPath(),a)a.call(this,r,this);else{var d=this.clipX(),f=this.clipY();r.rect(d,f,s,o)}r.clip(),u=c.copy().invert().getMatrix(),r.transform(u[0],u[1],u[2],u[3],u[4],u[5])}var p=!h&&"source-over"!==this.globalCompositeOperation()&&"drawScene"===t;p&&(r.save(),r._applyGlobalCompositeOperation(this)),null===(n=this.children)||void 0===n||n.forEach((function(n){n[t](e,i)})),p&&r.restore(),l&&r.restore()}getClientRect(t){var e,i,n,r,s,o,a=(t=t||{}).skipTransform,l=t.relativeTo,h=this;null===(e=this.children)||void 0===e||e.forEach((function(e){if(e.visible()){var o=e.getClientRect({relativeTo:h,skipShadow:t.skipShadow,skipStroke:t.skipStroke});0===o.width&&0===o.height||(void 0===i?(i=o.x,n=o.y,r=o.x+o.width,s=o.y+o.height):(i=Math.min(i,o.x),n=Math.min(n,o.y),r=Math.max(r,o.x+o.width),s=Math.max(s,o.y+o.height)))}}));for(var c=this.find("Shape"),u=!1,d=0;d<c.length;d++)if(c[d]._isVisible(this)){u=!0;break}return o=u&&void 0!==i?{x:i,y:n,width:r-i,height:s-n}:{x:0,y:0,width:0,height:0},a?o:this._transformedRect(o,l)}}Vg.addComponentsGetterSetter(bv,"clip",["x","y","width","height"]),Vg.addGetterSetter(bv,"clipX",void 0,Ng()),Vg.addGetterSetter(bv,"clipY",void 0,Ng()),Vg.addGetterSetter(bv,"clipWidth",void 0,Ng()),Vg.addGetterSetter(bv,"clipHeight",void 0,Ng()),Vg.addGetterSetter(bv,"clipFunc");const wv=new Map,_v=void 0!==Cg._global.PointerEvent;function xv(t){return wv.get(t)}function kv(t){return{evt:t,pointerId:t.pointerId}}function Cv(t,e){return wv.get(t)===e}function Sv(t,e){Ev(t),e.getStage()&&(wv.set(t,e),_v&&e._fire("gotpointercapture",kv(new PointerEvent("gotpointercapture"))))}function Ev(t,e){const i=wv.get(t);if(!i)return;const n=i.getStage();n&&n.content,wv.delete(t),_v&&i._fire("lostpointercapture",kv(new PointerEvent("lostpointercapture")))}var Av="mouseleave",Tv="mouseover",Mv="mouseenter",Ov="mousemove",Pv="mousedown",Rv="mouseup",Lv="pointermove",Iv="pointerdown",$v="pointerup",Dv="pointercancel",Nv="pointerout",jv="pointerleave",Bv="pointerover",Fv="pointerenter",zv="contextmenu",Uv="touchstart",Gv="touchend",Hv="touchmove",Vv="touchcancel",qv="wheel",Wv=[[Mv,"_pointerenter"],[Pv,"_pointerdown"],[Ov,"_pointermove"],[Rv,"_pointerup"],[Av,"_pointerleave"],[Uv,"_pointerdown"],[Hv,"_pointermove"],[Gv,"_pointerup"],[Vv,"_pointercancel"],[Tv,"_pointerover"],[qv,"_wheel"],[zv,"_contextmenu"],[Iv,"_pointerdown"],[Lv,"_pointermove"],[$v,"_pointerup"],[Dv,"_pointercancel"],["lostpointercapture","_lostpointercapture"]];const Yv={mouse:{[Nv]:"mouseout",[jv]:Av,[Bv]:Tv,[Fv]:Mv,[Lv]:Ov,[Iv]:Pv,[$v]:Rv,[Dv]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[Nv]:"touchout",[jv]:"touchleave",[Bv]:"touchover",[Fv]:"touchenter",[Lv]:Hv,[Iv]:Uv,[$v]:Gv,[Dv]:Vv,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[Nv]:Nv,[jv]:jv,[Bv]:Bv,[Fv]:Fv,[Lv]:Lv,[Iv]:Iv,[$v]:$v,[Dv]:Dv,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},Xv=t=>t.indexOf("pointer")>=0?"pointer":t.indexOf("touch")>=0?"touch":"mouse",Kv=t=>{const e=Xv(t);return"pointer"===e?Cg.pointerEventsEnabled&&Yv.pointer:"touch"===e?Yv.touch:"mouse"===e?Yv.mouse:void 0};function Qv(t={}){return(t.clipFunc||t.clipWidth||t.clipHeight)&&Ig.warn("Stage does not support clipping. Please use clip for Layers or Groups."),t}const Zv=[];class Jv extends bv{constructor(t){super(Qv(t)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),Zv.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",(()=>{Qv(this.attrs)})),this._checkVisibility()}_validateAdd(t){const e="Layer"===t.getType(),i="FastLayer"===t.getType();e||i||Ig.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const t=this.visible()?"":"none";this.content.style.display=t}setContainer(t){if("string"==typeof t){if("."===t.charAt(0)){var e=t.slice(1);t=document.getElementsByClassName(e)[0]}else{var i;i="#"!==t.charAt(0)?t:t.slice(1),t=document.getElementById(i)}if(!t)throw"Can not find container in document with id "+i}return this._setAttr("container",t),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),t.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){var t,e=this.children,i=e.length;for(t=0;t<i;t++)e[t].clear();return this}clone(t){return t||(t={}),t.container="undefined"!=typeof document&&document.createElement("div"),bv.prototype.clone.call(this,t)}destroy(){super.destroy();var t=this.content;t&&Ig._isInDocument(t)&&this.container().removeChild(t);var e=Zv.indexOf(this);return e>-1&&Zv.splice(e,1),this}getPointerPosition(){const t=this._pointerPositions[0]||this._changedPointerPositions[0];return t?{x:t.x,y:t.y}:(Ig.warn("Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);"),null)}_getPointerById(t){return this._pointerPositions.find((e=>e.id===t))}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(t){(t=t||{}).x=t.x||0,t.y=t.y||0,t.width=t.width||this.width(),t.height=t.height||this.height();var e=new Jg({width:t.width,height:t.height,pixelRatio:t.pixelRatio||1}),i=e.getContext()._context,n=this.children;return(t.x||t.y)&&i.translate(-1*t.x,-1*t.y),n.forEach((function(e){if(e.isVisible()){var n=e._toKonvaCanvas(t);i.drawImage(n._canvas,t.x,t.y,n.getWidth()/n.getPixelRatio(),n.getHeight()/n.getPixelRatio())}})),e}getIntersection(t){if(!t)return null;var e,i=this.children;for(e=i.length-1;e>=0;e--){const n=i[e].getIntersection(t);if(n)return n}return null}_resizeDOM(){var t=this.width(),e=this.height();this.content&&(this.content.style.width=t+"px",this.content.style.height=e+"px"),this.bufferCanvas.setSize(t,e),this.bufferHitCanvas.setSize(t,e),this.children.forEach((i=>{i.setSize({width:t,height:e}),i.draw()}))}add(t,...e){if(arguments.length>1){for(var i=0;i<arguments.length;i++)this.add(arguments[i]);return this}super.add(t);var n=this.children.length;return n>5&&Ig.warn("The stage has "+n+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),t.setSize({width:this.width(),height:this.height()}),t.draw(),Cg.isBrowser&&this.content.appendChild(t.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(t){return Cv(t,this)}setPointerCapture(t){Sv(t,this)}releaseCapture(t){Ev(t)}getLayers(){return this.children}_bindContentEvents(){Cg.isBrowser&&Wv.forEach((([t,e])=>{this.content.addEventListener(t,(t=>{this[e](t)}))}))}_pointerenter(t){this.setPointersPositions(t);const e=Kv(t.type);this._fire(e.pointerenter,{evt:t,target:this,currentTarget:this})}_pointerover(t){this.setPointersPositions(t);const e=Kv(t.type);this._fire(e.pointerover,{evt:t,target:this,currentTarget:this})}_getTargetShape(t){let e=this[t+"targetShape"];return e&&!e.getStage()&&(e=null),e}_pointerleave(t){const e=Kv(t.type),i=Xv(t.type);if(e){this.setPointersPositions(t);var n=this._getTargetShape(i),r=!ev.isDragging||Cg.hitOnDragEnabled;n&&r?(n._fireAndBubble(e.pointerout,{evt:t}),n._fireAndBubble(e.pointerleave,{evt:t}),this._fire(e.pointerleave,{evt:t,target:this,currentTarget:this}),this[i+"targetShape"]=null):r&&(this._fire(e.pointerleave,{evt:t,target:this,currentTarget:this}),this._fire(e.pointerout,{evt:t,target:this,currentTarget:this})),this.pointerPos=void 0,this._pointerPositions=[]}}_pointerdown(t){const e=Kv(t.type),i=Xv(t.type);if(e){this.setPointersPositions(t);var n=!1;this._changedPointerPositions.forEach((r=>{var s=this.getIntersection(r);if(ev.justDragged=!1,Cg["_"+i+"ListenClick"]=!0,!s||!s.isListening())return;Cg.capturePointerEventsEnabled&&s.setPointerCapture(r.id),this[i+"ClickStartShape"]=s,s._fireAndBubble(e.pointerdown,{evt:t,pointerId:r.id}),n=!0;const o=t.type.indexOf("touch")>=0;s.preventDefault()&&t.cancelable&&o&&t.preventDefault()})),n||this._fire(e.pointerdown,{evt:t,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}}_pointermove(t){const e=Kv(t.type),i=Xv(t.type);if(!e)return;if(ev.isDragging&&ev.node.preventDefault()&&t.cancelable&&t.preventDefault(),this.setPointersPositions(t),ev.isDragging&&!Cg.hitOnDragEnabled)return;var n={};let r=!1;var s=this._getTargetShape(i);this._changedPointerPositions.forEach((o=>{const a=xv(o.id)||this.getIntersection(o),l=o.id,h={evt:t,pointerId:l};var c=s!==a;if(c&&s&&(s._fireAndBubble(e.pointerout,Object.assign({},h),a),s._fireAndBubble(e.pointerleave,Object.assign({},h),a)),a){if(n[a._id])return;n[a._id]=!0}a&&a.isListening()?(r=!0,c&&(a._fireAndBubble(e.pointerover,Object.assign({},h),s),a._fireAndBubble(e.pointerenter,Object.assign({},h),s),this[i+"targetShape"]=a),a._fireAndBubble(e.pointermove,Object.assign({},h))):s&&(this._fire(e.pointerover,{evt:t,target:this,currentTarget:this,pointerId:l}),this[i+"targetShape"]=null)})),r||this._fire(e.pointermove,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(t){const e=Kv(t.type),i=Xv(t.type);if(!e)return;this.setPointersPositions(t);const n=this[i+"ClickStartShape"],r=this[i+"ClickEndShape"];var s={};let o=!1;this._changedPointerPositions.forEach((a=>{const l=xv(a.id)||this.getIntersection(a);if(l){if(l.releaseCapture(a.id),s[l._id])return;s[l._id]=!0}const h=a.id,c={evt:t,pointerId:h};let u=!1;Cg["_"+i+"InDblClickWindow"]?(u=!0,clearTimeout(this[i+"DblTimeout"])):ev.justDragged||(Cg["_"+i+"InDblClickWindow"]=!0,clearTimeout(this[i+"DblTimeout"])),this[i+"DblTimeout"]=setTimeout((function(){Cg["_"+i+"InDblClickWindow"]=!1}),Cg.dblClickWindow),l&&l.isListening()?(o=!0,this[i+"ClickEndShape"]=l,l._fireAndBubble(e.pointerup,Object.assign({},c)),Cg["_"+i+"ListenClick"]&&n&&n===l&&(l._fireAndBubble(e.pointerclick,Object.assign({},c)),u&&r&&r===l&&l._fireAndBubble(e.pointerdblclick,Object.assign({},c)))):(this[i+"ClickEndShape"]=null,Cg["_"+i+"ListenClick"]&&this._fire(e.pointerclick,{evt:t,target:this,currentTarget:this,pointerId:h}),u&&this._fire(e.pointerdblclick,{evt:t,target:this,currentTarget:this,pointerId:h}))})),o||this._fire(e.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),Cg["_"+i+"ListenClick"]=!1,t.cancelable&&t.preventDefault()}_contextmenu(t){this.setPointersPositions(t);var e=this.getIntersection(this.getPointerPosition());e&&e.isListening()?e._fireAndBubble(zv,{evt:t}):this._fire(zv,{evt:t,target:this,currentTarget:this})}_wheel(t){this.setPointersPositions(t);var e=this.getIntersection(this.getPointerPosition());e&&e.isListening()?e._fireAndBubble(qv,{evt:t}):this._fire(qv,{evt:t,target:this,currentTarget:this})}_pointercancel(t){this.setPointersPositions(t);const e=xv(t.pointerId)||this.getIntersection(this.getPointerPosition());e&&e._fireAndBubble($v,kv(t)),Ev(t.pointerId)}_lostpointercapture(t){Ev(t.pointerId)}setPointersPositions(t){var e=this._getContentPosition(),i=null,n=null;void 0!==(t=t||window.event).touches?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(t.touches,(t=>{this._pointerPositions.push({id:t.identifier,x:(t.clientX-e.left)/e.scaleX,y:(t.clientY-e.top)/e.scaleY})})),Array.prototype.forEach.call(t.changedTouches||t.touches,(t=>{this._changedPointerPositions.push({id:t.identifier,x:(t.clientX-e.left)/e.scaleX,y:(t.clientY-e.top)/e.scaleY})}))):(i=(t.clientX-e.left)/e.scaleX,n=(t.clientY-e.top)/e.scaleY,this.pointerPos={x:i,y:n},this._pointerPositions=[{x:i,y:n,id:Ig._getFirstPointerId(t)}],this._changedPointerPositions=[{x:i,y:n,id:Ig._getFirstPointerId(t)}])}_setPointerPosition(t){Ig.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(t)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};var t=this.content.getBoundingClientRect();return{top:t.top,left:t.left,scaleX:t.width/this.content.clientWidth||1,scaleY:t.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new Jg({width:this.width(),height:this.height()}),this.bufferHitCanvas=new tv({pixelRatio:1,width:this.width(),height:this.height()}),Cg.isBrowser){var t=this.container();if(!t)throw"Stage has no container. A container is required.";t.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),t.appendChild(this.content),this._resizeDOM()}}cache(){return Ig.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach((function(t){t.batchDraw()})),this}}Jv.prototype.nodeType="Stage",Sg(Jv),Vg.addGetterSetter(Jv,"container");var tm="hasShadow",em="shadowRGBA",im="patternImage",nm="linearGradient",rm="radialGradient";let sm;function om(){return sm||(sm=Ig.createCanvasElement().getContext("2d"),sm)}const am={};class lm extends mv{constructor(t){let e;for(super(t);e=Ig.getRandomColor(),!e||e in am;);this.colorKey=e,am[e]=this}getContext(){return Ig.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return Ig.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(tm,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&0!==this.shadowOpacity()&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(im,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const t=om().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(t&&t.setTransform){const e=new Eg;e.translate(this.fillPatternX(),this.fillPatternY()),e.rotate(Cg.getAngle(this.fillPatternRotation())),e.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),e.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const i=e.getMatrix(),n="undefined"==typeof DOMMatrix?{a:i[0],b:i[1],c:i[2],d:i[3],e:i[4],f:i[5]}:new DOMMatrix(i);t.setTransform(n)}return t}}_getLinearGradient(){return this._getCache(nm,this.__getLinearGradient)}__getLinearGradient(){var t=this.fillLinearGradientColorStops();if(t){for(var e=om(),i=this.fillLinearGradientStartPoint(),n=this.fillLinearGradientEndPoint(),r=e.createLinearGradient(i.x,i.y,n.x,n.y),s=0;s<t.length;s+=2)r.addColorStop(t[s],t[s+1]);return r}}_getRadialGradient(){return this._getCache(rm,this.__getRadialGradient)}__getRadialGradient(){var t=this.fillRadialGradientColorStops();if(t){for(var e=om(),i=this.fillRadialGradientStartPoint(),n=this.fillRadialGradientEndPoint(),r=e.createRadialGradient(i.x,i.y,this.fillRadialGradientStartRadius(),n.x,n.y,this.fillRadialGradientEndRadius()),s=0;s<t.length;s+=2)r.addColorStop(t[s],t[s+1]);return r}}getShadowRGBA(){return this._getCache(em,this._getShadowRGBA)}_getShadowRGBA(){if(this.hasShadow()){var t=Ig.colorToRGBA(this.shadowColor());return"rgba("+t.r+","+t.g+","+t.b+","+t.a*(this.shadowOpacity()||1)+")"}}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],(()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops())))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],(()=>this.strokeEnabled()&&this.strokeWidth()&&!(!this.stroke()&&!this.strokeLinearGradientColorStops())))}hasHitStroke(){const t=this.hitStrokeWidth();return"auto"===t?this.hasStroke():this.strokeEnabled()&&!!t}intersects(t){var e=this.getStage().bufferHitCanvas;return e.getContext().clear(),this.drawHit(e,null,!0),e.context.getImageData(Math.round(t.x),Math.round(t.y),1,1).data[3]>0}destroy(){return mv.prototype.destroy.call(this),delete am[this.colorKey],delete this.colorKey,this}_useBufferCanvas(t){var e;if(!this.getStage())return!1;if(null!==(e=this.attrs.perfectDrawEnabled)&&void 0!==e&&!e)return!1;const i=t||this.hasFill(),n=this.hasStroke(),r=1!==this.getAbsoluteOpacity();if(i&&n&&r)return!0;const s=this.hasShadow(),o=this.shadowForStrokeEnabled();return!!(i&&n&&s&&o)}setStrokeHitEnabled(t){Ig.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),t?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return 0!==this.hitStrokeWidth()}getSelfRect(){var t=this.size();return{x:this._centroid?-t.width/2:0,y:this._centroid?-t.height/2:0,width:t.width,height:t.height}}getClientRect(t={}){const e=t.skipTransform,i=t.relativeTo,n=this.getSelfRect(),r=!t.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,s=n.width+r,o=n.height+r,a=!t.skipShadow&&this.hasShadow(),l=a?this.shadowOffsetX():0,h=a?this.shadowOffsetY():0,c=s+Math.abs(l),u=o+Math.abs(h),d=a&&this.shadowBlur()||0,f={width:c+2*d,height:u+2*d,x:-(r/2+d)+Math.min(l,0)+n.x,y:-(r/2+d)+Math.min(h,0)+n.y};return e?f:this._transformedRect(f,i)}drawScene(t,e){var i,n,r=this.getLayer(),s=t||r.getCanvas(),o=s.getContext(),a=this._getCanvasCache(),l=this.getSceneFunc(),h=this.hasShadow(),c=s.isCache,u=e===this;if(!this.isVisible()&&!u)return this;if(a){o.save();var d=this.getAbsoluteTransform(e).getMatrix();return o.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this._drawCachedSceneCanvas(o),o.restore(),this}if(!l)return this;if(o.save(),this._useBufferCanvas()&&!c){(n=(i=this.getStage().bufferCanvas).getContext()).clear(),n.save(),n._applyLineJoin(this);var f=this.getAbsoluteTransform(e).getMatrix();n.transform(f[0],f[1],f[2],f[3],f[4],f[5]),l.call(this,n,this),n.restore();var p=i.pixelRatio;h&&o._applyShadow(this),o._applyOpacity(this),o._applyGlobalCompositeOperation(this),o.drawImage(i._canvas,0,0,i.width/p,i.height/p)}else o._applyLineJoin(this),u||(f=this.getAbsoluteTransform(e).getMatrix(),o.transform(f[0],f[1],f[2],f[3],f[4],f[5]),o._applyOpacity(this),o._applyGlobalCompositeOperation(this)),h&&o._applyShadow(this),l.call(this,o,this);return o.restore(),this}drawHit(t,e,i=!1){if(!this.shouldDrawHit(e,i))return this;var n=this.getLayer(),r=t||n.hitCanvas,s=r&&r.getContext(),o=this.hitFunc()||this.sceneFunc(),a=this._getCanvasCache(),l=a&&a.hit;if(this.colorKey||Ig.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),l){s.save();var h=this.getAbsoluteTransform(e).getMatrix();return s.transform(h[0],h[1],h[2],h[3],h[4],h[5]),this._drawCachedHitCanvas(s),s.restore(),this}if(!o)return this;if(s.save(),s._applyLineJoin(this),this!==e){var c=this.getAbsoluteTransform(e).getMatrix();s.transform(c[0],c[1],c[2],c[3],c[4],c[5])}return o.call(this,s,this),s.restore(),this}drawHitFromCache(t=0){var e,i,n,r,s,o=this._getCanvasCache(),a=this._getCachedSceneCanvas(),l=o.hit,h=l.getContext(),c=l.getWidth(),u=l.getHeight();h.clear(),h.drawImage(a._canvas,0,0,c,u);try{for(n=(i=(e=h.getImageData(0,0,c,u)).data).length,r=Ig._hexToRgb(this.colorKey),s=0;s<n;s+=4)i[s+3]>t?(i[s]=r.r,i[s+1]=r.g,i[s+2]=r.b,i[s+3]=255):i[s+3]=0;h.putImageData(e,0,0)}catch(t){Ig.error("Unable to draw hit graph from cached scene canvas. "+t.message)}return this}hasPointerCapture(t){return Cv(t,this)}setPointerCapture(t){Sv(t,this)}releaseCapture(t){Ev(t)}}lm.prototype._fillFunc=function(t){t.fill()},lm.prototype._strokeFunc=function(t){t.stroke()},lm.prototype._fillFuncHit=function(t){t.fill()},lm.prototype._strokeFuncHit=function(t){t.stroke()},lm.prototype._centroid=!1,lm.prototype.nodeType="Shape",Sg(lm),lm.prototype.eventListeners={},lm.prototype.on.call(lm.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",(function(){this._clearCache(tm)})),lm.prototype.on.call(lm.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",(function(){this._clearCache(em)})),lm.prototype.on.call(lm.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",(function(){this._clearCache(im)})),lm.prototype.on.call(lm.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",(function(){this._clearCache(nm)})),lm.prototype.on.call(lm.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",(function(){this._clearCache(rm)})),Vg.addGetterSetter(lm,"stroke",void 0,zg()),Vg.addGetterSetter(lm,"strokeWidth",2,Ng()),Vg.addGetterSetter(lm,"fillAfterStrokeEnabled",!1),Vg.addGetterSetter(lm,"hitStrokeWidth","auto",Bg()),Vg.addGetterSetter(lm,"strokeHitEnabled",!0,Ug()),Vg.addGetterSetter(lm,"perfectDrawEnabled",!0,Ug()),Vg.addGetterSetter(lm,"shadowForStrokeEnabled",!0,Ug()),Vg.addGetterSetter(lm,"lineJoin"),Vg.addGetterSetter(lm,"lineCap"),Vg.addGetterSetter(lm,"sceneFunc"),Vg.addGetterSetter(lm,"hitFunc"),Vg.addGetterSetter(lm,"dash"),Vg.addGetterSetter(lm,"dashOffset",0,Ng()),Vg.addGetterSetter(lm,"shadowColor",void 0,Fg()),Vg.addGetterSetter(lm,"shadowBlur",0,Ng()),Vg.addGetterSetter(lm,"shadowOpacity",1,Ng()),Vg.addComponentsGetterSetter(lm,"shadowOffset",["x","y"]),Vg.addGetterSetter(lm,"shadowOffsetX",0,Ng()),Vg.addGetterSetter(lm,"shadowOffsetY",0,Ng()),Vg.addGetterSetter(lm,"fillPatternImage"),Vg.addGetterSetter(lm,"fill",void 0,zg()),Vg.addGetterSetter(lm,"fillPatternX",0,Ng()),Vg.addGetterSetter(lm,"fillPatternY",0,Ng()),Vg.addGetterSetter(lm,"fillLinearGradientColorStops"),Vg.addGetterSetter(lm,"strokeLinearGradientColorStops"),Vg.addGetterSetter(lm,"fillRadialGradientStartRadius",0),Vg.addGetterSetter(lm,"fillRadialGradientEndRadius",0),Vg.addGetterSetter(lm,"fillRadialGradientColorStops"),Vg.addGetterSetter(lm,"fillPatternRepeat","repeat"),Vg.addGetterSetter(lm,"fillEnabled",!0),Vg.addGetterSetter(lm,"strokeEnabled",!0),Vg.addGetterSetter(lm,"shadowEnabled",!0),Vg.addGetterSetter(lm,"dashEnabled",!0),Vg.addGetterSetter(lm,"strokeScaleEnabled",!0),Vg.addGetterSetter(lm,"fillPriority","color"),Vg.addComponentsGetterSetter(lm,"fillPatternOffset",["x","y"]),Vg.addGetterSetter(lm,"fillPatternOffsetX",0,Ng()),Vg.addGetterSetter(lm,"fillPatternOffsetY",0,Ng()),Vg.addComponentsGetterSetter(lm,"fillPatternScale",["x","y"]),Vg.addGetterSetter(lm,"fillPatternScaleX",1,Ng()),Vg.addGetterSetter(lm,"fillPatternScaleY",1,Ng()),Vg.addComponentsGetterSetter(lm,"fillLinearGradientStartPoint",["x","y"]),Vg.addComponentsGetterSetter(lm,"strokeLinearGradientStartPoint",["x","y"]),Vg.addGetterSetter(lm,"fillLinearGradientStartPointX",0),Vg.addGetterSetter(lm,"strokeLinearGradientStartPointX",0),Vg.addGetterSetter(lm,"fillLinearGradientStartPointY",0),Vg.addGetterSetter(lm,"strokeLinearGradientStartPointY",0),Vg.addComponentsGetterSetter(lm,"fillLinearGradientEndPoint",["x","y"]),Vg.addComponentsGetterSetter(lm,"strokeLinearGradientEndPoint",["x","y"]),Vg.addGetterSetter(lm,"fillLinearGradientEndPointX",0),Vg.addGetterSetter(lm,"strokeLinearGradientEndPointX",0),Vg.addGetterSetter(lm,"fillLinearGradientEndPointY",0),Vg.addGetterSetter(lm,"strokeLinearGradientEndPointY",0),Vg.addComponentsGetterSetter(lm,"fillRadialGradientStartPoint",["x","y"]),Vg.addGetterSetter(lm,"fillRadialGradientStartPointX",0),Vg.addGetterSetter(lm,"fillRadialGradientStartPointY",0),Vg.addComponentsGetterSetter(lm,"fillRadialGradientEndPoint",["x","y"]),Vg.addGetterSetter(lm,"fillRadialGradientEndPointX",0),Vg.addGetterSetter(lm,"fillRadialGradientEndPointY",0),Vg.addGetterSetter(lm,"fillPatternRotation",0),Vg.backCompat(lm,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"});var hm=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],cm=hm.length;class um extends bv{constructor(t){super(t),this.canvas=new Jg,this.hitCanvas=new tv({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);var e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),t<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[t+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){mv.prototype.moveToTop.call(this);var t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!mv.prototype.moveUp.call(this))return!1;var t=this.getStage();return!(!t||!t.content||(t.content.removeChild(this.getNativeCanvasElement()),this.index<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[this.index+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement()),0))}moveDown(){if(mv.prototype.moveDown.call(this)){var t=this.getStage();if(t){var e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(mv.prototype.moveToBottom.call(this)){var t=this.getStage();if(t){var e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){var t=this.getNativeCanvasElement();return mv.prototype.remove.call(this),t&&t.parentNode&&Ig._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:e}){return this.canvas.setSize(t,e),this.hitCanvas.setSize(t,e),this._setSmoothEnabled(),this}_validateAdd(t){var e=t.getType();"Group"!==e&&"Shape"!==e&&Ig.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return(t=t||{}).width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=void 0!==t.x?t.x:this.x(),t.y=void 0!==t.y?t.y:this.y(),mv.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){const t=this.visible();this.canvas._canvas.style.display=t?"block":"none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){Ig.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){Ig.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,Ig.requestAnimFrame((()=>{this.draw(),this._waitingForDraw=!1}))),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;for(var e=1,i=!1;;){for(let n=0;n<cm;n++){const r=hm[n],s=this._getIntersection({x:t.x+r.x*e,y:t.y+r.y*e}),o=s.shape;if(o)return o;if(i=!!s.antialiased,!s.antialiased)break}if(!i)return null;e+=1}}_getIntersection(t){const e=this.hitCanvas.pixelRatio,i=this.hitCanvas.context.getImageData(Math.round(t.x*e),Math.round(t.y*e),1,1).data,n=i[3];if(255===n){const t=Ig._rgbToHex(i[0],i[1],i[2]),e=am["#"+t];return e?{shape:e}:{antialiased:!0}}return n>0?{antialiased:!0}:{}}drawScene(t,e){var i=this.getLayer(),n=t||i&&i.getCanvas();return this._fire("beforeDraw",{node:this}),this.clearBeforeDraw()&&n.getContext().clear(),bv.prototype.drawScene.call(this,n,e),this._fire("draw",{node:this}),this}drawHit(t,e){var i=this.getLayer(),n=t||i&&i.hitCanvas;return i&&i.clearBeforeDraw()&&i.getHitCanvas().getContext().clear(),bv.prototype.drawHit.call(this,n,e),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){Ig.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return Ig.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(this.parent&&this.parent.content){var t=this.parent;this.hitCanvas._canvas.parentNode?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}}}um.prototype.nodeType="Layer",Sg(um),Vg.addGetterSetter(um,"imageSmoothingEnabled",!0),Vg.addGetterSetter(um,"clearBeforeDraw",!0),Vg.addGetterSetter(um,"hitGraphEnabled",!0,Ug());class dm extends um{constructor(t){super(t),this.listening(!1),Ig.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}dm.prototype.nodeType="FastLayer",Sg(dm);class fm extends bv{_validateAdd(t){var e=t.getType();"Group"!==e&&"Shape"!==e&&Ig.throw("You may only add groups and shapes to groups.")}}fm.prototype.nodeType="Group",Sg(fm);var pm=kg.performance&&kg.performance.now?function(){return kg.performance.now()}:function(){return(new Date).getTime()};class gm{constructor(t,e){this.id=gm.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:pm(),frameRate:0},this.func=t,this.setLayers(e)}setLayers(t){var e;return e=t?t.length>0?t:[t]:[],this.layers=e,this}getLayers(){return this.layers}addLayer(t){var e,i=this.layers,n=i.length;for(e=0;e<n;e++)if(i[e]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){var t,e=gm.animations,i=e.length;for(t=0;t<i;t++)if(e[t].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=pm(),gm._addAnimation(this),this}stop(){return gm._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){var e,i=t.id,n=this.animations,r=n.length;for(e=0;e<r;e++)if(n[e].id===i){this.animations.splice(e,1);break}}static _runFrames(){var t,e,i,n,r,s,o,a,l={},h=this.animations;for(n=0;n<h.length;n++)if(e=(t=h[n]).layers,i=t.func,t._updateFrameObject(pm()),s=e.length,!i||!1!==i.call(t,t.frame))for(r=0;r<s;r++)void 0!==(o=e[r])._id&&(l[o._id]=o);for(a in l)l.hasOwnProperty(a)&&l[a].batchDraw()}static _animationLoop(){var t=gm;t.animations.length?(t._runFrames(),Ig.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,Ig.requestAnimFrame(this._animationLoop))}}gm.animations=[],gm.animIdCounter=0,gm.animRunning=!1;var vm={node:1,duration:1,easing:1,onFinish:1,yoyo:1},mm=0,ym=["fill","stroke","shadowColor"];class bm{constructor(t,e,i,n,r,s,o){this.prop=t,this.propFunc=e,this.begin=n,this._pos=n,this.duration=s,this._change=0,this.prevPos=0,this.yoyo=o,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=i,this._change=r-this.begin,this.pause()}fire(t){var e=this[t];e&&e()}setTime(t){t>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():t<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=t,this.update())}getTime(){return this._time}setPosition(t){this.prevPos=this._pos,this.propFunc(t),this._pos=t}getPosition(t){return void 0===t&&(t=this._time),this.func(t,this.begin,this._change,this.duration)}play(){this.state=2,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=3,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(t){this.pause(),this._time=t,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){var t=this.getTimer()-this._startTime;2===this.state?this.setTime(t):3===this.state&&this.setTime(this.duration-t)}pause(){this.state=1,this.fire("onPause")}getTimer(){return(new Date).getTime()}}class wm{constructor(t){var e,i,n=this,r=t.node,s=r._id,o=t.easing||_m.Linear,a=!!t.yoyo;e=void 0===t.duration?.3:0===t.duration?.001:t.duration,this.node=r,this._id=mm++;var l=r.getLayer()||(r instanceof Cg.Stage?r.getLayers():null);for(i in l||Ig.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new gm((function(){n.tween.onEnterFrame()}),l),this.tween=new bm(i,(function(t){n._tweenFunc(t)}),o,0,1,1e3*e,a),this._addListeners(),wm.attrs[s]||(wm.attrs[s]={}),wm.attrs[s][this._id]||(wm.attrs[s][this._id]={}),wm.tweens[s]||(wm.tweens[s]={}),t)void 0===vm[i]&&this._addAttr(i,t[i]);this.reset(),this.onFinish=t.onFinish,this.onReset=t.onReset,this.onUpdate=t.onUpdate}_addAttr(t,e){var i,n,r,s,o,a,l,h,c=this.node,u=c._id;if((r=wm.tweens[u][t])&&delete wm.attrs[u][r][t],i=c.getAttr(t),Ig._isArray(e))if(n=[],o=Math.max(e.length,i.length),"points"===t&&e.length!==i.length&&(e.length>i.length?(l=i,i=Ig._prepareArrayForTween(i,e,c.closed())):(a=e,e=Ig._prepareArrayForTween(e,i,c.closed()))),0===t.indexOf("fill"))for(s=0;s<o;s++)if(s%2==0)n.push(e[s]-i[s]);else{var d=Ig.colorToRGBA(i[s]);h=Ig.colorToRGBA(e[s]),i[s]=d,n.push({r:h.r-d.r,g:h.g-d.g,b:h.b-d.b,a:h.a-d.a})}else for(s=0;s<o;s++)n.push(e[s]-i[s]);else-1!==ym.indexOf(t)?(i=Ig.colorToRGBA(i),n={r:(h=Ig.colorToRGBA(e)).r-i.r,g:h.g-i.g,b:h.b-i.b,a:h.a-i.a}):n=e-i;wm.attrs[u][this._id][t]={start:i,diff:n,end:e,trueEnd:a,trueStart:l},wm.tweens[u][t]=this._id}_tweenFunc(t){var e,i,n,r,s,o,a,l,h=this.node,c=wm.attrs[h._id][this._id];for(e in c){if(n=(i=c[e]).start,r=i.diff,l=i.end,Ig._isArray(n))if(s=[],a=Math.max(n.length,l.length),0===e.indexOf("fill"))for(o=0;o<a;o++)o%2==0?s.push((n[o]||0)+r[o]*t):s.push("rgba("+Math.round(n[o].r+r[o].r*t)+","+Math.round(n[o].g+r[o].g*t)+","+Math.round(n[o].b+r[o].b*t)+","+(n[o].a+r[o].a*t)+")");else for(o=0;o<a;o++)s.push((n[o]||0)+r[o]*t);else s=-1!==ym.indexOf(e)?"rgba("+Math.round(n.r+r.r*t)+","+Math.round(n.g+r.g*t)+","+Math.round(n.b+r.b*t)+","+(n.a+r.a*t)+")":n+r*t;h.setAttr(e,s)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{var t=this.node,e=wm.attrs[t._id][this._id];e.points&&e.points.trueEnd&&t.setAttr("points",e.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{var t=this.node,e=wm.attrs[t._id][this._id];e.points&&e.points.trueStart&&t.points(e.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(t){return this.tween.seek(1e3*t),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){var t,e=this.node._id,i=this._id,n=wm.tweens[e];for(t in this.pause(),n)delete wm.tweens[e][t];delete wm.attrs[e][i]}}wm.attrs={},wm.tweens={},mv.prototype.to=function(t){var e=t.onFinish;t.node=this,t.onFinish=function(){this.destroy(),e&&e()},new wm(t).play()};const _m={BackEaseIn(t,e,i,n){var r=1.70158;return i*(t/=n)*t*((r+1)*t-r)+e},BackEaseOut(t,e,i,n){var r=1.70158;return i*((t=t/n-1)*t*((r+1)*t+r)+1)+e},BackEaseInOut(t,e,i,n){var r=1.70158;return(t/=n/2)<1?i/2*(t*t*((1+(r*=1.525))*t-r))+e:i/2*((t-=2)*t*((1+(r*=1.525))*t+r)+2)+e},ElasticEaseIn(t,e,i,n,r,s){var o=0;return 0===t?e:1==(t/=n)?e+i:(s||(s=.3*n),!r||r<Math.abs(i)?(r=i,o=s/4):o=s/(2*Math.PI)*Math.asin(i/r),-r*Math.pow(2,10*(t-=1))*Math.sin((t*n-o)*(2*Math.PI)/s)+e)},ElasticEaseOut(t,e,i,n,r,s){var o=0;return 0===t?e:1==(t/=n)?e+i:(s||(s=.3*n),!r||r<Math.abs(i)?(r=i,o=s/4):o=s/(2*Math.PI)*Math.asin(i/r),r*Math.pow(2,-10*t)*Math.sin((t*n-o)*(2*Math.PI)/s)+i+e)},ElasticEaseInOut(t,e,i,n,r,s){var o=0;return 0===t?e:2==(t/=n/2)?e+i:(s||(s=n*(.3*1.5)),!r||r<Math.abs(i)?(r=i,o=s/4):o=s/(2*Math.PI)*Math.asin(i/r),t<1?r*Math.pow(2,10*(t-=1))*Math.sin((t*n-o)*(2*Math.PI)/s)*-.5+e:r*Math.pow(2,-10*(t-=1))*Math.sin((t*n-o)*(2*Math.PI)/s)*.5+i+e)},BounceEaseOut:(t,e,i,n)=>(t/=n)<1/2.75?i*(7.5625*t*t)+e:t<2/2.75?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e,BounceEaseIn:(t,e,i,n)=>i-_m.BounceEaseOut(n-t,0,i,n)+e,BounceEaseInOut:(t,e,i,n)=>t<n/2?.5*_m.BounceEaseIn(2*t,0,i,n)+e:.5*_m.BounceEaseOut(2*t-n,0,i,n)+.5*i+e,EaseIn:(t,e,i,n)=>i*(t/=n)*t+e,EaseOut:(t,e,i,n)=>-i*(t/=n)*(t-2)+e,EaseInOut:(t,e,i,n)=>(t/=n/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e,StrongEaseIn:(t,e,i,n)=>i*(t/=n)*t*t*t*t+e,StrongEaseOut:(t,e,i,n)=>i*((t=t/n-1)*t*t*t*t+1)+e,StrongEaseInOut:(t,e,i,n)=>(t/=n/2)<1?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e,Linear:(t,e,i,n)=>i*t/n+e},xm=Ig._assign(Cg,{Util:Ig,Transform:Eg,Node:mv,Container:bv,Stage:Jv,stages:Zv,Layer:um,FastLayer:dm,Group:fm,DD:ev,Shape:lm,shapes:am,Animation:gm,Tween:wm,Easings:_m,Context:Xg,Canvas:Zg});class km extends lm{_sceneFunc(t){var e=Cg.getAngle(this.angle()),i=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,e,i),t.arc(0,0,this.innerRadius(),e,0,!i),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.outerRadius()}getHeight(){return 2*this.outerRadius()}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){const t=this.innerRadius(),e=this.outerRadius(),i=this.clockwise(),n=Cg.getAngle(i?360-this.angle():this.angle()),r=Math.cos(Math.min(n,Math.PI)),s=Math.sin(Math.min(Math.max(Math.PI,n),3*Math.PI/2)),o=Math.sin(Math.min(n,Math.PI/2)),a=r*(r>0?t:e),l=s*(s>0?t:e),h=o*(o>0?e:t);return{x:a,y:i?-1*h:l,width:1*e-a,height:h-l}}}function Cm(t,e,i,n,r,s,o){var a=Math.sqrt(Math.pow(i-t,2)+Math.pow(n-e,2)),l=Math.sqrt(Math.pow(r-i,2)+Math.pow(s-n,2)),h=o*a/(a+l),c=o*l/(a+l);return[i-h*(r-t),n-h*(s-e),i+c*(r-t),n+c*(s-e)]}function Sm(t,e){var i,n,r=t.length,s=[];for(i=2;i<r-2;i+=2)n=Cm(t[i-2],t[i-1],t[i],t[i+1],t[i+2],t[i+3],e),isNaN(n[0])||(s.push(n[0]),s.push(n[1]),s.push(t[i]),s.push(t[i+1]),s.push(n[2]),s.push(n[3]));return s}km.prototype._centroid=!0,km.prototype.className="Arc",km.prototype._attrsAffectingSize=["innerRadius","outerRadius"],Sg(km),Vg.addGetterSetter(km,"innerRadius",0,Ng()),Vg.addGetterSetter(km,"outerRadius",0,Ng()),Vg.addGetterSetter(km,"angle",0,Ng()),Vg.addGetterSetter(km,"clockwise",!1,Ug());class Em extends lm{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",(function(){this._clearCache("tensionPoints")}))}_sceneFunc(t){var e,i,n,r=this.points(),s=r.length,o=this.tension(),a=this.closed(),l=this.bezier();if(s){if(t.beginPath(),t.moveTo(r[0],r[1]),0!==o&&s>4){for(i=(e=this.getTensionPoints()).length,n=a?0:4,a||t.quadraticCurveTo(e[0],e[1],e[2],e[3]);n<i-2;)t.bezierCurveTo(e[n++],e[n++],e[n++],e[n++],e[n++],e[n++]);a||t.quadraticCurveTo(e[i-2],e[i-1],r[s-2],r[s-1])}else if(l)for(n=2;n<s;)t.bezierCurveTo(r[n++],r[n++],r[n++],r[n++],r[n++],r[n++]);else for(n=2;n<s;n+=2)t.lineTo(r[n],r[n+1]);a?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():Sm(this.points(),this.tension())}_getTensionPointsClosed(){var t=this.points(),e=t.length,i=this.tension(),n=Cm(t[e-2],t[e-1],t[0],t[1],t[2],t[3],i),r=Cm(t[e-4],t[e-3],t[e-2],t[e-1],t[0],t[1],i),s=Sm(t,i);return[n[2],n[3]].concat(s).concat([r[0],r[1],t[e-2],t[e-1],r[2],r[3],n[0],n[1],t[0],t[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){var t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};for(var e,i,n=(t=0!==this.tension()?[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:this.points())[0],r=t[0],s=t[1],o=t[1],a=0;a<t.length/2;a++)e=t[2*a],i=t[2*a+1],n=Math.min(n,e),r=Math.max(r,e),s=Math.min(s,i),o=Math.max(o,i);return{x:n,y:s,width:r-n,height:o-s}}}Em.prototype.className="Line",Em.prototype._attrsAffectingSize=["points","bezier","tension"],Sg(Em),Vg.addGetterSetter(Em,"closed",!1),Vg.addGetterSetter(Em,"bezier",!1),Vg.addGetterSetter(Em,"tension",0,Ng()),Vg.addGetterSetter(Em,"points",[],function(){if(Cg.isUnminified)return function(t,e){return Ig._isArray(t)?t.forEach((function(t){Ig._isNumber(t)||Ig.warn('"'+e+'" attribute has non numeric element '+t+". Make sure that all elements are numbers.")})):Ig.warn($g(t)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.'),t}}());class Am extends lm{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this.dataArray=Am.parsePathData(this.data()),this.pathLength=0;for(var e=0;e<this.dataArray.length;++e)this.pathLength+=this.dataArray[e].pathLength;this.on("dataChange.konva",(function(){this.dataArray=Am.parsePathData(this.data()),this.pathLength=0;for(var t=0;t<this.dataArray.length;++t)this.pathLength+=this.dataArray[t].pathLength}))}_sceneFunc(t){var e=this.dataArray;t.beginPath();for(var i=!1,n=0;n<e.length;n++){var r=e[n].command,s=e[n].points;switch(r){case"L":t.lineTo(s[0],s[1]);break;case"M":t.moveTo(s[0],s[1]);break;case"C":t.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5]);break;case"Q":t.quadraticCurveTo(s[0],s[1],s[2],s[3]);break;case"A":var o=s[0],a=s[1],l=s[2],h=s[3],c=s[4],u=s[5],d=s[6],f=s[7],p=l>h?l:h,g=l>h?1:l/h,v=l>h?h/l:1;t.translate(o,a),t.rotate(d),t.scale(g,v),t.arc(0,0,p,c,c+u,1-f),t.scale(1/g,1/v),t.rotate(-d),t.translate(-o,-a);break;case"z":i=!0,t.closePath()}}i||this.hasFill()?t.fillStrokeShape(this):t.strokeShape(this)}getSelfRect(){var t=[];this.dataArray.forEach((function(e){if("A"===e.command){var i=e.points[4],n=e.points[5],r=e.points[4]+n,s=Math.PI/180;if(Math.abs(i-r)<s&&(s=Math.abs(i-r)),n<0)for(let n=i-s;n>r;n-=s){const i=Am.getPointOnEllipticalArc(e.points[0],e.points[1],e.points[2],e.points[3],n,0);t.push(i.x,i.y)}else for(let n=i+s;n<r;n+=s){const i=Am.getPointOnEllipticalArc(e.points[0],e.points[1],e.points[2],e.points[3],n,0);t.push(i.x,i.y)}}else if("C"===e.command)for(let i=0;i<=1;i+=.01){const n=Am.getPointOnCubicBezier(i,e.start.x,e.start.y,e.points[0],e.points[1],e.points[2],e.points[3],e.points[4],e.points[5]);t.push(n.x,n.y)}else t=t.concat(e.points)}));for(var e,i,n=t[0],r=t[0],s=t[1],o=t[1],a=0;a<t.length/2;a++)e=t[2*a],i=t[2*a+1],isNaN(e)||(n=Math.min(n,e),r=Math.max(r,e)),isNaN(i)||(s=Math.min(s,i),o=Math.max(o,i));return{x:n,y:s,width:r-n,height:o-s}}getLength(){return this.pathLength}getPointAtLength(t){var e,i=0,n=this.dataArray.length;if(!n)return null;for(;i<n&&t>this.dataArray[i].pathLength;)t-=this.dataArray[i].pathLength,++i;if(i===n)return{x:(e=this.dataArray[i-1].points.slice(-2))[0],y:e[1]};if(t<.01)return{x:(e=this.dataArray[i].points.slice(0,2))[0],y:e[1]};var r=this.dataArray[i],s=r.points;switch(r.command){case"L":return Am.getPointOnLine(t,r.start.x,r.start.y,s[0],s[1]);case"C":return Am.getPointOnCubicBezier(t/r.pathLength,r.start.x,r.start.y,s[0],s[1],s[2],s[3],s[4],s[5]);case"Q":return Am.getPointOnQuadraticBezier(t/r.pathLength,r.start.x,r.start.y,s[0],s[1],s[2],s[3]);case"A":var o=s[0],a=s[1],l=s[2],h=s[3],c=s[4],u=s[5],d=s[6];return c+=u*t/r.pathLength,Am.getPointOnEllipticalArc(o,a,l,h,c,d)}return null}static getLineLength(t,e,i,n){return Math.sqrt((i-t)*(i-t)+(n-e)*(n-e))}static getPointOnLine(t,e,i,n,r,s,o){void 0===s&&(s=e),void 0===o&&(o=i);var a=(r-i)/(n-e+1e-8),l=Math.sqrt(t*t/(1+a*a));n<e&&(l*=-1);var h,c=a*l;if(n===e)h={x:s,y:o+c};else if((o-i)/(s-e+1e-8)===a)h={x:s+l,y:o+c};else{var u,d,f=this.getLineLength(e,i,n,r),p=(s-e)*(n-e)+(o-i)*(r-i);u=e+(p/=f*f)*(n-e),d=i+p*(r-i);var g=this.getLineLength(s,o,u,d),v=Math.sqrt(t*t-g*g);l=Math.sqrt(v*v/(1+a*a)),n<e&&(l*=-1),h={x:u+l,y:d+(c=a*l)}}return h}static getPointOnCubicBezier(t,e,i,n,r,s,o,a,l){function h(t){return t*t*t}function c(t){return 3*t*t*(1-t)}function u(t){return 3*t*(1-t)*(1-t)}function d(t){return(1-t)*(1-t)*(1-t)}return{x:a*h(t)+s*c(t)+n*u(t)+e*d(t),y:l*h(t)+o*c(t)+r*u(t)+i*d(t)}}static getPointOnQuadraticBezier(t,e,i,n,r,s,o){function a(t){return t*t}function l(t){return 2*t*(1-t)}function h(t){return(1-t)*(1-t)}return{x:s*a(t)+n*l(t)+e*h(t),y:o*a(t)+r*l(t)+i*h(t)}}static getPointOnEllipticalArc(t,e,i,n,r,s){var o=Math.cos(s),a=Math.sin(s),l=i*Math.cos(r),h=n*Math.sin(r);return{x:t+(l*o-h*a),y:e+(l*a+h*o)}}static parsePathData(t){if(!t)return[];var e=t,i=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];e=e.replace(new RegExp(" ","g"),",");for(var n=0;n<i.length;n++)e=e.replace(new RegExp(i[n],"g"),"|"+i[n]);var r,s=e.split("|"),o=[],a=[],l=0,h=0,c=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;for(n=1;n<s.length;n++){var u=s[n],d=u.charAt(0);for(u=u.slice(1),a.length=0;r=c.exec(u);)a.push(r[0]);for(var f=[],p=0,g=a.length;p<g;p++)if("00"!==a[p]){var v=parseFloat(a[p]);isNaN(v)?f.push(0):f.push(v)}else f.push(0,0);for(;f.length>0&&!isNaN(f[0]);){var m,y,b,w,_,x,k,C,S,E,A=null,T=[],M=l,O=h;switch(d){case"l":l+=f.shift(),h+=f.shift(),A="L",T.push(l,h);break;case"L":l=f.shift(),h=f.shift(),T.push(l,h);break;case"m":var P=f.shift(),R=f.shift();if(l+=P,h+=R,A="M",o.length>2&&"z"===o[o.length-1].command)for(var L=o.length-2;L>=0;L--)if("M"===o[L].command){l=o[L].points[0]+P,h=o[L].points[1]+R;break}T.push(l,h),d="l";break;case"M":l=f.shift(),h=f.shift(),A="M",T.push(l,h),d="L";break;case"h":l+=f.shift(),A="L",T.push(l,h);break;case"H":l=f.shift(),A="L",T.push(l,h);break;case"v":h+=f.shift(),A="L",T.push(l,h);break;case"V":h=f.shift(),A="L",T.push(l,h);break;case"C":T.push(f.shift(),f.shift(),f.shift(),f.shift()),l=f.shift(),h=f.shift(),T.push(l,h);break;case"c":T.push(l+f.shift(),h+f.shift(),l+f.shift(),h+f.shift()),l+=f.shift(),h+=f.shift(),A="C",T.push(l,h);break;case"S":y=l,b=h,"C"===(m=o[o.length-1]).command&&(y=l+(l-m.points[2]),b=h+(h-m.points[3])),T.push(y,b,f.shift(),f.shift()),l=f.shift(),h=f.shift(),A="C",T.push(l,h);break;case"s":y=l,b=h,"C"===(m=o[o.length-1]).command&&(y=l+(l-m.points[2]),b=h+(h-m.points[3])),T.push(y,b,l+f.shift(),h+f.shift()),l+=f.shift(),h+=f.shift(),A="C",T.push(l,h);break;case"Q":T.push(f.shift(),f.shift()),l=f.shift(),h=f.shift(),T.push(l,h);break;case"q":T.push(l+f.shift(),h+f.shift()),l+=f.shift(),h+=f.shift(),A="Q",T.push(l,h);break;case"T":y=l,b=h,"Q"===(m=o[o.length-1]).command&&(y=l+(l-m.points[0]),b=h+(h-m.points[1])),l=f.shift(),h=f.shift(),A="Q",T.push(y,b,l,h);break;case"t":y=l,b=h,"Q"===(m=o[o.length-1]).command&&(y=l+(l-m.points[0]),b=h+(h-m.points[1])),l+=f.shift(),h+=f.shift(),A="Q",T.push(y,b,l,h);break;case"A":w=f.shift(),_=f.shift(),x=f.shift(),k=f.shift(),C=f.shift(),S=l,E=h,l=f.shift(),h=f.shift(),A="A",T=this.convertEndpointToCenterParameterization(S,E,l,h,k,C,w,_,x);break;case"a":w=f.shift(),_=f.shift(),x=f.shift(),k=f.shift(),C=f.shift(),S=l,E=h,l+=f.shift(),h+=f.shift(),A="A",T=this.convertEndpointToCenterParameterization(S,E,l,h,k,C,w,_,x)}o.push({command:A||d,points:T,start:{x:M,y:O},pathLength:this.calcLength(M,O,A||d,T)})}"z"!==d&&"Z"!==d||o.push({command:"z",points:[],start:void 0,pathLength:0})}return o}static calcLength(t,e,i,n){var r,s,o,a,l=Am;switch(i){case"L":return l.getLineLength(t,e,n[0],n[1]);case"C":for(r=0,s=l.getPointOnCubicBezier(0,t,e,n[0],n[1],n[2],n[3],n[4],n[5]),a=.01;a<=1;a+=.01)o=l.getPointOnCubicBezier(a,t,e,n[0],n[1],n[2],n[3],n[4],n[5]),r+=l.getLineLength(s.x,s.y,o.x,o.y),s=o;return r;case"Q":for(r=0,s=l.getPointOnQuadraticBezier(0,t,e,n[0],n[1],n[2],n[3]),a=.01;a<=1;a+=.01)o=l.getPointOnQuadraticBezier(a,t,e,n[0],n[1],n[2],n[3]),r+=l.getLineLength(s.x,s.y,o.x,o.y),s=o;return r;case"A":r=0;var h=n[4],c=n[5],u=n[4]+c,d=Math.PI/180;if(Math.abs(h-u)<d&&(d=Math.abs(h-u)),s=l.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],h,0),c<0)for(a=h-d;a>u;a-=d)o=l.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],a,0),r+=l.getLineLength(s.x,s.y,o.x,o.y),s=o;else for(a=h+d;a<u;a+=d)o=l.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],a,0),r+=l.getLineLength(s.x,s.y,o.x,o.y),s=o;return o=l.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],u,0),r+l.getLineLength(s.x,s.y,o.x,o.y)}return 0}static convertEndpointToCenterParameterization(t,e,i,n,r,s,o,a,l){var h=l*(Math.PI/180),c=Math.cos(h)*(t-i)/2+Math.sin(h)*(e-n)/2,u=-1*Math.sin(h)*(t-i)/2+Math.cos(h)*(e-n)/2,d=c*c/(o*o)+u*u/(a*a);d>1&&(o*=Math.sqrt(d),a*=Math.sqrt(d));var f=Math.sqrt((o*o*(a*a)-o*o*(u*u)-a*a*(c*c))/(o*o*(u*u)+a*a*(c*c)));r===s&&(f*=-1),isNaN(f)&&(f=0);var p=f*o*u/a,g=f*-a*c/o,v=(t+i)/2+Math.cos(h)*p-Math.sin(h)*g,m=(e+n)/2+Math.sin(h)*p+Math.cos(h)*g,y=function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])},b=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(y(t)*y(e))},w=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(b(t,e))},_=w([1,0],[(c-p)/o,(u-g)/a]),x=[(c-p)/o,(u-g)/a],k=[(-1*c-p)/o,(-1*u-g)/a],C=w(x,k);return b(x,k)<=-1&&(C=Math.PI),b(x,k)>=1&&(C=0),0===s&&C>0&&(C-=2*Math.PI),1===s&&C<0&&(C+=2*Math.PI),[v,m,o,a,_,C,h,s]}}Am.prototype.className="Path",Am.prototype._attrsAffectingSize=["data"],Sg(Am),Vg.addGetterSetter(Am,"data");class Tm extends Em{_sceneFunc(t){super._sceneFunc(t);var e=2*Math.PI,i=this.points(),n=i,r=0!==this.tension()&&i.length>4;r&&(n=this.getTensionPoints());var s,o,a=this.pointerLength(),l=i.length;if(r){const t=[n[n.length-4],n[n.length-3],n[n.length-2],n[n.length-1],i[l-2],i[l-1]],e=Am.calcLength(n[n.length-4],n[n.length-3],"C",t),r=Am.getPointOnQuadraticBezier(Math.min(1,1-a/e),t[0],t[1],t[2],t[3],t[4],t[5]);s=i[l-2]-r.x,o=i[l-1]-r.y}else s=i[l-2]-i[l-4],o=i[l-1]-i[l-3];var h=(Math.atan2(o,s)+e)%e,c=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(i[l-2],i[l-1]),t.rotate(h),t.moveTo(0,0),t.lineTo(-a,c/2),t.lineTo(-a,-c/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(i[0],i[1]),r?(s=(n[0]+n[2])/2-i[0],o=(n[1]+n[3])/2-i[1]):(s=i[2]-i[0],o=i[3]-i[1]),t.rotate((Math.atan2(-o,-s)+e)%e),t.moveTo(0,0),t.lineTo(-a,c/2),t.lineTo(-a,-c/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){var e=this.dashEnabled();e&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),e&&(this.attrs.dashEnabled=!0)}getSelfRect(){const t=super.getSelfRect(),e=this.pointerWidth()/2;return{x:t.x-e,y:t.y-e,width:t.width+2*e,height:t.height+2*e}}}Tm.prototype.className="Arrow",Sg(Tm),Vg.addGetterSetter(Tm,"pointerLength",10,Ng()),Vg.addGetterSetter(Tm,"pointerWidth",10,Ng()),Vg.addGetterSetter(Tm,"pointerAtBeginning",!1),Vg.addGetterSetter(Tm,"pointerAtEnding",!0);class Mm extends lm{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,2*Math.PI,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.radius()}getHeight(){return 2*this.radius()}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}}Mm.prototype._centroid=!0,Mm.prototype.className="Circle",Mm.prototype._attrsAffectingSize=["radius"],Sg(Mm),Vg.addGetterSetter(Mm,"radius",0,Ng());class Om extends lm{_sceneFunc(t){var e=this.radiusX(),i=this.radiusY();t.beginPath(),t.save(),e!==i&&t.scale(1,i/e),t.arc(0,0,e,0,2*Math.PI,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.radiusX()}getHeight(){return 2*this.radiusY()}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}}Om.prototype.className="Ellipse",Om.prototype._centroid=!0,Om.prototype._attrsAffectingSize=["radiusX","radiusY"],Sg(Om),Vg.addComponentsGetterSetter(Om,"radius",["x","y"]),Vg.addGetterSetter(Om,"radiusX",0,Ng()),Vg.addGetterSetter(Om,"radiusY",0,Ng());class Pm extends lm{constructor(t){super(t),this.on("imageChange.konva",(()=>{this._setImageLoad()})),this._setImageLoad()}_setImageLoad(){const t=this.image();t&&t.complete||t&&4===t.readyState||t&&t.addEventListener&&t.addEventListener("load",(()=>{this._requestDraw()}))}_useBufferCanvas(){return super._useBufferCanvas(!0)}_sceneFunc(t){const e=this.getWidth(),i=this.getHeight(),n=this.attrs.image;let r;if(n){const t=this.attrs.cropWidth,s=this.attrs.cropHeight;r=t&&s?[n,this.cropX(),this.cropY(),t,s,0,0,e,i]:[n,0,0,e,i]}(this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,e,i),t.closePath(),t.fillStrokeShape(this)),n&&t.drawImage.apply(t,r)}_hitFunc(t){var e=this.width(),i=this.height();t.beginPath(),t.rect(0,0,e,i),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,e;return null!==(t=this.attrs.width)&&void 0!==t?t:null===(e=this.image())||void 0===e?void 0:e.width}getHeight(){var t,e;return null!==(t=this.attrs.height)&&void 0!==t?t:null===(e=this.image())||void 0===e?void 0:e.height}static fromURL(t,e,i=null){var n=Ig.createImageElement();n.onload=function(){var t=new Pm({image:n});e(t)},n.onerror=i,n.crossOrigin="Anonymous",n.src=t}}Pm.prototype.className="Image",Sg(Pm),Vg.addGetterSetter(Pm,"image"),Vg.addComponentsGetterSetter(Pm,"crop",["x","y","width","height"]),Vg.addGetterSetter(Pm,"cropX",0,Ng()),Vg.addGetterSetter(Pm,"cropY",0,Ng()),Vg.addGetterSetter(Pm,"cropWidth",0,Ng()),Vg.addGetterSetter(Pm,"cropHeight",0,Ng());var Rm=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height"],Lm="up",Im="right",$m="down",Dm="left",Nm=Rm.length;class jm extends fm{constructor(t){super(t),this.on("add.konva",(function(t){this._addListeners(t.child),this._sync()}))}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){var e,i=this,n=function(){i._sync()};for(e=0;e<Nm;e++)t.on(Rm[e]+"Change.konva",n)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){var t,e,i,n,r,s,o,a=this.getText(),l=this.getTag();if(a&&l){switch(t=a.width(),e=a.height(),i=l.pointerDirection(),n=l.pointerWidth(),o=l.pointerHeight(),r=0,s=0,i){case Lm:r=t/2,s=-1*o;break;case Im:r=t+n,s=e/2;break;case $m:r=t/2,s=e+o;break;case Dm:r=-1*n,s=e/2}l.setAttrs({x:-1*r,y:-1*s,width:t,height:e}),a.setAttrs({x:-1*r,y:-1*s})}}}jm.prototype.className="Label",Sg(jm);class Bm extends lm{_sceneFunc(t){var e=this.width(),i=this.height(),n=this.pointerDirection(),r=this.pointerWidth(),s=this.pointerHeight(),o=this.cornerRadius();let a=0,l=0,h=0,c=0;"number"==typeof o?a=l=h=c=Math.min(o,e/2,i/2):(a=Math.min(o[0]||0,e/2,i/2),l=Math.min(o[1]||0,e/2,i/2),c=Math.min(o[2]||0,e/2,i/2),h=Math.min(o[3]||0,e/2,i/2)),t.beginPath(),t.moveTo(a,0),n===Lm&&(t.lineTo((e-r)/2,0),t.lineTo(e/2,-1*s),t.lineTo((e+r)/2,0)),t.lineTo(e-l,0),t.arc(e-l,l,l,3*Math.PI/2,0,!1),n===Im&&(t.lineTo(e,(i-s)/2),t.lineTo(e+r,i/2),t.lineTo(e,(i+s)/2)),t.lineTo(e,i-c),t.arc(e-c,i-c,c,0,Math.PI/2,!1),n===$m&&(t.lineTo((e+r)/2,i),t.lineTo(e/2,i+s),t.lineTo((e-r)/2,i)),t.lineTo(h,i),t.arc(h,i-h,h,Math.PI/2,Math.PI,!1),n===Dm&&(t.lineTo(0,(i+s)/2),t.lineTo(-1*r,i/2),t.lineTo(0,(i-s)/2)),t.lineTo(0,a),t.arc(a,a,a,Math.PI,3*Math.PI/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){var t=0,e=0,i=this.pointerWidth(),n=this.pointerHeight(),r=this.pointerDirection(),s=this.width(),o=this.height();return r===Lm?(e-=n,o+=n):r===$m?o+=n:r===Dm?(t-=1.5*i,s+=i):r===Im&&(s+=1.5*i),{x:t,y:e,width:s,height:o}}}Bm.prototype.className="Tag",Sg(Bm),Vg.addGetterSetter(Bm,"pointerDirection","none"),Vg.addGetterSetter(Bm,"pointerWidth",0,Ng()),Vg.addGetterSetter(Bm,"pointerHeight",0,Ng()),Vg.addGetterSetter(Bm,"cornerRadius",0,jg(4));class Fm extends lm{_sceneFunc(t){var e=this.cornerRadius(),i=this.width(),n=this.height();if(t.beginPath(),e){let r=0,s=0,o=0,a=0;"number"==typeof e?r=s=o=a=Math.min(e,i/2,n/2):(r=Math.min(e[0]||0,i/2,n/2),s=Math.min(e[1]||0,i/2,n/2),a=Math.min(e[2]||0,i/2,n/2),o=Math.min(e[3]||0,i/2,n/2)),t.moveTo(r,0),t.lineTo(i-s,0),t.arc(i-s,s,s,3*Math.PI/2,0,!1),t.lineTo(i,n-a),t.arc(i-a,n-a,a,0,Math.PI/2,!1),t.lineTo(o,n),t.arc(o,n-o,o,Math.PI/2,Math.PI,!1),t.lineTo(0,r),t.arc(r,r,r,Math.PI,3*Math.PI/2,!1)}else t.rect(0,0,i,n);t.closePath(),t.fillStrokeShape(this)}}Fm.prototype.className="Rect",Sg(Fm),Vg.addGetterSetter(Fm,"cornerRadius",0,jg(4));class zm extends lm{_sceneFunc(t){const e=this._getPoints();t.beginPath(),t.moveTo(e[0].x,e[0].y);for(var i=1;i<e.length;i++)t.lineTo(e[i].x,e[i].y);t.closePath(),t.fillStrokeShape(this)}_getPoints(){const t=this.attrs.sides,e=this.attrs.radius||0,i=[];for(var n=0;n<t;n++)i.push({x:e*Math.sin(2*n*Math.PI/t),y:-1*e*Math.cos(2*n*Math.PI/t)});return i}getSelfRect(){const t=this._getPoints();var e=t[0].x,i=t[0].y,n=t[0].x,r=t[0].y;return t.forEach((t=>{e=Math.min(e,t.x),i=Math.max(i,t.x),n=Math.min(n,t.y),r=Math.max(r,t.y)})),{x:e,y:n,width:i-e,height:r-n}}getWidth(){return 2*this.radius()}getHeight(){return 2*this.radius()}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}zm.prototype.className="RegularPolygon",zm.prototype._centroid=!0,zm.prototype._attrsAffectingSize=["radius"],Sg(zm),Vg.addGetterSetter(zm,"radius",0,Ng()),Vg.addGetterSetter(zm,"sides",0,Ng());var Um=2*Math.PI;class Gm extends lm{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,Um,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),Um,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.outerRadius()}getHeight(){return 2*this.outerRadius()}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}Gm.prototype.className="Ring",Gm.prototype._centroid=!0,Gm.prototype._attrsAffectingSize=["innerRadius","outerRadius"],Sg(Gm),Vg.addGetterSetter(Gm,"innerRadius",0,Ng()),Vg.addGetterSetter(Gm,"outerRadius",0,Ng());class Hm extends lm{constructor(t){super(t),this._updated=!0,this.anim=new gm((()=>{var t=this._updated;return this._updated=!1,t})),this.on("animationChange.konva",(function(){this.frameIndex(0)})),this.on("frameIndexChange.konva",(function(){this._updated=!0})),this.on("frameRateChange.konva",(function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())}))}_sceneFunc(t){var e=this.animation(),i=this.frameIndex(),n=4*i,r=this.animations()[e],s=this.frameOffsets(),o=r[n+0],a=r[n+1],l=r[n+2],h=r[n+3],c=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,l,h),t.closePath(),t.fillStrokeShape(this)),c)if(s){var u=s[e],d=2*i;t.drawImage(c,o,a,l,h,u[d+0],u[d+1],l,h)}else t.drawImage(c,o,a,l,h,0,0,l,h)}_hitFunc(t){var e=this.animation(),i=this.frameIndex(),n=4*i,r=this.animations()[e],s=this.frameOffsets(),o=r[n+2],a=r[n+3];if(t.beginPath(),s){var l=s[e],h=2*i;t.rect(l[h+0],l[h+1],o,a)}else t.rect(0,0,o,a);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){var t=this;this.interval=setInterval((function(){t._updateIndex()}),1e3/this.frameRate())}start(){if(!this.isRunning()){var t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){var t=this.frameIndex(),e=this.animation();t<this.animations()[e].length/4-1?this.frameIndex(t+1):this.frameIndex(0)}}Hm.prototype.className="Sprite",Sg(Hm),Vg.addGetterSetter(Hm,"animation"),Vg.addGetterSetter(Hm,"animations"),Vg.addGetterSetter(Hm,"frameOffsets"),Vg.addGetterSetter(Hm,"image"),Vg.addGetterSetter(Hm,"frameIndex",0,Ng()),Vg.addGetterSetter(Hm,"frameRate",17,Ng()),Vg.backCompat(Hm,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});class Vm extends lm{_sceneFunc(t){var e=this.innerRadius(),i=this.outerRadius(),n=this.numPoints();t.beginPath(),t.moveTo(0,0-i);for(var r=1;r<2*n;r++){var s=r%2==0?i:e,o=s*Math.sin(r*Math.PI/n),a=-1*s*Math.cos(r*Math.PI/n);t.lineTo(o,a)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.outerRadius()}getHeight(){return 2*this.outerRadius()}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}function qm(t){return Array.from(t)}Vm.prototype.className="Star",Vm.prototype._centroid=!0,Vm.prototype._attrsAffectingSize=["innerRadius","outerRadius"],Sg(Vm),Vg.addGetterSetter(Vm,"numPoints",5,Ng()),Vg.addGetterSetter(Vm,"innerRadius",0,Ng()),Vg.addGetterSetter(Vm,"outerRadius",0,Ng());var Wm,Ym="auto",Xm="justify",Km="left",Qm="middle",Zm="normal",Jm=" ",ty=["fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],ey=ty.length;function iy(){return Wm||(Wm=Ig.createCanvasElement().getContext("2d"))}class ny extends lm{constructor(t){super(function(t){return(t=t||{}).fillLinearGradientColorStops||t.fillRadialGradientColorStops||t.fillPatternImage||(t.fill=t.fill||"black"),t}(t)),this._partialTextX=0,this._partialTextY=0;for(var e=0;e<ey;e++)this.on(ty[e]+"Change.konva",this._setTextData);this._setTextData()}_sceneFunc(t){var e=this.textArr,i=e.length;if(this.text()){var n,r=this.padding(),s=this.fontSize(),o=this.lineHeight()*s,a=this.verticalAlign(),l=0,h=this.align(),c=this.getWidth(),u=this.letterSpacing(),d=this.fill(),f=this.textDecoration(),p=-1!==f.indexOf("underline"),g=-1!==f.indexOf("line-through"),v=0,m=(v=o/2,0),y=0;for(t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",Qm),t.setAttr("textAlign",Km),a===Qm?l=(this.getHeight()-i*o-2*r)/2:"bottom"===a&&(l=this.getHeight()-i*o-2*r),t.translate(r,l+r),n=0;n<i;n++){m=0,y=0;var b,w,_,x=e[n],k=x.text,C=x.width,S=x.lastInParagraph;if(t.save(),"right"===h?m+=c-C-2*r:"center"===h&&(m+=(c-C-2*r)/2),p&&(t.save(),t.beginPath(),t.moveTo(m,v+y+Math.round(s/2)),w=0==(b=k.split(" ").length-1),_=h===Xm&&S&&!w?c-2*r:C,t.lineTo(m+Math.round(_),v+y+Math.round(s/2)),t.lineWidth=s/15,t.strokeStyle=d,t.stroke(),t.restore()),g&&(t.save(),t.beginPath(),t.moveTo(m,v+y),w=0==(b=k.split(" ").length-1),_=h===Xm&&S&&!w?c-2*r:C,t.lineTo(m+Math.round(_),v+y),t.lineWidth=s/15,t.strokeStyle=d,t.stroke(),t.restore()),0!==u||h===Xm){b=k.split(" ").length-1;for(var E=qm(k),A=0;A<E.length;A++){var T=E[A];" "!==T||S||h!==Xm||(m+=(c-2*r-C)/b),this._partialTextX=m,this._partialTextY=v+y,this._partialText=T,t.fillStrokeShape(this),m+=this.measureSize(T).width+u}}else this._partialTextX=m,this._partialTextY=v+y,this._partialText=k,t.fillStrokeShape(this);t.restore(),i>1&&(v+=o)}}}_hitFunc(t){var e=this.getWidth(),i=this.getHeight();t.beginPath(),t.rect(0,0,e,i),t.closePath(),t.fillStrokeShape(this)}setText(t){var e=Ig._isString(t)?t:null==t?"":t+"";return this._setAttr("text",e),this}getWidth(){return this.attrs.width===Ym||void 0===this.attrs.width?this.getTextWidth()+2*this.padding():this.attrs.width}getHeight(){return this.attrs.height===Ym||void 0===this.attrs.height?this.fontSize()*this.textArr.length*this.lineHeight()+2*this.padding():this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return Ig.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var e,i=iy(),n=this.fontSize();return i.save(),i.font=this._getContextFont(),e=i.measureText(t),i.restore(),{width:e.width,height:n}}_getContextFont(){return this.fontStyle()+Jm+this.fontVariant()+Jm+(this.fontSize()+"px ")+this.fontFamily().split(",").map((t=>{const e=(t=t.trim()).indexOf(" ")>=0,i=t.indexOf('"')>=0||t.indexOf("'")>=0;return e&&!i&&(t=`"${t}"`),t})).join(", ")}_addTextLine(t){this.align()===Xm&&(t=t.trim());var e=this._getTextWidth(t);return this.textArr.push({text:t,width:e,lastInParagraph:!1})}_getTextWidth(t){var e=this.letterSpacing(),i=t.length;return iy().measureText(t).width+(i?e*(i-1):0)}_setTextData(){var t=this.text().split("\n"),e=+this.fontSize(),i=0,n=this.lineHeight()*e,r=this.attrs.width,s=this.attrs.height,o=r!==Ym&&void 0!==r,a=s!==Ym&&void 0!==s,l=this.padding(),h=r-2*l,c=s-2*l,u=0,d=this.wrap(),f="none"!==d,p="char"!==d&&f,g=this.ellipsis();this.textArr=[],iy().font=this._getContextFont();for(var v=g?this._getTextWidth("…"):0,m=0,y=t.length;m<y;++m){var b=t[m],w=this._getTextWidth(b);if(o&&w>h)for(;b.length>0;){for(var _=0,x=b.length,k="",C=0;_<x;){var S=_+x>>>1,E=b.slice(0,S+1),A=this._getTextWidth(E)+v;A<=h?(_=S+1,k=E,C=A):x=S}if(!k)break;if(p){var T,M=b[k.length];(T=(M===Jm||"-"===M)&&C<=h?k.length:Math.max(k.lastIndexOf(Jm),k.lastIndexOf("-"))+1)>0&&(_=T,k=k.slice(0,_),C=this._getTextWidth(k))}if(k=k.trimRight(),this._addTextLine(k),i=Math.max(i,C),u+=n,!f||a&&u+n>c){var O=this.textArr[this.textArr.length-1];O&&g&&(this._getTextWidth(O.text+"…")<h||(O.text=O.text.slice(0,O.text.length-3)),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(O.text+"…"));break}if((b=(b=b.slice(_)).trimLeft()).length>0&&(w=this._getTextWidth(b))<=h){this._addTextLine(b),u+=n,i=Math.max(i,w);break}}else this._addTextLine(b),u+=n,i=Math.max(i,w);if(a&&u+n>c)break;this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0)}this.textHeight=e,this.textWidth=i}getStrokeScaleEnabled(){return!0}}ny.prototype._fillFunc=function(t){t.fillText(this._partialText,this._partialTextX,this._partialTextY)},ny.prototype._strokeFunc=function(t){t.strokeText(this._partialText,this._partialTextX,this._partialTextY)},ny.prototype.className="Text",ny.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],Sg(ny),Vg.overWriteSetter(ny,"width",Bg()),Vg.overWriteSetter(ny,"height",Bg()),Vg.addGetterSetter(ny,"fontFamily","Arial"),Vg.addGetterSetter(ny,"fontSize",12,Ng()),Vg.addGetterSetter(ny,"fontStyle",Zm),Vg.addGetterSetter(ny,"fontVariant",Zm),Vg.addGetterSetter(ny,"padding",0,Ng()),Vg.addGetterSetter(ny,"align",Km),Vg.addGetterSetter(ny,"verticalAlign","top"),Vg.addGetterSetter(ny,"lineHeight",1,Ng()),Vg.addGetterSetter(ny,"wrap","word"),Vg.addGetterSetter(ny,"ellipsis",!1,Ug()),Vg.addGetterSetter(ny,"letterSpacing",0,Ng()),Vg.addGetterSetter(ny,"text","",Fg()),Vg.addGetterSetter(ny,"textDecoration","");var ry="normal";function sy(t){t.fillText(this.partialText,0,0)}function oy(t){t.strokeText(this.partialText,0,0)}class ay extends lm{constructor(t){super(t),this.dummyCanvas=Ig.createCanvasElement(),this.dataArray=[],this.dataArray=Am.parsePathData(this.attrs.data),this.on("dataChange.konva",(function(){this.dataArray=Am.parsePathData(this.attrs.data),this._setTextData()})),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();var e=this.textDecoration(),i=this.fill(),n=this.fontSize(),r=this.glyphInfo;"underline"===e&&t.beginPath();for(var s=0;s<r.length;s++){t.save();var o=r[s].p0;t.translate(o.x,o.y),t.rotate(r[s].rotation),this.partialText=r[s].text,t.fillStrokeShape(this),"underline"===e&&(0===s&&t.moveTo(0,n/2+1),t.lineTo(n,n/2+1)),t.restore()}"underline"===e&&(t.strokeStyle=i,t.lineWidth=n/20,t.stroke()),t.restore()}_hitFunc(t){t.beginPath();var e=this.glyphInfo;if(e.length>=1){var i=e[0].p0;t.moveTo(i.x,i.y)}for(var n=0;n<e.length;n++){var r=e[n].p1;t.lineTo(r.x,r.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return Ig.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return ny.prototype.setText.call(this,t)}_getContextFont(){return ny.prototype._getContextFont.call(this)}_getTextSize(t){var e=this.dummyCanvas.getContext("2d");e.save(),e.font=this._getContextFont();var i=e.measureText(t);return e.restore(),{width:i.width,height:parseInt(this.attrs.fontSize,10)}}_setTextData(){var t=this,e=this._getTextSize(this.attrs.text),i=this.letterSpacing(),n=this.align(),r=this.kerningFunc();this.textWidth=e.width,this.textHeight=e.height;var s=Math.max(this.textWidth+((this.attrs.text||"").length-1)*i,0);this.glyphInfo=[];for(var o=0,a=0;a<t.dataArray.length;a++)t.dataArray[a].pathLength>0&&(o+=t.dataArray[a].pathLength);var l=0;"center"===n&&(l=Math.max(0,o/2-s/2)),"right"===n&&(l=Math.max(0,o-s));for(var h,c,u,d=qm(this.text()),f=this.text().split(" ").length-1,p=-1,g=0,v=function(){g=0;for(var e=t.dataArray,i=p+1;i<e.length;i++){if(e[i].pathLength>0)return p=i,e[i];"M"===e[i].command&&(h={x:e[i].points[0],y:e[i].points[1]})}return{}},m=function(e){var r=t._getTextSize(e).width+i;" "===e&&"justify"===n&&(r+=(o-s)/f);var a=0,l=0;for(c=void 0;Math.abs(r-a)/r>.01&&l<20;){l++;for(var d=a;void 0===u;)(u=v())&&d+u.pathLength<r&&(d+=u.pathLength,u=void 0);if(u==={}||void 0===h)return;var p=!1;switch(u.command){case"L":Am.getLineLength(h.x,h.y,u.points[0],u.points[1])>r?c=Am.getPointOnLine(r,h.x,h.y,u.points[0],u.points[1],h.x,h.y):u=void 0;break;case"A":var m=u.points[4],y=u.points[5],b=u.points[4]+y;0===g?g=m+1e-8:r>a?g+=Math.PI/180*y/Math.abs(y):g-=Math.PI/360*y/Math.abs(y),(y<0&&g<b||y>=0&&g>b)&&(g=b,p=!0),c=Am.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],g,u.points[6]);break;case"C":0===g?g=r>u.pathLength?1e-8:r/u.pathLength:r>a?g+=(r-a)/u.pathLength/2:g=Math.max(g-(a-r)/u.pathLength/2,0),g>1&&(g=1,p=!0),c=Am.getPointOnCubicBezier(g,u.start.x,u.start.y,u.points[0],u.points[1],u.points[2],u.points[3],u.points[4],u.points[5]);break;case"Q":0===g?g=r/u.pathLength:r>a?g+=(r-a)/u.pathLength:g-=(a-r)/u.pathLength,g>1&&(g=1,p=!0),c=Am.getPointOnQuadraticBezier(g,u.start.x,u.start.y,u.points[0],u.points[1],u.points[2],u.points[3])}void 0!==c&&(a=Am.getLineLength(h.x,h.y,c.x,c.y)),p&&(p=!1,u=void 0)}},y=l/(t._getTextSize("C").width+i)-1,b=0;b<y&&(m("C"),void 0!==h&&void 0!==c);b++)h=c;for(var w=0;w<d.length&&(m(d[w]),void 0!==h&&void 0!==c);w++){var _=Am.getLineLength(h.x,h.y,c.x,c.y),x=0;if(r)try{x=r(d[w-1],d[w])*this.fontSize()}catch(t){x=0}h.x+=x,c.x+=x,this.textWidth+=x;var k=Am.getPointOnLine(x+_/2,h.x,h.y,c.x,c.y),C=Math.atan2(c.y-h.y,c.x-h.x);this.glyphInfo.push({transposeX:k.x,transposeY:k.y,text:d[w],rotation:C,p0:h,p1:c}),h=c}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};var t=[];this.glyphInfo.forEach((function(e){t.push(e.p0.x),t.push(e.p0.y),t.push(e.p1.x),t.push(e.p1.y)}));for(var e,i,n=t[0]||0,r=t[0]||0,s=t[1]||0,o=t[1]||0,a=0;a<t.length/2;a++)e=t[2*a],i=t[2*a+1],n=Math.min(n,e),r=Math.max(r,e),s=Math.min(s,i),o=Math.max(o,i);var l=this.fontSize();return{x:n-l/2,y:s-l/2,width:r-n+l,height:o-s+l}}}ay.prototype._fillFunc=sy,ay.prototype._strokeFunc=oy,ay.prototype._fillFuncHit=sy,ay.prototype._strokeFuncHit=oy,ay.prototype.className="TextPath",ay.prototype._attrsAffectingSize=["text","fontSize","data"],Sg(ay),Vg.addGetterSetter(ay,"data"),Vg.addGetterSetter(ay,"fontFamily","Arial"),Vg.addGetterSetter(ay,"fontSize",12,Ng()),Vg.addGetterSetter(ay,"fontStyle",ry),Vg.addGetterSetter(ay,"align","left"),Vg.addGetterSetter(ay,"letterSpacing",0,Ng()),Vg.addGetterSetter(ay,"textBaseline","middle"),Vg.addGetterSetter(ay,"fontVariant",ry),Vg.addGetterSetter(ay,"text",""),Vg.addGetterSetter(ay,"textDecoration",null),Vg.addGetterSetter(ay,"kerningFunc",null);var ly=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange"].map((t=>t+".tr-konva")).join(" "),hy="nodesRect",cy=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],uy={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135};const dy="ontouchstart"in Cg._global;var fy=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function py(t,e,i){const n=i.x+(t.x-i.x)*Math.cos(e)-(t.y-i.y)*Math.sin(e),r=i.y+(t.x-i.x)*Math.sin(e)+(t.y-i.y)*Math.cos(e);return Object.assign(Object.assign({},t),{rotation:t.rotation+e,x:n,y:r})}class gy extends fm{constructor(t){super(t),this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(ly,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return Ig.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return"tr-konva"+this._id}setNodes(t=[]){return this._nodes&&this._nodes.length&&this.detach(),this._nodes=t,1===t.length&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach((t=>{const e=()=>{1===this.nodes().length&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),this._transforming||this.isDragging()||this.update()},i=t._attrsAffectingSize.map((t=>t+"Change."+this._getEventNamespace())).join(" ");t.on(i,e),t.on(cy.map((t=>t+`.${this._getEventNamespace()}`)).join(" "),e),t.on(`absoluteTransformChange.${this._getEventNamespace()}`,e),this._proxyDrag(t)})),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(t){let e;t.on(`dragstart.${this._getEventNamespace()}`,(i=>{e=t.getAbsolutePosition(),this.isDragging()||t===this.findOne(".back")||this.startDrag(i,!1)})),t.on(`dragmove.${this._getEventNamespace()}`,(i=>{if(!e)return;const n=t.getAbsolutePosition(),r=n.x-e.x,s=n.y-e.y;this.nodes().forEach((e=>{if(e===t)return;if(e.isDragging())return;const n=e.getAbsolutePosition();e.setAbsolutePosition({x:n.x+r,y:n.y+s}),e.startDrag(i)})),e=null}))}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach((t=>{t.off("."+this._getEventNamespace())})),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(hy),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(hy,this.__getNodeRect)}__getNodeShape(t,e=this.rotation(),i){var n=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),r=t.getAbsoluteScale(i),s=t.getAbsolutePosition(i),o=n.x*r.x-t.offsetX()*r.x,a=n.y*r.y-t.offsetY()*r.y;const l=(Cg.getAngle(t.getAbsoluteRotation())+2*Math.PI)%(2*Math.PI);return py({x:s.x+o*Math.cos(l)+a*Math.sin(-l),y:s.y+a*Math.cos(l)+o*Math.sin(l),width:n.width*r.x,height:n.height*r.y,rotation:l},-Cg.getAngle(e),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const t=[];this.nodes().map((e=>{const i=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()});var n=[{x:i.x,y:i.y},{x:i.x+i.width,y:i.y},{x:i.x+i.width,y:i.y+i.height},{x:i.x,y:i.y+i.height}],r=e.getAbsoluteTransform();n.forEach((function(e){var i=r.point(e);t.push(i)}))}));const e=new Eg;var i,n,r,s;e.rotate(-Cg.getAngle(this.rotation())),t.forEach((function(t){var o=e.point(t);void 0===i&&(i=r=o.x,n=s=o.y),i=Math.min(i,o.x),n=Math.min(n,o.y),r=Math.max(r,o.x),s=Math.max(s,o.y)})),e.invert();const o=e.point({x:i,y:n});return{x:o.x,y:o.y,width:r-i,height:s-n,rotation:Cg.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),fy.forEach(function(t){this._createAnchor(t)}.bind(this)),this._createAnchor("rotater")}_createAnchor(t){var e=new Fm({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:dy?10:"auto"}),i=this;e.on("mousedown touchstart",(function(t){i._handleMouseDown(t)})),e.on("dragstart",(t=>{e.stopDrag(),t.cancelBubble=!0})),e.on("dragend",(t=>{t.cancelBubble=!0})),e.on("mouseenter",(()=>{var i=Cg.getAngle(this.rotation()),n=function(t,e){if("rotater"===t)return"crosshair";e+=Ig.degToRad(uy[t]||0);var i=(Ig.radToDeg(e)%360+360)%360;return Ig._inRange(i,337.5,360)||Ig._inRange(i,0,22.5)?"ns-resize":Ig._inRange(i,22.5,67.5)?"nesw-resize":Ig._inRange(i,67.5,112.5)?"ew-resize":Ig._inRange(i,112.5,157.5)?"nwse-resize":Ig._inRange(i,157.5,202.5)?"ns-resize":Ig._inRange(i,202.5,247.5)?"nesw-resize":Ig._inRange(i,247.5,292.5)?"ew-resize":Ig._inRange(i,292.5,337.5)?"nwse-resize":(Ig.error("Transformer has unknown angle for cursor detection: "+i),"pointer")}(t,i);e.getStage().content&&(e.getStage().content.style.cursor=n),this._cursorChange=!0})),e.on("mouseout",(()=>{e.getStage().content&&(e.getStage().content.style.cursor=""),this._cursorChange=!1})),this.add(e)}_createBack(){var t=new lm({name:"back",width:0,height:0,draggable:!0,sceneFunc(t){var e=this.getParent(),i=e.padding();t.beginPath(),t.rect(-i,-i,this.width()+2*i,this.height()+2*i),t.moveTo(this.width()/2,-i),e.rotateEnabled()&&t.lineTo(this.width()/2,-e.rotateAnchorOffset()*Ig._sign(this.height())-i),t.fillStrokeShape(this)},hitFunc:(t,e)=>{if(this.shouldOverdrawWholeArea()){var i=this.padding();t.beginPath(),t.rect(-i,-i,e.width()+2*i,e.height()+2*i),t.fillStrokeShape(e)}}});this.add(t),this._proxyDrag(t),t.on("dragstart",(t=>{t.cancelBubble=!0})),t.on("dragmove",(t=>{t.cancelBubble=!0})),t.on("dragend",(t=>{t.cancelBubble=!0})),this.on("dragmove",(t=>{this.update()}))}_handleMouseDown(t){this._movingAnchorName=t.target.name().split(" ")[0];var e=this._getNodeRect(),i=e.width,n=e.height,r=Math.sqrt(Math.pow(i,2)+Math.pow(n,2));this.sin=Math.abs(n/r),this.cos=Math.abs(i/r),"undefined"!=typeof window&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;var s=t.target.getAbsolutePosition(),o=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:o.x-s.x,y:o.y-s.y},this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach((e=>{e._fire("transformstart",{evt:t.evt,target:e})}))}_handleMouseMove(t){var e,i,n,r=this.findOne("."+this._movingAnchorName),s=r.getStage();s.setPointersPositions(t);const o=s.getPointerPosition();let a={x:o.x-this._anchorDragOffset.x,y:o.y-this._anchorDragOffset.y};const l=r.getAbsolutePosition();this.anchorDragBoundFunc()&&(a=this.anchorDragBoundFunc()(l,a,t)),r.setAbsolutePosition(a);const h=r.getAbsolutePosition();if(l.x!==h.x||l.y!==h.y)if("rotater"!==this._movingAnchorName){var c=this.keepRatio()||t.shiftKey,u=this.centeredScaling()||t.altKey;if("top-left"===this._movingAnchorName){if(c){var d=u?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};n=Math.sqrt(Math.pow(d.x-r.x(),2)+Math.pow(d.y-r.y(),2));var f=this.findOne(".top-left").x()>d.x?-1:1,p=this.findOne(".top-left").y()>d.y?-1:1;e=n*this.cos*f,i=n*this.sin*p,this.findOne(".top-left").x(d.x-e),this.findOne(".top-left").y(d.y-i)}}else if("top-center"===this._movingAnchorName)this.findOne(".top-left").y(r.y());else if("top-right"===this._movingAnchorName){c&&(d=u?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()},n=Math.sqrt(Math.pow(r.x()-d.x,2)+Math.pow(d.y-r.y(),2)),f=this.findOne(".top-right").x()<d.x?-1:1,p=this.findOne(".top-right").y()>d.y?-1:1,e=n*this.cos*f,i=n*this.sin*p,this.findOne(".top-right").x(d.x+e),this.findOne(".top-right").y(d.y-i));var g=r.position();this.findOne(".top-left").y(g.y),this.findOne(".bottom-right").x(g.x)}else"middle-left"===this._movingAnchorName?this.findOne(".top-left").x(r.x()):"middle-right"===this._movingAnchorName?this.findOne(".bottom-right").x(r.x()):"bottom-left"===this._movingAnchorName?(c&&(d=u?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()},n=Math.sqrt(Math.pow(d.x-r.x(),2)+Math.pow(r.y()-d.y,2)),f=d.x<r.x()?-1:1,p=r.y()<d.y?-1:1,e=n*this.cos*f,i=n*this.sin*p,r.x(d.x-e),r.y(d.y+i)),g=r.position(),this.findOne(".top-left").x(g.x),this.findOne(".bottom-right").y(g.y)):"bottom-center"===this._movingAnchorName?this.findOne(".bottom-right").y(r.y()):"bottom-right"===this._movingAnchorName?c&&(d=u?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()},n=Math.sqrt(Math.pow(r.x()-d.x,2)+Math.pow(r.y()-d.y,2)),f=this.findOne(".bottom-right").x()<d.x?-1:1,p=this.findOne(".bottom-right").y()<d.y?-1:1,e=n*this.cos*f,i=n*this.sin*p,this.findOne(".bottom-right").x(d.x+e),this.findOne(".bottom-right").y(d.y+i)):console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(u=this.centeredScaling()||t.altKey){var v=this.findOne(".top-left"),m=this.findOne(".bottom-right"),y=v.x(),b=v.y(),w=this.getWidth()-m.x(),_=this.getHeight()-m.y();m.move({x:-y,y:-b}),v.move({x:w,y:_})}var x=this.findOne(".top-left").getAbsolutePosition();e=x.x,i=x.y;var k=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),C=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:e,y:i,width:k,height:C,rotation:Cg.getAngle(this.rotation())},t)}else{var S=this._getNodeRect();e=r.x()-S.width/2,i=-r.y()+S.height/2;let n=Math.atan2(-i,e)+Math.PI/2;S.height<0&&(n-=Math.PI);const s=Cg.getAngle(this.rotation())+n,o=Cg.getAngle(this.rotationSnapTolerance()),a=function(t,e,i){let n=e;for(let r=0;r<t.length;r++){const s=Cg.getAngle(t[r]),o=Math.abs(s-e)%(2*Math.PI);Math.min(o,2*Math.PI-o)<i&&(n=s)}return n}(this.rotationSnaps(),s,o),l=function(t,e){const i=function(t){return{x:t.x+t.width/2*Math.cos(t.rotation)+t.height/2*Math.sin(-t.rotation),y:t.y+t.height/2*Math.cos(t.rotation)+t.width/2*Math.sin(t.rotation)}}(t);return py(t,e,i)}(S,a-S.rotation);this._fitNodesInto(l,t)}}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){if(this._transforming){this._transforming=!1,"undefined"!=typeof window&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));var e=this.getNode();this._fire("transformend",{evt:t,target:e}),e&&this._nodes.forEach((e=>{e._fire("transformend",{evt:t,target:e})})),this._movingAnchorName=null}}_fitNodesInto(t,e){var i=this._getNodeRect();if(Ig._inRange(t.width,2*-this.padding()-1,1))return void this.update();if(Ig._inRange(t.height,2*-this.padding()-1,1))return void this.update();const n=this.flipEnabled();var r=new Eg;if(r.rotate(Cg.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){const e=r.point({x:2*-this.padding(),y:0});if(t.x+=e.x,t.y+=e.y,t.width+=2*this.padding(),this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=e.x,this._anchorDragOffset.y-=e.y,!n)return void this.update()}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){const e=r.point({x:2*this.padding(),y:0});if(this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=e.x,this._anchorDragOffset.y-=e.y,t.width+=2*this.padding(),!n)return void this.update()}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){const e=r.point({x:0,y:2*-this.padding()});if(t.x+=e.x,t.y+=e.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=e.x,this._anchorDragOffset.y-=e.y,t.height+=2*this.padding(),!n)return void this.update()}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const e=r.point({x:0,y:2*this.padding()});if(this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=e.x,this._anchorDragOffset.y-=e.y,t.height+=2*this.padding(),!n)return void this.update()}if(this.boundBoxFunc()){const e=this.boundBoxFunc()(i,t);e?t=e:Ig.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const s=1e7,o=new Eg;o.translate(i.x,i.y),o.rotate(i.rotation),o.scale(i.width/s,i.height/s);const a=new Eg;a.translate(t.x,t.y),a.rotate(t.rotation),a.scale(t.width/s,t.height/s);const l=a.multiply(o.invert());this._nodes.forEach((t=>{var i;const n=t.getParent().getAbsoluteTransform(),r=t.getTransform().copy();r.translate(t.offsetX(),t.offsetY());const s=new Eg;s.multiply(n.copy().invert()).multiply(l).multiply(n).multiply(r);const o=s.decompose();t.setAttrs(o),this._fire("transform",{evt:e,target:t}),t._fire("transform",{evt:e,target:t}),null===(i=t.getLayer())||void 0===i||i.batchDraw()})),this.rotation(Ig._getRotation(t.rotation)),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,e){this.findOne(t).setAttrs(e)}update(){var t,e=this._getNodeRect();this.rotation(Ig._getRotation(e.rotation));var i=e.width,n=e.height,r=this.enabledAnchors(),s=this.resizeEnabled(),o=this.padding(),a=this.anchorSize();this.find("._anchor").forEach((t=>{t.setAttrs({width:a,height:a,offsetX:a/2,offsetY:a/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})})),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:a/2+o,offsetY:a/2+o,visible:s&&r.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:i/2,y:0,offsetY:a/2+o,visible:s&&r.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:i,y:0,offsetX:a/2-o,offsetY:a/2+o,visible:s&&r.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:n/2,offsetX:a/2+o,visible:s&&r.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:i,y:n/2,offsetX:a/2-o,visible:s&&r.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:n,offsetX:a/2+o,offsetY:a/2-o,visible:s&&r.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:i/2,y:n,offsetY:a/2-o,visible:s&&r.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:i,y:n,offsetX:a/2-o,offsetY:a/2-o,visible:s&&r.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:i/2,y:-this.rotateAnchorOffset()*Ig._sign(n)-o,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:i,height:n,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0}),null===(t=this.getLayer())||void 0===t||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();var t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),fm.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return mv.prototype.toObject.call(this)}}gy.prototype.className="Transformer",Sg(gy),Vg.addGetterSetter(gy,"enabledAnchors",fy,(function(t){return t instanceof Array||Ig.warn("enabledAnchors value should be an array"),t instanceof Array&&t.forEach((function(t){-1===fy.indexOf(t)&&Ig.warn("Unknown anchor name: "+t+". Available names are: "+fy.join(", "))})),t||[]})),Vg.addGetterSetter(gy,"flipEnabled",!0,Ug()),Vg.addGetterSetter(gy,"resizeEnabled",!0),Vg.addGetterSetter(gy,"anchorSize",10,Ng()),Vg.addGetterSetter(gy,"rotateEnabled",!0),Vg.addGetterSetter(gy,"rotationSnaps",[]),Vg.addGetterSetter(gy,"rotateAnchorOffset",50,Ng()),Vg.addGetterSetter(gy,"rotationSnapTolerance",5,Ng()),Vg.addGetterSetter(gy,"borderEnabled",!0),Vg.addGetterSetter(gy,"anchorStroke","rgb(0, 161, 255)"),Vg.addGetterSetter(gy,"anchorStrokeWidth",1,Ng()),Vg.addGetterSetter(gy,"anchorFill","white"),Vg.addGetterSetter(gy,"anchorCornerRadius",0,Ng()),Vg.addGetterSetter(gy,"borderStroke","rgb(0, 161, 255)"),Vg.addGetterSetter(gy,"borderStrokeWidth",1,Ng()),Vg.addGetterSetter(gy,"borderDash"),Vg.addGetterSetter(gy,"keepRatio",!0),Vg.addGetterSetter(gy,"centeredScaling",!1),Vg.addGetterSetter(gy,"ignoreStroke",!1),Vg.addGetterSetter(gy,"padding",0,Ng()),Vg.addGetterSetter(gy,"node"),Vg.addGetterSetter(gy,"nodes"),Vg.addGetterSetter(gy,"boundBoxFunc"),Vg.addGetterSetter(gy,"anchorDragBoundFunc"),Vg.addGetterSetter(gy,"shouldOverdrawWholeArea",!1),Vg.addGetterSetter(gy,"useSingleNodeRotation",!0),Vg.backCompat(gy,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});class vy extends lm{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,Cg.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.radius()}getHeight(){return 2*this.radius()}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}function my(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}vy.prototype.className="Wedge",vy.prototype._centroid=!0,vy.prototype._attrsAffectingSize=["radius"],Sg(vy),Vg.addGetterSetter(vy,"radius",0,Ng()),Vg.addGetterSetter(vy,"angle",0,Ng()),Vg.addGetterSetter(vy,"clockwise",!1),Vg.backCompat(vy,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var yy=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],by=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function wy(t,e,i,n,r){var s=i-e,o=r-n;return 0===s?n+o/2:0===o?n:o*((t-e)/s)+n}function _y(t,e,i){var n=4*(i*t.width+e),r=[];return r.push(t.data[n++],t.data[n++],t.data[n++],t.data[n++]),r}function xy(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))}Vg.addGetterSetter(mv,"blurRadius",0,Ng(),Vg.afterSetFilter),Vg.addGetterSetter(mv,"brightness",0,Ng(),Vg.afterSetFilter),Vg.addGetterSetter(mv,"contrast",0,Ng(),Vg.afterSetFilter),Vg.addGetterSetter(mv,"embossStrength",.5,Ng(),Vg.afterSetFilter),Vg.addGetterSetter(mv,"embossWhiteLevel",.5,Ng(),Vg.afterSetFilter),Vg.addGetterSetter(mv,"embossDirection","top-left",null,Vg.afterSetFilter),Vg.addGetterSetter(mv,"embossBlend",!1,null,Vg.afterSetFilter),Vg.addGetterSetter(mv,"enhance",0,Ng(),Vg.afterSetFilter),Vg.addGetterSetter(mv,"hue",0,Ng(),Vg.afterSetFilter),Vg.addGetterSetter(mv,"saturation",0,Ng(),Vg.afterSetFilter),Vg.addGetterSetter(mv,"luminance",0,Ng(),Vg.afterSetFilter),Vg.addGetterSetter(mv,"hue",0,Ng(),Vg.afterSetFilter),Vg.addGetterSetter(mv,"saturation",0,Ng(),Vg.afterSetFilter),Vg.addGetterSetter(mv,"value",0,Ng(),Vg.afterSetFilter),Vg.addGetterSetter(mv,"kaleidoscopePower",2,Ng(),Vg.afterSetFilter),Vg.addGetterSetter(mv,"kaleidoscopeAngle",0,Ng(),Vg.afterSetFilter),Vg.addGetterSetter(mv,"threshold",0,Ng(),Vg.afterSetFilter),Vg.addGetterSetter(mv,"noise",.2,Ng(),Vg.afterSetFilter),Vg.addGetterSetter(mv,"pixelSize",8,Ng(),Vg.afterSetFilter),Vg.addGetterSetter(mv,"levels",.5,Ng(),Vg.afterSetFilter),Vg.addGetterSetter(mv,"red",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),Vg.addGetterSetter(mv,"green",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),Vg.addGetterSetter(mv,"blue",0,Dg,Vg.afterSetFilter),Vg.addGetterSetter(mv,"red",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),Vg.addGetterSetter(mv,"green",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),Vg.addGetterSetter(mv,"blue",0,Dg,Vg.afterSetFilter),Vg.addGetterSetter(mv,"alpha",1,(function(t){return this._filterUpToDate=!1,t>1?1:t<0?0:t})),Vg.addGetterSetter(mv,"threshold",.5,Ng(),Vg.afterSetFilter);const ky=xm.Util._assign(xm,{Arc:km,Arrow:Tm,Circle:Mm,Ellipse:Om,Image:Pm,Label:jm,Tag:Bm,Line:Em,Path:Am,Rect:Fm,RegularPolygon:zm,Ring:Gm,Sprite:Hm,Star:Vm,Text:ny,TextPath:ay,Transformer:gy,Wedge:vy,Filters:{Blur:function(t){var e=Math.round(this.blurRadius());e>0&&function(t,e){var i,n,r,s,o,a,l,h,c,u,d,f,p,g,v,m,y,b,w,_,x,k,C,S,E=t.data,A=t.width,T=t.height,M=e+e+1,O=A-1,P=T-1,R=e+1,L=R*(R+1)/2,I=new my,$=null,D=I,N=null,j=null,B=yy[e],F=by[e];for(r=1;r<M;r++)D=D.next=new my,r===R&&($=D);for(D.next=I,l=a=0,n=0;n<T;n++){for(m=y=b=w=h=c=u=d=0,f=R*(_=E[a]),p=R*(x=E[a+1]),g=R*(k=E[a+2]),v=R*(C=E[a+3]),h+=L*_,c+=L*x,u+=L*k,d+=L*C,D=I,r=0;r<R;r++)D.r=_,D.g=x,D.b=k,D.a=C,D=D.next;for(r=1;r<R;r++)s=a+((O<r?O:r)<<2),h+=(D.r=_=E[s])*(S=R-r),c+=(D.g=x=E[s+1])*S,u+=(D.b=k=E[s+2])*S,d+=(D.a=C=E[s+3])*S,m+=_,y+=x,b+=k,w+=C,D=D.next;for(N=I,j=$,i=0;i<A;i++)E[a+3]=C=d*B>>F,0!==C?(C=255/C,E[a]=(h*B>>F)*C,E[a+1]=(c*B>>F)*C,E[a+2]=(u*B>>F)*C):E[a]=E[a+1]=E[a+2]=0,h-=f,c-=p,u-=g,d-=v,f-=N.r,p-=N.g,g-=N.b,v-=N.a,s=l+((s=i+e+1)<O?s:O)<<2,h+=m+=N.r=E[s],c+=y+=N.g=E[s+1],u+=b+=N.b=E[s+2],d+=w+=N.a=E[s+3],N=N.next,f+=_=j.r,p+=x=j.g,g+=k=j.b,v+=C=j.a,m-=_,y-=x,b-=k,w-=C,j=j.next,a+=4;l+=A}for(i=0;i<A;i++){for(y=b=w=m=c=u=d=h=0,f=R*(_=E[a=i<<2]),p=R*(x=E[a+1]),g=R*(k=E[a+2]),v=R*(C=E[a+3]),h+=L*_,c+=L*x,u+=L*k,d+=L*C,D=I,r=0;r<R;r++)D.r=_,D.g=x,D.b=k,D.a=C,D=D.next;for(o=A,r=1;r<=e;r++)a=o+i<<2,h+=(D.r=_=E[a])*(S=R-r),c+=(D.g=x=E[a+1])*S,u+=(D.b=k=E[a+2])*S,d+=(D.a=C=E[a+3])*S,m+=_,y+=x,b+=k,w+=C,D=D.next,r<P&&(o+=A);for(a=i,N=I,j=$,n=0;n<T;n++)E[3+(s=a<<2)]=C=d*B>>F,C>0?(C=255/C,E[s]=(h*B>>F)*C,E[s+1]=(c*B>>F)*C,E[s+2]=(u*B>>F)*C):E[s]=E[s+1]=E[s+2]=0,h-=f,c-=p,u-=g,d-=v,f-=N.r,p-=N.g,g-=N.b,v-=N.a,s=i+((s=n+R)<P?s:P)*A<<2,h+=m+=N.r=E[s],c+=y+=N.g=E[s+1],u+=b+=N.b=E[s+2],d+=w+=N.a=E[s+3],N=N.next,f+=_=j.r,p+=x=j.g,g+=k=j.b,v+=C=j.a,m-=_,y-=x,b-=k,w-=C,j=j.next,a+=A}}(t,e)},Brighten:function(t){var e,i=255*this.brightness(),n=t.data,r=n.length;for(e=0;e<r;e+=4)n[e]+=i,n[e+1]+=i,n[e+2]+=i},Contrast:function(t){var e,i=Math.pow((this.contrast()+100)/100,2),n=t.data,r=n.length,s=150,o=150,a=150;for(e=0;e<r;e+=4)s=n[e],o=n[e+1],a=n[e+2],s/=255,s-=.5,s*=i,s+=.5,o/=255,o-=.5,o*=i,o+=.5,a/=255,a-=.5,a*=i,a+=.5,s=(s*=255)<0?0:s>255?255:s,o=(o*=255)<0?0:o>255?255:o,a=(a*=255)<0?0:a>255?255:a,n[e]=s,n[e+1]=o,n[e+2]=a},Emboss:function(t){var e=10*this.embossStrength(),i=255*this.embossWhiteLevel(),n=this.embossDirection(),r=this.embossBlend(),s=0,o=0,a=t.data,l=t.width,h=t.height,c=4*l,u=h;switch(n){case"top-left":s=-1,o=-1;break;case"top":s=-1,o=0;break;case"top-right":s=-1,o=1;break;case"right":s=0,o=1;break;case"bottom-right":s=1,o=1;break;case"bottom":s=1,o=0;break;case"bottom-left":s=1,o=-1;break;case"left":s=0,o=-1;break;default:Ig.error("Unknown emboss direction: "+n)}do{var d=(u-1)*c,f=s;u+f<1&&(f=0),u+f>h&&(f=0);var p=(u-1+f)*l*4,g=l;do{var v=d+4*(g-1),m=o;g+m<1&&(m=0),g+m>l&&(m=0);var y=p+4*(g-1+m),b=a[v]-a[y],w=a[v+1]-a[y+1],_=a[v+2]-a[y+2],x=b,k=x>0?x:-x;if((w>0?w:-w)>k&&(x=w),(_>0?_:-_)>k&&(x=_),x*=e,r){var C=a[v]+x,S=a[v+1]+x,E=a[v+2]+x;a[v]=C>255?255:C<0?0:C,a[v+1]=S>255?255:S<0?0:S,a[v+2]=E>255?255:E<0?0:E}else{var A=i-x;A<0?A=0:A>255&&(A=255),a[v]=a[v+1]=a[v+2]=A}}while(--g)}while(--u)},Enhance:function(t){var e,i,n,r,s=t.data,o=s.length,a=s[0],l=a,h=s[1],c=h,u=s[2],d=u,f=this.enhance();if(0!==f){for(r=0;r<o;r+=4)(e=s[r+0])<a?a=e:e>l&&(l=e),(i=s[r+1])<h?h=i:i>c&&(c=i),(n=s[r+2])<u?u=n:n>d&&(d=n);var p,g,v,m,y,b,w,_,x;for(l===a&&(l=255,a=0),c===h&&(c=255,h=0),d===u&&(d=255,u=0),f>0?(g=l+f*(255-l),v=a-f*(a-0),y=c+f*(255-c),b=h-f*(h-0),_=d+f*(255-d),x=u-f*(u-0)):(g=l+f*(l-(p=.5*(l+a))),v=a+f*(a-p),y=c+f*(c-(m=.5*(c+h))),b=h+f*(h-m),_=d+f*(d-(w=.5*(d+u))),x=u+f*(u-w)),r=0;r<o;r+=4)s[r+0]=wy(s[r+0],a,l,v,g),s[r+1]=wy(s[r+1],h,c,b,y),s[r+2]=wy(s[r+2],u,d,x,_)}},Grayscale:function(t){var e,i,n=t.data,r=n.length;for(e=0;e<r;e+=4)i=.34*n[e]+.5*n[e+1]+.16*n[e+2],n[e]=i,n[e+1]=i,n[e+2]=i},HSL:function(t){var e,i,n,r,s,o=t.data,a=o.length,l=Math.pow(2,this.saturation()),h=Math.abs(this.hue()+360)%360,c=127*this.luminance(),u=1*l*Math.cos(h*Math.PI/180),d=1*l*Math.sin(h*Math.PI/180),f=.299+.701*u+.167*d,p=.587-.587*u+.33*d,g=.114-.114*u-.497*d,v=.299-.299*u-.328*d,m=.587+.413*u+.035*d,y=.114-.114*u+.293*d,b=.299-.3*u+1.25*d,w=.587-.586*u-1.05*d,_=.114+.886*u-.2*d;for(e=0;e<a;e+=4)i=o[e+0],n=o[e+1],r=o[e+2],s=o[e+3],o[e+0]=f*i+p*n+g*r+c,o[e+1]=v*i+m*n+y*r+c,o[e+2]=b*i+w*n+_*r+c,o[e+3]=s},HSV:function(t){var e,i,n,r,s,o=t.data,a=o.length,l=Math.pow(2,this.value()),h=Math.pow(2,this.saturation()),c=Math.abs(this.hue()+360)%360,u=l*h*Math.cos(c*Math.PI/180),d=l*h*Math.sin(c*Math.PI/180),f=.299*l+.701*u+.167*d,p=.587*l-.587*u+.33*d,g=.114*l-.114*u-.497*d,v=.299*l-.299*u-.328*d,m=.587*l+.413*u+.035*d,y=.114*l-.114*u+.293*d,b=.299*l-.3*u+1.25*d,w=.587*l-.586*u-1.05*d,_=.114*l+.886*u-.2*d;for(e=0;e<a;e+=4)i=o[e+0],n=o[e+1],r=o[e+2],s=o[e+3],o[e+0]=f*i+p*n+g*r,o[e+1]=v*i+m*n+y*r,o[e+2]=b*i+w*n+_*r,o[e+3]=s},Invert:function(t){var e,i=t.data,n=i.length;for(e=0;e<n;e+=4)i[e]=255-i[e],i[e+1]=255-i[e+1],i[e+2]=255-i[e+2]},Kaleidoscope:function(t){var e,i,n,r,s,o,a,l,h,c=t.width,u=t.height,d=Math.round(this.kaleidoscopePower()),f=Math.round(this.kaleidoscopeAngle()),p=Math.floor(c*(f%360)/360);if(!(d<1)){var g=Ig.createCanvasElement();g.width=c,g.height=u;var v=g.getContext("2d").getImageData(0,0,c,u);!function(t,e,i){var n,r,s,o,a=t.data,l=e.data,h=t.width,c=t.height,u=i.polarCenterX||h/2,d=i.polarCenterY||c/2,f=0,p=0,g=0,v=0,m=Math.sqrt(u*u+d*d);r=h-u,s=c-d,m=(o=Math.sqrt(r*r+s*s))>m?o:m;var y,b,w,_,x=c,k=h,C=360/k*Math.PI/180;for(b=0;b<k;b+=1)for(w=Math.sin(b*C),_=Math.cos(b*C),y=0;y<x;y+=1)r=Math.floor(u+m*y/x*_),f=a[0+(n=4*((s=Math.floor(d+m*y/x*w))*h+r))],p=a[n+1],g=a[n+2],v=a[n+3],l[0+(n=4*(b+y*h))]=f,l[n+1]=p,l[n+2]=g,l[n+3]=v}(t,v,{polarCenterX:c/2,polarCenterY:u/2});for(var m=c/Math.pow(2,d);m<=8;)m*=2,d-=1;var y=m=Math.ceil(m),b=0,w=y,_=1;for(p+m>c&&(b=y,w=0,_=-1),i=0;i<u;i+=1)for(e=b;e!==w;e+=_)l=4*(c*i+Math.round(e+p)%c),r=v.data[l+0],s=v.data[l+1],o=v.data[l+2],a=v.data[l+3],h=4*(c*i+e),v.data[h+0]=r,v.data[h+1]=s,v.data[h+2]=o,v.data[h+3]=a;for(i=0;i<u;i+=1)for(y=Math.floor(m),n=0;n<d;n+=1){for(e=0;e<y+1;e+=1)l=4*(c*i+e),r=v.data[l+0],s=v.data[l+1],o=v.data[l+2],a=v.data[l+3],h=4*(c*i+2*y-e-1),v.data[h+0]=r,v.data[h+1]=s,v.data[h+2]=o,v.data[h+3]=a;y*=2}!function(t,e,i){var n,r,s,o,a,l,h=t.data,c=e.data,u=t.width,d=t.height,f=i.polarCenterX||u/2,p=i.polarCenterY||d/2,g=0,v=0,m=0,y=0,b=Math.sqrt(f*f+p*p);r=u-f,s=d-p,b=(l=Math.sqrt(r*r+s*s))>b?l:b;var w,_,x,k=d,C=u,S=i.polarRotation||0;for(r=0;r<u;r+=1)for(s=0;s<d;s+=1)o=r-f,a=s-p,w=Math.sqrt(o*o+a*a)*k/b,_=(_=(180*Math.atan2(a,o)/Math.PI+360+S)%360)*C/360,x=Math.floor(_),g=h[0+(n=4*(Math.floor(w)*u+x))],v=h[n+1],m=h[n+2],y=h[n+3],c[0+(n=4*(s*u+r))]=g,c[n+1]=v,c[n+2]=m,c[n+3]=y}(v,t,{polarRotation:0})}},Mask:function(t){var e=function(t,e){var i=_y(t,0,0),n=_y(t,t.width-1,0),r=_y(t,0,t.height-1),s=_y(t,t.width-1,t.height-1),o=e||10;if(xy(i,n)<o&&xy(n,s)<o&&xy(s,r)<o&&xy(r,i)<o){for(var a=function(t){for(var e=[0,0,0],i=0;i<t.length;i++)e[0]+=t[i][0],e[1]+=t[i][1],e[2]+=t[i][2];return e[0]/=t.length,e[1]/=t.length,e[2]/=t.length,e}([n,i,s,r]),l=[],h=0;h<t.width*t.height;h++){var c=xy(a,[t.data[4*h],t.data[4*h+1],t.data[4*h+2]]);l[h]=c<o?0:255}return l}}(t,this.threshold());return e&&(e=function(t,e,i){for(var n=[1,1,1,1,0,1,1,1,1],r=Math.round(Math.sqrt(n.length)),s=Math.floor(r/2),o=[],a=0;a<i;a++)for(var l=0;l<e;l++){for(var h=a*e+l,c=0,u=0;u<r;u++)for(var d=0;d<r;d++){var f=a+u-s,p=l+d-s;if(f>=0&&f<i&&p>=0&&p<e){var g=n[u*r+d];c+=t[f*e+p]*g}}o[h]=2040===c?255:0}return o}(e,t.width,t.height),e=function(t,e,i){for(var n=[1,1,1,1,1,1,1,1,1],r=Math.round(Math.sqrt(n.length)),s=Math.floor(r/2),o=[],a=0;a<i;a++)for(var l=0;l<e;l++){for(var h=a*e+l,c=0,u=0;u<r;u++)for(var d=0;d<r;d++){var f=a+u-s,p=l+d-s;if(f>=0&&f<i&&p>=0&&p<e){var g=n[u*r+d];c+=t[f*e+p]*g}}o[h]=c>=1020?255:0}return o}(e,t.width,t.height),e=function(t,e,i){for(var n=[1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9],r=Math.round(Math.sqrt(n.length)),s=Math.floor(r/2),o=[],a=0;a<i;a++)for(var l=0;l<e;l++){for(var h=a*e+l,c=0,u=0;u<r;u++)for(var d=0;d<r;d++){var f=a+u-s,p=l+d-s;if(f>=0&&f<i&&p>=0&&p<e){var g=n[u*r+d];c+=t[f*e+p]*g}}o[h]=c}return o}(e,t.width,t.height),function(t,e){for(var i=0;i<t.width*t.height;i++)t.data[4*i+3]=e[i]}(t,e)),t},Noise:function(t){var e,i=255*this.noise(),n=t.data,r=n.length,s=i/2;for(e=0;e<r;e+=4)n[e+0]+=s-2*s*Math.random(),n[e+1]+=s-2*s*Math.random(),n[e+2]+=s-2*s*Math.random()},Pixelate:function(t){var e,i,n,r,s,o,a,l,h,c,u,d,f,p,g=Math.ceil(this.pixelSize()),v=t.width,m=t.height,y=Math.ceil(v/g),b=Math.ceil(m/g),w=t.data;if(g<=0)Ig.error("pixelSize value can not be <= 0");else for(d=0;d<y;d+=1)for(f=0;f<b;f+=1){for(r=0,s=0,o=0,a=0,h=(l=d*g)+g,u=(c=f*g)+g,p=0,e=l;e<h;e+=1)if(!(e>=v))for(i=c;i<u;i+=1)i>=m||(r+=w[0+(n=4*(v*i+e))],s+=w[n+1],o+=w[n+2],a+=w[n+3],p+=1);for(r/=p,s/=p,o/=p,a/=p,e=l;e<h;e+=1)if(!(e>=v))for(i=c;i<u;i+=1)i>=m||(w[0+(n=4*(v*i+e))]=r,w[n+1]=s,w[n+2]=o,w[n+3]=a)}},Posterize:function(t){var e,i=Math.round(254*this.levels())+1,n=t.data,r=n.length,s=255/i;for(e=0;e<r;e+=1)n[e]=Math.floor(n[e]/s)*s},RGB:function(t){var e,i,n=t.data,r=n.length,s=this.red(),o=this.green(),a=this.blue();for(e=0;e<r;e+=4)i=(.34*n[e]+.5*n[e+1]+.16*n[e+2])/255,n[e]=i*s,n[e+1]=i*o,n[e+2]=i*a,n[e+3]=n[e+3]},RGBA:function(t){var e,i,n=t.data,r=n.length,s=this.red(),o=this.green(),a=this.blue(),l=this.alpha();for(e=0;e<r;e+=4)i=1-l,n[e]=s*l+n[e]*i,n[e+1]=o*l+n[e+1]*i,n[e+2]=a*l+n[e+2]*i},Sepia:function(t){var e,i,n,r,s=t.data,o=s.length;for(e=0;e<o;e+=4)i=s[e+0],n=s[e+1],r=s[e+2],s[e+0]=Math.min(255,.393*i+.769*n+.189*r),s[e+1]=Math.min(255,.349*i+.686*n+.168*r),s[e+2]=Math.min(255,.272*i+.534*n+.131*r)},Solarize:function(t){var e=t.data,i=t.width,n=4*i,r=t.height;do{var s=(r-1)*n,o=i;do{var a=s+4*(o-1),l=e[a],h=e[a+1],c=e[a+2];l>127&&(l=255-l),h>127&&(h=255-h),c>127&&(c=255-c),e[a]=l,e[a+1]=h,e[a+2]=c}while(--o)}while(--r)},Threshold:function(t){var e,i=255*this.threshold(),n=t.data,r=n.length;for(e=0;e<r;e+=1)n[e]=n[e]<i?0:255}}}),Cy=ky;function Sy(t,e){let i;if(void 0===e)for(const e of t)null!=e&&(i<e||void 0===i&&e>=e)&&(i=e);else{let n=-1;for(let r of t)null!=(r=e(r,++n,t))&&(i<r||void 0===i&&r>=r)&&(i=r)}return i}function Ey(t,e){let i;if(void 0===e)for(const e of t)null!=e&&(i>e||void 0===i&&e>=e)&&(i=e);else{let n=-1;for(let r of t)null!=(r=e(r,++n,t))&&(i>r||void 0===i&&r>=r)&&(i=r)}return i}function Ay(){}function Ty(t){return null==t?Ay:function(){return this.querySelector(t)}}function My(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function Oy(){return[]}function Py(t){return null==t?Oy:function(){return this.querySelectorAll(t)}}function Ry(t){return function(){return this.matches(t)}}function Ly(t){return function(e){return e.matches(t)}}var Iy=Array.prototype.find;function $y(){return this.firstElementChild}var Dy=Array.prototype.filter;function Ny(){return Array.from(this.children)}function jy(t){return new Array(t.length)}function By(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function Fy(t){return function(){return t}}function zy(t,e,i,n,r,s){for(var o,a=0,l=e.length,h=s.length;a<h;++a)(o=e[a])?(o.__data__=s[a],n[a]=o):i[a]=new By(t,s[a]);for(;a<l;++a)(o=e[a])&&(r[a]=o)}function Uy(t,e,i,n,r,s,o){var a,l,h,c=new Map,u=e.length,d=s.length,f=new Array(u);for(a=0;a<u;++a)(l=e[a])&&(f[a]=h=o.call(l,l.__data__,a,e)+"",c.has(h)?r[a]=l:c.set(h,l));for(a=0;a<d;++a)h=o.call(t,s[a],a,s)+"",(l=c.get(h))?(n[a]=l,l.__data__=s[a],c.delete(h)):i[a]=new By(t,s[a]);for(a=0;a<u;++a)(l=e[a])&&c.get(f[a])===l&&(r[a]=l)}function Gy(t){return t.__data__}function Hy(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function Vy(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}By.prototype={constructor:By,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var qy="http://www.w3.org/1999/xhtml";const Wy={svg:"http://www.w3.org/2000/svg",xhtml:qy,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Yy(t){var e=t+="",i=e.indexOf(":");return i>=0&&"xmlns"!==(e=t.slice(0,i))&&(t=t.slice(i+1)),Wy.hasOwnProperty(e)?{space:Wy[e],local:t}:t}function Xy(t){return function(){this.removeAttribute(t)}}function Ky(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Qy(t,e){return function(){this.setAttribute(t,e)}}function Zy(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Jy(t,e){return function(){var i=e.apply(this,arguments);null==i?this.removeAttribute(t):this.setAttribute(t,i)}}function tb(t,e){return function(){var i=e.apply(this,arguments);null==i?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,i)}}function eb(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function ib(t){return function(){this.style.removeProperty(t)}}function nb(t,e,i){return function(){this.style.setProperty(t,e,i)}}function rb(t,e,i){return function(){var n=e.apply(this,arguments);null==n?this.style.removeProperty(t):this.style.setProperty(t,n,i)}}function sb(t,e){return t.style.getPropertyValue(e)||eb(t).getComputedStyle(t,null).getPropertyValue(e)}function ob(t){return function(){delete this[t]}}function ab(t,e){return function(){this[t]=e}}function lb(t,e){return function(){var i=e.apply(this,arguments);null==i?delete this[t]:this[t]=i}}function hb(t){return t.trim().split(/^|\s+/)}function cb(t){return t.classList||new ub(t)}function ub(t){this._node=t,this._names=hb(t.getAttribute("class")||"")}function db(t,e){for(var i=cb(t),n=-1,r=e.length;++n<r;)i.add(e[n])}function fb(t,e){for(var i=cb(t),n=-1,r=e.length;++n<r;)i.remove(e[n])}function pb(t){return function(){db(this,t)}}function gb(t){return function(){fb(this,t)}}function vb(t,e){return function(){(e.apply(this,arguments)?db:fb)(this,t)}}function mb(){this.textContent=""}function yb(t){return function(){this.textContent=t}}function bb(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function wb(){this.innerHTML=""}function _b(t){return function(){this.innerHTML=t}}function xb(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function kb(){this.nextSibling&&this.parentNode.appendChild(this)}function Cb(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Sb(t){return function(){var e=this.ownerDocument,i=this.namespaceURI;return i===qy&&e.documentElement.namespaceURI===qy?e.createElement(t):e.createElementNS(i,t)}}function Eb(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Ab(t){var e=Yy(t);return(e.local?Eb:Sb)(e)}function Tb(){return null}function Mb(){var t=this.parentNode;t&&t.removeChild(this)}function Ob(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Pb(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Rb(t){return t.trim().split(/^|\s+/).map((function(t){var e="",i=t.indexOf(".");return i>=0&&(e=t.slice(i+1),t=t.slice(0,i)),{type:t,name:e}}))}function Lb(t){return function(){var e=this.__on;if(e){for(var i,n=0,r=-1,s=e.length;n<s;++n)i=e[n],t.type&&i.type!==t.type||i.name!==t.name?e[++r]=i:this.removeEventListener(i.type,i.listener,i.options);++r?e.length=r:delete this.__on}}}function Ib(t,e,i){return function(){var n,r=this.__on,s=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(r)for(var o=0,a=r.length;o<a;++o)if((n=r[o]).type===t.type&&n.name===t.name)return this.removeEventListener(n.type,n.listener,n.options),this.addEventListener(n.type,n.listener=s,n.options=i),void(n.value=e);this.addEventListener(t.type,s,i),n={type:t.type,name:t.name,value:e,listener:s,options:i},r?r.push(n):this.__on=[n]}}function $b(t,e,i){var n=eb(t),r=n.CustomEvent;"function"==typeof r?r=new r(e,i):(r=n.document.createEvent("Event"),i?(r.initEvent(e,i.bubbles,i.cancelable),r.detail=i.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function Db(t,e){return function(){return $b(this,t,e)}}function Nb(t,e){return function(){return $b(this,t,e.apply(this,arguments))}}ub.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var jb=[null];function Bb(t,e){this._groups=t,this._parents=e}function Fb(){return new Bb([[document.documentElement]],jb)}Bb.prototype=Fb.prototype={constructor:Bb,select:function(t){"function"!=typeof t&&(t=Ty(t));for(var e=this._groups,i=e.length,n=new Array(i),r=0;r<i;++r)for(var s,o,a=e[r],l=a.length,h=n[r]=new Array(l),c=0;c<l;++c)(s=a[c])&&(o=t.call(s,s.__data__,c,a))&&("__data__"in s&&(o.__data__=s.__data__),h[c]=o);return new Bb(n,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return My(t.apply(this,arguments))}}(t):Py(t);for(var e=this._groups,i=e.length,n=[],r=[],s=0;s<i;++s)for(var o,a=e[s],l=a.length,h=0;h<l;++h)(o=a[h])&&(n.push(t.call(o,o.__data__,h,a)),r.push(o));return new Bb(n,r)},selectChild:function(t){return this.select(null==t?$y:function(t){return function(){return Iy.call(this.children,t)}}("function"==typeof t?t:Ly(t)))},selectChildren:function(t){return this.selectAll(null==t?Ny:function(t){return function(){return Dy.call(this.children,t)}}("function"==typeof t?t:Ly(t)))},filter:function(t){"function"!=typeof t&&(t=Ry(t));for(var e=this._groups,i=e.length,n=new Array(i),r=0;r<i;++r)for(var s,o=e[r],a=o.length,l=n[r]=[],h=0;h<a;++h)(s=o[h])&&t.call(s,s.__data__,h,o)&&l.push(s);return new Bb(n,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,Gy);var i=e?Uy:zy,n=this._parents,r=this._groups;"function"!=typeof t&&(t=Fy(t));for(var s=r.length,o=new Array(s),a=new Array(s),l=new Array(s),h=0;h<s;++h){var c=n[h],u=r[h],d=u.length,f=Hy(t.call(c,c&&c.__data__,h,n)),p=f.length,g=a[h]=new Array(p),v=o[h]=new Array(p);i(c,u,g,v,l[h]=new Array(d),f,e);for(var m,y,b=0,w=0;b<p;++b)if(m=g[b]){for(b>=w&&(w=b+1);!(y=v[w])&&++w<p;);m._next=y||null}}return(o=new Bb(o,n))._enter=a,o._exit=l,o},enter:function(){return new Bb(this._enter||this._groups.map(jy),this._parents)},exit:function(){return new Bb(this._exit||this._groups.map(jy),this._parents)},join:function(t,e,i){var n=this.enter(),r=this,s=this.exit();return"function"==typeof t?(n=t(n))&&(n=n.selection()):n=n.append(t+""),null!=e&&(r=e(r))&&(r=r.selection()),null==i?s.remove():i(s),n&&r?n.merge(r).order():r},merge:function(t){for(var e=t.selection?t.selection():t,i=this._groups,n=e._groups,r=i.length,s=n.length,o=Math.min(r,s),a=new Array(r),l=0;l<o;++l)for(var h,c=i[l],u=n[l],d=c.length,f=a[l]=new Array(d),p=0;p<d;++p)(h=c[p]||u[p])&&(f[p]=h);for(;l<r;++l)a[l]=i[l];return new Bb(a,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,i=t.length;++e<i;)for(var n,r=t[e],s=r.length-1,o=r[s];--s>=0;)(n=r[s])&&(o&&4^n.compareDocumentPosition(o)&&o.parentNode.insertBefore(n,o),o=n);return this},sort:function(t){function e(e,i){return e&&i?t(e.__data__,i.__data__):!e-!i}t||(t=Vy);for(var i=this._groups,n=i.length,r=new Array(n),s=0;s<n;++s){for(var o,a=i[s],l=a.length,h=r[s]=new Array(l),c=0;c<l;++c)(o=a[c])&&(h[c]=o);h.sort(e)}return new Bb(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var n=t[e],r=0,s=n.length;r<s;++r){var o=n[r];if(o)return o}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,i=0,n=e.length;i<n;++i)for(var r,s=e[i],o=0,a=s.length;o<a;++o)(r=s[o])&&t.call(r,r.__data__,o,s);return this},attr:function(t,e){var i=Yy(t);if(arguments.length<2){var n=this.node();return i.local?n.getAttributeNS(i.space,i.local):n.getAttribute(i)}return this.each((null==e?i.local?Ky:Xy:"function"==typeof e?i.local?tb:Jy:i.local?Zy:Qy)(i,e))},style:function(t,e,i){return arguments.length>1?this.each((null==e?ib:"function"==typeof e?rb:nb)(t,e,null==i?"":i)):sb(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?ob:"function"==typeof e?lb:ab)(t,e)):this.node()[t]},classed:function(t,e){var i=hb(t+"");if(arguments.length<2){for(var n=cb(this.node()),r=-1,s=i.length;++r<s;)if(!n.contains(i[r]))return!1;return!0}return this.each(("function"==typeof e?vb:e?pb:gb)(i,e))},text:function(t){return arguments.length?this.each(null==t?mb:("function"==typeof t?bb:yb)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?wb:("function"==typeof t?xb:_b)(t)):this.node().innerHTML},raise:function(){return this.each(kb)},lower:function(){return this.each(Cb)},append:function(t){var e="function"==typeof t?t:Ab(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var i="function"==typeof t?t:Ab(t),n=null==e?Tb:"function"==typeof e?e:Ty(e);return this.select((function(){return this.insertBefore(i.apply(this,arguments),n.apply(this,arguments)||null)}))},remove:function(){return this.each(Mb)},clone:function(t){return this.select(t?Pb:Ob)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,i){var n,r,s=Rb(t+""),o=s.length;if(!(arguments.length<2)){for(a=e?Ib:Lb,n=0;n<o;++n)this.each(a(s[n],e,i));return this}var a=this.node().__on;if(a)for(var l,h=0,c=a.length;h<c;++h)for(n=0,l=a[h];n<o;++n)if((r=s[n]).type===l.type&&r.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?Nb:Db)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var n,r=t[e],s=0,o=r.length;s<o;++s)(n=r[s])&&(yield n)}};const zb=Fb;var Ub={value:()=>{}};function Gb(){for(var t,e=0,i=arguments.length,n={};e<i;++e){if(!(t=arguments[e]+"")||t in n||/[\s.]/.test(t))throw new Error("illegal type: "+t);n[t]=[]}return new Hb(n)}function Hb(t){this._=t}function Vb(t,e){return t.trim().split(/^|\s+/).map((function(t){var i="",n=t.indexOf(".");if(n>=0&&(i=t.slice(n+1),t=t.slice(0,n)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:i}}))}function qb(t,e){for(var i,n=0,r=t.length;n<r;++n)if((i=t[n]).name===e)return i.value}function Wb(t,e,i){for(var n=0,r=t.length;n<r;++n)if(t[n].name===e){t[n]=Ub,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=i&&t.push({name:e,value:i}),t}Hb.prototype=Gb.prototype={constructor:Hb,on:function(t,e){var i,n=this._,r=Vb(t+"",n),s=-1,o=r.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++s<o;)if(i=(t=r[s]).type)n[i]=Wb(n[i],t.name,e);else if(null==e)for(i in n)n[i]=Wb(n[i],t.name,null);return this}for(;++s<o;)if((i=(t=r[s]).type)&&(i=qb(n[i],t.name)))return i},copy:function(){var t={},e=this._;for(var i in e)t[i]=e[i].slice();return new Hb(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var i,n,r=new Array(i),s=0;s<i;++s)r[s]=arguments[s+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=0,i=(n=this._[t]).length;s<i;++s)n[s].value.apply(e,r)},apply:function(t,e,i){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],r=0,s=n.length;r<s;++r)n[r].value.apply(e,i)}};const Yb=Gb;var Xb,Kb,Qb=0,Zb=0,Jb=0,tw=0,ew=0,iw=0,nw="object"==typeof performance&&performance.now?performance:Date,rw="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function sw(){return ew||(rw(ow),ew=nw.now()+iw)}function ow(){ew=0}function aw(){this._call=this._time=this._next=null}function lw(t,e,i){var n=new aw;return n.restart(t,e,i),n}function hw(){ew=(tw=nw.now())+iw,Qb=Zb=0;try{!function(){sw(),++Qb;for(var t,e=Xb;e;)(t=ew-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Qb}()}finally{Qb=0,function(){for(var t,e,i=Xb,n=1/0;i;)i._call?(n>i._time&&(n=i._time),t=i,i=i._next):(e=i._next,i._next=null,i=t?t._next=e:Xb=e);Kb=t,uw(n)}(),ew=0}}function cw(){var t=nw.now(),e=t-tw;e>1e3&&(iw-=e,tw=t)}function uw(t){Qb||(Zb&&(Zb=clearTimeout(Zb)),t-ew>24?(t<1/0&&(Zb=setTimeout(hw,t-nw.now()-iw)),Jb&&(Jb=clearInterval(Jb))):(Jb||(tw=nw.now(),Jb=setInterval(cw,1e3)),Qb=1,rw(hw)))}function dw(t,e,i){var n=new aw;return e=null==e?0:+e,n.restart((i=>{n.stop(),t(i+e)}),e,i),n}aw.prototype=lw.prototype={constructor:aw,restart:function(t,e,i){if("function"!=typeof t)throw new TypeError("callback is not a function");i=(null==i?sw():+i)+(null==e?0:+e),this._next||Kb===this||(Kb?Kb._next=this:Xb=this,Kb=this),this._call=t,this._time=i,uw()},stop:function(){this._call&&(this._call=null,this._time=1/0,uw())}};var fw=Yb("start","end","cancel","interrupt"),pw=[];function gw(t,e,i,n,r,s){var o=t.__transition;if(o){if(i in o)return}else t.__transition={};!function(t,e,i){var n,r=t.__transition;function s(l){var h,c,u,d;if(1!==i.state)return a();for(h in r)if((d=r[h]).name===i.name){if(3===d.state)return dw(s);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete r[h]):+h<e&&(d.state=6,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete r[h])}if(dw((function(){3===i.state&&(i.state=4,i.timer.restart(o,i.delay,i.time),o(l))})),i.state=2,i.on.call("start",t,t.__data__,i.index,i.group),2===i.state){for(i.state=3,n=new Array(u=i.tween.length),h=0,c=-1;h<u;++h)(d=i.tween[h].value.call(t,t.__data__,i.index,i.group))&&(n[++c]=d);n.length=c+1}}function o(e){for(var r=e<i.duration?i.ease.call(null,e/i.duration):(i.timer.restart(a),i.state=5,1),s=-1,o=n.length;++s<o;)n[s].call(t,r);5===i.state&&(i.on.call("end",t,t.__data__,i.index,i.group),a())}function a(){for(var n in i.state=6,i.timer.stop(),delete r[e],r)return;delete t.__transition}r[e]=i,i.timer=lw((function(t){i.state=1,i.timer.restart(s,i.delay,i.time),i.delay<=t&&s(t-i.delay)}),0,i.time)}(t,i,{name:e,index:n,group:r,on:fw,tween:pw,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:0})}function vw(t,e){var i=yw(t,e);if(i.state>0)throw new Error("too late; already scheduled");return i}function mw(t,e){var i=yw(t,e);if(i.state>3)throw new Error("too late; already running");return i}function yw(t,e){var i=t.__transition;if(!i||!(i=i[e]))throw new Error("transition not found");return i}function bw(t,e){var i,n,r,s=t.__transition,o=!0;if(s){for(r in e=null==e?null:e+"",s)(i=s[r]).name===e?(n=i.state>2&&i.state<5,i.state=6,i.timer.stop(),i.on.call(n?"interrupt":"cancel",t,t.__data__,i.index,i.group),delete s[r]):o=!1;o&&delete t.__transition}}function ww(t,e){return t=+t,e=+e,function(i){return t*(1-i)+e*i}}var _w,xw=180/Math.PI,kw={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Cw(t,e,i,n,r,s){var o,a,l;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(l=t*i+e*n)&&(i-=t*l,n-=e*l),(a=Math.sqrt(i*i+n*n))&&(i/=a,n/=a,l/=a),t*n<e*i&&(t=-t,e=-e,l=-l,o=-o),{translateX:r,translateY:s,rotate:Math.atan2(e,t)*xw,skewX:Math.atan(l)*xw,scaleX:o,scaleY:a}}function Sw(t,e,i,n){function r(t){return t.length?t.pop()+" ":""}return function(s,o){var a=[],l=[];return s=t(s),o=t(o),function(t,n,r,s,o,a){if(t!==r||n!==s){var l=o.push("translate(",null,e,null,i);a.push({i:l-4,x:ww(t,r)},{i:l-2,x:ww(n,s)})}else(r||s)&&o.push("translate("+r+e+s+i)}(s.translateX,s.translateY,o.translateX,o.translateY,a,l),function(t,e,i,s){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),s.push({i:i.push(r(i)+"rotate(",null,n)-2,x:ww(t,e)})):e&&i.push(r(i)+"rotate("+e+n)}(s.rotate,o.rotate,a,l),function(t,e,i,s){t!==e?s.push({i:i.push(r(i)+"skewX(",null,n)-2,x:ww(t,e)}):e&&i.push(r(i)+"skewX("+e+n)}(s.skewX,o.skewX,a,l),function(t,e,i,n,s,o){if(t!==i||e!==n){var a=s.push(r(s)+"scale(",null,",",null,")");o.push({i:a-4,x:ww(t,i)},{i:a-2,x:ww(e,n)})}else 1===i&&1===n||s.push(r(s)+"scale("+i+","+n+")")}(s.scaleX,s.scaleY,o.scaleX,o.scaleY,a,l),s=o=null,function(t){for(var e,i=-1,n=l.length;++i<n;)a[(e=l[i]).i]=e.x(t);return a.join("")}}}var Ew=Sw((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?kw:Cw(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),Aw=Sw((function(t){return null==t?kw:(_w||(_w=document.createElementNS("http://www.w3.org/2000/svg","g")),_w.setAttribute("transform",t),(t=_w.transform.baseVal.consolidate())?Cw((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):kw)}),", ",")",")");function Tw(t,e){var i,n;return function(){var r=mw(this,t),s=r.tween;if(s!==i)for(var o=0,a=(n=i=s).length;o<a;++o)if(n[o].name===e){(n=n.slice()).splice(o,1);break}r.tween=n}}function Mw(t,e,i){var n,r;if("function"!=typeof i)throw new Error;return function(){var s=mw(this,t),o=s.tween;if(o!==n){r=(n=o).slice();for(var a={name:e,value:i},l=0,h=r.length;l<h;++l)if(r[l].name===e){r[l]=a;break}l===h&&r.push(a)}s.tween=r}}function Ow(t,e,i){var n=t._id;return t.each((function(){var t=mw(this,n);(t.value||(t.value={}))[e]=i.apply(this,arguments)})),function(t){return yw(t,n).value[e]}}function Pw(t,e,i){t.prototype=e.prototype=i,i.constructor=t}function Rw(t,e){var i=Object.create(t.prototype);for(var n in e)i[n]=e[n];return i}function Lw(){}var Iw=.7,$w=1/Iw,Dw="\\s*([+-]?\\d+)\\s*",Nw="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",jw="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Bw=/^#([0-9a-f]{3,8})$/,Fw=new RegExp("^rgb\\("+[Dw,Dw,Dw]+"\\)$"),zw=new RegExp("^rgb\\("+[jw,jw,jw]+"\\)$"),Uw=new RegExp("^rgba\\("+[Dw,Dw,Dw,Nw]+"\\)$"),Gw=new RegExp("^rgba\\("+[jw,jw,jw,Nw]+"\\)$"),Hw=new RegExp("^hsl\\("+[Nw,jw,jw]+"\\)$"),Vw=new RegExp("^hsla\\("+[Nw,jw,jw,Nw]+"\\)$"),qw={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Ww(){return this.rgb().formatHex()}function Yw(){return this.rgb().formatRgb()}function Xw(t){var e,i;return t=(t+"").trim().toLowerCase(),(e=Bw.exec(t))?(i=e[1].length,e=parseInt(e[1],16),6===i?Kw(e):3===i?new t_(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===i?Qw(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===i?Qw(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Fw.exec(t))?new t_(e[1],e[2],e[3],1):(e=zw.exec(t))?new t_(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Uw.exec(t))?Qw(e[1],e[2],e[3],e[4]):(e=Gw.exec(t))?Qw(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Hw.exec(t))?r_(e[1],e[2]/100,e[3]/100,1):(e=Vw.exec(t))?r_(e[1],e[2]/100,e[3]/100,e[4]):qw.hasOwnProperty(t)?Kw(qw[t]):"transparent"===t?new t_(NaN,NaN,NaN,0):null}function Kw(t){return new t_(t>>16&255,t>>8&255,255&t,1)}function Qw(t,e,i,n){return n<=0&&(t=e=i=NaN),new t_(t,e,i,n)}function Zw(t){return t instanceof Lw||(t=Xw(t)),t?new t_((t=t.rgb()).r,t.g,t.b,t.opacity):new t_}function Jw(t,e,i,n){return 1===arguments.length?Zw(t):new t_(t,e,i,null==n?1:n)}function t_(t,e,i,n){this.r=+t,this.g=+e,this.b=+i,this.opacity=+n}function e_(){return"#"+n_(this.r)+n_(this.g)+n_(this.b)}function i_(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function n_(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function r_(t,e,i,n){return n<=0?t=e=i=NaN:i<=0||i>=1?t=e=NaN:e<=0&&(t=NaN),new o_(t,e,i,n)}function s_(t){if(t instanceof o_)return new o_(t.h,t.s,t.l,t.opacity);if(t instanceof Lw||(t=Xw(t)),!t)return new o_;if(t instanceof o_)return t;var e=(t=t.rgb()).r/255,i=t.g/255,n=t.b/255,r=Math.min(e,i,n),s=Math.max(e,i,n),o=NaN,a=s-r,l=(s+r)/2;return a?(o=e===s?(i-n)/a+6*(i<n):i===s?(n-e)/a+2:(e-i)/a+4,a/=l<.5?s+r:2-s-r,o*=60):a=l>0&&l<1?0:o,new o_(o,a,l,t.opacity)}function o_(t,e,i,n){this.h=+t,this.s=+e,this.l=+i,this.opacity=+n}function a_(t,e,i){return 255*(t<60?e+(i-e)*t/60:t<180?i:t<240?e+(i-e)*(240-t)/60:e)}function l_(t,e,i,n,r){var s=t*t,o=s*t;return((1-3*t+3*s-o)*e+(4-6*s+3*o)*i+(1+3*t+3*s-3*o)*n+o*r)/6}Pw(Lw,Xw,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Ww,formatHex:Ww,formatHsl:function(){return s_(this).formatHsl()},formatRgb:Yw,toString:Yw}),Pw(t_,Jw,Rw(Lw,{brighter:function(t){return t=null==t?$w:Math.pow($w,t),new t_(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?Iw:Math.pow(Iw,t),new t_(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:e_,formatHex:e_,formatRgb:i_,toString:i_})),Pw(o_,(function(t,e,i,n){return 1===arguments.length?s_(t):new o_(t,e,i,null==n?1:n)}),Rw(Lw,{brighter:function(t){return t=null==t?$w:Math.pow($w,t),new o_(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?Iw:Math.pow(Iw,t),new o_(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,i=this.l,n=i+(i<.5?i:1-i)*e,r=2*i-n;return new t_(a_(t>=240?t-240:t+120,r,n),a_(t,r,n),a_(t<120?t+240:t-120,r,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));const h_=t=>()=>t;function c_(t,e){var i=e-t;return i?function(t,e){return function(i){return t+i*e}}(t,i):h_(isNaN(t)?e:t)}const u_=function t(e){var i=function(t){return 1==(t=+t)?c_:function(e,i){return i-e?function(t,e,i){return t=Math.pow(t,i),e=Math.pow(e,i)-t,i=1/i,function(n){return Math.pow(t+n*e,i)}}(e,i,t):h_(isNaN(e)?i:e)}}(e);function n(t,e){var n=i((t=Jw(t)).r,(e=Jw(e)).r),r=i(t.g,e.g),s=i(t.b,e.b),o=c_(t.opacity,e.opacity);return function(e){return t.r=n(e),t.g=r(e),t.b=s(e),t.opacity=o(e),t+""}}return n.gamma=t,n}(1);function d_(t){return function(e){var i,n,r=e.length,s=new Array(r),o=new Array(r),a=new Array(r);for(i=0;i<r;++i)n=Jw(e[i]),s[i]=n.r||0,o[i]=n.g||0,a[i]=n.b||0;return s=t(s),o=t(o),a=t(a),n.opacity=1,function(t){return n.r=s(t),n.g=o(t),n.b=a(t),n+""}}}d_((function(t){var e=t.length-1;return function(i){var n=i<=0?i=0:i>=1?(i=1,e-1):Math.floor(i*e),r=t[n],s=t[n+1],o=n>0?t[n-1]:2*r-s,a=n<e-1?t[n+2]:2*s-r;return l_((i-n/e)*e,o,r,s,a)}})),d_((function(t){var e=t.length;return function(i){var n=Math.floor(((i%=1)<0?++i:i)*e),r=t[(n+e-1)%e],s=t[n%e],o=t[(n+1)%e],a=t[(n+2)%e];return l_((i-n/e)*e,r,s,o,a)}}));var f_=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,p_=new RegExp(f_.source,"g");function g_(t,e){var i,n,r,s=f_.lastIndex=p_.lastIndex=0,o=-1,a=[],l=[];for(t+="",e+="";(i=f_.exec(t))&&(n=p_.exec(e));)(r=n.index)>s&&(r=e.slice(s,r),a[o]?a[o]+=r:a[++o]=r),(i=i[0])===(n=n[0])?a[o]?a[o]+=n:a[++o]=n:(a[++o]=null,l.push({i:o,x:ww(i,n)})),s=p_.lastIndex;return s<e.length&&(r=e.slice(s),a[o]?a[o]+=r:a[++o]=r),a.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var i,n=0;n<e;++n)a[(i=l[n]).i]=i.x(t);return a.join("")})}function v_(t,e){var i;return("number"==typeof e?ww:e instanceof Xw?u_:(i=Xw(e))?(e=i,u_):g_)(t,e)}function m_(t){return function(){this.removeAttribute(t)}}function y_(t){return function(){this.removeAttributeNS(t.space,t.local)}}function b_(t,e,i){var n,r,s=i+"";return function(){var o=this.getAttribute(t);return o===s?null:o===n?r:r=e(n=o,i)}}function w_(t,e,i){var n,r,s=i+"";return function(){var o=this.getAttributeNS(t.space,t.local);return o===s?null:o===n?r:r=e(n=o,i)}}function __(t,e,i){var n,r,s;return function(){var o,a,l=i(this);if(null!=l)return(o=this.getAttribute(t))===(a=l+"")?null:o===n&&a===r?s:(r=a,s=e(n=o,l));this.removeAttribute(t)}}function x_(t,e,i){var n,r,s;return function(){var o,a,l=i(this);if(null!=l)return(o=this.getAttributeNS(t.space,t.local))===(a=l+"")?null:o===n&&a===r?s:(r=a,s=e(n=o,l));this.removeAttributeNS(t.space,t.local)}}function k_(t,e){return function(i){this.setAttribute(t,e.call(this,i))}}function C_(t,e){return function(i){this.setAttributeNS(t.space,t.local,e.call(this,i))}}function S_(t,e){var i,n;function r(){var r=e.apply(this,arguments);return r!==n&&(i=(n=r)&&C_(t,r)),i}return r._value=e,r}function E_(t,e){var i,n;function r(){var r=e.apply(this,arguments);return r!==n&&(i=(n=r)&&k_(t,r)),i}return r._value=e,r}function A_(t,e){return function(){vw(this,t).delay=+e.apply(this,arguments)}}function T_(t,e){return e=+e,function(){vw(this,t).delay=e}}function M_(t,e){return function(){mw(this,t).duration=+e.apply(this,arguments)}}function O_(t,e){return e=+e,function(){mw(this,t).duration=e}}function P_(t,e){if("function"!=typeof e)throw new Error;return function(){mw(this,t).ease=e}}function R_(t,e,i){var n,r,s=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?vw:mw;return function(){var o=s(this,t),a=o.on;a!==n&&(r=(n=a).copy()).on(e,i),o.on=r}}var L_=zb.prototype.constructor;function I_(t){return function(){this.style.removeProperty(t)}}function $_(t,e,i){return function(n){this.style.setProperty(t,e.call(this,n),i)}}function D_(t,e,i){var n,r;function s(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&$_(t,s,i)),n}return s._value=e,s}function N_(t){return function(e){this.textContent=t.call(this,e)}}function j_(t){var e,i;function n(){var n=t.apply(this,arguments);return n!==i&&(e=(i=n)&&N_(n)),e}return n._value=t,n}var B_=0;function F_(t,e,i,n){this._groups=t,this._parents=e,this._name=i,this._id=n}function z_(){return++B_}var U_=zb.prototype;F_.prototype=function(t){return zb().transition(t)}.prototype={constructor:F_,select:function(t){var e=this._name,i=this._id;"function"!=typeof t&&(t=Ty(t));for(var n=this._groups,r=n.length,s=new Array(r),o=0;o<r;++o)for(var a,l,h=n[o],c=h.length,u=s[o]=new Array(c),d=0;d<c;++d)(a=h[d])&&(l=t.call(a,a.__data__,d,h))&&("__data__"in a&&(l.__data__=a.__data__),u[d]=l,gw(u[d],e,i,d,u,yw(a,i)));return new F_(s,this._parents,e,i)},selectAll:function(t){var e=this._name,i=this._id;"function"!=typeof t&&(t=Py(t));for(var n=this._groups,r=n.length,s=[],o=[],a=0;a<r;++a)for(var l,h=n[a],c=h.length,u=0;u<c;++u)if(l=h[u]){for(var d,f=t.call(l,l.__data__,u,h),p=yw(l,i),g=0,v=f.length;g<v;++g)(d=f[g])&&gw(d,e,i,g,f,p);s.push(f),o.push(l)}return new F_(s,o,e,i)},selectChild:U_.selectChild,selectChildren:U_.selectChildren,filter:function(t){"function"!=typeof t&&(t=Ry(t));for(var e=this._groups,i=e.length,n=new Array(i),r=0;r<i;++r)for(var s,o=e[r],a=o.length,l=n[r]=[],h=0;h<a;++h)(s=o[h])&&t.call(s,s.__data__,h,o)&&l.push(s);return new F_(n,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,i=t._groups,n=e.length,r=i.length,s=Math.min(n,r),o=new Array(n),a=0;a<s;++a)for(var l,h=e[a],c=i[a],u=h.length,d=o[a]=new Array(u),f=0;f<u;++f)(l=h[f]||c[f])&&(d[f]=l);for(;a<n;++a)o[a]=e[a];return new F_(o,this._parents,this._name,this._id)},selection:function(){return new L_(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,i=z_(),n=this._groups,r=n.length,s=0;s<r;++s)for(var o,a=n[s],l=a.length,h=0;h<l;++h)if(o=a[h]){var c=yw(o,e);gw(o,t,i,h,a,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new F_(n,this._parents,t,i)},call:U_.call,nodes:U_.nodes,node:U_.node,size:U_.size,empty:U_.empty,each:U_.each,on:function(t,e){var i=this._id;return arguments.length<2?yw(this.node(),i).on.on(t):this.each(R_(i,t,e))},attr:function(t,e){var i=Yy(t),n="transform"===i?Aw:v_;return this.attrTween(t,"function"==typeof e?(i.local?x_:__)(i,n,Ow(this,"attr."+t,e)):null==e?(i.local?y_:m_)(i):(i.local?w_:b_)(i,n,e))},attrTween:function(t,e){var i="attr."+t;if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;var n=Yy(t);return this.tween(i,(n.local?S_:E_)(n,e))},style:function(t,e,i){var n="transform"==(t+="")?Ew:v_;return null==e?this.styleTween(t,function(t,e){var i,n,r;return function(){var s=sb(this,t),o=(this.style.removeProperty(t),sb(this,t));return s===o?null:s===i&&o===n?r:r=e(i=s,n=o)}}(t,n)).on("end.style."+t,I_(t)):"function"==typeof e?this.styleTween(t,function(t,e,i){var n,r,s;return function(){var o=sb(this,t),a=i(this),l=a+"";return null==a&&(this.style.removeProperty(t),l=a=sb(this,t)),o===l?null:o===n&&l===r?s:(r=l,s=e(n=o,a))}}(t,n,Ow(this,"style."+t,e))).each(function(t,e){var i,n,r,s,o="style."+e,a="end."+o;return function(){var l=mw(this,t),h=l.on,c=null==l.value[o]?s||(s=I_(e)):void 0;h===i&&r===c||(n=(i=h).copy()).on(a,r=c),l.on=n}}(this._id,t)):this.styleTween(t,function(t,e,i){var n,r,s=i+"";return function(){var o=sb(this,t);return o===s?null:o===n?r:r=e(n=o,i)}}(t,n,e),i).on("end.style."+t,null)},styleTween:function(t,e,i){var n="style."+(t+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;return this.tween(n,D_(t,e,null==i?"":i))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(Ow(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,j_(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var i in this.__transition)if(+i!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var i=this._id;if(t+="",arguments.length<2){for(var n,r=yw(this.node(),i).tween,s=0,o=r.length;s<o;++s)if((n=r[s]).name===t)return n.value;return null}return this.each((null==e?Tw:Mw)(i,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?A_:T_)(e,t)):yw(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?M_:O_)(e,t)):yw(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(P_(e,t)):yw(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var i=e.apply(this,arguments);if("function"!=typeof i)throw new Error;mw(this,t).ease=i}}(this._id,t))},end:function(){var t,e,i=this,n=i._id,r=i.size();return new Promise((function(s,o){var a={value:o},l={value:function(){0==--r&&s()}};i.each((function(){var i=mw(this,n),r=i.on;r!==t&&((e=(t=r).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),i.on=e})),0===r&&s()}))},[Symbol.iterator]:U_[Symbol.iterator]};var G_={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function H_(t,e){for(var i;!(i=t.__transition)||!(i=i[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return i}zb.prototype.interrupt=function(t){return this.each((function(){bw(this,t)}))},zb.prototype.transition=function(t){var e,i;t instanceof F_?(e=t._id,t=t._name):(e=z_(),(i=G_).time=sw(),t=null==t?null:t+"");for(var n=this._groups,r=n.length,s=0;s<r;++s)for(var o,a=n[s],l=a.length,h=0;h<l;++h)(o=a[h])&&gw(o,t,e,h,a,i||H_(o,e));return new F_(n,this._parents,t,e)};const{abs:V_,max:q_,min:W_}=Math;function Y_(t){return{type:t}}function X_(t,e,i,n){if(isNaN(e)||isNaN(i))return t;var r,s,o,a,l,h,c,u,d,f=t._root,p={data:n},g=t._x0,v=t._y0,m=t._x1,y=t._y1;if(!f)return t._root=p,t;for(;f.length;)if((h=e>=(s=(g+m)/2))?g=s:m=s,(c=i>=(o=(v+y)/2))?v=o:y=o,r=f,!(f=f[u=c<<1|h]))return r[u]=p,t;if(a=+t._x.call(null,f.data),l=+t._y.call(null,f.data),e===a&&i===l)return p.next=f,r?r[u]=p:t._root=p,t;do{r=r?r[u]=new Array(4):t._root=new Array(4),(h=e>=(s=(g+m)/2))?g=s:m=s,(c=i>=(o=(v+y)/2))?v=o:y=o}while((u=c<<1|h)==(d=(l>=o)<<1|a>=s));return r[d]=f,r[u]=p,t}function K_(t,e,i,n,r){this.node=t,this.x0=e,this.y0=i,this.x1=n,this.y1=r}function Q_(t){return t[0]}function Z_(t){return t[1]}function J_(t,e,i){var n=new tx(null==e?Q_:e,null==i?Z_:i,NaN,NaN,NaN,NaN);return null==t?n:n.addAll(t)}function tx(t,e,i,n,r,s){this._x=t,this._y=e,this._x0=i,this._y0=n,this._x1=r,this._y1=s,this._root=void 0}function ex(t){for(var e={data:t.data},i=e;t=t.next;)i=i.next={data:t.data};return e}["w","e"].map(Y_),["n","s"].map(Y_),["n","w","e","s","nw","ne","sw","se"].map(Y_);var ix=J_.prototype=tx.prototype;function nx(t){return function(){return t}}function rx(t){return 1e-6*(t()-.5)}function sx(t){return t.x+t.vx}function ox(t){return t.y+t.vy}function ax(t){var e,i,n,r=1,s=1;function o(){for(var t,o,l,h,c,u,d,f=e.length,p=0;p<s;++p)for(o=J_(e,sx,ox).visitAfter(a),t=0;t<f;++t)l=e[t],u=i[l.index],d=u*u,h=l.x+l.vx,c=l.y+l.vy,o.visit(g);function g(t,e,i,s,o){var a=t.data,f=t.r,p=u+f;if(!a)return e>h+p||s<h-p||i>c+p||o<c-p;if(a.index>l.index){var g=h-a.x-a.vx,v=c-a.y-a.vy,m=g*g+v*v;m<p*p&&(0===g&&(m+=(g=rx(n))*g),0===v&&(m+=(v=rx(n))*v),m=(p-(m=Math.sqrt(m)))/m*r,l.vx+=(g*=m)*(p=(f*=f)/(d+f)),l.vy+=(v*=m)*p,a.vx-=g*(p=1-p),a.vy-=v*p)}}}function a(t){if(t.data)return t.r=i[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function l(){if(e){var n,r,s=e.length;for(i=new Array(s),n=0;n<s;++n)r=e[n],i[r.index]=+t(r,n,e)}}return"function"!=typeof t&&(t=nx(null==t?1:+t)),o.initialize=function(t,i){e=t,n=i,l()},o.iterations=function(t){return arguments.length?(s=+t,o):s},o.strength=function(t){return arguments.length?(r=+t,o):r},o.radius=function(e){return arguments.length?(t="function"==typeof e?e:nx(+e),l(),o):t},o}function lx(t,e,i){var n,r,s,o=nx(.1);function a(t){for(var o=0,a=n.length;o<a;++o){var l=n[o],h=l.x-e||1e-6,c=l.y-i||1e-6,u=Math.sqrt(h*h+c*c),d=(s[o]-u)*r[o]*t/u;l.vx+=h*d,l.vy+=c*d}}function l(){if(n){var e,i=n.length;for(r=new Array(i),s=new Array(i),e=0;e<i;++e)s[e]=+t(n[e],e,n),r[e]=isNaN(s[e])?0:+o(n[e],e,n)}}return"function"!=typeof t&&(t=nx(+t)),null==e&&(e=0),null==i&&(i=0),a.initialize=function(t){n=t,l()},a.strength=function(t){return arguments.length?(o="function"==typeof t?t:nx(+t),l(),a):o},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:nx(+e),l(),a):t},a.x=function(t){return arguments.length?(e=+t,a):e},a.y=function(t){return arguments.length?(i=+t,a):i},a}ix.copy=function(){var t,e,i=new tx(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root;if(!n)return i;if(!n.length)return i._root=ex(n),i;for(t=[{source:n,target:i._root=new Array(4)}];n=t.pop();)for(var r=0;r<4;++r)(e=n.source[r])&&(e.length?t.push({source:e,target:n.target[r]=new Array(4)}):n.target[r]=ex(e));return i},ix.add=function(t){const e=+this._x.call(null,t),i=+this._y.call(null,t);return X_(this.cover(e,i),e,i,t)},ix.addAll=function(t){var e,i,n,r,s=t.length,o=new Array(s),a=new Array(s),l=1/0,h=1/0,c=-1/0,u=-1/0;for(i=0;i<s;++i)isNaN(n=+this._x.call(null,e=t[i]))||isNaN(r=+this._y.call(null,e))||(o[i]=n,a[i]=r,n<l&&(l=n),n>c&&(c=n),r<h&&(h=r),r>u&&(u=r));if(l>c||h>u)return this;for(this.cover(l,h).cover(c,u),i=0;i<s;++i)X_(this,o[i],a[i],t[i]);return this},ix.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var i=this._x0,n=this._y0,r=this._x1,s=this._y1;if(isNaN(i))r=(i=Math.floor(t))+1,s=(n=Math.floor(e))+1;else{for(var o,a,l=r-i||1,h=this._root;i>t||t>=r||n>e||e>=s;)switch(a=(e<n)<<1|t<i,(o=new Array(4))[a]=h,h=o,l*=2,a){case 0:r=i+l,s=n+l;break;case 1:i=r-l,s=n+l;break;case 2:r=i+l,n=s-l;break;case 3:i=r-l,n=s-l}this._root&&this._root.length&&(this._root=h)}return this._x0=i,this._y0=n,this._x1=r,this._y1=s,this},ix.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},ix.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},ix.find=function(t,e,i){var n,r,s,o,a,l,h,c=this._x0,u=this._y0,d=this._x1,f=this._y1,p=[],g=this._root;for(g&&p.push(new K_(g,c,u,d,f)),null==i?i=1/0:(c=t-i,u=e-i,d=t+i,f=e+i,i*=i);l=p.pop();)if(!(!(g=l.node)||(r=l.x0)>d||(s=l.y0)>f||(o=l.x1)<c||(a=l.y1)<u))if(g.length){var v=(r+o)/2,m=(s+a)/2;p.push(new K_(g[3],v,m,o,a),new K_(g[2],r,m,v,a),new K_(g[1],v,s,o,m),new K_(g[0],r,s,v,m)),(h=(e>=m)<<1|t>=v)&&(l=p[p.length-1],p[p.length-1]=p[p.length-1-h],p[p.length-1-h]=l)}else{var y=t-+this._x.call(null,g.data),b=e-+this._y.call(null,g.data),w=y*y+b*b;if(w<i){var _=Math.sqrt(i=w);c=t-_,u=e-_,d=t+_,f=e+_,n=g.data}}return n},ix.remove=function(t){if(isNaN(s=+this._x.call(null,t))||isNaN(o=+this._y.call(null,t)))return this;var e,i,n,r,s,o,a,l,h,c,u,d,f=this._root,p=this._x0,g=this._y0,v=this._x1,m=this._y1;if(!f)return this;if(f.length)for(;;){if((h=s>=(a=(p+v)/2))?p=a:v=a,(c=o>=(l=(g+m)/2))?g=l:m=l,e=f,!(f=f[u=c<<1|h]))return this;if(!f.length)break;(e[u+1&3]||e[u+2&3]||e[u+3&3])&&(i=e,d=u)}for(;f.data!==t;)if(n=f,!(f=f.next))return this;return(r=f.next)&&delete f.next,n?(r?n.next=r:delete n.next,this):e?(r?e[u]=r:delete e[u],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(i?i[d]=f:this._root=f),this):(this._root=r,this)},ix.removeAll=function(t){for(var e=0,i=t.length;e<i;++e)this.remove(t[e]);return this},ix.root=function(){return this._root},ix.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},ix.visit=function(t){var e,i,n,r,s,o,a=[],l=this._root;for(l&&a.push(new K_(l,this._x0,this._y0,this._x1,this._y1));e=a.pop();)if(!t(l=e.node,n=e.x0,r=e.y0,s=e.x1,o=e.y1)&&l.length){var h=(n+s)/2,c=(r+o)/2;(i=l[3])&&a.push(new K_(i,h,c,s,o)),(i=l[2])&&a.push(new K_(i,n,c,h,o)),(i=l[1])&&a.push(new K_(i,h,r,s,c)),(i=l[0])&&a.push(new K_(i,n,r,h,c))}return this},ix.visitAfter=function(t){var e,i=[],n=[];for(this._root&&i.push(new K_(this._root,this._x0,this._y0,this._x1,this._y1));e=i.pop();){var r=e.node;if(r.length){var s,o=e.x0,a=e.y0,l=e.x1,h=e.y1,c=(o+l)/2,u=(a+h)/2;(s=r[0])&&i.push(new K_(s,o,a,c,u)),(s=r[1])&&i.push(new K_(s,c,a,l,u)),(s=r[2])&&i.push(new K_(s,o,u,c,h)),(s=r[3])&&i.push(new K_(s,c,u,l,h))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},ix.x=function(t){return arguments.length?(this._x=t,this):this._x},ix.y=function(t){return arguments.length?(this._y=t,this):this._y};const hx=4294967296;var cx=Math.PI*(3-Math.sqrt(5));function ux(t){var e,i=1,n=.001,r=1-Math.pow(n,1/300),s=0,o=.6,a=new Map,l=lw(u),h=Yb("tick","end"),c=function(){let t=1;return()=>(t=(1664525*t+1013904223)%hx)/hx}();function u(){d(),h.call("tick",e),i<n&&(l.stop(),h.call("end",e))}function d(n){var l,h,c=t.length;void 0===n&&(n=1);for(var u=0;u<n;++u)for(i+=(s-i)*r,a.forEach((function(t){t(i)})),l=0;l<c;++l)null==(h=t[l]).fx?h.x+=h.vx*=o:(h.x=h.fx,h.vx=0),null==h.fy?h.y+=h.vy*=o:(h.y=h.fy,h.vy=0);return e}function f(){for(var e,i=0,n=t.length;i<n;++i){if((e=t[i]).index=i,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var r=10*Math.sqrt(.5+i),s=i*cx;e.x=r*Math.cos(s),e.y=r*Math.sin(s)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function p(e){return e.initialize&&e.initialize(t,c),e}return null==t&&(t=[]),f(),e={tick:d,restart:function(){return l.restart(u),e},stop:function(){return l.stop(),e},nodes:function(i){return arguments.length?(t=i,f(),a.forEach(p),e):t},alpha:function(t){return arguments.length?(i=+t,e):i},alphaMin:function(t){return arguments.length?(n=+t,e):n},alphaDecay:function(t){return arguments.length?(r=+t,e):+r},alphaTarget:function(t){return arguments.length?(s=+t,e):s},velocityDecay:function(t){return arguments.length?(o=1-t,e):1-o},randomSource:function(t){return arguments.length?(c=t,a.forEach(p),e):c},force:function(t,i){return arguments.length>1?(null==i?a.delete(t):a.set(t,p(i)),e):a.get(t)},find:function(e,i,n){var r,s,o,a,l,h=0,c=t.length;for(null==n?n=1/0:n*=n,h=0;h<c;++h)(o=(r=e-(a=t[h]).x)*r+(s=i-a.y)*s)<n&&(l=a,n=o);return l},on:function(t,i){return arguments.length>1?(h.on(t,i),e):h.on(t)}}}function dx(t){var e,i,n,r=nx(.1);function s(t){for(var r,s=0,o=e.length;s<o;++s)(r=e[s]).vx+=(n[s]-r.x)*i[s]*t}function o(){if(e){var s,o=e.length;for(i=new Array(o),n=new Array(o),s=0;s<o;++s)i[s]=isNaN(n[s]=+t(e[s],s,e))?0:+r(e[s],s,e)}}return"function"!=typeof t&&(t=nx(null==t?0:+t)),s.initialize=function(t){e=t,o()},s.strength=function(t){return arguments.length?(r="function"==typeof t?t:nx(+t),o(),s):r},s.x=function(e){return arguments.length?(t="function"==typeof e?e:nx(+e),o(),s):t},s}function fx(t){var e,i,n,r=nx(.1);function s(t){for(var r,s=0,o=e.length;s<o;++s)(r=e[s]).vy+=(n[s]-r.y)*i[s]*t}function o(){if(e){var s,o=e.length;for(i=new Array(o),n=new Array(o),s=0;s<o;++s)i[s]=isNaN(n[s]=+t(e[s],s,e))?0:+r(e[s],s,e)}}return"function"!=typeof t&&(t=nx(null==t?0:+t)),s.initialize=function(t){e=t,o()},s.strength=function(t){return arguments.length?(r="function"==typeof t?t:nx(+t),o(),s):r},s.y=function(e){return arguments.length?(t="function"==typeof e?e:nx(+e),o(),s):t},s}function px(t){var e=0,i=t.children,n=i&&i.length;if(n)for(;--n>=0;)e+=i[n].value;else e=1;t.value=e}function gx(t,e){t instanceof Map?(t=[void 0,t],void 0===e&&(e=mx)):void 0===e&&(e=vx);for(var i,n,r,s,o,a=new wx(t),l=[a];i=l.pop();)if((r=e(i.data))&&(o=(r=Array.from(r)).length))for(i.children=r,s=o-1;s>=0;--s)l.push(n=r[s]=new wx(r[s])),n.parent=i,n.depth=i.depth+1;return a.eachBefore(bx)}function vx(t){return t.children}function mx(t){return Array.isArray(t)?t[1]:null}function yx(t){void 0!==t.data.value&&(t.value=t.data.value),t.data=t.data.data}function bx(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function wx(t){this.data=t,this.depth=this.height=0,this.parent=null}function _x(t,e){var i,n;if(Cx(e,t))return[e];for(i=0;i<t.length;++i)if(xx(e,t[i])&&Cx(Ex(t[i],e),t))return[t[i],e];for(i=0;i<t.length-1;++i)for(n=i+1;n<t.length;++n)if(xx(Ex(t[i],t[n]),e)&&xx(Ex(t[i],e),t[n])&&xx(Ex(t[n],e),t[i])&&Cx(Ax(t[i],t[n],e),t))return[t[i],t[n],e];throw new Error}function xx(t,e){var i=t.r-e.r,n=e.x-t.x,r=e.y-t.y;return i<0||i*i<n*n+r*r}function kx(t,e){var i=t.r-e.r+1e-9*Math.max(t.r,e.r,1),n=e.x-t.x,r=e.y-t.y;return i>0&&i*i>n*n+r*r}function Cx(t,e){for(var i=0;i<e.length;++i)if(!kx(t,e[i]))return!1;return!0}function Sx(t){switch(t.length){case 1:return{x:(e=t[0]).x,y:e.y,r:e.r};case 2:return Ex(t[0],t[1]);case 3:return Ax(t[0],t[1],t[2])}var e}function Ex(t,e){var i=t.x,n=t.y,r=t.r,s=e.x,o=e.y,a=e.r,l=s-i,h=o-n,c=a-r,u=Math.sqrt(l*l+h*h);return{x:(i+s+l/u*c)/2,y:(n+o+h/u*c)/2,r:(u+r+a)/2}}function Ax(t,e,i){var n=t.x,r=t.y,s=t.r,o=e.x,a=e.y,l=e.r,h=i.x,c=i.y,u=i.r,d=n-o,f=n-h,p=r-a,g=r-c,v=l-s,m=u-s,y=n*n+r*r-s*s,b=y-o*o-a*a+l*l,w=y-h*h-c*c+u*u,_=f*p-d*g,x=(p*w-g*b)/(2*_)-n,k=(g*v-p*m)/_,C=(f*b-d*w)/(2*_)-r,S=(d*m-f*v)/_,E=k*k+S*S-1,A=2*(s+x*k+C*S),T=x*x+C*C-s*s,M=-(E?(A+Math.sqrt(A*A-4*E*T))/(2*E):T/A);return{x:n+x+k*M,y:r+C+S*M,r:M}}function Tx(t,e,i){var n,r,s,o,a=t.x-e.x,l=t.y-e.y,h=a*a+l*l;h?(r=e.r+i.r,r*=r,o=t.r+i.r,r>(o*=o)?(n=(h+o-r)/(2*h),s=Math.sqrt(Math.max(0,o/h-n*n)),i.x=t.x-n*a-s*l,i.y=t.y-n*l+s*a):(n=(h+r-o)/(2*h),s=Math.sqrt(Math.max(0,r/h-n*n)),i.x=e.x+n*a-s*l,i.y=e.y+n*l+s*a)):(i.x=e.x+i.r,i.y=e.y)}function Mx(t,e){var i=t.r+e.r-1e-6,n=e.x-t.x,r=e.y-t.y;return i>0&&i*i>n*n+r*r}function Ox(t){var e=t._,i=t.next._,n=e.r+i.r,r=(e.x*i.r+i.x*e.r)/n,s=(e.y*i.r+i.y*e.r)/n;return r*r+s*s}function Px(t){this._=t,this.next=null,this.previous=null}function Rx(t){return null==t?null:function(t){if("function"!=typeof t)throw new Error;return t}(t)}function Lx(){return 0}function Ix(t){return function(){return t}}function $x(t){return Math.sqrt(t.value)}function Dx(){var t=null,e=1,i=1,n=Lx;function r(r){return r.x=e/2,r.y=i/2,t?r.eachBefore(Nx(t)).eachAfter(jx(n,.5)).eachBefore(Bx(1)):r.eachBefore(Nx($x)).eachAfter(jx(Lx,1)).eachAfter(jx(n,r.r/Math.min(e,i))).eachBefore(Bx(Math.min(e,i)/(2*r.r))),r}return r.radius=function(e){return arguments.length?(t=Rx(e),r):t},r.size=function(t){return arguments.length?(e=+t[0],i=+t[1],r):[e,i]},r.padding=function(t){return arguments.length?(n="function"==typeof t?t:Ix(+t),r):n},r}function Nx(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function jx(t,e){return function(i){if(n=i.children){var n,r,s,o=n.length,a=t(i)*e||0;if(a)for(r=0;r<o;++r)n[r].r+=a;if(s=function(t){if(!(r=(t=function(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}(t)).length))return 0;var e,i,n,r,s,o,a,l,h,c,u;if((e=t[0]).x=0,e.y=0,!(r>1))return e.r;if(i=t[1],e.x=-i.r,i.x=e.r,i.y=0,!(r>2))return e.r+i.r;Tx(i,e,n=t[2]),e=new Px(e),i=new Px(i),n=new Px(n),e.next=n.previous=i,i.next=e.previous=n,n.next=i.previous=e;t:for(a=3;a<r;++a){Tx(e._,i._,n=t[a]),n=new Px(n),l=i.next,h=e.previous,c=i._.r,u=e._.r;do{if(c<=u){if(Mx(l._,n._)){i=l,e.next=i,i.previous=e,--a;continue t}c+=l._.r,l=l.next}else{if(Mx(h._,n._)){(e=h).next=i,i.previous=e,--a;continue t}u+=h._.r,h=h.previous}}while(l!==h.next);for(n.previous=e,n.next=i,e.next=i.previous=i=n,s=Ox(e);(n=n.next)!==i;)(o=Ox(n))<s&&(e=n,s=o);i=e.next}for(e=[i._],n=i;(n=n.next)!==i;)e.push(n._);for(n=function(t){for(var e,i,n=0,r=(t=function(t){for(var e,i,n=t.length;n;)i=Math.random()*n--|0,e=t[n],t[n]=t[i],t[i]=e;return t}(Array.from(t))).length,s=[];n<r;)e=t[n],i&&kx(i,e)?++n:(i=Sx(s=_x(s,e)),n=0);return i}(e),a=0;a<r;++a)(e=t[a]).x-=n.x,e.y-=n.y;return n.r}(n),a)for(r=0;r<o;++r)n[r].r-=a;i.r=s+a}}}function Bx(t){return function(e){var i=e.parent;e.r*=t,i&&(e.x=i.x+t*e.x,e.y=i.y+t*e.y)}}wx.prototype=gx.prototype={constructor:wx,count:function(){return this.eachAfter(px)},each:function(t,e){let i=-1;for(const n of this)t.call(e,n,++i,this);return this},eachAfter:function(t,e){for(var i,n,r,s=this,o=[s],a=[],l=-1;s=o.pop();)if(a.push(s),i=s.children)for(n=0,r=i.length;n<r;++n)o.push(i[n]);for(;s=a.pop();)t.call(e,s,++l,this);return this},eachBefore:function(t,e){for(var i,n,r=this,s=[r],o=-1;r=s.pop();)if(t.call(e,r,++o,this),i=r.children)for(n=i.length-1;n>=0;--n)s.push(i[n]);return this},find:function(t,e){let i=-1;for(const n of this)if(t.call(e,n,++i,this))return n},sum:function(t){return this.eachAfter((function(e){for(var i=+t(e.data)||0,n=e.children,r=n&&n.length;--r>=0;)i+=n[r].value;e.value=i}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,i=function(t,e){if(t===e)return t;var i=t.ancestors(),n=e.ancestors(),r=null;for(t=i.pop(),e=n.pop();t===e;)r=t,t=i.pop(),e=n.pop();return r}(e,t),n=[e];e!==i;)e=e.parent,n.push(e);for(var r=n.length;t!==i;)n.splice(r,0,t),t=t.parent;return n},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){return Array.from(this)},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(i){i!==t&&e.push({source:i.parent,target:i})})),e},copy:function(){return gx(this).eachBefore(yx)},[Symbol.iterator]:function*(){var t,e,i,n,r=this,s=[r];do{for(t=s.reverse(),s=[];r=t.pop();)if(yield r,e=r.children)for(i=0,n=e.length;i<n;++i)s.push(e[i])}while(s.length)}};const Fx=function t(e){function i(t,i){return t=null==t?0:+t,i=null==i?1:+i,1===arguments.length?(i=t,t=0):i-=t,function(){return e()*i+t}}return i.source=t,i}(Math.random);function zx(t,e,i){t=+t,e=+e,i=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+i;for(var n=-1,r=0|Math.max(0,Math.ceil((e-t)/i)),s=new Array(r);++n<r;)s[n]=t+n*i;return s}function Ux(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}class Gx extends Map{constructor(t,e=Vx){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const[e,i]of t)this.set(e,i)}get(t){return super.get(Hx(this,t))}has(t){return super.has(Hx(this,t))}set(t,e){return super.set(function({_intern:t,_key:e},i){const n=e(i);return t.has(n)?t.get(n):(t.set(n,i),i)}(this,t),e)}delete(t){return super.delete(function({_intern:t,_key:e},i){const n=e(i);return t.has(n)&&(i=t.get(n),t.delete(n)),i}(this,t))}}function Hx({_intern:t,_key:e},i){const n=e(i);return t.has(n)?t.get(n):i}function Vx(t){return null!==t&&"object"==typeof t?t.valueOf():t}Set;const qx=Symbol("implicit");function Wx(){var t=new Gx,e=[],i=[],n=qx;function r(r){let s=t.get(r);if(void 0===s){if(n!==qx)return n;t.set(r,s=e.push(r)-1)}return i[s%i.length]}return r.domain=function(i){if(!arguments.length)return e.slice();e=[],t=new Gx;for(const n of i)t.has(n)||t.set(n,e.push(n)-1);return r},r.range=function(t){return arguments.length?(i=Array.from(t),r):i.slice()},r.unknown=function(t){return arguments.length?(n=t,r):n},r.copy=function(){return Wx(e,i).unknown(n)},Ux.apply(r,arguments),r}function Yx(){var t,e,i=Wx().unknown(void 0),n=i.domain,r=i.range,s=0,o=1,a=!1,l=0,h=0,c=.5;function u(){var i=n().length,u=o<s,d=u?o:s,f=u?s:o;t=(f-d)/Math.max(1,i-l+2*h),a&&(t=Math.floor(t)),d+=(f-d-t*(i-l))*c,e=t*(1-l),a&&(d=Math.round(d),e=Math.round(e));var p=zx(i).map((function(e){return d+t*e}));return r(u?p.reverse():p)}return delete i.unknown,i.domain=function(t){return arguments.length?(n(t),u()):n()},i.range=function(t){return arguments.length?([s,o]=t,s=+s,o=+o,u()):[s,o]},i.rangeRound=function(t){return[s,o]=t,s=+s,o=+o,a=!0,u()},i.bandwidth=function(){return e},i.step=function(){return t},i.round=function(t){return arguments.length?(a=!!t,u()):a},i.padding=function(t){return arguments.length?(l=Math.min(1,h=+t),u()):l},i.paddingInner=function(t){return arguments.length?(l=Math.min(1,t),u()):l},i.paddingOuter=function(t){return arguments.length?(h=+t,u()):h},i.align=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),u()):c},i.copy=function(){return Yx(n(),[s,o]).round(a).paddingInner(l).paddingOuter(h).align(c)},Ux.apply(u(),arguments)}var Xx=Math.sqrt(50),Kx=Math.sqrt(10),Qx=Math.sqrt(2);function Zx(t,e,i){var n=(e-t)/Math.max(0,i),r=Math.floor(Math.log(n)/Math.LN10),s=n/Math.pow(10,r);return r>=0?(s>=Xx?10:s>=Kx?5:s>=Qx?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(s>=Xx?10:s>=Kx?5:s>=Qx?2:1)}function Jx(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function tk(t){let e=t,i=t,n=t;function r(t,e,r=0,s=t.length){if(r<s){if(0!==i(e,e))return s;do{const i=r+s>>>1;n(t[i],e)<0?r=i+1:s=i}while(r<s)}return r}return 2!==t.length&&(e=(e,i)=>t(e)-i,i=Jx,n=(e,i)=>Jx(t(e),i)),{left:r,center:function(t,i,n=0,s=t.length){const o=r(t,i,n,s-1);return o>n&&e(t[o-1],i)>-e(t[o],i)?o-1:o},right:function(t,e,r=0,s=t.length){if(r<s){if(0!==i(e,e))return s;do{const i=r+s>>>1;n(t[i],e)<=0?r=i+1:s=i}while(r<s)}return r}}}const ek=tk(Jx),ik=ek.right,nk=(ek.left,tk((function(t){return null===t?NaN:+t})).center,ik);function rk(t,e){var i,n=e?e.length:0,r=t?Math.min(n,t.length):0,s=new Array(r),o=new Array(n);for(i=0;i<r;++i)s[i]=lk(t[i],e[i]);for(;i<n;++i)o[i]=e[i];return function(t){for(i=0;i<r;++i)o[i]=s[i](t);return o}}function sk(t,e){var i=new Date;return t=+t,e=+e,function(n){return i.setTime(t*(1-n)+e*n),i}}function ok(t,e){var i,n={},r={};for(i in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)i in t?n[i]=lk(t[i],e[i]):r[i]=e[i];return function(t){for(i in n)r[i]=n[i](t);return r}}function ak(t,e){e||(e=[]);var i,n=t?Math.min(e.length,t.length):0,r=e.slice();return function(s){for(i=0;i<n;++i)r[i]=t[i]*(1-s)+e[i]*s;return r}}function lk(t,e){var i,n=typeof e;return null==e||"boolean"===n?h_(e):("number"===n?ww:"string"===n?(i=Xw(e))?(e=i,u_):g_:e instanceof Xw?u_:e instanceof Date?sk:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}(e)?ak:Array.isArray(e)?rk:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?ok:ww)(t,e)}function hk(t,e){return t=+t,e=+e,function(i){return Math.round(t*(1-i)+e*i)}}function ck(t){return+t}var uk=[0,1];function dk(t){return t}function fk(t,e){return(e-=t=+t)?function(i){return(i-t)/e}:function(t){return function(){return t}}(isNaN(e)?NaN:.5)}function pk(t,e,i){var n=t[0],r=t[1],s=e[0],o=e[1];return r<n?(n=fk(r,n),s=i(o,s)):(n=fk(n,r),s=i(s,o)),function(t){return s(n(t))}}function gk(t,e,i){var n=Math.min(t.length,e.length)-1,r=new Array(n),s=new Array(n),o=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<n;)r[o]=fk(t[o],t[o+1]),s[o]=i(e[o],e[o+1]);return function(e){var i=nk(t,e,1,n)-1;return s[i](r[i](e))}}function vk(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function mk(){return function(){var t,e,i,n,r,s,o=uk,a=uk,l=lk,h=dk;function c(){var t=Math.min(o.length,a.length);return h!==dk&&(h=function(t,e){var i;return t>e&&(i=t,t=e,e=i),function(i){return Math.max(t,Math.min(e,i))}}(o[0],o[t-1])),n=t>2?gk:pk,r=s=null,u}function u(e){return null==e||isNaN(e=+e)?i:(r||(r=n(o.map(t),a,l)))(t(h(e)))}return u.invert=function(i){return h(e((s||(s=n(a,o.map(t),ww)))(i)))},u.domain=function(t){return arguments.length?(o=Array.from(t,ck),c()):o.slice()},u.range=function(t){return arguments.length?(a=Array.from(t),c()):a.slice()},u.rangeRound=function(t){return a=Array.from(t),l=hk,c()},u.clamp=function(t){return arguments.length?(h=!!t||dk,c()):h!==dk},u.interpolate=function(t){return arguments.length?(l=t,c()):l},u.unknown=function(t){return arguments.length?(i=t,u):i},function(i,n){return t=i,e=n,c()}}()(dk,dk)}var yk,bk=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function wk(t){if(!(e=bk.exec(t)))throw new Error("invalid format: "+t);var e;return new _k({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function _k(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function xk(t,e){if((i=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var i,n=t.slice(0,i);return[n.length>1?n[0]+n.slice(2):n,+t.slice(i+1)]}function kk(t){return(t=xk(Math.abs(t)))?t[1]:NaN}function Ck(t,e){var i=xk(t,e);if(!i)return t+"";var n=i[0],r=i[1];return r<0?"0."+new Array(-r).join("0")+n:n.length>r+1?n.slice(0,r+1)+"."+n.slice(r+1):n+new Array(r-n.length+2).join("0")}wk.prototype=_k.prototype,_k.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const Sk={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Ck(100*t,e),r:Ck,s:function(t,e){var i=xk(t,e);if(!i)return t+"";var n=i[0],r=i[1],s=r-(yk=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,o=n.length;return s===o?n:s>o?n+new Array(s-o+1).join("0"):s>0?n.slice(0,s)+"."+n.slice(s):"0."+new Array(1-s).join("0")+xk(t,Math.max(0,e+s-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Ek(t){return t}var Ak,Tk,Mk,Ok=Array.prototype.map,Pk=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Rk(t){var e=t.domain;return t.ticks=function(t){var i=e();return function(t,e,i){var n,r,s,o,a=-1;if(i=+i,(t=+t)==(e=+e)&&i>0)return[t];if((n=e<t)&&(r=t,t=e,e=r),0===(o=Zx(t,e,i))||!isFinite(o))return[];if(o>0){let i=Math.round(t/o),n=Math.round(e/o);for(i*o<t&&++i,n*o>e&&--n,s=new Array(r=n-i+1);++a<r;)s[a]=(i+a)*o}else{o=-o;let i=Math.round(t*o),n=Math.round(e*o);for(i/o<t&&++i,n/o>e&&--n,s=new Array(r=n-i+1);++a<r;)s[a]=(i+a)/o}return n&&s.reverse(),s}(i[0],i[i.length-1],null==t?10:t)},t.tickFormat=function(t,i){var n=e();return function(t,e,i,n){var r,s=function(t,e,i){var n=Math.abs(e-t)/Math.max(0,i),r=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),s=n/r;return s>=Xx?r*=10:s>=Kx?r*=5:s>=Qx&&(r*=2),e<t?-r:r}(t,e,i);switch((n=wk(null==n?",f":n)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=n.precision||isNaN(r=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(kk(e)/3)))-kk(Math.abs(t)))}(s,o))||(n.precision=r),Mk(n,o);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(r=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,kk(e)-kk(t))+1}(s,Math.max(Math.abs(t),Math.abs(e))))||(n.precision=r-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(r=function(t){return Math.max(0,-kk(Math.abs(t)))}(s))||(n.precision=r-2*("%"===n.type))}return Tk(n)}(n[0],n[n.length-1],null==t?10:t,i)},t.nice=function(i){null==i&&(i=10);var n,r,s=e(),o=0,a=s.length-1,l=s[o],h=s[a],c=10;for(h<l&&(r=l,l=h,h=r,r=o,o=a,a=r);c-- >0;){if((r=Zx(l,h,i))===n)return s[o]=l,s[a]=h,e(s);if(r>0)l=Math.floor(l/r)*r,h=Math.ceil(h/r)*r;else{if(!(r<0))break;l=Math.ceil(l*r)/r,h=Math.floor(h*r)/r}n=r}return t},t}function Lk(){var t=mk();return t.copy=function(){return vk(t,Lk())},Ux.apply(t,arguments),Rk(t)}function Ik(t){return"string"==typeof t?new Bb([[document.querySelector(t)]],[document.documentElement]):new Bb([[t]],jb)}Ak=function(t){var e,i,n=void 0===t.grouping||void 0===t.thousands?Ek:(e=Ok.call(t.grouping,Number),i=t.thousands+"",function(t,n){for(var r=t.length,s=[],o=0,a=e[0],l=0;r>0&&a>0&&(l+a+1>n&&(a=Math.max(1,n-l)),s.push(t.substring(r-=a,r+a)),!((l+=a+1)>n));)a=e[o=(o+1)%e.length];return s.reverse().join(i)}),r=void 0===t.currency?"":t.currency[0]+"",s=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",a=void 0===t.numerals?Ek:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(Ok.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",h=void 0===t.minus?"−":t.minus+"",c=void 0===t.nan?"NaN":t.nan+"";function u(t){var e=(t=wk(t)).fill,i=t.align,u=t.sign,d=t.symbol,f=t.zero,p=t.width,g=t.comma,v=t.precision,m=t.trim,y=t.type;"n"===y?(g=!0,y="g"):Sk[y]||(void 0===v&&(v=12),m=!0,y="g"),(f||"0"===e&&"="===i)&&(f=!0,e="0",i="=");var b="$"===d?r:"#"===d&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",w="$"===d?s:/[%p]/.test(y)?l:"",_=Sk[y],x=/[defgprs%]/.test(y);function k(t){var r,s,l,d=b,k=w;if("c"===y)k=_(t)+k,t="";else{var C=(t=+t)<0||1/t<0;if(t=isNaN(t)?c:_(Math.abs(t),v),m&&(t=function(t){t:for(var e,i=t.length,n=1,r=-1;n<i;++n)switch(t[n]){case".":r=e=n;break;case"0":0===r&&(r=n),e=n;break;default:if(!+t[n])break t;r>0&&(r=0)}return r>0?t.slice(0,r)+t.slice(e+1):t}(t)),C&&0==+t&&"+"!==u&&(C=!1),d=(C?"("===u?u:h:"-"===u||"("===u?"":u)+d,k=("s"===y?Pk[8+yk/3]:"")+k+(C&&"("===u?")":""),x)for(r=-1,s=t.length;++r<s;)if(48>(l=t.charCodeAt(r))||l>57){k=(46===l?o+t.slice(r+1):t.slice(r))+k,t=t.slice(0,r);break}}g&&!f&&(t=n(t,1/0));var S=d.length+t.length+k.length,E=S<p?new Array(p-S+1).join(e):"";switch(g&&f&&(t=n(E+t,E.length?p-k.length:1/0),E=""),i){case"<":t=d+t+k+E;break;case"=":t=d+E+t+k;break;case"^":t=E.slice(0,S=E.length>>1)+d+t+k+E.slice(S);break;default:t=E+d+t+k}return a(t)}return v=void 0===v?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),k.toString=function(){return t+""},k}return{format:u,formatPrefix:function(t,e){var i=u(((t=wk(t)).type="f",t)),n=3*Math.max(-8,Math.min(8,Math.floor(kk(e)/3))),r=Math.pow(10,-n),s=Pk[8+n/3];return function(t){return i(r*t)+s}}}}({thousands:",",grouping:[3],currency:["$",""]}),Tk=Ak.format,Mk=Ak.formatPrefix;const $k={capture:!0,passive:!1};function Dk(t){t.preventDefault(),t.stopImmediatePropagation()}function Nk(t){var e=t.document.documentElement,i=Ik(t).on("dragstart.drag",Dk,$k);"onselectstart"in e?i.on("selectstart.drag",Dk,$k):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function jk(t,e){var i=t.document.documentElement,n=Ik(t).on("dragstart.drag",null);e&&(n.on("click.drag",Dk,$k),setTimeout((function(){n.on("click.drag",null)}),0)),"onselectstart"in i?n.on("selectstart.drag",null):(i.style.MozUserSelect=i.__noselect,delete i.__noselect)}function Bk(t){return((t=Math.exp(t))+1/t)/2}const Fk=function t(e,i,n){function r(t,r){var s,o,a=t[0],l=t[1],h=t[2],c=r[0],u=r[1],d=r[2],f=c-a,p=u-l,g=f*f+p*p;if(g<1e-12)o=Math.log(d/h)/e,s=function(t){return[a+t*f,l+t*p,h*Math.exp(e*t*o)]};else{var v=Math.sqrt(g),m=(d*d-h*h+n*g)/(2*h*i*v),y=(d*d-h*h-n*g)/(2*d*i*v),b=Math.log(Math.sqrt(m*m+1)-m),w=Math.log(Math.sqrt(y*y+1)-y);o=(w-b)/e,s=function(t){var n=t*o,r=Bk(b),s=h/(i*v)*(r*function(t){return((t=Math.exp(2*t))-1)/(t+1)}(e*n+b)-function(t){return((t=Math.exp(t))-1/t)/2}(b));return[a+s*f,l+s*p,h*r/Bk(e*n+b)]}}return s.duration=1e3*o*e/Math.SQRT2,s}return r.rho=function(e){var i=Math.max(.001,+e),n=i*i;return t(i,n,n*n)},r}(Math.SQRT2,2,4);function zk(t,e){if(t=function(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var i=e.ownerSVGElement||e;if(i.createSVGPoint){var n=i.createSVGPoint();return n.x=t.clientX,n.y=t.clientY,[(n=n.matrixTransform(e.getScreenCTM().inverse())).x,n.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]}}return[t.pageX,t.pageY]}const Uk=t=>()=>t;function Gk(t,{sourceEvent:e,target:i,transform:n,dispatch:r}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:r}})}function Hk(t,e,i){this.k=t,this.x=e,this.y=i}Hk.prototype={constructor:Hk,scale:function(t){return 1===t?this:new Hk(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new Hk(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Vk=new Hk(1,0,0);function qk(t){t.stopImmediatePropagation()}function Wk(t){t.preventDefault(),t.stopImmediatePropagation()}function Yk(t){return!(t.ctrlKey&&"wheel"!==t.type||t.button)}function Xk(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function Kk(){return this.__zoom||Vk}function Qk(t){return-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function Zk(){return navigator.maxTouchPoints||"ontouchstart"in this}function Jk(t,e,i){var n=t.invertX(e[0][0])-i[0][0],r=t.invertX(e[1][0])-i[1][0],s=t.invertY(e[0][1])-i[0][1],o=t.invertY(e[1][1])-i[1][1];return t.translate(r>n?(n+r)/2:Math.min(0,n)||Math.max(0,r),o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o))}function tC(){var t,e,i,n=Yk,r=Xk,s=Jk,o=Qk,a=Zk,l=[0,1/0],h=[[-1/0,-1/0],[1/0,1/0]],c=250,u=Fk,d=Yb("start","zoom","end"),f=500,p=0,g=10;function v(t){t.property("__zoom",Kk).on("wheel.zoom",k,{passive:!1}).on("mousedown.zoom",C).on("dblclick.zoom",S).filter(a).on("touchstart.zoom",E).on("touchmove.zoom",A).on("touchend.zoom touchcancel.zoom",T).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(t,e){return(e=Math.max(l[0],Math.min(l[1],e)))===t.k?t:new Hk(e,t.x,t.y)}function y(t,e,i){var n=e[0]-i[0]*t.k,r=e[1]-i[1]*t.k;return n===t.x&&r===t.y?t:new Hk(t.k,n,r)}function b(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function w(t,e,i,n){t.on("start.zoom",(function(){_(this,arguments).event(n).start()})).on("interrupt.zoom end.zoom",(function(){_(this,arguments).event(n).end()})).tween("zoom",(function(){var t=this,s=arguments,o=_(t,s).event(n),a=r.apply(t,s),l=null==i?b(a):"function"==typeof i?i.apply(t,s):i,h=Math.max(a[1][0]-a[0][0],a[1][1]-a[0][1]),c=t.__zoom,d="function"==typeof e?e.apply(t,s):e,f=u(c.invert(l).concat(h/c.k),d.invert(l).concat(h/d.k));return function(t){if(1===t)t=d;else{var e=f(t),i=h/e[2];t=new Hk(i,l[0]-e[0]*i,l[1]-e[1]*i)}o.zoom(null,t)}}))}function _(t,e,i){return!i&&t.__zooming||new x(t,e)}function x(t,e){this.that=t,this.args=e,this.active=0,this.sourceEvent=null,this.extent=r.apply(t,e),this.taps=0}function k(t,...e){if(n.apply(this,arguments)){var i=_(this,e).event(t),r=this.__zoom,a=Math.max(l[0],Math.min(l[1],r.k*Math.pow(2,o.apply(this,arguments)))),c=zk(t);if(i.wheel)i.mouse[0][0]===c[0]&&i.mouse[0][1]===c[1]||(i.mouse[1]=r.invert(i.mouse[0]=c)),clearTimeout(i.wheel);else{if(r.k===a)return;i.mouse=[c,r.invert(c)],bw(this),i.start()}Wk(t),i.wheel=setTimeout(u,150),i.zoom("mouse",s(y(m(r,a),i.mouse[0],i.mouse[1]),i.extent,h))}function u(){i.wheel=null,i.end()}}function C(t,...e){if(!i&&n.apply(this,arguments)){var r=t.currentTarget,o=_(this,e,!0).event(t),a=Ik(t.view).on("mousemove.zoom",d,!0).on("mouseup.zoom",f,!0),l=zk(t,r),c=t.clientX,u=t.clientY;Nk(t.view),qk(t),o.mouse=[l,this.__zoom.invert(l)],bw(this),o.start()}function d(t){if(Wk(t),!o.moved){var e=t.clientX-c,i=t.clientY-u;o.moved=e*e+i*i>p}o.event(t).zoom("mouse",s(y(o.that.__zoom,o.mouse[0]=zk(t,r),o.mouse[1]),o.extent,h))}function f(t){a.on("mousemove.zoom mouseup.zoom",null),jk(t.view,o.moved),Wk(t),o.event(t).end()}}function S(t,...e){if(n.apply(this,arguments)){var i=this.__zoom,o=zk(t.changedTouches?t.changedTouches[0]:t,this),a=i.invert(o),l=i.k*(t.shiftKey?.5:2),u=s(y(m(i,l),o,a),r.apply(this,e),h);Wk(t),c>0?Ik(this).transition().duration(c).call(w,u,o,t):Ik(this).call(v.transform,u,o,t)}}function E(i,...r){if(n.apply(this,arguments)){var s,o,a,l,h=i.touches,c=h.length,u=_(this,r,i.changedTouches.length===c).event(i);for(qk(i),o=0;o<c;++o)l=[l=zk(a=h[o],this),this.__zoom.invert(l),a.identifier],u.touch0?u.touch1||u.touch0[2]===l[2]||(u.touch1=l,u.taps=0):(u.touch0=l,s=!0,u.taps=1+!!t);t&&(t=clearTimeout(t)),s&&(u.taps<2&&(e=l[0],t=setTimeout((function(){t=null}),f)),bw(this),u.start())}}function A(t,...e){if(this.__zooming){var i,n,r,o,a=_(this,e).event(t),l=t.changedTouches,c=l.length;for(Wk(t),i=0;i<c;++i)r=zk(n=l[i],this),a.touch0&&a.touch0[2]===n.identifier?a.touch0[0]=r:a.touch1&&a.touch1[2]===n.identifier&&(a.touch1[0]=r);if(n=a.that.__zoom,a.touch1){var u=a.touch0[0],d=a.touch0[1],f=a.touch1[0],p=a.touch1[1],g=(g=f[0]-u[0])*g+(g=f[1]-u[1])*g,v=(v=p[0]-d[0])*v+(v=p[1]-d[1])*v;n=m(n,Math.sqrt(g/v)),r=[(u[0]+f[0])/2,(u[1]+f[1])/2],o=[(d[0]+p[0])/2,(d[1]+p[1])/2]}else{if(!a.touch0)return;r=a.touch0[0],o=a.touch0[1]}a.zoom("touch",s(y(n,r,o),a.extent,h))}}function T(t,...n){if(this.__zooming){var r,s,o=_(this,n).event(t),a=t.changedTouches,l=a.length;for(qk(t),i&&clearTimeout(i),i=setTimeout((function(){i=null}),f),r=0;r<l;++r)s=a[r],o.touch0&&o.touch0[2]===s.identifier?delete o.touch0:o.touch1&&o.touch1[2]===s.identifier&&delete o.touch1;if(o.touch1&&!o.touch0&&(o.touch0=o.touch1,delete o.touch1),o.touch0)o.touch0[1]=this.__zoom.invert(o.touch0[0]);else if(o.end(),2===o.taps&&(s=zk(s,this),Math.hypot(e[0]-s[0],e[1]-s[1])<g)){var h=Ik(this).on("dblclick.zoom");h&&h.apply(this,arguments)}}}return v.transform=function(t,e,i,n){var r=t.selection?t.selection():t;r.property("__zoom",Kk),t!==r?w(t,e,i,n):r.interrupt().each((function(){_(this,arguments).event(n).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()}))},v.scaleBy=function(t,e,i,n){v.scaleTo(t,(function(){return this.__zoom.k*("function"==typeof e?e.apply(this,arguments):e)}),i,n)},v.scaleTo=function(t,e,i,n){v.transform(t,(function(){var t=r.apply(this,arguments),n=this.__zoom,o=null==i?b(t):"function"==typeof i?i.apply(this,arguments):i,a=n.invert(o),l="function"==typeof e?e.apply(this,arguments):e;return s(y(m(n,l),o,a),t,h)}),i,n)},v.translateBy=function(t,e,i,n){v.transform(t,(function(){return s(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof i?i.apply(this,arguments):i),r.apply(this,arguments),h)}),null,n)},v.translateTo=function(t,e,i,n,o){v.transform(t,(function(){var t=r.apply(this,arguments),o=this.__zoom,a=null==n?b(t):"function"==typeof n?n.apply(this,arguments):n;return s(Vk.translate(a[0],a[1]).scale(o.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof i?-i.apply(this,arguments):-i),t,h)}),n,o)},x.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var e=Ik(this.that).datum();d.call(t,this.that,new Gk(t,{sourceEvent:this.sourceEvent,target:v,type:t,transform:this.that.__zoom,dispatch:d}),e)}},v.wheelDelta=function(t){return arguments.length?(o="function"==typeof t?t:Uk(+t),v):o},v.filter=function(t){return arguments.length?(n="function"==typeof t?t:Uk(!!t),v):n},v.touchable=function(t){return arguments.length?(a="function"==typeof t?t:Uk(!!t),v):a},v.extent=function(t){return arguments.length?(r="function"==typeof t?t:Uk([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),v):r},v.scaleExtent=function(t){return arguments.length?(l[0]=+t[0],l[1]=+t[1],v):[l[0],l[1]]},v.translateExtent=function(t){return arguments.length?(h[0][0]=+t[0][0],h[1][0]=+t[1][0],h[0][1]=+t[0][1],h[1][1]=+t[1][1],v):[[h[0][0],h[0][1]],[h[1][0],h[1][1]]]},v.constrain=function(t){return arguments.length?(s=t,v):s},v.duration=function(t){return arguments.length?(c=+t,v):c},v.interpolate=function(t){return arguments.length?(u=t,v):u},v.on=function(){var t=d.on.apply(d,arguments);return t===d?v:t},v.clickDistance=function(t){return arguments.length?(p=(t=+t)*t,v):Math.sqrt(p)},v.tapDistance=function(t){return arguments.length?(g=+t,v):g},v}Hk.prototype;var eC,iC,nC,rC,sC,oC=n(99),aC=n.n(oC);class lC{createCircle(t){return new Cy.Circle({x:t.x??0,y:t.y??0,radius:t.radius??0,fill:t.fill??"",stroke:t.stroke??"",opacity:t.opacity??1,strokeWidth:t.strokeWidth??1,listening:t.listening??!1,perfectDrawEnabled:t.perfectDrawEnabled??!1,shadowForStrokeEnabled:t.shadowForStrokeEnabled??!1})}createArc(t){let e=new Cy.Arc({innerRadius:t.innerRadius??0,outerRadius:t.outerRadius??10,angle:t.angle??180,fill:t.fill??"",opacity:t.opacity??1,listening:t.listening??!1,perfectDrawEnabled:t.perfectDrawEnabled??!1,shadowForStrokeEnabled:t.shadowForStrokeEnabled??!1});return t.type&&(e.type=t.type),e.data={fill:t.fill??""},e}createTextArea(t){return new Cy.Text({x:(t.x??0)-(t.width??10)/2,y:(t.y??0)-(t.height??10)/2,fill:t.fill??"",text:t.text??"",width:t.width??10,height:t.height??10,fontSize:t.fontSize??12,padding:t.padding??2,opacity:t.opacity??1,wrap:t.wrap??"word",align:t.align??"center",verticalAlign:t.verticalAlign??"middle",listening:t.listening??!1,perfectDrawEnabled:t.perfectDrawEnabled??!1,shadowForStrokeEnabled:t.shadowForStrokeEnabled??!1,fontFamily:"Inter"})}createText(t){let e=new Cy.Text({x:t.x??0,y:t.y??0,fill:t.fill??"",fontSize:t.fontSize??12,text:t.text,opacity:t.opacity??1,listening:!1,perfectDrawEnabled:!1,shadowForStrokeEnabled:!1,fontFamily:"Inter"}),i=t.textAlignX??"left",n=t.textAlignY??"top";return"right"==i&&e.offsetX(e.width()),"center"==i&&e.offsetX(.5*e.width()),"bottom"==n&&e.offsetY(e.height()),"center"==n&&e.offsetY(.5*e.height()),e}createRect(t){return new Cy.Rect({x:t.x??0,y:t.y??0,width:t.width??10,height:t.height??10,fill:t.fill??"",stroke:t.stroke??"",strokeWidth:t.strokeWidth??1,cornerRadius:t.cornerRadius??0,opacity:t.opacity??1,listening:t.listening??!1,perfectDrawEnabled:t.perfectDrawEnabled??!1,shadowForStrokeEnabled:t.shadowForStrokeEnabled??!1})}}function hC(t,e,i,n){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function cC(t,e,i,n,r){var s={};return Object.keys(n).forEach((function(t){s[t]=n[t]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(t,e,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(t,e,s),s=null),s}let uC=eh(e)(eC=fe(Element,Ho,cg,ug,lC)((iC=class{constructor(t,e,i,n,r){hC(this,"data",nC,this),hC(this,"height",rC,this),hC(this,"colors",sC,this),this.element=t,this.observerLocator=e,this.dataService=i,this.colorService=n,this.konvaHelper=r,this.element.classList.add("b2022-kg-story"),this.konva={},this.hasStarted=!1,this.tweens=[],this.dictionary={1:"modern geo stack",2:"early modern townlands",3:"irish exchequer index",4:"dib","modern geo stack":"Modern Places","early modern townlands":"Early Modern Townlands",dib:"Dictionary of Irish Biography","irish exchequer index":"Medieval People"}}async binding(){this.data||(this.data=await this.dataService.getData()),this.colors||(this.colors=this.colorService.getColors())}attached(){let t={handleChange:()=>{this.setCanvasDimensions(),this.setupVisualisation(),this.setupScrollamaSteps(),this.setupScrollama()}};this.observerLocator.getObserver(this.element.querySelector("div"),"clientWidth").subscribe(t),this.createCanvas(),this.setupPagePositionObserver(),t.handleChange()}createCanvas(){const t=this.element.querySelector(".konva-container"),e=new Cy.Stage({container:t}),i=new Cy.Layer,n=new Cy.Group;i.add(n),e.add(i),this.konva.stage=e,this.konva.layer=i,this.konva.group=n}setCanvasDimensions(){const t=this.element.querySelector(".konva-container"),e=Math.min(t.clientWidth,parseInt(this.height)||400),i=Math.min(t.clientWidth,parseInt(this.height)||400);this.konva.stage.width(e),this.konva.stage.height(i),this.konva.group.x(10),this.konva.group.y(10),this.konva.group.width(e-20),this.konva.group.height(i-20),this.konva.stage.content.style.marginLeft="auto",this.konva.stage.content.style.marginRight="auto"}setupPagePositionObserver(){this.observer=new IntersectionObserver(((t,e)=>{t.forEach((t=>{t.isIntersecting&&!this.hasStarted&&(console.log("👀 - Starting Vis 01"),this.hasStarted=!0),!t.isIntersecting&&this.hasStarted&&(console.log("👀 - Leaving Vis 01"),this.hasStarted=!1)}))}),{threshold:.5});let t=this.element.querySelector(".konva-container");this.observer.observe(t)}setupVisualisation(){this.konva.group.destroyChildren();let t=this.createNodes();t.forEach((t=>{this.addKonvaStuffToNode(t),"DIB"===t.data.name&&this.addGenderRepresentationsToDibNode(t),this.konva.group.add(t.konva.group)})),this.nodes=t}createNodes(){const t=Dx().size([this.konva.group.width(),this.konva.group.height()]),e={children:this.data.subgraphs.map((t=>({name:t.key,value:t.value})))},i=gx(e).sum((t=>t.value));return t(i),i.descendants()}addKonvaStuffToNode(t){let e=new Cy.Group({x:t.x,y:t.y}),i=this.konvaHelper.createCircle({radius:t.r,stroke:this.colors.FontDark,fill:0===t.depth?this.colors.GreenMuted:"white"}),n=t.data.name??"",r=this.konvaHelper.createTextArea({text:this.dictionary[n.toLowerCase()],width:2*t.r,height:2*t.r,fontSize:.3*t.r,padding:Math.min(.2*t.r,4),wrap:"word",opacity:t.r<20?0:1,fill:this.colors.FontDark});t.data.x=t.x,t.data.y=t.y,t.data.r=t.r,t.konva={group:e,circle:i,text:r},e.add(i,r)}addGenderRepresentationsToDibNode(t){let e=new Cy.Group,i=new Cy.Group,n=this.konvaHelper.createCircle({radius:0,stroke:this.colors.PurpleFull,strokeWidth:1,fill:this.colors.PurpleMuted,opacity:0}),r=this.konvaHelper.createCircle({radius:0,stroke:this.colors.YellowFull,strokeWidth:1,fill:this.colors.YellowMuted,opacity:0}),s=this.konvaHelper.createTextArea({width:2*t.r,height:2*t.r,text:"Men",fill:this.colors.FontDark,opacity:0}),o=this.konvaHelper.createTextArea({width:2*t.r,height:2*t.r,text:"Women",fill:this.colors.FontDark,opacity:0});e.add(n,s),i.add(r,o),t.konva.group.add(e),t.konva.group.add(i),t.konva.nested={group1:e,group2:i,circle1:n,circle2:r,text1:s,text2:o}}setupScrollamaSteps(){let t=this.element.querySelector(".scrollama-container"),e=t.querySelector(".sticky-container"),i=t.querySelector(".steps-container").querySelectorAll(".step");return i.forEach((t=>{let i=t.getAttribute("data-step"),n="0px",r=`${this.konva.stage.height()}px`;1==i&&(n=.5*e.clientHeight-.5*t.clientHeight+"px"),t.style.marginTop=n,t.style.marginBottom=r})),i}setupScrollama(){this.scroller&&this.scroller.destroy();let t=this.element.querySelector(".scrollama-container").querySelector(".sticky-container"),e=aC()(),i=this.setupScrollamaSteps(),n=.5*window.innerHeight-.5*this.konva.stage.height();t.style.top=`${n}px`,e.resize(),e.setup({step:i,offset:Math.floor(.5*window.innerHeight)+"px",debug:!1}).onStepEnter((t=>{this.stepEnterHandler(t)})).onStepExit((t=>{this.stepExitHandler(t)})),this.scroller=e}stepEnterHandler(t){}stepExitHandler(t){"2"===t.element.dataset.step&&("up"===t.direction?this.step2EnterUp():"down"===t.direction&&this.step2EnterDown()),"3"===t.element.dataset.step&&("up"===t.direction?this.step3EnterUp():"down"===t.direction&&this.step3EnterDown())}step2EnterUp(){this.checkTweens();let t=this.nodes.find((t=>"DIB"===t.data.name)),e=[],i=.5;this.nodes.forEach((t=>{if("DIB"===t.data.name){let n=new Cy.Tween({node:t.konva.group,x:t.data.x,y:t.data.y,duration:i}),r=new Cy.Tween({node:t.konva.circle,radius:t.data.r,duration:i}),s=new Cy.Tween({node:t.konva.text,x:-t.data.r,y:-t.data.r,width:2*t.data.r,height:2*t.data.r,fontSize:.25*t.data.r,padding:5,duration:i});e.push(n,r,s)}let n=new Cy.Tween({node:t.konva.group,opacity:1,duration:i});e.push(n)}));let n=new Cy.Tween({node:t.konva.nested.group1,x:0,duration:i}),r=new Cy.Tween({node:t.konva.nested.group2,x:0,duration:i}),s=new Cy.Tween({node:t.konva.nested.circle1,radius:0,duration:i}),o=new Cy.Tween({node:t.konva.nested.circle2,radius:0,duration:i});e.push(n,r,s,o),e.forEach((t=>{t.onFinish=()=>{t.destroy()},t.play()})),this.tweens=this.tweens.concat(e)}step2EnterDown(){this.checkTweens();let t=this.nodes[0],e=[],i=.5;this.nodes.forEach((n=>{if("DIB"===n.data.name){let r=new Cy.Tween({node:n.konva.group,x:t.x,y:t.y,duration:i}),s=new Cy.Tween({node:n.konva.circle,radius:t.r,duration:i}),o=new Cy.Tween({node:n.konva.text,x:-t.r,y:-t.r,fontSize:.2*t.r,width:2*t.r,height:2*t.r,duration:i});e.push(r,s,o)}else{let t=new Cy.Tween({node:n.konva.group,opacity:0,duration:i});e.push(t)}})),e.forEach((t=>{t.onFinish=()=>{t.destroy()},t.play()})),this.tweens=this.tweens.concat(e)}step3EnterUp(){this.checkTweens(),this.nodes[0];let t=this.nodes.find((t=>"DIB"===t.data.name)),e=[],i=.35,n=new Cy.Tween({node:t.konva.nested.group1,x:0,duration:i}),r=new Cy.Tween({node:t.konva.nested.group2,x:0,duration:i}),s=new Cy.Tween({node:t.konva.nested.circle1,radius:0,duration:i}),o=new Cy.Tween({node:t.konva.nested.circle2,radius:0,duration:i}),a=new Cy.Tween({node:t.konva.nested.text1,opacity:0,duration:i}),l=new Cy.Tween({node:t.konva.nested.text2,opacity:0,duration:i}),h=new Cy.Tween({node:t.konva.text,opacity:1,duration:.5});e.push(n,r,s,o,a,l,h),e.forEach((t=>{t.onFinish=()=>t.destroy(),t.play()})),this.tweens=this.tweens.concat(e)}step3EnterDown(){this.checkTweens();let t=this.nodes[0],e=this.nodes.find((t=>"DIB"===t.data.name)),i=[],n=t.r,r=this.data.counts.men+this.data.counts.women,s=this.data.counts.men/r*100,o=this.data.counts.women/r*100,a=Lk().domain([0,100]).range([0,n]),l=a(s),h=a(o),c=new Cy.Tween({node:e.konva.nested.group1,x:-(n-l),duration:.4}),u=new Cy.Tween({node:e.konva.nested.group2,x:+(n-h),duration:.4}),d=new Cy.Tween({node:e.konva.nested.circle1,radius:l,opacity:1,duration:.4}),f=new Cy.Tween({node:e.konva.nested.circle2,radius:h,opacity:1,duration:.4}),p=new Cy.Tween({node:e.konva.nested.text1,opacity:1,fontSize:.3*l,duration:.4}),g=new Cy.Tween({node:e.konva.nested.text2,opacity:1,fontSize:.5*h,duration:.4}),v=new Cy.Tween({node:e.konva.text,opacity:0,duration:.5});i.push(c,u,d,f,p,g,v),i.forEach((t=>{t.onFinish=()=>t.destroy(),t.play()})),this.tweens=this.tweens.concat(i)}checkTweens(){this.tweens.forEach((t=>{t.anim.isRunning()&&t.finish(),t=null})),this.tweens=this.tweens.filter((t=>t))}stepMouseover(t,e){let i=[],n=this.dictionary[e];this.nodes.forEach((t=>{if(!t.parent)return null;if(t.data.name.toLowerCase()===n){let e=new Cy.Tween({node:t.konva.circle,fill:"#3b3b3b",duration:.3}),n=new Cy.Tween({node:t.konva.text,fill:"white",duration:.3});i.push(e,n)}})),i.forEach((t=>{t.onFinish=()=>t.destroy(),t.play()}))}stepMouseout(t){let e=[];this.nodes.forEach((t=>{let i=new Cy.Tween({node:t.konva.circle,fill:"white",duration:.5}),n=new Cy.Tween({node:t.konva.text,fill:"black",duration:.5});e.push(i,n)})),e.forEach((t=>{t.onFinish=()=>t.destroy(),t.play()}))}detaching(){this.observer.disconnect()}},nC=cC(iC.prototype,"data",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rC=cC(iC.prototype,"height",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sC=cC(iC.prototype,"colors",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eC=iC))||eC)||eC;const dC="vis-02",fC='<div class="scrolly-vis">\n  <div class="scrollama-container">\n\n    <div class="sticky-container">\n      <div class="konva-container"></div>\n    </div>\n\n    <div class="steps-container">\n\n      <div class="step" data-step="1">\n        <p class="my-0">\n          We can organise the women according to the century they lived in. Most of the women recorded in the DIB date to the\n          twentieth century.\n        </p>\n      </div>\n\n      <div class="step" data-step="2">\n        <p class="my-0">\n          We can also look at women who have a particular area of interest. For example, the group at the centre shows all the\n          women whose area of interest is <span class="my-badge bg-secondary">music and dance</span>.\n        </p>\n      </div>\n\n      <div class="step" data-step="3">\n        <p class="my-0">\n          Another attribute we can look at is occupations. For example, the group at the centre now shows all the women who worked as a <span class="my-badge bg-secondary">teacher</span>.\n        </p>\n      </div>\n\n      <div class="step" data-step="4">\n        <p class="mt-0">\n          Now it\'s your turn. Select an area of interest or occupation to find different groupings of women. See what you can discover.\n        </p>\n\n        <div>\n          <div>\n            <div>\n              Areas Of Interest:\n            </div>\n            <div style="display: flex; flex-wrap: wrap; justify-content: flex-start;">\n              <div class="${filter.active ? \'bg-dark text-light\' : \'text-dark\'} me-1" style="border-radius: 5px;"\n                repeat.for=\'filter of filters1\' click.delegate="onFilterClick(filter)" role="button">\n                <span style="font-size:1rem; font-weight: 400;" class="pointer my-badge my-badge-light ${$index > 0 ? \'mx-1\' : \'\'} ${filter.active ? \'my-badge-light-active\' : \'\'}">\n                  ${filter.name}\n                </span>\n              </div>\n            </div>\n          </div>\n\n          <div class="mt-2">\n            <div>\n              Occupations:\n            </div>\n            <div style="display: flex; flex-wrap: wrap; justify-content: flex-start;">\n              <div class="${filter.active ? \'bg-dark text-light\' : \'text-dark\'} me-1"\n                repeat.for=\'filter of filters2\' click.delegate="onFilterClick(filter)" role="button">\n                <span style="font-size:1rem; font-weight: 400;" class="pointer my-badge my-badge-light ${$index > 0 ? \'mx-1\' : \'\'} ${filter.active ? \'my-badge-light-active\' : \'\'}">\n                  ${filter.name}\n                </span>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div style="height: 1px; width: 100%;"></div>\n  </div>\n</div>',pC=fC,gC=[];let vC;function mC(t){vC||(vC=fh.define({name:dC,template:fC,dependencies:gC})),t.register(vC)}function yC(t){let e=["th","st","nd","rd"],i=t%100;return t+(e[(i-20)%10]||e[i]||e[0])}var bC,wC,_C,xC,kC;function CC(t,e,i,n){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function SC(t,e,i,n,r){var s={};return Object.keys(n).forEach((function(t){s[t]=n[t]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(t,e,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(t,e,s),s=null),s}let EC=eh(s)(bC=fe(Element,Ho,cg,ug,lC)((wC=class{constructor(t,e,i,n,r){CC(this,"data",_C,this),CC(this,"height",xC,this),CC(this,"colors",kC,this),this.element=t,this.observerLocator=e,this.dataService=i,this.colorService=n,this.konvaHelper=r,this.element.classList.add("b2022-kg-story"),this.konva={},this.filters1=[],this.filters2=[],this.hasStarted=!1,this.tweens=[]}async binding(){this.data||(this.data=await this.dataService.getData()),this.colors||(this.colors=this.colorService.getColors())}attached(){let t={handleChange:()=>{this.setCanvasDimensions(),this.setupVisualisation(),this.setupScrollamaSteps(),this.setupScrollama()}};this.observerLocator.getObserver(this.element.querySelector("div"),"clientWidth").subscribe(t),this.createCanvas(),this.setupPagePositionObserver(),this.setupCanvasEvents(),this.setupFilters(),t.handleChange()}createCanvas(){const t=this.element.querySelector(".konva-container"),e=new Cy.Stage({container:t}),i=new Cy.Layer,n=new Cy.Group,r=new Cy.Group,s=new Cy.Group;n.add(r,s),i.add(n),e.add(i),this.konva.stage=e,this.konva.layer=i,this.konva.group1=n,this.konva.group2=r,this.konva.group3=s}setCanvasDimensions(){const t=this.element.querySelector(".konva-container"),e=Math.min(t.clientWidth,parseInt(this.height)||400),i=Math.min(t.clientWidth,parseInt(this.height)||400);this.konva.stage.width(e),this.konva.stage.height(i),this.konva.group1.x(10),this.konva.group1.y(10),this.konva.group1.width(e-20),this.konva.group1.height(i-20),this.konva.group2.x(this.konva.group1.width()/2),this.konva.group2.y(this.konva.group1.height()/2),this.konva.group3.x(this.konva.group1.width()/2),this.konva.group3.y(this.konva.group1.height()/2),this.konva.stage.content.style.marginLeft="auto",this.konva.stage.content.style.marginRight="auto"}setupVisualisation(){this.konva.group2.destroyChildren(),this.konva.group3.destroyChildren();const t=Fx(-this.konva.group1.width()/2,this.konva.group1.width()/2),e=Fx(-this.konva.group1.height()/2,this.konva.group1.height()/2);this.nodes=this.data.elementsF.map(((i,n)=>{let r=this.konvaHelper.createCircle({radius:3,fill:this.colors.YellowFull}),s=parseInt(i.century.replace("c","")),o={data:i,konva:{circle:r},layout:{x:t(),y:e()},r:r.radius(),centuryInt:s,centuryCategory:s<17?"Pre 17th":yC(s)};return r.position({x:o.layout.x,y:o.layout.y}),this.konva.group3.add(r),o})),this.centuries=[...this.nodes.reduce(((t,e)=>(t.add(parseInt(e.data.century.replace("c",""))),t)),new Set)].filter((t=>!isNaN(t))).sort(((t,e)=>t-e)).map((t=>({key:t,label:t<17?"Pre 17th":yC(t)}))),this.centuriesCategories=[...this.centuries.reduce(((t,e)=>(t.add(e.label),t)),new Set)].map((t=>({key:t}))),this.centuriesScaleR=Yx().domain(this.centuriesCategories.map((t=>t.key))).range([0,Math.min(this.konva.group1.width(),this.konva.group1.height())/2]),this.centuriesCategories.forEach(((t,e)=>{let i=this.centuriesScaleR(t.key),n=this.centuriesScaleR(t.key)+this.centuriesScaleR.bandwidth()/2,r=this.centuriesScaleR(t.key)+this.centuriesScaleR.bandwidth(),s=this.konvaHelper.createArc({innerRadius:i,outerRadius:r,angle:360,fill:e%2==1?this.colors.GreenMuted:"white",opacity:0,listening:!0,type:"arc-interactive"}),o=new Cy.Group({x:0,y:0===i?i:n,opacity:0}),a=this.konvaHelper.createText({text:t.key,fontSize:16,textAlignX:"center",textAlignY:"center",fill:this.colors.FontDark}),l=this.konvaHelper.createRect({x:-(a.width()+8)/2,y:-(a.height()+8)/2,width:a.width()+8,height:a.height()+8,cornerRadius:5,fill:"white",opacity:.8});o.add(l,a),t.konva={arc:s,text:a,bgRect:l,textGroup:o},this.konva.group2.add(s),this.konva.group3.add(o)}))}setupCanvasEvents(){this.konva.stage.on("mouseover",(t=>{let e=t.target;if(e.type&&"arc-interactive"===e.type){let t=new Cy.Tween({node:e,fill:this.colors.GreenFull,duration:.1,onFinish:()=>t.destroy()}).play()}})),this.konva.stage.on("mouseout",(t=>{let e=t.target;if(e.type&&"arc-interactive"===e.type){let t=new Cy.Tween({node:e,fill:e.data.fill,duration:.1,onFinish:()=>t.destroy()}).play()}}))}startVisualisation(){this.nodes.forEach((t=>{let e=new Cy.Tween({node:t.konva.circle,x:t.layout.x,y:t.layout.y,duration:1,onUpdate:()=>{t.x=t.konva.circle.x(),t.y=t.konva.circle.y()},onFinish:()=>{e.destroy()}}).play()}))}stopVisualisation(){this.simulation&&this.simulation.stop()}setupPagePositionObserver(){this.observer=new IntersectionObserver(((t,e)=>{t.forEach((t=>{t.isIntersecting&&!this.hasStarted&&(console.log("👀 - Starting Vis 02"),this.startVisualisation(),this.hasStarted=!0),!t.isIntersecting&&this.hasStarted&&(console.log("👀 - Leaving Vis 02"),this.stopVisualisation(),this.hasStarted=!1)}))}),{threshold:.5});let t=this.element.querySelector(".konva-container");this.observer.observe(t)}setupScrollamaSteps(){let t=this.element.querySelector(".scrollama-container"),e=t.querySelector(".sticky-container"),i=t.querySelector(".steps-container").querySelectorAll(".step");return i.forEach((t=>{let i=t.getAttribute("data-step"),n="0px",r=`${this.konva.stage.height()}px`;1==i&&(n=.5*e.clientHeight-.5*t.clientHeight+"px"),t.style.marginTop=n,t.style.marginBottom=r})),i}setupScrollama(){this.scroller&&this.scroller.destroy();let t=this.element.querySelector(".scrollama-container").querySelector(".sticky-container"),e=aC()(),i=this.setupScrollamaSteps(),n=.5*window.innerHeight-.5*this.konva.stage.height();t.style.top=`${n}px`,e.resize(),e.setup({step:i,offset:Math.floor(.5*window.innerHeight)+"px",debug:!1}).onStepEnter((t=>{this.stepEnterHandler(t)})).onStepExit((t=>{this.stepExitHandler(t)})),this.scroller=e}stepEnterHandler(t){}stepExitHandler(t){"1"===t.element.dataset.step&&("up"===t.direction?this.step1EnterUp():"down"===t.direction&&this.step1EnterDown()),"2"===t.element.dataset.step&&("up"===t.direction?this.step2EnterUp():"down"===t.direction&&this.step2EnterDown()),"3"===t.element.dataset.step&&("up"===t.direction?this.step3EnterUp():"down"===t.direction&&this.step3EnterDown()),"4"===t.element.dataset.step&&("up"===t.direction?this.step4EnterUp():"down"===t.direction&&this.step4EnterDown())}setupFilters(){this.filters1.push("Politics","Literature","Religion","Music and Dance","Education","Law","Sport"),this.filters2.push("Politician","Author","Teacher","Philanthropist","Actress"),this.filters1=this.filters1.map((t=>({name:t,active:!1}))),this.filters2=this.filters2.map((t=>({name:t,active:!1})))}onFilterClick(t){t.active=!t.active,(new Array).concat(this.filters1,this.filters2).forEach((e=>{e.name!==t.name&&(e.active=!1)}));let e=(new Array).concat(this.filters1,this.filters2).some((t=>t.active));if(this.simulation&&this.simulation.stop(),e){this.nodes.forEach((e=>{let i=e.data.aoi.includes(t.name.toLowerCase()),n=e.data.occ.includes(t.name.toLowerCase());e.active=!(!i&&!n)}));const e=.5*Math.min(this.konva.group1.width(),this.konva.group1.height())-50;this.simulation=ux(this.nodes).force("radial",lx().radius((t=>t.active?20:e))).force("collide",ax().radius((t=>t.r+.5)).iterations(2)),this.simulation.on("tick",(()=>{for(let t of this.nodes)t.konva.circle.position({x:t.x,y:t.y})}))}else this.startVisualisation()}onFitlerReset(){this.filters1.forEach((t=>t.active=!1)),this.filters2.forEach((t=>t.active=!1))}step1EnterUp(){this.simulation&&this.simulation.stop(),this.checkTweens(),this.startVisualisation();let t=[];this.centuriesCategories.forEach((e=>{let i=new Cy.Tween({node:e.konva.arc,duration:1,opacity:0}),n=new Cy.Tween({node:e.konva.textGroup,duration:1,opacity:0});t.push(i,n)})),t.forEach((t=>{t.onFinish=()=>t.destroy(),t.play()})),this.tweens=this.tweens.concat(t)}step1EnterDown(){this.simulation&&this.simulation.stop(),this.checkTweens();let t=ux(this.nodes).force("x",dx()).force("y",fx()).force("collide",ax().radius((t=>t.r+.5)).iterations(2)),e=ux(this.nodes).force("radial",lx().radius((t=>this.centuriesScaleR(t.centuryCategory)+this.centuriesScaleR.bandwidth()/2||0))).force("collide",ax().radius((t=>t.r+.5)).iterations(2)).stop();t.on("tick",(()=>{for(let t of this.nodes)t.konva.circle.position({x:t.x,y:t.y})})),e.on("tick",(()=>{for(let t of this.nodes)t.konva.circle.position({x:t.x,y:t.y})})),this.simulation=t,setTimeout((()=>{this.simulation.stop(),this.simulation=e,this.simulation.restart()}),500);let i=[];this.centuriesCategories.forEach((t=>{let e=new Cy.Tween({node:t.konva.arc,duration:1,opacity:1}),n=new Cy.Tween({node:t.konva.textGroup,duration:1,opacity:1});i.push(e,n)})),i.forEach((t=>{t.onFinish=()=>t.destroy(),t.play()})),this.tweens=this.tweens.concat(i)}step2EnterUp(){this.step1EnterDown()}step2EnterDown(){this.simulation&&this.simulation.stop(),this.checkTweens(),this.nodes.forEach((t=>{t.active=t.data.aoi.includes("music and dance")}));const t=.5*Math.min(this.konva.group1.width(),this.konva.group1.height())-50;let e=ux(this.nodes).force("x",dx()).force("y",fx()).force("collide",ax().radius((t=>t.r+.5)).iterations(2)),i=ux(this.nodes).force("radial",lx().radius((e=>e.active?20:t))).force("collide",ax().radius((t=>t.r+.5)).iterations(2)).stop();e.on("tick",(()=>{for(let t of this.nodes)t.konva.circle.position({x:t.x,y:t.y})})),i.on("tick",(()=>{for(let t of this.nodes)t.konva.circle.position({x:t.x,y:t.y})})),this.simulation=e,setTimeout((()=>{this.simulation.stop(),this.simulation=i,this.simulation.restart()}),500);let n=[];this.centuriesCategories.forEach((t=>{let e=new Cy.Tween({node:t.konva.arc,duration:1,opacity:0}),i=new Cy.Tween({node:t.konva.textGroup,duration:1,opacity:0});n.push(e,i)})),n.forEach((t=>{t.onFinish=()=>t.destroy(),t.play()})),this.tweens=this.tweens.concat(n)}step3EnterUp(){this.step2EnterDown()}step3EnterDown(){this.simulation&&this.simulation.stop(),this.checkTweens(),this.nodes.forEach((t=>{t.active=t.data.occ.includes("teacher")}));const t=.5*Math.min(this.konva.group1.width(),this.konva.group1.height())-50;let e=ux(this.nodes).force("x",dx()).force("y",fx()).force("collide",ax().radius((t=>t.r+.5)).iterations(2)),i=ux(this.nodes).force("radial",lx().radius((e=>e.active?20:t))).force("collide",ax().radius((t=>t.r+.5)).iterations(2)).stop();e.on("tick",(()=>{for(let t of this.nodes)t.konva.circle.position({x:t.x,y:t.y})})),i.on("tick",(()=>{for(let t of this.nodes)t.konva.circle.position({x:t.x,y:t.y})})),this.simulation=e,setTimeout((()=>{this.simulation.stop(),this.simulation=i,this.simulation.restart()}),500)}step4EnterUp(){this.onFitlerReset(),this.step3EnterDown()}step4EnterDown(){this.simulation&&this.simulation.stop(),this.checkTweens(),this.simulation=ux(this.nodes).force("x",dx()).force("y",fx()).force("collide",ax().radius((t=>t.r+.5)).iterations(2)),this.simulation.on("tick",(()=>{for(let t of this.nodes)t.konva.circle.position({x:t.x,y:t.y})})),setTimeout((()=>{this.simulation.stop(),this.startVisualisation()}),300)}checkTweens(){this.tweens.forEach((t=>{t.anim.isRunning()&&t.finish(),t=null})),this.tweens=this.tweens.filter((t=>t))}detaching(){this.observer.disconnect()}},_C=SC(wC.prototype,"data",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xC=SC(wC.prototype,"height",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kC=SC(wC.prototype,"colors",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bC=wC))||bC)||bC;const AC="vis-03",TC='<div class="position-relative">\n  <div class="konva-container">\n    <custom-vis-tooltip data.bind="tooltip"></custom-vis-tooltip>\n  </div>\n\n  <custom-vis-icons \n    on-reset.call="onReset()" \n    on-info.call="onInfo()" \n    on-expand.call="onExpand()" \n    on-contract.call="onContract()"\n    is-expanded.bind="isExpanded"\n  >\n  </custom-vis-icons>\n</div>',MC=TC,OC=[];let PC;function RC(t){PC||(PC=fh.define({name:AC,template:TC,dependencies:OC})),t.register(PC)}const LC="vis-03-fullscreen-dialog",IC='\n\n<div class="p-3 w-100 h-100" style="background: white;">\n  <vis-03 height.bind="height" is-expanded.bind="true"></vis-03>\n</div>\n',$C=IC,DC=[h];let NC;function jC(t){NC||(NC=fh.define({name:LC,template:IC,dependencies:DC})),t.register(NC)}var BC;let FC=eh(a)(BC=fe(Element,kp,Sp)(BC=class{constructor(t,e,i){this.element=t,this.dialogDom=i,this.dialog=e,i.wrapper.classList.add("b2022-kg-story"),i.wrapper.style.position="fixed",i.wrapper.style.zIndex=1e3,i.overlay.style.backgroundColor="rgba(0, 0, 0, 0.5)",i.overlay.style.position="absolute",i.overlay.style.top="0",i.overlay.style.left="0",i.overlay.style.right="0",i.overlay.style.bottom="0";let n=.9*this.dialogDom.overlay.clientWidth,r=.9*this.dialogDom.overlay.clientHeight;i.contentHost.style.width=`${Math.min(n,r)}px`,i.contentHost.style.height=`${Math.min(n,r)}px`}attaching(){let t=this.element.querySelector("div"),e=window.getComputedStyle(t),i=parseInt(e.paddingTop),n=parseInt(e.paddingBottom),r=t.clientHeight-(i+n);this.height=r}})||BC)||BC;const zC="vis-03-info-popover",UC='<div class="my-popover">\n  <p>\n    In this visualisation each circle encodes an area of interest. The size of each circle corresponds to the number of women that are associated with that specific area of interest. The larger the circle, the greater the frequency.\n  </p>\n  <p>\n    You can interact with the visualisation. Use the mouse wheel to zoom. Click and drag to pan.\n  </p>\n</div>',GC=UC,HC=[];let VC;function qC(t){VC||(VC=fh.define({name:zC,template:UC,dependencies:HC})),t.register(VC)}var WC;let YC=eh(l)(WC=fe(Element)(WC=class{constructor(t){this.element=t}})||WC)||WC;var XC,KC,QC,ZC,JC,tS;function eS(t,e,i,n){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function iS(t,e,i,n,r){var s={};return Object.keys(n).forEach((function(t){s[t]=n[t]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(t,e,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(t,e,s),s=null),s}let nS=eh(o)(XC=fe(Element,xp,gi,cg,ug,lC)((KC=class{constructor(t,e,i,n,r,s){eS(this,"data",QC,this),eS(this,"height",ZC,this),eS(this,"colors",JC,this),eS(this,"isExpanded",tS,this),this.element=t,this.dialogService=e,this.eventAggregator=i,this.dataService=n,this.colorService=r,this.konvaHelper=s,this.element.classList.add("b2022-kg-story"),this.konva={},this.tooltip=null,this.hasStarted=!1,this.subs=[]}async binding(){this.data||(this.data=await this.dataService.getData()),this.colors||(this.colors=this.colorService.getColors())}attached(){this.createCanvas(),this.setupVisualisation(),this.setupPagePositionObserver(),this.setupCanvasEvents(),this.setupZoom()}createCanvas(){const t=this.element.querySelector(".konva-container"),e=t.clientWidth,i=parseInt(this.height)||400,n=new Cy.Stage({container:t,width:e,height:i}),r=new Cy.Layer,s=new Cy.Group({x:10,y:10,width:e-20,height:i-20}),o=new Cy.Group;s.add(o),r.add(s),n.add(r),this.konva.stage=n,this.konva.layer=r,this.konva.group1=s,this.konva.group2=o}setupCanvasEvents(){this.konva.stage.on("mouseover",(t=>{let e=t.target;e.data&&e.data.node&&(this.tooltip=new Map([["name",e.data.node.data.key],["size",`${e.data.node.data.value} women`]]))})),this.konva.stage.on("mouseout",(t=>{this.tooltip=null}))}setupVisualisation(){let t=this.data.elementsF.reduce(((t,e)=>(e.aoi.forEach((e=>{t.has(e)?t.set(e,t.get(e)+1):t.set(e,1)})),t)),new Map),e=gx({children:[...t.entries()].map((t=>({key:t[0],value:t[1]})))}).sum((t=>t.value));Dx().size([this.konva.group1.width(),this.konva.group1.height()])(e);let i=e.children,n=Fx(-this.konva.group1.width(),this.konva.group1.width()),r=Fx(-this.konva.group1.height(),this.konva.group1.height());i.forEach((t=>{const e=new Cy.Group({x:n(),y:r()}),i=this.konvaHelper.createCircle({radius:t.r,stroke:this.colors.YellowFull,fill:this.colors.YellowMuted,listening:!0}),s=this.konvaHelper.createTextArea({text:t.data.key,width:2*t.r,height:2*t.r,fontSize:.3*t.r,padding:Math.min(.2*t.r,4),fill:this.colors.FontDark});i.data={node:t},t.data.x=t.x,t.data.y=t.y,t.konva={group:e,circle:i,text:s},e.add(i,s),this.konva.group2.add(e)})),this.nodes=i}setupZoom(){let t=null,e={clientX:0,clientY:0};this.zoom=tC().scaleExtent([.5,32]).on("zoom",(t=>{this.konva.layer.scale({x:t.transform.k,y:t.transform.k}),this.konva.layer.position({x:t.transform.x,y:t.transform.y}),this.nodes.forEach((e=>e.konva.circle.strokeWidth(1/t.transform.k))),t&&t.sourceEvent&&(e.clientX=t.sourceEvent.clientX,e.clientY=t.sourceEvent.clientY)})).on("start",(i=>{t=this.tooltip,this.tooltip=null,i&&i.sourceEvent&&(e.clientX=i.sourceEvent.clientX,e.clientY=i.sourceEvent.clientY)})).on("end",(i=>{this.tooltip=t,t=null;let n=new MouseEvent("mousemove",{clientX:e.clientX,clientY:e.clientY,detail:6});document.dispatchEvent(new MouseEvent("mousemove",n))})),this.zoom(Ik(this.konva.stage.content))}startVisualisation(){let t=this.nodes,e=[];t.forEach((t=>{let i=new Cy.Tween({node:t.konva.group,x:t.data.x,y:t.data.y,duration:1});e.push(i)})),e.forEach((t=>{t.onFinish=()=>t.destroy(),t.play()})),this.hasStarted=!0}onReset(){this.zoom.transform(Ik(this.konva.stage.content),Vk)}onInfo(){return YC}onExpand(){document.body.style.overflow="hidden",this.dialogService.open({component:()=>FC,lock:!1}).whenClosed((t=>{document.body.style.overflow="auto"}))}onContract(){this.dialogService.closeAll()}onDownload(){}setupPagePositionObserver(){this.observer=new IntersectionObserver(((t,e)=>{t.forEach((t=>{t.isIntersecting&&(console.log("👀 - Starting Vis 03"),this.startVisualisation()),!t.isIntersecting&&this.hasStarted&&(console.log("👀 - Resetting Vis 03"),this.onReset())}))}),{threshold:.5});let t=this.element.querySelector(".konva-container");this.observer.observe(t)}detaching(){this.observer.disconnect(),this.subs.forEach((t=>t.dispose())),this.subs=[]}},QC=iS(KC.prototype,"data",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZC=iS(KC.prototype,"height",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JC=iS(KC.prototype,"colors",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tS=iS(KC.prototype,"isExpanded",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),XC=KC))||XC)||XC;const rS="vis-04",sS='<div class="position-relative">\n  <div class="konva-container">\n    <custom-vis-tooltip data.bind="tooltip"></custom-vis-tooltip>\n  </div>\n\n  <custom-vis-icons \n    on-reset.call="onReset()" \n    on-info.call="onInfo()" \n    on-expand.call="onExpand()" \n    on-contract.call="onContract()"\n    is-expanded.bind="isExpanded"\n  >\n  </custom-vis-icons>\n\n  <div class="gender-legend">\n    <div class="g-l-icon">\n      <div class="g-l-shape female-outline-fill"></div>\n      <div class="g-l-label"> Female </div>\n    </div>\n\n    <div style="margin-top: 10px;"></div>\n\n    <div class="g-l-icon">\n      <div class="g-l-shape male-outline-fill"></div>\n      <div class="g-l-label"> Male </div>\n    </div>\n  </div>\n</div>',oS=sS,aS=[];let lS;function hS(t){lS||(lS=fh.define({name:rS,template:sS,dependencies:aS})),t.register(lS)}const cS="vis-04-fullscreen-dialog",uS='\n\n<div class="p-3 w-100 h-100" style="background: white;">\n  <vis-04 height.bind="height" is-expanded.bind="true"></vis-04>\n</div>',dS=uS,fS=[f];let pS;function gS(t){pS||(pS=fh.define({name:cS,template:uS,dependencies:fS})),t.register(pS)}var vS;let mS=eh(u)(vS=fe(Element,kp,Sp)(vS=class{constructor(t,e,i){this.element=t,this.dialogDom=i,this.dialog=e,i.wrapper.classList.add("b2022-kg-story"),i.wrapper.style.position="fixed",i.wrapper.style.zIndex=1e3,i.overlay.style.backgroundColor="rgba(0, 0, 0, 0.5)",i.overlay.style.position="absolute",i.overlay.style.top="0",i.overlay.style.left="0",i.overlay.style.right="0",i.overlay.style.bottom="0";let n=.9*this.dialogDom.overlay.clientWidth,r=.9*this.dialogDom.overlay.clientHeight;i.contentHost.style.width=`${Math.min(n,r)}px`,i.contentHost.style.height=`${Math.min(n,r)}px`}attaching(){let t=this.element.querySelector("div"),e=window.getComputedStyle(t),i=parseInt(e.paddingTop),n=parseInt(e.paddingBottom),r=t.clientHeight-(i+n);this.height=r}})||vS)||vS;const yS="vis-04-info-popover",bS='<div class="my-popover">\n  <p>\n    In this visualisation each circle encodes an area of interest. Where the area of interest is split between males and females. The size of each inner circle corresponds to the number of women or men that are associated with that specific area of interest. The larger the circle, the greater the frequency.\n  </p>\n  <p>\n    You can interact with the visualisation. Use the mouse wheel to zoom. Click and drag to pan.\n  </p>\n</div>',wS=bS,_S=[];let xS;function kS(t){xS||(xS=fh.define({name:yS,template:bS,dependencies:_S})),t.register(xS)}var CS;let SS=eh(d)(CS=fe(Element)(CS=class{constructor(t){this.element=t}})||CS)||CS;var ES,AS,TS,MS,OS,PS;function RS(t,e,i,n){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function LS(t,e,i,n,r){var s={};return Object.keys(n).forEach((function(t){s[t]=n[t]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(t,e,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(t,e,s),s=null),s}let IS=eh(c)(ES=fe(Element,xp,gi,cg,ug,lC)((AS=class{constructor(t,e,i,n,r,s){RS(this,"data",TS,this),RS(this,"height",MS,this),RS(this,"colors",OS,this),RS(this,"isExpanded",PS,this),this.element=t,this.dialogService=e,this.eventAggregator=i,this.dataService=n,this.colorService=r,this.konvaHelper=s,this.element.classList.add("b2022-kg-story"),this.konva={},this.tooltip=null,this.hasStarted=!1}async binding(){this.data||(this.data=await this.dataService.getData()),this.colors||(this.colors=this.colorService.getColors())}attached(){this.createCanvas(),this.setupVisualisation(),this.setupPagePositionObserver(),this.setupCanvasEvents(),this.setupZoom()}createCanvas(){const t=this.element.querySelector(".konva-container"),e=t.clientWidth,i=parseInt(this.height)||400,n=new Cy.Stage({container:t,width:e,height:i}),r=new Cy.Layer,s=new Cy.Group({x:10,y:10,width:e-20,height:i-20}),o=new Cy.Group;s.add(o),r.add(s),n.add(r),this.konva.stage=n,this.konva.layer=r,this.konva.group1=s,this.konva.group2=o}setupCanvasEvents(){this.konva.stage.on("mouseover",(t=>{let e=t.target;e.data&&e.data.node&&(this.tooltip=new Map([["name",e.data.node.data.key],["size 1",`${e.data.node.data.values.m} men`],["size 2",`${e.data.node.data.values.f} women`]]))})),this.konva.stage.on("mouseout",(t=>{this.tooltip=null}))}setupVisualisation(){let t=this.data.elementsT.reduce(((t,e)=>{let i="F"===e.gender?"f":"m";return e.aoi.forEach((e=>{t.has(e)||t.set(e,{m:0,f:0}),t.get(e)[i]++})),t}),new Map),e=gx({children:[...t.entries()].map((t=>({key:t[0],values:t[1]})))}).sum((t=>t.values?(t.values.m?t.values.m:0)+(t.values.f?t.values.f:0):0));Dx().size([this.konva.group1.width(),this.konva.group1.height()])(e);let i=e.children,n=Fx(-this.konva.group1.width(),this.konva.group1.width()),r=Fx(-this.konva.group1.height(),this.konva.group1.height());i.forEach((t=>{let e=Dx().size([2*t.r,2*t.r]),i=gx({children:[{value:t.data.values.m,gender:"M"},{value:t.data.values.f,gender:"F"}].filter((t=>t.value>0))}).sum((t=>t.value));e(i);let s=new Cy.Group({x:n(),y:r()}),o=new Cy.Shape({sceneFunc:(e,n)=>{e.beginPath(),e.arc(0,0,t.r,0,2*Math.PI),e.lineWidth=1/this.konva.layer.scaleX(),e.strokeStyle="rgba(0,0,0,0.2)",e.stroke(),e.closePath(),i.leaves().forEach((t=>{if(t.r<=0)return null;e.beginPath(),e.arc(t.x-i.r,t.y-i.r,t.r,0,2*Math.PI),e.fillStyle="M"===t.data.gender?this.colors.PurpleMuted:this.colors.YellowMuted,e.fill(),e.strokeStyle="M"===t.data.gender?this.colors.PurpleFull:this.colors.YellowFull,e.stroke(),e.closePath()}))},hitFunc:(e,i)=>{e.beginPath(),e.arc(0,0,t.r,0,2*Math.PI),e.closePath(),e.fillStrokeShape(i)},perfectDrawEnabled:!1,listening:!0,shadowForStrokeEnabled:!1}),a=this.konvaHelper.createTextArea({text:t.data.key,width:2*t.r,height:2*t.r,fontSize:.3*t.r,padding:Math.min(.2*t.r,4),fill:this.colors.FontDark});o.data={node:t},t.data.x=t.x,t.data.y=t.y,s.add(o,a),t.konva={group:s,shape:o,text:a},this.konva.group2.add(s)})),this.nodes=i}setupZoom(){let t=null,e={clientX:0,clientY:0};this.zoom=tC().scaleExtent([.5,32]).on("zoom",(t=>{this.konva.layer.scale({x:t.transform.k,y:t.transform.k}),this.konva.layer.position({x:t.transform.x,y:t.transform.y}),t&&t.sourceEvent&&(e.clientX=t.sourceEvent.clientX,e.clientY=t.sourceEvent.clientY)})).on("start",(i=>{t=this.tooltip,this.tooltip=null,i&&i.sourceEvent&&(e.clientX=i.sourceEvent.clientX,e.clientY=i.sourceEvent.clientY)})).on("end",(i=>{this.tooltip=t,t=null;let n=new MouseEvent("mousemove",{clientX:e.clientX,clientY:e.clientY,detail:6});document.dispatchEvent(new MouseEvent("mousemove",n))})),this.zoom(Ik(this.konva.stage.content))}startVisualisation(){let t=this.nodes,e=[];t.forEach((t=>{let i=new Cy.Tween({node:t.konva.group,x:t.data.x,y:t.data.y,duration:1});e.push(i)})),e.forEach((t=>{t.onFinish=()=>t.destroy(),t.play()})),this.hasStarted=!0}onReset(){this.zoom.transform(Ik(this.konva.stage.content),Vk)}onInfo(){return SS}onExpand(){document.body.style.overflow="hidden",this.dialogService.open({component:()=>mS,lock:!1}).whenClosed((t=>{document.body.style.overflow="auto"}))}onContract(){this.dialogService.closeAll()}onDownload(){}setupPagePositionObserver(){this.observer=new IntersectionObserver(((t,e)=>{t.forEach((t=>{t.isIntersecting&&(console.log("👀 - Starting Vis 04"),this.startVisualisation()),!t.isIntersecting&&this.hasStarted&&(console.log("👀 - Resetting Vis 04"),this.onReset())}))}),{threshold:.5});let t=this.element.querySelector(".konva-container");this.observer.observe(t)}detaching(){this.observer.disconnect()}},TS=LS(AS.prototype,"data",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MS=LS(AS.prototype,"height",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OS=LS(AS.prototype,"colors",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PS=LS(AS.prototype,"isExpanded",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ES=AS))||ES)||ES;const $S="vis-05",DS='<div class="position-relative">\n  <div class="konva-container">\n    <custom-vis-tooltip data.bind="tooltip"></custom-vis-tooltip>\n  </div>\n\n    <custom-vis-icons \n      on-reset.call="onReset()" \n      on-info.call="onInfo()" \n      on-expand.call="onExpand()" \n      on-contract.call="onContract()"\n      is-expanded.bind="isExpanded"\n    >\n    </custom-vis-icons>\n</div>',NS=DS,jS=[];let BS;function FS(t){BS||(BS=fh.define({name:$S,template:DS,dependencies:jS})),t.register(BS)}const zS="vis-05-fullscreen-dialog",US='\n\n<div class="p-3 w-100 h-100" style="background: white;">\n  <vis-05 height.bind="height" is-expanded.bind="true"></vis-05>\n</div>',GS=US,HS=[m];let VS;function qS(t){VS||(VS=fh.define({name:zS,template:US,dependencies:HS})),t.register(VS)}var WS;let YS=eh(g)(WS=fe(Element,kp,Sp)(WS=class{constructor(t,e,i){this.element=t,this.dialogDom=i,this.dialog=e,i.wrapper.classList.add("b2022-kg-story"),i.wrapper.style.position="fixed",i.wrapper.style.zIndex=1e3,i.overlay.style.backgroundColor="rgba(0, 0, 0, 0.5)",i.overlay.style.position="absolute",i.overlay.style.top="0",i.overlay.style.left="0",i.overlay.style.right="0",i.overlay.style.bottom="0";let n=.9*this.dialogDom.overlay.clientWidth,r=.9*this.dialogDom.overlay.clientHeight;i.contentHost.style.width=`${Math.min(n,r)}px`}attaching(){let t=this.element.querySelector("div"),e=window.getComputedStyle(t);parseInt(e.paddingTop),parseInt(e.paddingBottom),t.clientHeight,this.height=700}})||WS)||WS;const XS="vis-05-info-popover",KS='<div class="my-popover">\n  <p>\n    In this visualisation each circle encodes an area of interest. The size of each circle corresponds to the number of women that are associated with that specific area of interest. The larger the circle, the greater the frequency.\n  </p>\n  <p>\n    You can interact with the visualisation. Click on a circle to select it and compare how the area of interest evolved over the centuries.\n  </p>\n</div>',QS=KS,ZS=[];let JS;function tE(t){JS||(JS=fh.define({name:XS,template:KS,dependencies:ZS})),t.register(JS)}var eE;let iE=eh(v)(eE=fe(Element)(eE=class{constructor(t){this.element=t}})||eE)||eE;var nE,rE,sE,oE,aE,lE;function hE(t,e,i,n){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function cE(t,e,i,n,r){var s={};return Object.keys(n).forEach((function(t){s[t]=n[t]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(t,e,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(t,e,s),s=null),s}let uE=eh(p)(nE=fe(Element,xp,gi,cg,ug,lC)((rE=class{constructor(t,e,i,n,r,s){hE(this,"data",sE,this),hE(this,"height",oE,this),hE(this,"colors",aE,this),hE(this,"isExpanded",lE,this),this.element=t,this.dialogService=e,this.eventAggregator=i,this.dataService=n,this.colorService=r,this.konvaHelper=s,this.element.classList.add("b2022-kg-story"),this.konva={},this.tooltip=null,this.filters=[],this.hasStarted=!1}async binding(){this.data||(this.data=await this.dataService.getData()),this.colors||(this.colors=this.colorService.getColors())}attached(){this.createCanvas(),this.setupVisualisation(),this.setupSimulation(),this.setupPagePositionObserver(),this.setupCanvasEvents()}createCanvas(){const t=this.element.querySelector(".konva-container"),e=t.clientWidth,i=parseInt(this.height)||400,n=new Cy.Stage({container:t,width:e,height:i}),r=new Cy.Layer,s=new Cy.Group({x:10,y:10,width:e-20,height:i-20}),o=new Cy.Group({width:s.width(),y:s.height()-50,height:50}),a=new Cy.Group({width:s.width(),height:s.height()-o.height()});s.add(o,a),r.add(s),n.add(r),this.konva.stage=n,this.konva.layer=r,this.konva.group1=s,this.konva.group2=o,this.konva.group3=a}setupVisualisation(){let t=[...this.data.elementsF.reduce(((t,e)=>{let i=parseInt(e.century.replace("c",""));i=i<19?18:i,t.has(i)||t.set(i,new Map);let n=t.get(i);return e.aoi.forEach((t=>{n.has(t)||n.set(t,0),n.set(t,n.get(t)+1)})),t}),new Map).entries()].map((t=>[...t[1].entries()].map((e=>({century:t[0],area:e[0],count:e[1]}))))).flat(1).filter((t=>t.century)).sort(((t,e)=>t.century-e.century)),e=[...t.reduce(((t,e)=>t.add(e.century)),new Set)];this.filters=[...t.reduce(((t,e)=>t.add(e.area)),new Set)].map((t=>({key:t,active:!1})));let i=Yx().domain(e).range([0,this.konva.group2.width()]),n=Lk().domain([Ey(t,(t=>t.count)),Sy(t,(t=>t.count))]).range([15,55]);e.forEach((t=>{let e=i(t)+i.bandwidth()/2,n=this.konvaHelper.createText({x:e,y:this.konva.group2.height()/2,textAlignX:"center",textAlignY:"center",fontSize:16,text:18===t?"Pre 19th Century":`${yC(t)} Century`,fill:this.colors.FontDark});this.konva.group2.add(n)})),t.forEach((t=>{let e=new Cy.Group({x:i(t.century)+i.bandwidth()/2,y:this.konva.group3.height()/2}),r=this.konvaHelper.createCircle({fill:this.colors.YellowMuted,stroke:this.colors.YellowFull,radius:n(t.count),listening:!0}),s=this.konvaHelper.createTextArea({text:t.area,width:2*r.radius(),height:2*r.radius(),fontSize:.35*r.radius(),padding:Math.min(.2*r.radius(),4),fill:this.colors.FontDark});e.add(r,s),s.fontSize()<10&&s.remove(),r.data={node:t},t.konva={group:e,circle:r,text:s},t.x=e.x(),t.y=e.y(),t.radius=r.radius(),t.xCenter=e.x(),t.yCenter=e.y(),t.width=i.bandwidth(),t.height=this.konva.group3.height(),this.konva.group3.add(e)})),this.nodes=t}setupSimulation(){let t=this.nodes,e=ux(t).force("x",dx((t=>t.xCenter)).strength(.1)).force("y",fx((t=>t.yCenter)).strength(.01)).force("collide",ax().radius((t=>t.radius+.5)).iterations(2));e.on("tick",(()=>{t.forEach((t=>{let e=t.radius,i=.5*t.width,n=.5*t.height,r=Math.min(Math.max(t.xCenter-i+e,t.x),t.xCenter+i-e),s=Math.min(Math.max(t.yCenter-n+e,t.y),t.yCenter+n-e);t.konva.group.position({x:r,y:s})}))})),e.stop(),this.simulation=e}startVisualisation(){this.simulation&&this.simulation.restart()}stopVisualisation(){this.simulation&&this.simulation.stop()}setupCanvasEvents(){this.konva.stage.on("mouseover",(t=>{t.target.data&&t.target.data.node&&(this.tooltip=new Map([["name",t.target.data.node.area],["size",`${t.target.data.node.count} women`]]))})),this.konva.stage.on("mouseout",(t=>{this.tooltip=null})),this.konva.stage.on("click",(t=>{t.target.data&&t.target.data.node?this.onNodeClick(t.target.data.node):this.onNodeClick()}))}onNodeClick(t){if(t){let e=this.filters.find((e=>e.key===t.area));e&&(e.active=!e.active)}else this.filters.forEach((t=>t.active=!1));let e=!this.filters.some((t=>t.active)),i=[];this.nodes.forEach((t=>{let n=this.filters.find((e=>e.key===t.area)),r=null;r=e||n.active?new Cy.Tween({node:t.konva.group,duration:.2,opacity:1}):new Cy.Tween({node:t.konva.group,duration:.2,opacity:.2}),i.push(r)})),i.forEach((t=>{t.onFinish=()=>t.destroy(),t.play()}))}onReset(){this.onNodeClick()}onInfo(){return iE}onExpand(){document.body.style.overflow="hidden",this.dialogService.open({component:()=>YS,lock:!1}).whenClosed((t=>{document.body.style.overflow="auto"}))}onContract(){this.dialogService.closeAll()}onDownload(){}setupPagePositionObserver(){this.observer=new IntersectionObserver(((t,e)=>{t.forEach((t=>{t.isIntersecting&&!this.hasStarted&&(console.log("👀 - Starting Vis 05"),this.startVisualisation(),this.hasStarted=!0),!t.isIntersecting&&this.hasStarted&&(console.log("👀 - Leaving Vis 05"),this.stopVisualisation(),this.hasStarted=!1)}))}),{threshold:.5});let t=this.element.querySelector(".konva-container");this.observer.observe(t)}detaching(){this.observer.disconnect()}},sE=cE(rE.prototype,"data",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oE=cE(rE.prototype,"height",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aE=cE(rE.prototype,"colors",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lE=cE(rE.prototype,"isExpanded",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nE=rE))||nE)||nE;const dE="vis-06",fE='<div class="position-relative">\n  <div class="konva-container">\n    <custom-vis-tooltip data.bind="tooltip"></custom-vis-tooltip>\n  </div>\n\n  <custom-vis-icons \n    on-reset.call="onReset()" \n    on-info.call="onInfo()" \n    on-expand.call="onExpand()" \n    on-contract.call="onContract()"\n    is-expanded.bind="isExpanded"\n  >\n  </custom-vis-icons>\n</div>',pE=fE,gE=[];let vE;function mE(t){vE||(vE=fh.define({name:dE,template:fE,dependencies:gE})),t.register(vE)}const yE="vis-06-fullscreen-dialog",bE='\n\n<div class="p-3 w-100 h-100" style="background: white;">\n  <vis-06 height.bind="height" is-expanded.bind="true"></vis-06>\n</div>',wE=bE,_E=[_];let xE;function kE(t){xE||(xE=fh.define({name:yE,template:bE,dependencies:_E})),t.register(xE)}var CE;let SE=eh(b)(CE=fe(Element,kp,Sp)(CE=class{constructor(t,e,i){this.element=t,this.dialogDom=i,this.dialog=e,i.wrapper.classList.add("b2022-kg-story"),i.wrapper.style.position="fixed",i.wrapper.style.zIndex=1e3,i.overlay.style.backgroundColor="rgba(0, 0, 0, 0.5)",i.overlay.style.position="absolute",i.overlay.style.top="0",i.overlay.style.left="0",i.overlay.style.right="0",i.overlay.style.bottom="0";let n=.9*this.dialogDom.overlay.clientWidth,r=.9*this.dialogDom.overlay.clientHeight;i.contentHost.style.width=`${Math.min(n,r)}px`,i.contentHost.style.height=`${Math.min(n,r)}px`}attaching(){let t=this.element.querySelector("div"),e=window.getComputedStyle(t),i=parseInt(e.paddingTop),n=parseInt(e.paddingBottom),r=t.clientHeight-(i+n);this.height=r}})||CE)||CE;const EE="vis-06-info-popover",AE='<div class="my-popover">\n  <p>\n    In this visualisation each circle encodes an occupation. The size of each circle corresponds to the number of\n    women that are associated with that specific occupation. The larger the circle, the greater the frequency.\n  </p>\n  <p>\n    You can interact with the visualisation. Use the mouse wheel to zoom. Click and drag to pan.\n  </p>\n</div>',TE=AE,ME=[];let OE;function PE(t){OE||(OE=fh.define({name:EE,template:AE,dependencies:ME})),t.register(OE)}var RE;let LE=eh(w)(RE=fe(Element)(RE=class{constructor(t){this.element=t}})||RE)||RE;var IE,$E,DE,NE,jE,BE;function FE(t,e,i,n){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function zE(t,e,i,n,r){var s={};return Object.keys(n).forEach((function(t){s[t]=n[t]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(t,e,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(t,e,s),s=null),s}let UE=eh(y)(IE=fe(Element,xp,gi,cg,ug,lC)(($E=class{constructor(t,e,i,n,r,s){FE(this,"data",DE,this),FE(this,"height",NE,this),FE(this,"colors",jE,this),FE(this,"isExpanded",BE,this),this.element=t,this.dialogService=e,this.eventAggregator=i,this.dataService=n,this.colorService=r,this.konvaHelper=s,this.element.classList.add("b2022-kg-story"),this.konva={},this.tooltip=null,this.hasStarted=!1}async binding(){this.data||(this.data=await this.dataService.getData()),this.colors||(this.colors=this.colorService.getColors())}attached(){this.createCanvas(),this.setupVisualisation(),this.setupPagePositionObserver(),this.setupCanvasEvents(),this.setupZoom()}createCanvas(){const t=this.element.querySelector(".konva-container"),e=t.clientWidth,i=parseInt(this.height)||400,n=new Cy.Stage({container:t,width:e,height:i}),r=new Cy.Layer,s=new Cy.Group({x:10,y:10,width:e-20,height:i-20}),o=new Cy.Group;s.add(o),r.add(s),n.add(r),this.konva.stage=n,this.konva.layer=r,this.konva.group1=s,this.konva.group2=o}setupVisualisationData(){let t=this.data.elementsF.reduce(((t,e)=>(e.occ.forEach((e=>{t.has(e)||t.set(e,0),t.set(e,t.get(e)+1)})),t)),new Map);return[...t.entries()].map((t=>({key:t[0],value:t[1]}))).filter((t=>t.value>0))}setupVisualisation(){this.konva.group2.destroyChildren();let t=this.setupVisualisationData(),e=Dx().size([this.konva.group1.width(),this.konva.group1.height()]),i=gx({children:t}).sum((t=>t.value));e(i);let n=Fx(-this.konva.group1.width(),this.konva.group1.width()),r=Fx(-this.konva.group1.height(),this.konva.group1.height());i.leaves().forEach((t=>{const e=new Cy.Group({x:n(),y:r()}),i=this.konvaHelper.createCircle({radius:t.r,fill:this.colors.YellowMuted,stroke:this.colors.YellowFull,listening:!0}),s=this.konvaHelper.createTextArea({text:t.data.key,width:2*t.r,height:2*t.r,fontSize:.3*t.r,padding:Math.min(.2*t.r,4),fill:this.colors.FontDark});i.data={node:t},t.data.x=t.x,t.data.y=t.y,t.konva={group:e,circle:i,text:s},e.add(i,s),this.konva.group2.add(e)})),this.nodes=i.leaves()}setupCanvasEvents(){this.konva.stage.on("mouseover",(t=>{let e=t.target;e.data&&e.data.node&&(this.tooltip=new Map([["name",e.data.node.data.key],["size",`${e.data.node.value} women`]]))})),this.konva.stage.on("mouseout",(t=>{this.tooltip=null}))}setupZoom(){let t=null,e={clientX:0,clientY:0};this.zoom=tC().scaleExtent([.5,32]).on("zoom",(t=>{this.konva.layer.scale({x:t.transform.k,y:t.transform.k}),this.konva.layer.position({x:t.transform.x,y:t.transform.y}),this.nodes.forEach((e=>e.konva.circle.strokeWidth(1/t.transform.k))),t&&t.sourceEvent&&(e.clientX=t.sourceEvent.clientX,e.clientY=t.sourceEvent.clientY)})).on("start",(i=>{t=this.tooltip,this.tooltip=null,i&&i.sourceEvent&&(e.clientX=i.sourceEvent.clientX,e.clientY=i.sourceEvent.clientY)})).on("end",(i=>{this.tooltip=t,t=null;let n=new MouseEvent("mousemove",{clientX:e.clientX,clientY:e.clientY,detail:6});document.dispatchEvent(new MouseEvent("mousemove",n))})),this.zoom(Ik(this.konva.stage.content))}startVisualisation(){let t=this.nodes,e=[];t.forEach((t=>{t.konva.text.remove();let i=new Cy.Tween({node:t.konva.group,x:t.data.x,y:t.data.y,duration:1,onFinish:()=>{t.konva.group.add(t.konva.text),i.destroy()}}).play();e.push(i)})),this.hasStarted=!0}setupPagePositionObserver(){this.observer=new IntersectionObserver(((t,e)=>{t.forEach((t=>{t.isIntersecting&&(console.log("👀 - Starting Vis 06"),this.startVisualisation()),!t.isIntersecting&&this.hasStarted&&(console.log("👀 - Resetting Vis 06"),this.onReset())}))}),{threshold:.5});let t=this.element.querySelector(".konva-container");this.observer.observe(t)}onReset(){this.zoom.transform(Ik(this.konva.stage.content),Vk)}onInfo(){return LE}onExpand(){document.body.style.overflow="hidden",this.dialogService.open({component:()=>SE,lock:!1}).whenClosed((t=>{document.body.style.overflow="auto"}))}onContract(){this.dialogService.closeAll()}onDownload(){}detaching(){this.observer.disconnect()}},DE=zE($E.prototype,"data",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NE=zE($E.prototype,"height",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jE=zE($E.prototype,"colors",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BE=zE($E.prototype,"isExpanded",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),IE=$E))||IE)||IE;const GE="vis-07",HE='<div class="position-relative">\n  <div class="konva-container">\n    <custom-vis-tooltip data.bind="tooltip"></custom-vis-tooltip>\n  </div>\n\n  <custom-vis-icons \n    on-reset.call="onReset()" \n    on-info.call="onInfo()" \n    on-expand.call="onExpand()" \n    on-contract.call="onContract()"\n    is-expanded.bind="isExpanded"\n  >\n  </custom-vis-icons>\n\n  <div class="gender-legend">\n    <div class="g-l-icon">\n      <div class="g-l-shape female-outline-fill"></div>\n      <div class="g-l-label"> Female </div>\n    </div>\n  \n    <div style="margin-top: 10px;"></div>\n  \n    <div class="g-l-icon">\n      <div class="g-l-shape male-outline-fill"></div>\n      <div class="g-l-label"> Male </div>\n    </div>\n  </div>\n</div>',VE=HE,qE=[];let WE;function YE(t){WE||(WE=fh.define({name:GE,template:HE,dependencies:qE})),t.register(WE)}const XE="vis-07-fullscreen-dialog",KE='\n\n<div class="p-3 w-100 h-100" style="background: white;">\n  <vis-07 height.bind="height" is-expanded.bind="true"></vis-07>\n</div>',QE=KE,ZE=[S];let JE;function tA(t){JE||(JE=fh.define({name:XE,template:KE,dependencies:ZE})),t.register(JE)}var eA;let iA=eh(k)(eA=fe(Element,kp,Sp)(eA=class{constructor(t,e,i){this.element=t,this.dialogDom=i,this.dialog=e,i.wrapper.classList.add("b2022-kg-story"),i.wrapper.style.position="fixed",i.wrapper.style.zIndex=1e3,i.overlay.style.backgroundColor="rgba(0, 0, 0, 0.5)",i.overlay.style.position="absolute",i.overlay.style.top="0",i.overlay.style.left="0",i.overlay.style.right="0",i.overlay.style.bottom="0";let n=.9*this.dialogDom.overlay.clientWidth,r=.9*this.dialogDom.overlay.clientHeight;i.contentHost.style.width=`${Math.min(n,r)}px`,i.contentHost.style.height=`${Math.min(n,r)}px`}attaching(){let t=this.element.querySelector("div"),e=window.getComputedStyle(t),i=parseInt(e.paddingTop),n=parseInt(e.paddingBottom),r=t.clientHeight-(i+n);this.height=r}})||eA)||eA;const nA="vis-07-info-popover",rA='<div class="my-popover">\n  <p>\n    In this visualisation each circle encodes an occupation. Where the occupation is split between males and\n    females. The size of each inner circle corresponds to the number of women or men that are associated with that\n    specific occupation. The larger the circle, the greater the frequency.\n  </p>\n  <p>\n    You can interact with the visualisation. Use the mouse wheel to zoom. Click and drag to pan.\n  </p>\n</div>',sA=rA,oA=[];let aA;function lA(t){aA||(aA=fh.define({name:nA,template:rA,dependencies:oA})),t.register(aA)}var hA;let cA=eh(C)(hA=fe(Element)(hA=class{constructor(t){this.element=t}})||hA)||hA;var uA,dA,fA,pA,gA,vA;function mA(t,e,i,n){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function yA(t,e,i,n,r){var s={};return Object.keys(n).forEach((function(t){s[t]=n[t]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(t,e,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(t,e,s),s=null),s}let bA=eh(x)(uA=fe(Element,xp,gi,cg,ug,lC)((dA=class{constructor(t,e,i,n,r,s){mA(this,"data",fA,this),mA(this,"height",pA,this),mA(this,"colors",gA,this),mA(this,"isExpanded",vA,this),this.element=t,this.dialogService=e,this.eventAggregator=i,this.dataService=n,this.colorService=r,this.konvaHelper=s,this.element.classList.add("b2022-kg-story"),this.konva={},this.tooltip=null,this.hasStarted=!1}async binding(){this.data||(this.data=await this.dataService.getData()),this.colors||(this.colors=this.colorService.getColors())}attached(){this.createCanvas(),this.setupVisualisation(),this.setupPagePositionObserver(),this.setupCanvasEvents(),this.setupZoom()}createCanvas(){const t=this.element.querySelector(".konva-container"),e=t.clientWidth,i=parseInt(this.height)||400,n=new Cy.Stage({container:t,width:e,height:i}),r=new Cy.Layer,s=new Cy.Group({x:10,y:10,width:e-20,height:i-20}),o=new Cy.Group;s.add(o),r.add(s),n.add(r),this.konva.stage=n,this.konva.layer=r,this.konva.group1=s,this.konva.group2=o}setupVisualisationData(){let t=this.data.elementsT.reduce(((t,e)=>{let i="F"===e.gender?"f":"m";return e.occ.forEach((e=>{t.has(e)||t.set(e,{m:0,f:0}),t.get(e)[i]++})),t}),new Map),e=[...t.entries()].map((t=>({key:t[0],values:t[1]})));return e=e.filter((t=>t.values.f>0)),e}setupVisualisation(){this.konva.group2.destroyChildren();let t=this.setupVisualisationData(),e=Dx().size([this.konva.group1.width(),this.konva.group1.height()]),i=gx({children:t}).sum((t=>t.values?(t.values.m?t.values.m:0)+(t.values.f?t.values.f:0):0));e(i);let n=Fx(-this.konva.group1.width(),this.konva.group1.width()),r=Fx(-this.konva.group1.height(),this.konva.group1.height());i.leaves().forEach((t=>{let e=Dx().size([2*t.r,2*t.r]),i=gx({children:[{value:t.data.values.m,gender:"M"},{value:t.data.values.f,gender:"F"}]}).sum((t=>t.value));e(i);let s=new Cy.Group({x:n(),y:r()}),o=new Cy.Shape({sceneFunc:(e,n)=>{e.beginPath(),e.arc(0,0,t.r,0,2*Math.PI),e.lineWidth=1/this.konva.layer.scaleX(),e.strokeStyle="rgba(0,0,0,0.2)",e.stroke(),e.closePath(),i.leaves().forEach((t=>{if(t.r<=0)return null;e.beginPath(),e.arc(t.x-i.r,t.y-i.r,t.r,0,2*Math.PI),e.fillStyle="M"===t.data.gender?this.colors.PurpleMuted:this.colors.YellowMuted,e.fill(),e.strokeStyle="M"===t.data.gender?this.colors.PurpleFull:this.colors.YellowFull,e.stroke(),e.closePath()}))},hitFunc:(e,i)=>{e.beginPath(),e.arc(0,0,t.r,0,2*Math.PI),e.closePath(),e.fillStrokeShape(i)},perfectDrawEnabled:!1,listening:!0,shadowForStrokeEnabled:!1}),a=this.konvaHelper.createTextArea({text:t.data.key,width:2*t.r,height:2*t.r,fontSize:.3*t.r,padding:Math.min(.2*t.r,4),fill:this.colors.FontDark});o.data={node:t},t.data.x=t.x,t.data.y=t.y,s.add(o,a),t.konva={group:s,shape:o,text:a},this.konva.group2.add(s)})),this.nodes=i.leaves()}setupCanvasEvents(){this.konva.stage.on("mouseover",(t=>{let e=t.target;e.data&&e.data.node&&(this.tooltip=new Map([["name",e.data.node.data.key],["size 1",`${e.data.node.data.values.m} men`],["size 2",`${e.data.node.data.values.f} women`]]))})),this.konva.stage.on("mouseout",(t=>{this.tooltip=null}))}setupZoom(){let t=null,e={clientX:0,clientY:0};this.zoom=tC().scaleExtent([.5,32]).on("zoom",(t=>{this.konva.layer.scale({x:t.transform.k,y:t.transform.k}),this.konva.layer.position({x:t.transform.x,y:t.transform.y}),t&&t.sourceEvent&&(e.clientX=t.sourceEvent.clientX,e.clientY=t.sourceEvent.clientY)})).on("start",(i=>{t=this.tooltip,this.tooltip=null,i&&i.sourceEvent&&(e.clientX=i.sourceEvent.clientX,e.clientY=i.sourceEvent.clientY)})).on("end",(i=>{this.tooltip=t,t=null;let n=new MouseEvent("mousemove",{clientX:e.clientX,clientY:e.clientY,detail:6});document.dispatchEvent(new MouseEvent("mousemove",n))})),this.zoom(Ik(this.konva.stage.content))}startVisualisation(){this.nodes.forEach((t=>{t.konva.text.remove();let e=new Cy.Tween({node:t.konva.group,x:t.data.x,y:t.data.y,duration:1,onFinish:()=>{t.konva.group.add(t.konva.text),e.destroy()}}).play()})),this.hasStarted=!0}setupPagePositionObserver(){this.observer=new IntersectionObserver(((t,e)=>{t.forEach((t=>{t.isIntersecting&&(console.log("👀 - Starting Vis 07"),this.startVisualisation()),!t.isIntersecting&&this.hasStarted&&(console.log("👀 - Resetting Vis 07"),this.onReset())}))}),{threshold:.5});let t=this.element.querySelector(".konva-container");this.observer.observe(t)}onReset(){this.zoom.transform(Ik(this.konva.stage.content),Vk)}onInfo(){return cA}onExpand(){document.body.style.overflow="hidden",this.dialogService.open({component:()=>iA,lock:!1}).whenClosed((t=>{document.body.style.overflow="auto"}))}onContract(){this.dialogService.closeAll()}onDownload(){}detaching(){this.observer.disconnect()}},fA=yA(dA.prototype,"data",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pA=yA(dA.prototype,"height",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gA=yA(dA.prototype,"colors",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vA=yA(dA.prototype,"isExpanded",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uA=dA))||uA)||uA;const wA="vis-08",_A='<div class="position-relative">\n  <div class="konva-container">\n    <custom-vis-tooltip data.bind="tooltip"></custom-vis-tooltip>\n  </div>\n\n  <custom-vis-icons \n    on-reset.call="onReset()" \n    on-info.call="onInfo()" \n    on-expand.call="onExpand()" \n    on-contract.call="onContract()"\n    is-expanded.bind="isExpanded">\n  </custom-vis-icons>\n</div>',xA=_A,kA=[];let CA;function SA(t){CA||(CA=fh.define({name:wA,template:_A,dependencies:kA})),t.register(CA)}const EA="vis-08-fullscreen-dialog",AA='\n\n<div class="p-3 w-100 h-100" style="background: white;">\n  <vis-08 height.bind="height" is-expanded.bind="true"></vis-08>\n</div>',TA=AA,MA=[M];let OA;function PA(t){OA||(OA=fh.define({name:EA,template:AA,dependencies:MA})),t.register(OA)}var RA;let LA=eh(A)(RA=fe(Element,kp,Sp)(RA=class{constructor(t,e,i){this.element=t,this.dialogDom=i,this.dialog=e,i.wrapper.classList.add("b2022-kg-story"),i.wrapper.style.position="fixed",i.wrapper.style.zIndex=1e3,i.overlay.style.backgroundColor="rgba(0, 0, 0, 0.5)",i.overlay.style.position="absolute",i.overlay.style.top="0",i.overlay.style.left="0",i.overlay.style.right="0",i.overlay.style.bottom="0";let n=.9*this.dialogDom.overlay.clientWidth,r=.9*this.dialogDom.overlay.clientHeight;i.contentHost.style.width=`${Math.min(n,r)}px`}attaching(){let t=this.element.querySelector("div"),e=window.getComputedStyle(t);parseInt(e.paddingTop),parseInt(e.paddingBottom),t.clientHeight,this.height=700}})||RA)||RA;const IA="vis-08-info-popover",$A='<div class="my-popover">\n  <p>\n    In this visualisation each circle encodes an occupation. The size of each circle corresponds to the number of\n    women that are associated with that specific occupation. The larger the circle, the greater the frequency.\n  </p>\n  <p>\n    You can interact with the visualisation. Click on a circle to select it and compare how the occupation evolved\n    over the centuries.\n  </p>\n</div>',DA=$A,NA=[];let jA;function BA(t){jA||(jA=fh.define({name:IA,template:$A,dependencies:NA})),t.register(jA)}var FA;let zA=eh(T)(FA=fe(Element)(FA=class{constructor(t){this.element=t}})||FA)||FA;var UA,GA,HA,VA,qA,WA;function YA(t,e,i,n){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function XA(t,e,i,n,r){var s={};return Object.keys(n).forEach((function(t){s[t]=n[t]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(t,e,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(t,e,s),s=null),s}let KA=eh(E)(UA=fe(Element,xp,gi,cg,ug,lC)((GA=class{constructor(t,e,i,n,r,s){YA(this,"data",HA,this),YA(this,"height",VA,this),YA(this,"colors",qA,this),YA(this,"isExpanded",WA,this),this.element=t,this.dialogService=e,this.eventAggregator=i,this.dataService=n,this.colorService=r,this.konvaHelper=s,this.element.classList.add("b2022-kg-story"),this.konva={},this.tooltip=null,this.filters=[],this.hasStarted=!1}async binding(){this.data||(this.data=await this.dataService.getData()),this.colors||(this.colors=this.colorService.getColors())}attached(){this.createCanvas(),this.setupVisualisation(),this.setupSimulation(),this.setupPagePositionObserver(),this.setupCanvasEvents()}createCanvas(){const t=this.element.querySelector(".konva-container"),e=t.clientWidth,i=parseInt(this.height)||400,n=new Cy.Stage({container:t,width:e,height:i}),r=new Cy.Layer,s=new Cy.Group({x:10,y:10,width:e-20,height:i-20}),o=new Cy.Group({width:s.width(),y:s.height()-50,height:50}),a=new Cy.Group({width:s.width(),height:s.height()-o.height()});s.add(o,a),r.add(s),n.add(r),this.konva.stage=n,this.konva.layer=r,this.konva.group1=s,this.konva.group2=o,this.konva.group3=a}setupVisualisationData(){let t=this.data.elementsF.reduce(((t,e)=>(e.occ.forEach((e=>{t.has(e)||t.set(e,0),t.set(e,t.get(e)+1)})),t)),new Map),e=[...this.data.elementsF.reduce(((e,i)=>{let n=parseInt(i.century.replace("c",""));n=n<19?18:n,e.has(n)||e.set(n,new Map);let r=e.get(n);return i.occ.forEach((e=>{t.get(e)<=5||(r.has(e)||r.set(e,0),r.set(e,r.get(e)+1))})),e}),new Map).entries()].map((t=>[...t[1].entries()].map((e=>({century:t[0],area:e[0],count:e[1]}))))).flat(1).filter((t=>t.century)).sort(((t,e)=>t.century-e.century));return e}setupVisualisation(){this.konva.group2.destroyChildren(),this.konva.group3.destroyChildren();let t=this.setupVisualisationData(),e=[...t.reduce(((t,e)=>t.add(e.century)),new Set)];this.filters=[...t.reduce(((t,e)=>t.add(e.area)),new Set)].map((t=>({key:t,active:!1})));let i=Yx().domain(e).range([0,this.konva.group2.width()]),n=Lk().domain([Ey(t,(t=>t.count)),Sy(t,(t=>t.count))]).range([15,55]);e.forEach((t=>{let e=i(t)+i.bandwidth()/2,n=this.konvaHelper.createText({x:e,y:this.konva.group2.height()/2,textAlignX:"center",textAlignY:"center",fontSize:16,text:18===t?"Pre 19th Century":`${yC(t)} Century`,fill:this.colors.FontDark});this.konva.group2.add(n)})),t.forEach((t=>{let e=new Cy.Group({x:i(t.century)+i.bandwidth()/2,y:this.konva.group3.height()/2}),r=this.konvaHelper.createCircle({fill:this.colors.YellowMuted,stroke:this.colors.YellowFull,radius:n(t.count),listening:!0}),s=this.konvaHelper.createTextArea({text:t.area,width:2*r.radius(),height:2*r.radius(),fontSize:.35*r.radius(),padding:Math.min(.2*r.radius(),4),fill:this.colors.FontDark});e.add(r,s),s.fontSize()<10&&s.remove(),r.data={node:t},t.konva={group:e,circle:r,text:s},t.x=e.x(),t.y=e.y(),t.radius=r.radius(),t.xCenter=e.x(),t.yCenter=e.y(),t.width=i.bandwidth(),t.height=this.konva.group3.height(),this.konva.group3.add(e)})),this.nodes=t}setupSimulation(){this.simulation&&this.simulation.stop();let t=this.nodes,e=ux(t).force("x",dx((t=>t.xCenter)).strength(.1)).force("y",fx((t=>t.yCenter)).strength(.01)).force("collide",ax().radius((t=>t.radius+.5)).iterations(2));e.on("tick",(()=>{t.forEach((t=>{let e=t.radius,i=.5*t.width,n=.5*t.height,r=Math.min(Math.max(t.xCenter-i+e,t.x),t.xCenter+i-e),s=Math.min(Math.max(t.yCenter-n+e,t.y),t.yCenter+n-e);t.konva.group.position({x:r,y:s})}))})),e.stop(),this.simulation=e}setupCanvasEvents(){this.konva.stage.on("mouseover",(t=>{t.target.data&&t.target.data.node&&(this.tooltip=new Map([["name",t.target.data.node.area],["size",`${t.target.data.node.count} women`]]))})),this.konva.stage.on("mouseout",(t=>{this.tooltip=null})),this.konva.stage.on("click",(t=>{t.target.data&&t.target.data.node?this.onNodeClick(t.target.data.node):this.onNodeClick()}))}startVisualisation(){this.simulation&&this.simulation.restart()}stopVisualisation(){this.simulation&&this.simulation.stop()}onNodeClick(t){if(t){let e=this.filters.find((e=>e.key===t.area));e&&(e.active=!e.active)}else this.filters.forEach((t=>t.active=!1));let e=!this.filters.some((t=>t.active)),i=[];this.nodes.forEach((t=>{let n=this.filters.find((e=>e.key===t.area)),r=null;r=e||n.active?new Cy.Tween({node:t.konva.group,duration:.2,opacity:1}):new Cy.Tween({node:t.konva.group,duration:.2,opacity:.2}),i.push(r)})),i.forEach((t=>{t.onFinish=()=>t.destroy(),t.play()}))}setupPagePositionObserver(){this.observer=new IntersectionObserver(((t,e)=>{t.forEach((t=>{t.isIntersecting&&!this.hasStarted&&(console.log("👀 - Starting Vis 08"),this.startVisualisation(),this.hasStarted=!0),!t.isIntersecting&&this.hasStarted&&(console.log("👀 - Leaving Vis 08"),this.stopVisualisation(),this.hasStarted=!1)}))}),{threshold:.5});let t=this.element.querySelector(".konva-container");this.observer.observe(t)}onReset(){this.onNodeClick()}onInfo(){return zA}onExpand(){document.body.style.overflow="hidden",this.dialogService.open({component:()=>LA,lock:!1}).whenClosed((t=>{document.body.style.overflow="auto"}))}onContract(){this.dialogService.closeAll()}onDownload(){}detaching(){this.observer.disconnect()}},HA=XA(GA.prototype,"data",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VA=XA(GA.prototype,"height",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qA=XA(GA.prototype,"colors",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WA=XA(GA.prototype,"isExpanded",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UA=GA))||UA)||UA;const QA="custom-vis-icons",ZA='<div class="custom-vis-icons">\n  <div class="info-icon-wrapper">\n    <img src="https://b2022-kg-story.ivanbacher.me/icons/info.svg" alt="info icon">\n  </div>\n\n  <div>\n    <img src="https://b2022-kg-story.ivanbacher.me/icons/reset.svg" alt="reset icon" data-type="tooltip" title="Reset Visualisation" click.delegate="reset()">\n  </div>\n\n  <div>\n    <div if.bind="isExpanded">\n      <img src="https://b2022-kg-story.ivanbacher.me/icons/contract.svg" alt="contract icon" data-type="tooltip" title="Close" click.delegate="contract()">\n    </div>\n    <div else>\n      <img src="https://b2022-kg-story.ivanbacher.me/icons/expand.svg" alt="expand icon" data-type="tooltip" title="Expand Visualisation" click.delegate="expand()">\n    </div>\n  </div>\n</div>\n\n<au-compose view-model.bind="infoPopoverViewModel"></au-compose>',JA=ZA,tT=[];let eT;function iT(t){eT||(eT=fh.define({name:QA,template:ZA,dependencies:tT})),t.register(eT)}function nT(t){if(null==t)return window;if("[object Window]"!==t.toString()){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function rT(t){return t instanceof nT(t).Element||t instanceof Element}function sT(t){return t instanceof nT(t).HTMLElement||t instanceof HTMLElement}function oT(t){return"undefined"!=typeof ShadowRoot&&(t instanceof nT(t).ShadowRoot||t instanceof ShadowRoot)}var aT=Math.max,lT=Math.min,hT=Math.round;function cT(t,e){void 0===e&&(e=!1);var i=t.getBoundingClientRect(),n=1,r=1;if(sT(t)&&e){var s=t.offsetHeight,o=t.offsetWidth;o>0&&(n=hT(i.width)/o||1),s>0&&(r=hT(i.height)/s||1)}return{width:i.width/n,height:i.height/r,top:i.top/r,right:i.right/n,bottom:i.bottom/r,left:i.left/n,x:i.left/n,y:i.top/r}}function uT(t){var e=nT(t);return{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function dT(t){return t?(t.nodeName||"").toLowerCase():null}function fT(t){return((rT(t)?t.ownerDocument:t.document)||window.document).documentElement}function pT(t){return cT(fT(t)).left+uT(t).scrollLeft}function gT(t){return nT(t).getComputedStyle(t)}function vT(t){var e=gT(t),i=e.overflow,n=e.overflowX,r=e.overflowY;return/auto|scroll|overlay|hidden/.test(i+r+n)}function mT(t,e,i){void 0===i&&(i=!1);var n,r,s=sT(e),o=sT(e)&&function(t){var e=t.getBoundingClientRect(),i=hT(e.width)/t.offsetWidth||1,n=hT(e.height)/t.offsetHeight||1;return 1!==i||1!==n}(e),a=fT(e),l=cT(t,o),h={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(s||!s&&!i)&&(("body"!==dT(e)||vT(a))&&(h=(n=e)!==nT(n)&&sT(n)?{scrollLeft:(r=n).scrollLeft,scrollTop:r.scrollTop}:uT(n)),sT(e)?((c=cT(e,!0)).x+=e.clientLeft,c.y+=e.clientTop):a&&(c.x=pT(a))),{x:l.left+h.scrollLeft-c.x,y:l.top+h.scrollTop-c.y,width:l.width,height:l.height}}function yT(t){var e=cT(t),i=t.offsetWidth,n=t.offsetHeight;return Math.abs(e.width-i)<=1&&(i=e.width),Math.abs(e.height-n)<=1&&(n=e.height),{x:t.offsetLeft,y:t.offsetTop,width:i,height:n}}function bT(t){return"html"===dT(t)?t:t.assignedSlot||t.parentNode||(oT(t)?t.host:null)||fT(t)}function wT(t){return["html","body","#document"].indexOf(dT(t))>=0?t.ownerDocument.body:sT(t)&&vT(t)?t:wT(bT(t))}function _T(t,e){var i;void 0===e&&(e=[]);var n=wT(t),r=n===(null==(i=t.ownerDocument)?void 0:i.body),s=nT(n),o=r?[s].concat(s.visualViewport||[],vT(n)?n:[]):n,a=e.concat(o);return r?a:a.concat(_T(bT(o)))}function xT(t){return["table","td","th"].indexOf(dT(t))>=0}function kT(t){return sT(t)&&"fixed"!==gT(t).position?t.offsetParent:null}function CT(t){for(var e=nT(t),i=kT(t);i&&xT(i)&&"static"===gT(i).position;)i=kT(i);return i&&("html"===dT(i)||"body"===dT(i)&&"static"===gT(i).position)?e:i||function(t){var e=-1!==navigator.userAgent.toLowerCase().indexOf("firefox");if(-1!==navigator.userAgent.indexOf("Trident")&&sT(t)&&"fixed"===gT(t).position)return null;var i=bT(t);for(oT(i)&&(i=i.host);sT(i)&&["html","body"].indexOf(dT(i))<0;){var n=gT(i);if("none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||-1!==["transform","perspective"].indexOf(n.willChange)||e&&"filter"===n.willChange||e&&n.filter&&"none"!==n.filter)return i;i=i.parentNode}return null}(t)||e}var ST="top",ET="bottom",AT="right",TT="left",MT="auto",OT=[ST,ET,AT,TT],PT="start",RT="end",LT="viewport",IT="popper",$T=OT.reduce((function(t,e){return t.concat([e+"-"+PT,e+"-"+RT])}),[]),DT=[].concat(OT,[MT]).reduce((function(t,e){return t.concat([e,e+"-"+PT,e+"-"+RT])}),[]),NT=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function jT(t){var e=new Map,i=new Set,n=[];function r(t){i.add(t.name),[].concat(t.requires||[],t.requiresIfExists||[]).forEach((function(t){if(!i.has(t)){var n=e.get(t);n&&r(n)}})),n.push(t)}return t.forEach((function(t){e.set(t.name,t)})),t.forEach((function(t){i.has(t.name)||r(t)})),n}function BT(t){var e;return function(){return e||(e=new Promise((function(i){Promise.resolve().then((function(){e=void 0,i(t())}))}))),e}}var FT={placement:"bottom",modifiers:[],strategy:"absolute"};function zT(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return!e.some((function(t){return!(t&&"function"==typeof t.getBoundingClientRect)}))}var UT={passive:!0};const GT={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(t){var e=t.state,i=t.instance,n=t.options,r=n.scroll,s=void 0===r||r,o=n.resize,a=void 0===o||o,l=nT(e.elements.popper),h=[].concat(e.scrollParents.reference,e.scrollParents.popper);return s&&h.forEach((function(t){t.addEventListener("scroll",i.update,UT)})),a&&l.addEventListener("resize",i.update,UT),function(){s&&h.forEach((function(t){t.removeEventListener("scroll",i.update,UT)})),a&&l.removeEventListener("resize",i.update,UT)}},data:{}};function HT(t){return t.split("-")[0]}function VT(t){return t.split("-")[1]}function qT(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function WT(t){var e,i=t.reference,n=t.element,r=t.placement,s=r?HT(r):null,o=r?VT(r):null,a=i.x+i.width/2-n.width/2,l=i.y+i.height/2-n.height/2;switch(s){case ST:e={x:a,y:i.y-n.height};break;case ET:e={x:a,y:i.y+i.height};break;case AT:e={x:i.x+i.width,y:l};break;case TT:e={x:i.x-n.width,y:l};break;default:e={x:i.x,y:i.y}}var h=s?qT(s):null;if(null!=h){var c="y"===h?"height":"width";switch(o){case PT:e[h]=e[h]-(i[c]/2-n[c]/2);break;case RT:e[h]=e[h]+(i[c]/2-n[c]/2)}}return e}var YT={top:"auto",right:"auto",bottom:"auto",left:"auto"};function XT(t){var e,i=t.popper,n=t.popperRect,r=t.placement,s=t.variation,o=t.offsets,a=t.position,l=t.gpuAcceleration,h=t.adaptive,c=t.roundOffsets,u=t.isFixed,d=o.x,f=void 0===d?0:d,p=o.y,g=void 0===p?0:p,v="function"==typeof c?c({x:f,y:g}):{x:f,y:g};f=v.x,g=v.y;var m=o.hasOwnProperty("x"),y=o.hasOwnProperty("y"),b=TT,w=ST,_=window;if(h){var x=CT(i),k="clientHeight",C="clientWidth";x===nT(i)&&"static"!==gT(x=fT(i)).position&&"absolute"===a&&(k="scrollHeight",C="scrollWidth"),(r===ST||(r===TT||r===AT)&&s===RT)&&(w=ET,g-=(u&&x===_&&_.visualViewport?_.visualViewport.height:x[k])-n.height,g*=l?1:-1),r!==TT&&(r!==ST&&r!==ET||s!==RT)||(b=AT,f-=(u&&x===_&&_.visualViewport?_.visualViewport.width:x[C])-n.width,f*=l?1:-1)}var S,E=Object.assign({position:a},h&&YT),A=!0===c?function(t){var e=t.x,i=t.y,n=window.devicePixelRatio||1;return{x:hT(e*n)/n||0,y:hT(i*n)/n||0}}({x:f,y:g}):{x:f,y:g};return f=A.x,g=A.y,l?Object.assign({},E,((S={})[w]=y?"0":"",S[b]=m?"0":"",S.transform=(_.devicePixelRatio||1)<=1?"translate("+f+"px, "+g+"px)":"translate3d("+f+"px, "+g+"px, 0)",S)):Object.assign({},E,((e={})[w]=y?g+"px":"",e[b]=m?f+"px":"",e.transform="",e))}const KT={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(t){var e=t.state,i=t.options,n=i.gpuAcceleration,r=void 0===n||n,s=i.adaptive,o=void 0===s||s,a=i.roundOffsets,l=void 0===a||a,h={placement:HT(e.placement),variation:VT(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:r,isFixed:"fixed"===e.options.strategy};null!=e.modifiersData.popperOffsets&&(e.styles.popper=Object.assign({},e.styles.popper,XT(Object.assign({},h,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:o,roundOffsets:l})))),null!=e.modifiersData.arrow&&(e.styles.arrow=Object.assign({},e.styles.arrow,XT(Object.assign({},h,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})},data:{}},QT={name:"applyStyles",enabled:!0,phase:"write",fn:function(t){var e=t.state;Object.keys(e.elements).forEach((function(t){var i=e.styles[t]||{},n=e.attributes[t]||{},r=e.elements[t];sT(r)&&dT(r)&&(Object.assign(r.style,i),Object.keys(n).forEach((function(t){var e=n[t];!1===e?r.removeAttribute(t):r.setAttribute(t,!0===e?"":e)})))}))},effect:function(t){var e=t.state,i={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,i.popper),e.styles=i,e.elements.arrow&&Object.assign(e.elements.arrow.style,i.arrow),function(){Object.keys(e.elements).forEach((function(t){var n=e.elements[t],r=e.attributes[t]||{},s=Object.keys(e.styles.hasOwnProperty(t)?e.styles[t]:i[t]).reduce((function(t,e){return t[e]="",t}),{});sT(n)&&dT(n)&&(Object.assign(n.style,s),Object.keys(r).forEach((function(t){n.removeAttribute(t)})))}))}},requires:["computeStyles"]},ZT={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(t){var e=t.state,i=t.options,n=t.name,r=i.offset,s=void 0===r?[0,0]:r,o=DT.reduce((function(t,i){return t[i]=function(t,e,i){var n=HT(t),r=[TT,ST].indexOf(n)>=0?-1:1,s="function"==typeof i?i(Object.assign({},e,{placement:t})):i,o=s[0],a=s[1];return o=o||0,a=(a||0)*r,[TT,AT].indexOf(n)>=0?{x:a,y:o}:{x:o,y:a}}(i,e.rects,s),t}),{}),a=o[e.placement],l=a.x,h=a.y;null!=e.modifiersData.popperOffsets&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=h),e.modifiersData[n]=o}};var JT={left:"right",right:"left",bottom:"top",top:"bottom"};function tM(t){return t.replace(/left|right|bottom|top/g,(function(t){return JT[t]}))}var eM={start:"end",end:"start"};function iM(t){return t.replace(/start|end/g,(function(t){return eM[t]}))}function nM(t,e){var i=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(i&&oT(i)){var n=e;do{if(n&&t.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function rM(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function sM(t,e){return e===LT?rM(function(t){var e=nT(t),i=fT(t),n=e.visualViewport,r=i.clientWidth,s=i.clientHeight,o=0,a=0;return n&&(r=n.width,s=n.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(o=n.offsetLeft,a=n.offsetTop)),{width:r,height:s,x:o+pT(t),y:a}}(t)):rT(e)?function(t){var e=cT(t);return e.top=e.top+t.clientTop,e.left=e.left+t.clientLeft,e.bottom=e.top+t.clientHeight,e.right=e.left+t.clientWidth,e.width=t.clientWidth,e.height=t.clientHeight,e.x=e.left,e.y=e.top,e}(e):rM(function(t){var e,i=fT(t),n=uT(t),r=null==(e=t.ownerDocument)?void 0:e.body,s=aT(i.scrollWidth,i.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),o=aT(i.scrollHeight,i.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),a=-n.scrollLeft+pT(t),l=-n.scrollTop;return"rtl"===gT(r||i).direction&&(a+=aT(i.clientWidth,r?r.clientWidth:0)-s),{width:s,height:o,x:a,y:l}}(fT(t)))}function oM(t){return Object.assign({},{top:0,right:0,bottom:0,left:0},t)}function aM(t,e){return e.reduce((function(e,i){return e[i]=t,e}),{})}function lM(t,e){void 0===e&&(e={});var i=e,n=i.placement,r=void 0===n?t.placement:n,s=i.boundary,o=void 0===s?"clippingParents":s,a=i.rootBoundary,l=void 0===a?LT:a,h=i.elementContext,c=void 0===h?IT:h,u=i.altBoundary,d=void 0!==u&&u,f=i.padding,p=void 0===f?0:f,g=oM("number"!=typeof p?p:aM(p,OT)),v=c===IT?"reference":IT,m=t.rects.popper,y=t.elements[d?v:c],b=function(t,e,i){var n="clippingParents"===e?function(t){var e=_T(bT(t)),i=["absolute","fixed"].indexOf(gT(t).position)>=0&&sT(t)?CT(t):t;return rT(i)?e.filter((function(t){return rT(t)&&nM(t,i)&&"body"!==dT(t)})):[]}(t):[].concat(e),r=[].concat(n,[i]),s=r[0],o=r.reduce((function(e,i){var n=sM(t,i);return e.top=aT(n.top,e.top),e.right=lT(n.right,e.right),e.bottom=lT(n.bottom,e.bottom),e.left=aT(n.left,e.left),e}),sM(t,s));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}(rT(y)?y:y.contextElement||fT(t.elements.popper),o,l),w=cT(t.elements.reference),_=WT({reference:w,element:m,strategy:"absolute",placement:r}),x=rM(Object.assign({},m,_)),k=c===IT?x:w,C={top:b.top-k.top+g.top,bottom:k.bottom-b.bottom+g.bottom,left:b.left-k.left+g.left,right:k.right-b.right+g.right},S=t.modifiersData.offset;if(c===IT&&S){var E=S[r];Object.keys(C).forEach((function(t){var e=[AT,ET].indexOf(t)>=0?1:-1,i=[ST,ET].indexOf(t)>=0?"y":"x";C[t]+=E[i]*e}))}return C}const hM={name:"flip",enabled:!0,phase:"main",fn:function(t){var e=t.state,i=t.options,n=t.name;if(!e.modifiersData[n]._skip){for(var r=i.mainAxis,s=void 0===r||r,o=i.altAxis,a=void 0===o||o,l=i.fallbackPlacements,h=i.padding,c=i.boundary,u=i.rootBoundary,d=i.altBoundary,f=i.flipVariations,p=void 0===f||f,g=i.allowedAutoPlacements,v=e.options.placement,m=HT(v),y=l||(m!==v&&p?function(t){if(HT(t)===MT)return[];var e=tM(t);return[iM(t),e,iM(e)]}(v):[tM(v)]),b=[v].concat(y).reduce((function(t,i){return t.concat(HT(i)===MT?function(t,e){void 0===e&&(e={});var i=e,n=i.placement,r=i.boundary,s=i.rootBoundary,o=i.padding,a=i.flipVariations,l=i.allowedAutoPlacements,h=void 0===l?DT:l,c=VT(n),u=c?a?$T:$T.filter((function(t){return VT(t)===c})):OT,d=u.filter((function(t){return h.indexOf(t)>=0}));0===d.length&&(d=u);var f=d.reduce((function(e,i){return e[i]=lM(t,{placement:i,boundary:r,rootBoundary:s,padding:o})[HT(i)],e}),{});return Object.keys(f).sort((function(t,e){return f[t]-f[e]}))}(e,{placement:i,boundary:c,rootBoundary:u,padding:h,flipVariations:p,allowedAutoPlacements:g}):i)}),[]),w=e.rects.reference,_=e.rects.popper,x=new Map,k=!0,C=b[0],S=0;S<b.length;S++){var E=b[S],A=HT(E),T=VT(E)===PT,M=[ST,ET].indexOf(A)>=0,O=M?"width":"height",P=lM(e,{placement:E,boundary:c,rootBoundary:u,altBoundary:d,padding:h}),R=M?T?AT:TT:T?ET:ST;w[O]>_[O]&&(R=tM(R));var L=tM(R),I=[];if(s&&I.push(P[A]<=0),a&&I.push(P[R]<=0,P[L]<=0),I.every((function(t){return t}))){C=E,k=!1;break}x.set(E,I)}if(k)for(var $=function(t){var e=b.find((function(e){var i=x.get(e);if(i)return i.slice(0,t).every((function(t){return t}))}));if(e)return C=e,"break"},D=p?3:1;D>0&&"break"!==$(D);D--);e.placement!==C&&(e.modifiersData[n]._skip=!0,e.placement=C,e.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function cM(t,e,i){return aT(t,lT(e,i))}const uM={name:"preventOverflow",enabled:!0,phase:"main",fn:function(t){var e=t.state,i=t.options,n=t.name,r=i.mainAxis,s=void 0===r||r,o=i.altAxis,a=void 0!==o&&o,l=i.boundary,h=i.rootBoundary,c=i.altBoundary,u=i.padding,d=i.tether,f=void 0===d||d,p=i.tetherOffset,g=void 0===p?0:p,v=lM(e,{boundary:l,rootBoundary:h,padding:u,altBoundary:c}),m=HT(e.placement),y=VT(e.placement),b=!y,w=qT(m),_="x"===w?"y":"x",x=e.modifiersData.popperOffsets,k=e.rects.reference,C=e.rects.popper,S="function"==typeof g?g(Object.assign({},e.rects,{placement:e.placement})):g,E="number"==typeof S?{mainAxis:S,altAxis:S}:Object.assign({mainAxis:0,altAxis:0},S),A=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,T={x:0,y:0};if(x){if(s){var M,O="y"===w?ST:TT,P="y"===w?ET:AT,R="y"===w?"height":"width",L=x[w],I=L+v[O],$=L-v[P],D=f?-C[R]/2:0,N=y===PT?k[R]:C[R],j=y===PT?-C[R]:-k[R],B=e.elements.arrow,F=f&&B?yT(B):{width:0,height:0},z=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},U=z[O],G=z[P],H=cM(0,k[R],F[R]),V=b?k[R]/2-D-H-U-E.mainAxis:N-H-U-E.mainAxis,q=b?-k[R]/2+D+H+G+E.mainAxis:j+H+G+E.mainAxis,W=e.elements.arrow&&CT(e.elements.arrow),Y=W?"y"===w?W.clientTop||0:W.clientLeft||0:0,X=null!=(M=null==A?void 0:A[w])?M:0,K=L+q-X,Q=cM(f?lT(I,L+V-X-Y):I,L,f?aT($,K):$);x[w]=Q,T[w]=Q-L}if(a){var Z,J="x"===w?ST:TT,tt="x"===w?ET:AT,et=x[_],it="y"===_?"height":"width",nt=et+v[J],rt=et-v[tt],st=-1!==[ST,TT].indexOf(m),ot=null!=(Z=null==A?void 0:A[_])?Z:0,at=st?nt:et-k[it]-C[it]-ot+E.altAxis,lt=st?et+k[it]+C[it]-ot-E.altAxis:rt,ht=f&&st?function(t,e,i){var n=cM(t,e,i);return n>i?i:n}(at,et,lt):cM(f?at:nt,et,f?lt:rt);x[_]=ht,T[_]=ht-et}e.modifiersData[n]=T}},requiresIfExists:["offset"]},dM={name:"arrow",enabled:!0,phase:"main",fn:function(t){var e,i=t.state,n=t.name,r=t.options,s=i.elements.arrow,o=i.modifiersData.popperOffsets,a=HT(i.placement),l=qT(a),h=[TT,AT].indexOf(a)>=0?"height":"width";if(s&&o){var c=function(t,e){return oM("number"!=typeof(t="function"==typeof t?t(Object.assign({},e.rects,{placement:e.placement})):t)?t:aM(t,OT))}(r.padding,i),u=yT(s),d="y"===l?ST:TT,f="y"===l?ET:AT,p=i.rects.reference[h]+i.rects.reference[l]-o[l]-i.rects.popper[h],g=o[l]-i.rects.reference[l],v=CT(s),m=v?"y"===l?v.clientHeight||0:v.clientWidth||0:0,y=p/2-g/2,b=c[d],w=m-u[h]-c[f],_=m/2-u[h]/2+y,x=cM(b,_,w),k=l;i.modifiersData[n]=((e={})[k]=x,e.centerOffset=x-_,e)}},effect:function(t){var e=t.state,i=t.options.element,n=void 0===i?"[data-popper-arrow]":i;null!=n&&("string"!=typeof n||(n=e.elements.popper.querySelector(n)))&&nM(e.elements.popper,n)&&(e.elements.arrow=n)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function fM(t,e,i){return void 0===i&&(i={x:0,y:0}),{top:t.top-e.height-i.y,right:t.right-e.width+i.x,bottom:t.bottom-e.height+i.y,left:t.left-e.width-i.x}}function pM(t){return[ST,AT,ET,TT].some((function(e){return t[e]>=0}))}var gM=function(t){void 0===t&&(t={});var e=t,i=e.defaultModifiers,n=void 0===i?[]:i,r=e.defaultOptions,s=void 0===r?FT:r;return function(t,e,i){void 0===i&&(i=s);var r={placement:"bottom",orderedModifiers:[],options:Object.assign({},FT,s),modifiersData:{},elements:{reference:t,popper:e},attributes:{},styles:{}},o=[],a=!1,l={state:r,setOptions:function(i){var a="function"==typeof i?i(r.options):i;h(),r.options=Object.assign({},s,r.options,a),r.scrollParents={reference:rT(t)?_T(t):t.contextElement?_T(t.contextElement):[],popper:_T(e)};var c,u,d=function(t){var e=jT(t);return NT.reduce((function(t,i){return t.concat(e.filter((function(t){return t.phase===i})))}),[])}((c=[].concat(n,r.options.modifiers),u=c.reduce((function(t,e){var i=t[e.name];return t[e.name]=i?Object.assign({},i,e,{options:Object.assign({},i.options,e.options),data:Object.assign({},i.data,e.data)}):e,t}),{}),Object.keys(u).map((function(t){return u[t]}))));return r.orderedModifiers=d.filter((function(t){return t.enabled})),r.orderedModifiers.forEach((function(t){var e=t.name,i=t.options,n=void 0===i?{}:i,s=t.effect;if("function"==typeof s){var a=s({state:r,name:e,instance:l,options:n});o.push(a||function(){})}})),l.update()},forceUpdate:function(){if(!a){var t=r.elements,e=t.reference,i=t.popper;if(zT(e,i)){r.rects={reference:mT(e,CT(i),"fixed"===r.options.strategy),popper:yT(i)},r.reset=!1,r.placement=r.options.placement,r.orderedModifiers.forEach((function(t){return r.modifiersData[t.name]=Object.assign({},t.data)}));for(var n=0;n<r.orderedModifiers.length;n++)if(!0!==r.reset){var s=r.orderedModifiers[n],o=s.fn,h=s.options,c=void 0===h?{}:h,u=s.name;"function"==typeof o&&(r=o({state:r,options:c,name:u,instance:l})||r)}else r.reset=!1,n=-1}}},update:BT((function(){return new Promise((function(t){l.forceUpdate(),t(r)}))})),destroy:function(){h(),a=!0}};if(!zT(t,e))return l;function h(){o.forEach((function(t){return t()})),o=[]}return l.setOptions(i).then((function(t){!a&&i.onFirstUpdate&&i.onFirstUpdate(t)})),l}}({defaultModifiers:[GT,{name:"popperOffsets",enabled:!0,phase:"read",fn:function(t){var e=t.state,i=t.name;e.modifiersData[i]=WT({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})},data:{}},KT,QT,ZT,hM,uM,dM,{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(t){var e=t.state,i=t.name,n=e.rects.reference,r=e.rects.popper,s=e.modifiersData.preventOverflow,o=lM(e,{elementContext:"reference"}),a=lM(e,{altBoundary:!0}),l=fM(o,n),h=fM(a,r,s),c=pM(l),u=pM(h);e.modifiersData[i]={referenceClippingOffsets:l,popperEscapeOffsets:h,isReferenceHidden:c,hasPopperEscaped:u},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":u})}}]}),vM="tippy-content",mM="tippy-arrow",yM="tippy-svg-arrow",bM={passive:!0,capture:!0},wM=function(){return document.body};function _M(t,e,i){if(Array.isArray(t)){var n=t[e];return null==n?Array.isArray(i)?i[e]:i:n}return t}function xM(t,e){var i={}.toString.call(t);return 0===i.indexOf("[object")&&i.indexOf(e+"]")>-1}function kM(t,e){return"function"==typeof t?t.apply(void 0,e):t}function CM(t,e){return 0===e?t:function(n){clearTimeout(i),i=setTimeout((function(){t(n)}),e)};var i}function SM(t){return[].concat(t)}function EM(t,e){-1===t.indexOf(e)&&t.push(e)}function AM(t){return[].slice.call(t)}function TM(t){return Object.keys(t).reduce((function(e,i){return void 0!==t[i]&&(e[i]=t[i]),e}),{})}function MM(){return document.createElement("div")}function OM(t){return["Element","Fragment"].some((function(e){return xM(t,e)}))}function PM(t){return xM(t,"MouseEvent")}function RM(t,e){t.forEach((function(t){t&&(t.style.transitionDuration=e+"ms")}))}function LM(t,e){t.forEach((function(t){t&&t.setAttribute("data-state",e)}))}function IM(t){var e,i=SM(t)[0];return null!=i&&null!=(e=i.ownerDocument)&&e.body?i.ownerDocument:document}function $M(t,e,i){var n=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach((function(e){t[n](e,i)}))}function DM(t,e){for(var i=e;i;){var n;if(t.contains(i))return!0;i=null==i.getRootNode||null==(n=i.getRootNode())?void 0:n.host}return!1}var NM={isTouch:!1},jM=0;function BM(){NM.isTouch||(NM.isTouch=!0,window.performance&&document.addEventListener("mousemove",FM))}function FM(){var t=performance.now();t-jM<20&&(NM.isTouch=!1,document.removeEventListener("mousemove",FM)),jM=t}function zM(){var t=document.activeElement;if(function(t){return!(!t||!t._tippy||t._tippy.reference!==t)}(t)){var e=t._tippy;t.blur&&!e.state.isVisible&&t.blur()}}var UM=!("undefined"==typeof window||"undefined"==typeof document||!window.msCrypto),GM=Object.assign({appendTo:wM,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},{animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},{allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999}),HM=Object.keys(GM);function VM(t){var e=(t.plugins||[]).reduce((function(e,i){var n,r=i.name,s=i.defaultValue;return r&&(e[r]=void 0!==t[r]?t[r]:null!=(n=GM[r])?n:s),e}),{});return Object.assign({},t,e)}function qM(t,e){var i=Object.assign({},e,{content:kM(e.content,[t])},e.ignoreAttributes?{}:function(t,e){return(e?Object.keys(VM(Object.assign({},GM,{plugins:e}))):HM).reduce((function(e,i){var n=(t.getAttribute("data-tippy-"+i)||"").trim();if(!n)return e;if("content"===i)e[i]=n;else try{e[i]=JSON.parse(n)}catch(t){e[i]=n}return e}),{})}(t,e.plugins));return i.aria=Object.assign({},GM.aria,i.aria),i.aria={expanded:"auto"===i.aria.expanded?e.interactive:i.aria.expanded,content:"auto"===i.aria.content?e.interactive?null:"describedby":i.aria.content},i}function WM(t,e){t.innerHTML=e}function YM(t){var e=MM();return!0===t?e.className=mM:(e.className=yM,OM(t)?e.appendChild(t):WM(e,t)),e}function XM(t,e){OM(e.content)?(WM(t,""),t.appendChild(e.content)):"function"!=typeof e.content&&(e.allowHTML?WM(t,e.content):t.textContent=e.content)}function KM(t){var e=t.firstElementChild,i=AM(e.children);return{box:e,content:i.find((function(t){return t.classList.contains(vM)})),arrow:i.find((function(t){return t.classList.contains(mM)||t.classList.contains(yM)})),backdrop:i.find((function(t){return t.classList.contains("tippy-backdrop")}))}}function QM(t){var e=MM(),i=MM();i.className="tippy-box",i.setAttribute("data-state","hidden"),i.setAttribute("tabindex","-1");var n=MM();function r(i,n){var r=KM(e),s=r.box,o=r.content,a=r.arrow;n.theme?s.setAttribute("data-theme",n.theme):s.removeAttribute("data-theme"),"string"==typeof n.animation?s.setAttribute("data-animation",n.animation):s.removeAttribute("data-animation"),n.inertia?s.setAttribute("data-inertia",""):s.removeAttribute("data-inertia"),s.style.maxWidth="number"==typeof n.maxWidth?n.maxWidth+"px":n.maxWidth,n.role?s.setAttribute("role",n.role):s.removeAttribute("role"),i.content===n.content&&i.allowHTML===n.allowHTML||XM(o,t.props),n.arrow?a?i.arrow!==n.arrow&&(s.removeChild(a),s.appendChild(YM(n.arrow))):s.appendChild(YM(n.arrow)):a&&s.removeChild(a)}return n.className=vM,n.setAttribute("data-state","hidden"),XM(n,t.props),e.appendChild(i),i.appendChild(n),r(t.props,t.props),{popper:e,onUpdate:r}}QM.$$tippy=!0;var ZM=1,JM=[],tO=[];function eO(t,e){void 0===e&&(e={});var i=GM.plugins.concat(e.plugins||[]);document.addEventListener("touchstart",BM,bM),window.addEventListener("blur",zM);var n=Object.assign({},e,{plugins:i}),r=function(t){return OM(t)?[t]:function(t){return xM(t,"NodeList")}(t)?AM(t):Array.isArray(t)?t:AM(document.querySelectorAll(t))}(t).reduce((function(t,e){var i=e&&function(t,e){var i,n,r,s,o,a,l,h,c=qM(t,Object.assign({},GM,VM(TM(e)))),u=!1,d=!1,f=!1,p=!1,g=[],v=CM(W,c.interactiveDebounce),m=ZM++,y=(h=c.plugins).filter((function(t,e){return h.indexOf(t)===e})),b={id:m,reference:t,popper:MM(),popperInstance:null,props:c,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},plugins:y,clearDelayTimeouts:function(){clearTimeout(i),clearTimeout(n),cancelAnimationFrame(r)},setProps:function(e){if(!b.state.isDestroyed){L("onBeforeUpdate",[b,e]),V();var i=b.props,n=qM(t,Object.assign({},i,TM(e),{ignoreAttributes:!0}));b.props=n,H(),i.interactiveDebounce!==n.interactiveDebounce&&(D(),v=CM(W,n.interactiveDebounce)),i.triggerTarget&&!n.triggerTarget?SM(i.triggerTarget).forEach((function(t){t.removeAttribute("aria-expanded")})):n.triggerTarget&&t.removeAttribute("aria-expanded"),$(),R(),x&&x(i,n),b.popperInstance&&(Q(),J().forEach((function(t){requestAnimationFrame(t._tippy.popperInstance.forceUpdate)}))),L("onAfterUpdate",[b,e])}},setContent:function(t){b.setProps({content:t})},show:function(){var t=b.state.isVisible,e=b.state.isDestroyed,i=!b.state.isEnabled,n=NM.isTouch&&!b.props.touch,r=_M(b.props.duration,0,GM.duration);if(!(t||e||i||n||T().hasAttribute("disabled")||(L("onShow",[b],!1),!1===b.props.onShow(b)))){if(b.state.isVisible=!0,A()&&(_.style.visibility="visible"),R(),F(),b.state.isMounted||(_.style.transition="none"),A()){var s=O();RM([s.box,s.content],0)}var o,l,h;a=function(){var t;if(b.state.isVisible&&!p){if(p=!0,_.offsetHeight,_.style.transition=b.props.moveTransition,A()&&b.props.animation){var e=O(),i=e.box,n=e.content;RM([i,n],r),LM([i,n],"visible")}I(),$(),EM(tO,b),null==(t=b.popperInstance)||t.forceUpdate(),L("onMount",[b]),b.props.animation&&A()&&function(t,e){U(t,(function(){b.state.isShown=!0,L("onShown",[b])}))}(r)}},l=b.props.appendTo,h=T(),(o=b.props.interactive&&l===wM||"parent"===l?h.parentNode:kM(l,[h])).contains(_)||o.appendChild(_),b.state.isMounted=!0,Q()}},hide:function(){var t=!b.state.isVisible,e=b.state.isDestroyed,i=!b.state.isEnabled,n=_M(b.props.duration,1,GM.duration);if(!(t||e||i)&&(L("onHide",[b],!1),!1!==b.props.onHide(b))){if(b.state.isVisible=!1,b.state.isShown=!1,p=!1,u=!1,A()&&(_.style.visibility="hidden"),D(),z(),R(!0),A()){var r=O(),s=r.box,o=r.content;b.props.animation&&(RM([s,o],n),LM([s,o],"hidden"))}I(),$(),b.props.animation?A()&&function(t,e){U(t,(function(){!b.state.isVisible&&_.parentNode&&_.parentNode.contains(_)&&e()}))}(n,b.unmount):b.unmount()}},hideWithInteractivity:function(t){M().addEventListener("mousemove",v),EM(JM,v),v(t)},enable:function(){b.state.isEnabled=!0},disable:function(){b.hide(),b.state.isEnabled=!1},unmount:function(){b.state.isVisible&&b.hide(),b.state.isMounted&&(Z(),J().forEach((function(t){t._tippy.unmount()})),_.parentNode&&_.parentNode.removeChild(_),tO=tO.filter((function(t){return t!==b})),b.state.isMounted=!1,L("onHidden",[b]))},destroy:function(){b.state.isDestroyed||(b.clearDelayTimeouts(),b.unmount(),V(),delete t._tippy,b.state.isDestroyed=!0,L("onDestroy",[b]))}};if(!c.render)return b;var w=c.render(b),_=w.popper,x=w.onUpdate;_.setAttribute("data-tippy-root",""),_.id="tippy-"+b.id,b.popper=_,t._tippy=b,_._tippy=b;var k=y.map((function(t){return t.fn(b)})),C=t.hasAttribute("aria-expanded");return H(),$(),R(),L("onCreate",[b]),c.showOnCreate&&tt(),_.addEventListener("mouseenter",(function(){b.props.interactive&&b.state.isVisible&&b.clearDelayTimeouts()})),_.addEventListener("mouseleave",(function(){b.props.interactive&&b.props.trigger.indexOf("mouseenter")>=0&&M().addEventListener("mousemove",v)})),b;function S(){var t=b.props.touch;return Array.isArray(t)?t:[t,0]}function E(){return"hold"===S()[0]}function A(){var t;return!(null==(t=b.props.render)||!t.$$tippy)}function T(){return l||t}function M(){var t=T().parentNode;return t?IM(t):document}function O(){return KM(_)}function P(t){return b.state.isMounted&&!b.state.isVisible||NM.isTouch||s&&"focus"===s.type?0:_M(b.props.delay,t?0:1,GM.delay)}function R(t){void 0===t&&(t=!1),_.style.pointerEvents=b.props.interactive&&!t?"":"none",_.style.zIndex=""+b.props.zIndex}function L(t,e,i){var n;void 0===i&&(i=!0),k.forEach((function(i){i[t]&&i[t].apply(i,e)})),i&&(n=b.props)[t].apply(n,e)}function I(){var e=b.props.aria;if(e.content){var i="aria-"+e.content,n=_.id;SM(b.props.triggerTarget||t).forEach((function(t){var e=t.getAttribute(i);if(b.state.isVisible)t.setAttribute(i,e?e+" "+n:n);else{var r=e&&e.replace(n,"").trim();r?t.setAttribute(i,r):t.removeAttribute(i)}}))}}function $(){!C&&b.props.aria.expanded&&SM(b.props.triggerTarget||t).forEach((function(t){b.props.interactive?t.setAttribute("aria-expanded",b.state.isVisible&&t===T()?"true":"false"):t.removeAttribute("aria-expanded")}))}function D(){M().removeEventListener("mousemove",v),JM=JM.filter((function(t){return t!==v}))}function N(e){if(!NM.isTouch||!f&&"mousedown"!==e.type){var i=e.composedPath&&e.composedPath()[0]||e.target;if(!b.props.interactive||!DM(_,i)){if(SM(b.props.triggerTarget||t).some((function(t){return DM(t,i)}))){if(NM.isTouch)return;if(b.state.isVisible&&b.props.trigger.indexOf("click")>=0)return}else L("onClickOutside",[b,e]);!0===b.props.hideOnClick&&(b.clearDelayTimeouts(),b.hide(),d=!0,setTimeout((function(){d=!1})),b.state.isMounted||z())}}}function j(){f=!0}function B(){f=!1}function F(){var t=M();t.addEventListener("mousedown",N,!0),t.addEventListener("touchend",N,bM),t.addEventListener("touchstart",B,bM),t.addEventListener("touchmove",j,bM)}function z(){var t=M();t.removeEventListener("mousedown",N,!0),t.removeEventListener("touchend",N,bM),t.removeEventListener("touchstart",B,bM),t.removeEventListener("touchmove",j,bM)}function U(t,e){var i=O().box;function n(t){t.target===i&&($M(i,"remove",n),e())}if(0===t)return e();$M(i,"remove",o),$M(i,"add",n),o=n}function G(e,i,n){void 0===n&&(n=!1),SM(b.props.triggerTarget||t).forEach((function(t){t.addEventListener(e,i,n),g.push({node:t,eventType:e,handler:i,options:n})}))}function H(){E()&&(G("touchstart",q,{passive:!0}),G("touchend",Y,{passive:!0})),function(t){return t.split(/\s+/).filter(Boolean)}(b.props.trigger).forEach((function(t){if("manual"!==t)switch(G(t,q),t){case"mouseenter":G("mouseleave",Y);break;case"focus":G(UM?"focusout":"blur",X);break;case"focusin":G("focusout",X)}}))}function V(){g.forEach((function(t){var e=t.node,i=t.eventType,n=t.handler,r=t.options;e.removeEventListener(i,n,r)})),g=[]}function q(t){var e,i=!1;if(b.state.isEnabled&&!K(t)&&!d){var n="focus"===(null==(e=s)?void 0:e.type);s=t,l=t.currentTarget,$(),!b.state.isVisible&&PM(t)&&JM.forEach((function(e){return e(t)})),"click"===t.type&&(b.props.trigger.indexOf("mouseenter")<0||u)&&!1!==b.props.hideOnClick&&b.state.isVisible?i=!0:tt(t),"click"===t.type&&(u=!i),i&&!n&&et(t)}}function W(t){var e=t.target,i=T().contains(e)||_.contains(e);if("mousemove"!==t.type||!i){var n=J().concat(_).map((function(t){var e,i=null==(e=t._tippy.popperInstance)?void 0:e.state;return i?{popperRect:t.getBoundingClientRect(),popperState:i,props:c}:null})).filter(Boolean);(function(t,e){var i=e.clientX,n=e.clientY;return t.every((function(t){var e=t.popperRect,r=t.popperState,s=t.props.interactiveBorder,o=r.placement.split("-")[0],a=r.modifiersData.offset;if(!a)return!0;var l="bottom"===o?a.top.y:0,h="top"===o?a.bottom.y:0,c="right"===o?a.left.x:0,u="left"===o?a.right.x:0,d=e.top-n+l>s,f=n-e.bottom-h>s,p=e.left-i+c>s,g=i-e.right-u>s;return d||f||p||g}))})(n,t)&&(D(),et(t))}}function Y(t){K(t)||b.props.trigger.indexOf("click")>=0&&u||(b.props.interactive?b.hideWithInteractivity(t):et(t))}function X(t){b.props.trigger.indexOf("focusin")<0&&t.target!==T()||b.props.interactive&&t.relatedTarget&&_.contains(t.relatedTarget)||et(t)}function K(t){return!!NM.isTouch&&E()!==t.type.indexOf("touch")>=0}function Q(){Z();var e=b.props,i=e.popperOptions,n=e.placement,r=e.offset,s=e.getReferenceClientRect,o=e.moveTransition,l=A()?KM(_).arrow:null,h=s?{getBoundingClientRect:s,contextElement:s.contextElement||T()}:t,c=[{name:"offset",options:{offset:r}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!o}},{name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(t){var e=t.state;if(A()){var i=O().box;["placement","reference-hidden","escaped"].forEach((function(t){"placement"===t?i.setAttribute("data-placement",e.placement):e.attributes.popper["data-popper-"+t]?i.setAttribute("data-"+t,""):i.removeAttribute("data-"+t)})),e.attributes.popper={}}}}];A()&&l&&c.push({name:"arrow",options:{element:l,padding:3}}),c.push.apply(c,(null==i?void 0:i.modifiers)||[]),b.popperInstance=gM(h,_,Object.assign({},i,{placement:n,onFirstUpdate:a,modifiers:c}))}function Z(){b.popperInstance&&(b.popperInstance.destroy(),b.popperInstance=null)}function J(){return AM(_.querySelectorAll("[data-tippy-root]"))}function tt(t){b.clearDelayTimeouts(),t&&L("onTrigger",[b,t]),F();var e=P(!0),n=S(),r=n[0],s=n[1];NM.isTouch&&"hold"===r&&s&&(e=s),e?i=setTimeout((function(){b.show()}),e):b.show()}function et(t){if(b.clearDelayTimeouts(),L("onUntrigger",[b,t]),b.state.isVisible){if(!(b.props.trigger.indexOf("mouseenter")>=0&&b.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(t.type)>=0&&u)){var e=P(!1);e?n=setTimeout((function(){b.state.isVisible&&b.hide()}),e):r=requestAnimationFrame((function(){b.hide()}))}}else z()}}(e,n);return i&&t.push(i),t}),[]);return OM(t)?r[0]:r}eO.defaultProps=GM,eO.setDefaultProps=function(t){Object.keys(t).forEach((function(e){GM[e]=t[e]}))},eO.currentInput=NM,Object.assign({},QT,{effect:function(t){var e=t.state,i={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(e.elements.popper.style,i.popper),e.styles=i,e.elements.arrow&&Object.assign(e.elements.arrow.style,i.arrow)}});var iO={clientX:0,clientY:0},nO=[];function rO(t){var e=t.clientX,i=t.clientY;iO={clientX:e,clientY:i}}var sO={name:"followCursor",defaultValue:!1,fn:function(t){var e=t.reference,i=IM(t.props.triggerTarget||e),n=!1,r=!1,s=!0,o=t.props;function a(){return"initial"===t.props.followCursor&&t.state.isVisible}function l(){i.addEventListener("mousemove",u)}function h(){i.removeEventListener("mousemove",u)}function c(){n=!0,t.setProps({getReferenceClientRect:null}),n=!1}function u(i){var n=!i.target||e.contains(i.target),r=t.props.followCursor,s=i.clientX,o=i.clientY,a=e.getBoundingClientRect(),l=s-a.left,h=o-a.top;!n&&t.props.interactive||t.setProps({getReferenceClientRect:function(){var t=e.getBoundingClientRect(),i=s,n=o;"initial"===r&&(i=t.left+l,n=t.top+h);var a="horizontal"===r?t.top:n,c="vertical"===r?t.right:i,u="horizontal"===r?t.bottom:n,d="vertical"===r?t.left:i;return{width:c-d,height:u-a,top:a,right:c,bottom:u,left:d}}})}function d(){t.props.followCursor&&(nO.push({instance:t,doc:i}),function(t){t.addEventListener("mousemove",rO)}(i))}function f(){0===(nO=nO.filter((function(e){return e.instance!==t}))).filter((function(t){return t.doc===i})).length&&function(t){t.removeEventListener("mousemove",rO)}(i)}return{onCreate:d,onDestroy:f,onBeforeUpdate:function(){o=t.props},onAfterUpdate:function(e,i){var s=i.followCursor;n||void 0!==s&&o.followCursor!==s&&(f(),s?(d(),!t.state.isMounted||r||a()||l()):(h(),c()))},onMount:function(){t.props.followCursor&&!r&&(s&&(u(iO),s=!1),a()||l())},onTrigger:function(t,e){PM(e)&&(iO={clientX:e.clientX,clientY:e.clientY}),r="focus"===e.type},onHidden:function(){t.props.followCursor&&(c(),h(),s=!0)}}}};eO.setDefaultProps({render:QM});const oO=eO;var aO,lO,hO,cO,uO,dO,fO;function pO(t,e,i,n){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function gO(t,e,i,n,r){var s={};return Object.keys(n).forEach((function(t){s[t]=n[t]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(t,e,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(t,e,s),s=null),s}let vO=eh(O)(aO=fe(Element)((hO=gO((lO=class{constructor(t){pO(this,"onReset",hO,this),pO(this,"onInfo",cO,this),pO(this,"onExpand",uO,this),pO(this,"onContract",dO,this),pO(this,"isExpanded",fO,this),this.element=t}attached(){this.initTooltips(),this.initPopover()}initPopover(){this.infoPopoverViewModel=this.onInfo();let t=this.element.querySelector(".info-icon-wrapper img"),e=this.element.querySelector("au-compose"),i=oO(t,{hideOnClick:!1,content:e,trigger:"mouseenter",allowHTML:!0,placement:"bottom",maxWidth:600});i.popper.classList.add("b2022-kg-story"),this.popover=i}initTooltips(){let t=[].slice.call(this.element.querySelectorAll('[data-type="tooltip"]')).map((t=>oO(t,{hideOnClick:!1,content:t.getAttribute("title"),trigger:"mouseenter",placement:this.isExpanded?"bottom":"top",appendTo:"parent"})));this.tooltips=t}reset(){this.onReset()}expand(){this.onExpand()}contract(){this.onContract()}detaching(){this.tooltips.forEach((t=>{t.destroy()})),this.popover.destroy()}}).prototype,"onReset",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cO=gO(lO.prototype,"onInfo",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uO=gO(lO.prototype,"onExpand",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dO=gO(lO.prototype,"onContract",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fO=gO(lO.prototype,"isExpanded",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aO=lO))||aO)||aO;const mO="custom-vis-tooltip",yO='<div class="my-tooltip">\n  <div repeat.for="pair of toShow">\n    <span class="text-capitalize">\n      ${pair[1]}\n    </span>\n  </div>\n</div>',bO=yO,wO=[];let _O;function xO(t){_O||(_O=fh.define({name:mO,template:yO,dependencies:wO})),t.register(_O)}var kO,CO,SO;let EO=eh(P)(kO=fe(Element)((CO=class{constructor(t){var e;(e=SO)&&Object.defineProperty(this,"data",{enumerable:e.enumerable,configurable:e.configurable,writable:e.writable,value:e.initializer?e.initializer.call(this):void 0}),this.element=t,this.toShow=new Map}dataChanged(t,e){t?(this.toShow=t,this.show()):this.hide()}attached(){this.tooltip=oO(this.element.parentElement,{followCursor:!0,hideOnClick:!1,content:this.element,trigger:"manual",allowHTML:!0,plugins:[sO],placement:"right",offset:[0,20]}),this.tooltip.popper.classList.add("b2022-kg-story")}show(){this.tooltip.show()}hide(){this.tooltip.hide()}detaching(){this.tooltip.destroy()}},AO=CO.prototype,TO="data",MO=[ma],OO={configurable:!0,enumerable:!0,writable:!0,initializer:null},PO={},Object.keys(OO).forEach((function(t){PO[t]=OO[t]})),PO.enumerable=!!PO.enumerable,PO.configurable=!!PO.configurable,("value"in PO||PO.initializer)&&(PO.writable=!0),void 0===(PO=MO.slice().reverse().reduce((function(t,e){return e(AO,TO,t)||t}),PO)).initializer&&(Object.defineProperty(AO,TO,PO),PO=null),SO=PO,kO=CO))||kO)||kO;var AO,TO,MO,OO,PO;Gp.register(Bp).register([vO,EO]).register(Ll.beforeCreate(Fp,(t=>{t.define("b2022-kg-story-vis-01",uC)}))).register(Ll.beforeCreate(Fp,(t=>{t.define("b2022-kg-story-vis-02",EC)}))).register(Ll.beforeCreate(Fp,(t=>{t.define("b2022-kg-story-vis-03",nS)}))).register(Ll.beforeCreate(Fp,(t=>{t.define("b2022-kg-story-vis-04",IS)}))).register(Ll.beforeCreate(Fp,(t=>{t.define("b2022-kg-story-vis-05",uE)}))).register(Ll.beforeCreate(Fp,(t=>{t.define("b2022-kg-story-vis-06",UE)}))).register(Ll.beforeCreate(Fp,(t=>{t.define("b2022-kg-story-vis-07",bA)}))).register(Ll.beforeCreate(Fp,(t=>{t.define("b2022-kg-story-vis-08",KA)}))).app(gg)})(),r})()},466:function(t){var e;t.exports=((e=function(){function t(t){return r.appendChild(t.dom),t}function i(t){for(var e=0;e<r.children.length;e++)r.children[e].style.display=e===t?"block":"none";n=t}var n=0,r=document.createElement("div");r.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",r.addEventListener("click",(function(t){t.preventDefault(),i(++n%r.children.length)}),!1);var s=(performance||Date).now(),o=s,a=0,l=t(new e.Panel("FPS","#0ff","#002")),h=t(new e.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=t(new e.Panel("MB","#f08","#201"));return i(0),{REVISION:16,dom:r,addPanel:t,showPanel:i,begin:function(){s=(performance||Date).now()},end:function(){a++;var t=(performance||Date).now();if(h.update(t-s,200),t>o+1e3&&(l.update(1e3*a/(t-o),100),o=t,a=0,c)){var e=performance.memory;c.update(e.usedJSHeapSize/1048576,e.jsHeapSizeLimit/1048576)}return t},update:function(){s=this.end()},domElement:r,setMode:i}}).Panel=function(t,e,i){var n=1/0,r=0,s=Math.round,o=s(window.devicePixelRatio||1),a=80*o,l=48*o,h=3*o,c=2*o,u=3*o,d=15*o,f=74*o,p=30*o,g=document.createElement("canvas");g.width=a,g.height=l,g.style.cssText="width:80px;height:48px";var v=g.getContext("2d");return v.font="bold "+9*o+"px Helvetica,Arial,sans-serif",v.textBaseline="top",v.fillStyle=i,v.fillRect(0,0,a,l),v.fillStyle=e,v.fillText(t,h,c),v.fillRect(u,d,f,p),v.fillStyle=i,v.globalAlpha=.9,v.fillRect(u,d,f,p),{dom:g,update:function(l,m){n=Math.min(n,l),r=Math.max(r,l),v.fillStyle=i,v.globalAlpha=1,v.fillRect(0,0,a,d),v.fillStyle=e,v.fillText(s(l)+" "+t+" ("+s(n)+"-"+s(r)+")",h,c),v.drawImage(g,u+o,d,f-o,p,u,d,f-o,p),v.fillRect(u+f-o,d,o,p),v.fillStyle=i,v.globalAlpha=.9,v.fillRect(u+f-o,d,o,s((1-l/m)*p))}}},e)}},e={};function i(n){var r=e[n];if(void 0!==r)return r.exports;var s=e[n]={exports:{}};return t[n].call(s.exports,s,s.exports,i),s.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{"use strict";var t={};i.r(t),i.d(t,{afterMain:()=>_,afterRead:()=>y,afterWrite:()=>C,applyStyles:()=>P,arrow:()=>X,auto:()=>o,basePlacements:()=>a,beforeMain:()=>b,beforeRead:()=>v,beforeWrite:()=>x,bottom:()=>n,clippingParents:()=>c,computeStyles:()=>J,createPopper:()=>Tt,createPopperBase:()=>At,createPopperLite:()=>Mt,detectOverflow:()=>pt,end:()=>h,eventListeners:()=>et,flip:()=>gt,hide:()=>yt,left:()=>s,main:()=>w,modifierPhases:()=>S,offset:()=>bt,placements:()=>g,popper:()=>d,popperGenerator:()=>Et,popperOffsets:()=>wt,preventOverflow:()=>_t,read:()=>m,reference:()=>f,right:()=>r,start:()=>l,top:()=>e,variationPlacements:()=>p,viewport:()=>u,write:()=>k});var e="top",n="bottom",r="right",s="left",o="auto",a=[e,n,r,s],l="start",h="end",c="clippingParents",u="viewport",d="popper",f="reference",p=a.reduce((function(t,e){return t.concat([e+"-"+l,e+"-"+h])}),[]),g=[].concat(a,[o]).reduce((function(t,e){return t.concat([e,e+"-"+l,e+"-"+h])}),[]),v="beforeRead",m="read",y="afterRead",b="beforeMain",w="main",_="afterMain",x="beforeWrite",k="write",C="afterWrite",S=[v,m,y,b,w,_,x,k,C];function E(t){return t?(t.nodeName||"").toLowerCase():null}function A(t){if(null==t)return window;if("[object Window]"!==t.toString()){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function T(t){return t instanceof A(t).Element||t instanceof Element}function M(t){return t instanceof A(t).HTMLElement||t instanceof HTMLElement}function O(t){return"undefined"!=typeof ShadowRoot&&(t instanceof A(t).ShadowRoot||t instanceof ShadowRoot)}const P={name:"applyStyles",enabled:!0,phase:"write",fn:function(t){var e=t.state;Object.keys(e.elements).forEach((function(t){var i=e.styles[t]||{},n=e.attributes[t]||{},r=e.elements[t];M(r)&&E(r)&&(Object.assign(r.style,i),Object.keys(n).forEach((function(t){var e=n[t];!1===e?r.removeAttribute(t):r.setAttribute(t,!0===e?"":e)})))}))},effect:function(t){var e=t.state,i={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,i.popper),e.styles=i,e.elements.arrow&&Object.assign(e.elements.arrow.style,i.arrow),function(){Object.keys(e.elements).forEach((function(t){var n=e.elements[t],r=e.attributes[t]||{},s=Object.keys(e.styles.hasOwnProperty(t)?e.styles[t]:i[t]).reduce((function(t,e){return t[e]="",t}),{});M(n)&&E(n)&&(Object.assign(n.style,s),Object.keys(r).forEach((function(t){n.removeAttribute(t)})))}))}},requires:["computeStyles"]};function R(t){return t.split("-")[0]}var L=Math.max,I=Math.min,$=Math.round;function D(t,e){void 0===e&&(e=!1);var i=t.getBoundingClientRect(),n=1,r=1;if(M(t)&&e){var s=t.offsetHeight,o=t.offsetWidth;o>0&&(n=$(i.width)/o||1),s>0&&(r=$(i.height)/s||1)}return{width:i.width/n,height:i.height/r,top:i.top/r,right:i.right/n,bottom:i.bottom/r,left:i.left/n,x:i.left/n,y:i.top/r}}function N(t){var e=D(t),i=t.offsetWidth,n=t.offsetHeight;return Math.abs(e.width-i)<=1&&(i=e.width),Math.abs(e.height-n)<=1&&(n=e.height),{x:t.offsetLeft,y:t.offsetTop,width:i,height:n}}function j(t,e){var i=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(i&&O(i)){var n=e;do{if(n&&t.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function B(t){return A(t).getComputedStyle(t)}function F(t){return["table","td","th"].indexOf(E(t))>=0}function z(t){return((T(t)?t.ownerDocument:t.document)||window.document).documentElement}function U(t){return"html"===E(t)?t:t.assignedSlot||t.parentNode||(O(t)?t.host:null)||z(t)}function G(t){return M(t)&&"fixed"!==B(t).position?t.offsetParent:null}function H(t){for(var e=A(t),i=G(t);i&&F(i)&&"static"===B(i).position;)i=G(i);return i&&("html"===E(i)||"body"===E(i)&&"static"===B(i).position)?e:i||function(t){var e=-1!==navigator.userAgent.toLowerCase().indexOf("firefox");if(-1!==navigator.userAgent.indexOf("Trident")&&M(t)&&"fixed"===B(t).position)return null;var i=U(t);for(O(i)&&(i=i.host);M(i)&&["html","body"].indexOf(E(i))<0;){var n=B(i);if("none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||-1!==["transform","perspective"].indexOf(n.willChange)||e&&"filter"===n.willChange||e&&n.filter&&"none"!==n.filter)return i;i=i.parentNode}return null}(t)||e}function V(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function q(t,e,i){return L(t,I(e,i))}function W(t){return Object.assign({},{top:0,right:0,bottom:0,left:0},t)}function Y(t,e){return e.reduce((function(e,i){return e[i]=t,e}),{})}const X={name:"arrow",enabled:!0,phase:"main",fn:function(t){var i,o=t.state,l=t.name,h=t.options,c=o.elements.arrow,u=o.modifiersData.popperOffsets,d=R(o.placement),f=V(d),p=[s,r].indexOf(d)>=0?"height":"width";if(c&&u){var g=function(t,e){return W("number"!=typeof(t="function"==typeof t?t(Object.assign({},e.rects,{placement:e.placement})):t)?t:Y(t,a))}(h.padding,o),v=N(c),m="y"===f?e:s,y="y"===f?n:r,b=o.rects.reference[p]+o.rects.reference[f]-u[f]-o.rects.popper[p],w=u[f]-o.rects.reference[f],_=H(c),x=_?"y"===f?_.clientHeight||0:_.clientWidth||0:0,k=b/2-w/2,C=g[m],S=x-v[p]-g[y],E=x/2-v[p]/2+k,A=q(C,E,S),T=f;o.modifiersData[l]=((i={})[T]=A,i.centerOffset=A-E,i)}},effect:function(t){var e=t.state,i=t.options.element,n=void 0===i?"[data-popper-arrow]":i;null!=n&&("string"!=typeof n||(n=e.elements.popper.querySelector(n)))&&j(e.elements.popper,n)&&(e.elements.arrow=n)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function K(t){return t.split("-")[1]}var Q={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Z(t){var i,o=t.popper,a=t.popperRect,l=t.placement,c=t.variation,u=t.offsets,d=t.position,f=t.gpuAcceleration,p=t.adaptive,g=t.roundOffsets,v=t.isFixed,m=u.x,y=void 0===m?0:m,b=u.y,w=void 0===b?0:b,_="function"==typeof g?g({x:y,y:w}):{x:y,y:w};y=_.x,w=_.y;var x=u.hasOwnProperty("x"),k=u.hasOwnProperty("y"),C=s,S=e,E=window;if(p){var T=H(o),M="clientHeight",O="clientWidth";T===A(o)&&"static"!==B(T=z(o)).position&&"absolute"===d&&(M="scrollHeight",O="scrollWidth"),(l===e||(l===s||l===r)&&c===h)&&(S=n,w-=(v&&T===E&&E.visualViewport?E.visualViewport.height:T[M])-a.height,w*=f?1:-1),l!==s&&(l!==e&&l!==n||c!==h)||(C=r,y-=(v&&T===E&&E.visualViewport?E.visualViewport.width:T[O])-a.width,y*=f?1:-1)}var P,R=Object.assign({position:d},p&&Q),L=!0===g?function(t){var e=t.x,i=t.y,n=window.devicePixelRatio||1;return{x:$(e*n)/n||0,y:$(i*n)/n||0}}({x:y,y:w}):{x:y,y:w};return y=L.x,w=L.y,f?Object.assign({},R,((P={})[S]=k?"0":"",P[C]=x?"0":"",P.transform=(E.devicePixelRatio||1)<=1?"translate("+y+"px, "+w+"px)":"translate3d("+y+"px, "+w+"px, 0)",P)):Object.assign({},R,((i={})[S]=k?w+"px":"",i[C]=x?y+"px":"",i.transform="",i))}const J={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(t){var e=t.state,i=t.options,n=i.gpuAcceleration,r=void 0===n||n,s=i.adaptive,o=void 0===s||s,a=i.roundOffsets,l=void 0===a||a,h={placement:R(e.placement),variation:K(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:r,isFixed:"fixed"===e.options.strategy};null!=e.modifiersData.popperOffsets&&(e.styles.popper=Object.assign({},e.styles.popper,Z(Object.assign({},h,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:o,roundOffsets:l})))),null!=e.modifiersData.arrow&&(e.styles.arrow=Object.assign({},e.styles.arrow,Z(Object.assign({},h,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})},data:{}};var tt={passive:!0};const et={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(t){var e=t.state,i=t.instance,n=t.options,r=n.scroll,s=void 0===r||r,o=n.resize,a=void 0===o||o,l=A(e.elements.popper),h=[].concat(e.scrollParents.reference,e.scrollParents.popper);return s&&h.forEach((function(t){t.addEventListener("scroll",i.update,tt)})),a&&l.addEventListener("resize",i.update,tt),function(){s&&h.forEach((function(t){t.removeEventListener("scroll",i.update,tt)})),a&&l.removeEventListener("resize",i.update,tt)}},data:{}};var it={left:"right",right:"left",bottom:"top",top:"bottom"};function nt(t){return t.replace(/left|right|bottom|top/g,(function(t){return it[t]}))}var rt={start:"end",end:"start"};function st(t){return t.replace(/start|end/g,(function(t){return rt[t]}))}function ot(t){var e=A(t);return{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function at(t){return D(z(t)).left+ot(t).scrollLeft}function lt(t){var e=B(t),i=e.overflow,n=e.overflowX,r=e.overflowY;return/auto|scroll|overlay|hidden/.test(i+r+n)}function ht(t){return["html","body","#document"].indexOf(E(t))>=0?t.ownerDocument.body:M(t)&&lt(t)?t:ht(U(t))}function ct(t,e){var i;void 0===e&&(e=[]);var n=ht(t),r=n===(null==(i=t.ownerDocument)?void 0:i.body),s=A(n),o=r?[s].concat(s.visualViewport||[],lt(n)?n:[]):n,a=e.concat(o);return r?a:a.concat(ct(U(o)))}function ut(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function dt(t,e){return e===u?ut(function(t){var e=A(t),i=z(t),n=e.visualViewport,r=i.clientWidth,s=i.clientHeight,o=0,a=0;return n&&(r=n.width,s=n.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(o=n.offsetLeft,a=n.offsetTop)),{width:r,height:s,x:o+at(t),y:a}}(t)):T(e)?function(t){var e=D(t);return e.top=e.top+t.clientTop,e.left=e.left+t.clientLeft,e.bottom=e.top+t.clientHeight,e.right=e.left+t.clientWidth,e.width=t.clientWidth,e.height=t.clientHeight,e.x=e.left,e.y=e.top,e}(e):ut(function(t){var e,i=z(t),n=ot(t),r=null==(e=t.ownerDocument)?void 0:e.body,s=L(i.scrollWidth,i.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),o=L(i.scrollHeight,i.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),a=-n.scrollLeft+at(t),l=-n.scrollTop;return"rtl"===B(r||i).direction&&(a+=L(i.clientWidth,r?r.clientWidth:0)-s),{width:s,height:o,x:a,y:l}}(z(t)))}function ft(t){var i,o=t.reference,a=t.element,c=t.placement,u=c?R(c):null,d=c?K(c):null,f=o.x+o.width/2-a.width/2,p=o.y+o.height/2-a.height/2;switch(u){case e:i={x:f,y:o.y-a.height};break;case n:i={x:f,y:o.y+o.height};break;case r:i={x:o.x+o.width,y:p};break;case s:i={x:o.x-a.width,y:p};break;default:i={x:o.x,y:o.y}}var g=u?V(u):null;if(null!=g){var v="y"===g?"height":"width";switch(d){case l:i[g]=i[g]-(o[v]/2-a[v]/2);break;case h:i[g]=i[g]+(o[v]/2-a[v]/2)}}return i}function pt(t,i){void 0===i&&(i={});var s=i,o=s.placement,l=void 0===o?t.placement:o,h=s.boundary,p=void 0===h?c:h,g=s.rootBoundary,v=void 0===g?u:g,m=s.elementContext,y=void 0===m?d:m,b=s.altBoundary,w=void 0!==b&&b,_=s.padding,x=void 0===_?0:_,k=W("number"!=typeof x?x:Y(x,a)),C=y===d?f:d,S=t.rects.popper,A=t.elements[w?C:y],O=function(t,e,i){var n="clippingParents"===e?function(t){var e=ct(U(t)),i=["absolute","fixed"].indexOf(B(t).position)>=0&&M(t)?H(t):t;return T(i)?e.filter((function(t){return T(t)&&j(t,i)&&"body"!==E(t)})):[]}(t):[].concat(e),r=[].concat(n,[i]),s=r[0],o=r.reduce((function(e,i){var n=dt(t,i);return e.top=L(n.top,e.top),e.right=I(n.right,e.right),e.bottom=I(n.bottom,e.bottom),e.left=L(n.left,e.left),e}),dt(t,s));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}(T(A)?A:A.contextElement||z(t.elements.popper),p,v),P=D(t.elements.reference),R=ft({reference:P,element:S,strategy:"absolute",placement:l}),$=ut(Object.assign({},S,R)),N=y===d?$:P,F={top:O.top-N.top+k.top,bottom:N.bottom-O.bottom+k.bottom,left:O.left-N.left+k.left,right:N.right-O.right+k.right},G=t.modifiersData.offset;if(y===d&&G){var V=G[l];Object.keys(F).forEach((function(t){var i=[r,n].indexOf(t)>=0?1:-1,s=[e,n].indexOf(t)>=0?"y":"x";F[t]+=V[s]*i}))}return F}const gt={name:"flip",enabled:!0,phase:"main",fn:function(t){var i=t.state,h=t.options,c=t.name;if(!i.modifiersData[c]._skip){for(var u=h.mainAxis,d=void 0===u||u,f=h.altAxis,v=void 0===f||f,m=h.fallbackPlacements,y=h.padding,b=h.boundary,w=h.rootBoundary,_=h.altBoundary,x=h.flipVariations,k=void 0===x||x,C=h.allowedAutoPlacements,S=i.options.placement,E=R(S),A=m||(E!==S&&k?function(t){if(R(t)===o)return[];var e=nt(t);return[st(t),e,st(e)]}(S):[nt(S)]),T=[S].concat(A).reduce((function(t,e){return t.concat(R(e)===o?function(t,e){void 0===e&&(e={});var i=e,n=i.placement,r=i.boundary,s=i.rootBoundary,o=i.padding,l=i.flipVariations,h=i.allowedAutoPlacements,c=void 0===h?g:h,u=K(n),d=u?l?p:p.filter((function(t){return K(t)===u})):a,f=d.filter((function(t){return c.indexOf(t)>=0}));0===f.length&&(f=d);var v=f.reduce((function(e,i){return e[i]=pt(t,{placement:i,boundary:r,rootBoundary:s,padding:o})[R(i)],e}),{});return Object.keys(v).sort((function(t,e){return v[t]-v[e]}))}(i,{placement:e,boundary:b,rootBoundary:w,padding:y,flipVariations:k,allowedAutoPlacements:C}):e)}),[]),M=i.rects.reference,O=i.rects.popper,P=new Map,L=!0,I=T[0],$=0;$<T.length;$++){var D=T[$],N=R(D),j=K(D)===l,B=[e,n].indexOf(N)>=0,F=B?"width":"height",z=pt(i,{placement:D,boundary:b,rootBoundary:w,altBoundary:_,padding:y}),U=B?j?r:s:j?n:e;M[F]>O[F]&&(U=nt(U));var G=nt(U),H=[];if(d&&H.push(z[N]<=0),v&&H.push(z[U]<=0,z[G]<=0),H.every((function(t){return t}))){I=D,L=!1;break}P.set(D,H)}if(L)for(var V=function(t){var e=T.find((function(e){var i=P.get(e);if(i)return i.slice(0,t).every((function(t){return t}))}));if(e)return I=e,"break"},q=k?3:1;q>0&&"break"!==V(q);q--);i.placement!==I&&(i.modifiersData[c]._skip=!0,i.placement=I,i.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function vt(t,e,i){return void 0===i&&(i={x:0,y:0}),{top:t.top-e.height-i.y,right:t.right-e.width+i.x,bottom:t.bottom-e.height+i.y,left:t.left-e.width-i.x}}function mt(t){return[e,r,n,s].some((function(e){return t[e]>=0}))}const yt={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(t){var e=t.state,i=t.name,n=e.rects.reference,r=e.rects.popper,s=e.modifiersData.preventOverflow,o=pt(e,{elementContext:"reference"}),a=pt(e,{altBoundary:!0}),l=vt(o,n),h=vt(a,r,s),c=mt(l),u=mt(h);e.modifiersData[i]={referenceClippingOffsets:l,popperEscapeOffsets:h,isReferenceHidden:c,hasPopperEscaped:u},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":u})}},bt={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(t){var i=t.state,n=t.options,o=t.name,a=n.offset,l=void 0===a?[0,0]:a,h=g.reduce((function(t,n){return t[n]=function(t,i,n){var o=R(t),a=[s,e].indexOf(o)>=0?-1:1,l="function"==typeof n?n(Object.assign({},i,{placement:t})):n,h=l[0],c=l[1];return h=h||0,c=(c||0)*a,[s,r].indexOf(o)>=0?{x:c,y:h}:{x:h,y:c}}(n,i.rects,l),t}),{}),c=h[i.placement],u=c.x,d=c.y;null!=i.modifiersData.popperOffsets&&(i.modifiersData.popperOffsets.x+=u,i.modifiersData.popperOffsets.y+=d),i.modifiersData[o]=h}},wt={name:"popperOffsets",enabled:!0,phase:"read",fn:function(t){var e=t.state,i=t.name;e.modifiersData[i]=ft({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})},data:{}},_t={name:"preventOverflow",enabled:!0,phase:"main",fn:function(t){var i=t.state,o=t.options,a=t.name,h=o.mainAxis,c=void 0===h||h,u=o.altAxis,d=void 0!==u&&u,f=o.boundary,p=o.rootBoundary,g=o.altBoundary,v=o.padding,m=o.tether,y=void 0===m||m,b=o.tetherOffset,w=void 0===b?0:b,_=pt(i,{boundary:f,rootBoundary:p,padding:v,altBoundary:g}),x=R(i.placement),k=K(i.placement),C=!k,S=V(x),E="x"===S?"y":"x",A=i.modifiersData.popperOffsets,T=i.rects.reference,M=i.rects.popper,O="function"==typeof w?w(Object.assign({},i.rects,{placement:i.placement})):w,P="number"==typeof O?{mainAxis:O,altAxis:O}:Object.assign({mainAxis:0,altAxis:0},O),$=i.modifiersData.offset?i.modifiersData.offset[i.placement]:null,D={x:0,y:0};if(A){if(c){var j,B="y"===S?e:s,F="y"===S?n:r,z="y"===S?"height":"width",U=A[S],G=U+_[B],W=U-_[F],Y=y?-M[z]/2:0,X=k===l?T[z]:M[z],Q=k===l?-M[z]:-T[z],Z=i.elements.arrow,J=y&&Z?N(Z):{width:0,height:0},tt=i.modifiersData["arrow#persistent"]?i.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},et=tt[B],it=tt[F],nt=q(0,T[z],J[z]),rt=C?T[z]/2-Y-nt-et-P.mainAxis:X-nt-et-P.mainAxis,st=C?-T[z]/2+Y+nt+it+P.mainAxis:Q+nt+it+P.mainAxis,ot=i.elements.arrow&&H(i.elements.arrow),at=ot?"y"===S?ot.clientTop||0:ot.clientLeft||0:0,lt=null!=(j=null==$?void 0:$[S])?j:0,ht=U+st-lt,ct=q(y?I(G,U+rt-lt-at):G,U,y?L(W,ht):W);A[S]=ct,D[S]=ct-U}if(d){var ut,dt="x"===S?e:s,ft="x"===S?n:r,gt=A[E],vt="y"===E?"height":"width",mt=gt+_[dt],yt=gt-_[ft],bt=-1!==[e,s].indexOf(x),wt=null!=(ut=null==$?void 0:$[E])?ut:0,_t=bt?mt:gt-T[vt]-M[vt]-wt+P.altAxis,xt=bt?gt+T[vt]+M[vt]-wt-P.altAxis:yt,kt=y&&bt?function(t,e,i){var n=q(t,e,i);return n>i?i:n}(_t,gt,xt):q(y?_t:mt,gt,y?xt:yt);A[E]=kt,D[E]=kt-gt}i.modifiersData[a]=D}},requiresIfExists:["offset"]};function xt(t,e,i){void 0===i&&(i=!1);var n,r,s=M(e),o=M(e)&&function(t){var e=t.getBoundingClientRect(),i=$(e.width)/t.offsetWidth||1,n=$(e.height)/t.offsetHeight||1;return 1!==i||1!==n}(e),a=z(e),l=D(t,o),h={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(s||!s&&!i)&&(("body"!==E(e)||lt(a))&&(h=(n=e)!==A(n)&&M(n)?{scrollLeft:(r=n).scrollLeft,scrollTop:r.scrollTop}:ot(n)),M(e)?((c=D(e,!0)).x+=e.clientLeft,c.y+=e.clientTop):a&&(c.x=at(a))),{x:l.left+h.scrollLeft-c.x,y:l.top+h.scrollTop-c.y,width:l.width,height:l.height}}function kt(t){var e=new Map,i=new Set,n=[];function r(t){i.add(t.name),[].concat(t.requires||[],t.requiresIfExists||[]).forEach((function(t){if(!i.has(t)){var n=e.get(t);n&&r(n)}})),n.push(t)}return t.forEach((function(t){e.set(t.name,t)})),t.forEach((function(t){i.has(t.name)||r(t)})),n}var Ct={placement:"bottom",modifiers:[],strategy:"absolute"};function St(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return!e.some((function(t){return!(t&&"function"==typeof t.getBoundingClientRect)}))}function Et(t){void 0===t&&(t={});var e=t,i=e.defaultModifiers,n=void 0===i?[]:i,r=e.defaultOptions,s=void 0===r?Ct:r;return function(t,e,i){void 0===i&&(i=s);var r,o,a={placement:"bottom",orderedModifiers:[],options:Object.assign({},Ct,s),modifiersData:{},elements:{reference:t,popper:e},attributes:{},styles:{}},l=[],h=!1,c={state:a,setOptions:function(i){var r="function"==typeof i?i(a.options):i;u(),a.options=Object.assign({},s,a.options,r),a.scrollParents={reference:T(t)?ct(t):t.contextElement?ct(t.contextElement):[],popper:ct(e)};var o,h,d=function(t){var e=kt(t);return S.reduce((function(t,i){return t.concat(e.filter((function(t){return t.phase===i})))}),[])}((o=[].concat(n,a.options.modifiers),h=o.reduce((function(t,e){var i=t[e.name];return t[e.name]=i?Object.assign({},i,e,{options:Object.assign({},i.options,e.options),data:Object.assign({},i.data,e.data)}):e,t}),{}),Object.keys(h).map((function(t){return h[t]}))));return a.orderedModifiers=d.filter((function(t){return t.enabled})),a.orderedModifiers.forEach((function(t){var e=t.name,i=t.options,n=void 0===i?{}:i,r=t.effect;if("function"==typeof r){var s=r({state:a,name:e,instance:c,options:n});l.push(s||function(){})}})),c.update()},forceUpdate:function(){if(!h){var t=a.elements,e=t.reference,i=t.popper;if(St(e,i)){a.rects={reference:xt(e,H(i),"fixed"===a.options.strategy),popper:N(i)},a.reset=!1,a.placement=a.options.placement,a.orderedModifiers.forEach((function(t){return a.modifiersData[t.name]=Object.assign({},t.data)}));for(var n=0;n<a.orderedModifiers.length;n++)if(!0!==a.reset){var r=a.orderedModifiers[n],s=r.fn,o=r.options,l=void 0===o?{}:o,u=r.name;"function"==typeof s&&(a=s({state:a,options:l,name:u,instance:c})||a)}else a.reset=!1,n=-1}}},update:(r=function(){return new Promise((function(t){c.forceUpdate(),t(a)}))},function(){return o||(o=new Promise((function(t){Promise.resolve().then((function(){o=void 0,t(r())}))}))),o}),destroy:function(){u(),h=!0}};if(!St(t,e))return c;function u(){l.forEach((function(t){return t()})),l=[]}return c.setOptions(i).then((function(t){!h&&i.onFirstUpdate&&i.onFirstUpdate(t)})),c}}var At=Et(),Tt=Et({defaultModifiers:[et,wt,J,P,bt,gt,_t,X,yt]}),Mt=Et({defaultModifiers:[et,wt,J,P]});const Ot="transitionend",Pt=t=>{let e=t.getAttribute("data-bs-target");if(!e||"#"===e){let i=t.getAttribute("href");if(!i||!i.includes("#")&&!i.startsWith("."))return null;i.includes("#")&&!i.startsWith("#")&&(i=`#${i.split("#")[1]}`),e=i&&"#"!==i?i.trim():null}return e},Rt=t=>{const e=Pt(t);return e&&document.querySelector(e)?e:null},Lt=t=>{const e=Pt(t);return e?document.querySelector(e):null},It=t=>{t.dispatchEvent(new Event(Ot))},$t=t=>!(!t||"object"!=typeof t)&&(void 0!==t.jquery&&(t=t[0]),void 0!==t.nodeType),Dt=t=>$t(t)?t.jquery?t[0]:t:"string"==typeof t&&t.length>0?document.querySelector(t):null,Nt=(t,e,i)=>{Object.keys(i).forEach((n=>{const r=i[n],s=e[n],o=s&&$t(s)?"element":null==(a=s)?`${a}`:{}.toString.call(a).match(/\s([a-z]+)/i)[1].toLowerCase();var a;if(!new RegExp(r).test(o))throw new TypeError(`${t.toUpperCase()}: Option "${n}" provided type "${o}" but expected type "${r}".`)}))},jt=t=>!(!$t(t)||0===t.getClientRects().length)&&"visible"===getComputedStyle(t).getPropertyValue("visibility"),Bt=t=>!t||t.nodeType!==Node.ELEMENT_NODE||!!t.classList.contains("disabled")||(void 0!==t.disabled?t.disabled:t.hasAttribute("disabled")&&"false"!==t.getAttribute("disabled")),Ft=t=>{if(!document.documentElement.attachShadow)return null;if("function"==typeof t.getRootNode){const e=t.getRootNode();return e instanceof ShadowRoot?e:null}return t instanceof ShadowRoot?t:t.parentNode?Ft(t.parentNode):null},zt=()=>{},Ut=t=>{t.offsetHeight},Gt=()=>{const{jQuery:t}=window;return t&&!document.body.hasAttribute("data-bs-no-jquery")?t:null},Ht=[],Vt=()=>"rtl"===document.documentElement.dir,qt=t=>{var e;e=()=>{const e=Gt();if(e){const i=t.NAME,n=e.fn[i];e.fn[i]=t.jQueryInterface,e.fn[i].Constructor=t,e.fn[i].noConflict=()=>(e.fn[i]=n,t.jQueryInterface)}},"loading"===document.readyState?(Ht.length||document.addEventListener("DOMContentLoaded",(()=>{Ht.forEach((t=>t()))})),Ht.push(e)):e()},Wt=t=>{"function"==typeof t&&t()},Yt=(t,e,i=!0)=>{if(!i)return void Wt(t);const n=(t=>{if(!t)return 0;let{transitionDuration:e,transitionDelay:i}=window.getComputedStyle(t);const n=Number.parseFloat(e),r=Number.parseFloat(i);return n||r?(e=e.split(",")[0],i=i.split(",")[0],1e3*(Number.parseFloat(e)+Number.parseFloat(i))):0})(e)+5;let r=!1;const s=({target:i})=>{i===e&&(r=!0,e.removeEventListener(Ot,s),Wt(t))};e.addEventListener(Ot,s),setTimeout((()=>{r||It(e)}),n)},Xt=(t,e,i,n)=>{let r=t.indexOf(e);if(-1===r)return t[!i&&n?t.length-1:0];const s=t.length;return r+=i?1:-1,n&&(r=(r+s)%s),t[Math.max(0,Math.min(r,s-1))]},Kt=/[^.]*(?=\..*)\.|.*/,Qt=/\..*/,Zt=/::\d+$/,Jt={};let te=1;const ee={mouseenter:"mouseover",mouseleave:"mouseout"},ie=/^(mouseenter|mouseleave)/i,ne=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function re(t,e){return e&&`${e}::${te++}`||t.uidEvent||te++}function se(t){const e=re(t);return t.uidEvent=e,Jt[e]=Jt[e]||{},Jt[e]}function oe(t,e,i=null){const n=Object.keys(t);for(let r=0,s=n.length;r<s;r++){const s=t[n[r]];if(s.originalHandler===e&&s.delegationSelector===i)return s}return null}function ae(t,e,i){const n="string"==typeof e,r=n?i:e;let s=ce(t);return ne.has(s)||(s=t),[n,r,s]}function le(t,e,i,n,r){if("string"!=typeof e||!t)return;if(i||(i=n,n=null),ie.test(e)){const t=t=>function(e){if(!e.relatedTarget||e.relatedTarget!==e.delegateTarget&&!e.delegateTarget.contains(e.relatedTarget))return t.call(this,e)};n?n=t(n):i=t(i)}const[s,o,a]=ae(e,i,n),l=se(t),h=l[a]||(l[a]={}),c=oe(h,o,s?i:null);if(c)return void(c.oneOff=c.oneOff&&r);const u=re(o,e.replace(Kt,"")),d=s?function(t,e,i){return function n(r){const s=t.querySelectorAll(e);for(let{target:o}=r;o&&o!==this;o=o.parentNode)for(let a=s.length;a--;)if(s[a]===o)return r.delegateTarget=o,n.oneOff&&ue.off(t,r.type,e,i),i.apply(o,[r]);return null}}(t,i,n):function(t,e){return function i(n){return n.delegateTarget=t,i.oneOff&&ue.off(t,n.type,e),e.apply(t,[n])}}(t,i);d.delegationSelector=s?i:null,d.originalHandler=o,d.oneOff=r,d.uidEvent=u,h[u]=d,t.addEventListener(a,d,s)}function he(t,e,i,n,r){const s=oe(e[i],n,r);s&&(t.removeEventListener(i,s,Boolean(r)),delete e[i][s.uidEvent])}function ce(t){return t=t.replace(Qt,""),ee[t]||t}const ue={on(t,e,i,n){le(t,e,i,n,!1)},one(t,e,i,n){le(t,e,i,n,!0)},off(t,e,i,n){if("string"!=typeof e||!t)return;const[r,s,o]=ae(e,i,n),a=o!==e,l=se(t),h=e.startsWith(".");if(void 0!==s){if(!l||!l[o])return;return void he(t,l,o,s,r?i:null)}h&&Object.keys(l).forEach((i=>{!function(t,e,i,n){const r=e[i]||{};Object.keys(r).forEach((s=>{if(s.includes(n)){const n=r[s];he(t,e,i,n.originalHandler,n.delegationSelector)}}))}(t,l,i,e.slice(1))}));const c=l[o]||{};Object.keys(c).forEach((i=>{const n=i.replace(Zt,"");if(!a||e.includes(n)){const e=c[i];he(t,l,o,e.originalHandler,e.delegationSelector)}}))},trigger(t,e,i){if("string"!=typeof e||!t)return null;const n=Gt(),r=ce(e),s=e!==r,o=ne.has(r);let a,l=!0,h=!0,c=!1,u=null;return s&&n&&(a=n.Event(e,i),n(t).trigger(a),l=!a.isPropagationStopped(),h=!a.isImmediatePropagationStopped(),c=a.isDefaultPrevented()),o?(u=document.createEvent("HTMLEvents"),u.initEvent(r,l,!0)):u=new CustomEvent(e,{bubbles:l,cancelable:!0}),void 0!==i&&Object.keys(i).forEach((t=>{Object.defineProperty(u,t,{get:()=>i[t]})})),c&&u.preventDefault(),h&&t.dispatchEvent(u),u.defaultPrevented&&void 0!==a&&a.preventDefault(),u}},de=new Map,fe={set(t,e,i){de.has(t)||de.set(t,new Map);const n=de.get(t);n.has(e)||0===n.size?n.set(e,i):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(n.keys())[0]}.`)},get:(t,e)=>de.has(t)&&de.get(t).get(e)||null,remove(t,e){if(!de.has(t))return;const i=de.get(t);i.delete(e),0===i.size&&de.delete(t)}};class pe{constructor(t){(t=Dt(t))&&(this._element=t,fe.set(this._element,this.constructor.DATA_KEY,this))}dispose(){fe.remove(this._element,this.constructor.DATA_KEY),ue.off(this._element,this.constructor.EVENT_KEY),Object.getOwnPropertyNames(this).forEach((t=>{this[t]=null}))}_queueCallback(t,e,i=!0){Yt(t,e,i)}static getInstance(t){return fe.get(Dt(t),this.DATA_KEY)}static getOrCreateInstance(t,e={}){return this.getInstance(t)||new this(t,"object"==typeof e?e:null)}static get VERSION(){return"5.1.3"}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}}const ge=(t,e="hide")=>{const i=`click.dismiss${t.EVENT_KEY}`,n=t.NAME;ue.on(document,i,`[data-bs-dismiss="${n}"]`,(function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),Bt(this))return;const r=Lt(this)||this.closest(`.${n}`);t.getOrCreateInstance(r)[e]()}))};class ve extends pe{static get NAME(){return"alert"}close(){if(ue.trigger(this._element,"close.bs.alert").defaultPrevented)return;this._element.classList.remove("show");const t=this._element.classList.contains("fade");this._queueCallback((()=>this._destroyElement()),this._element,t)}_destroyElement(){this._element.remove(),ue.trigger(this._element,"closed.bs.alert"),this.dispose()}static jQueryInterface(t){return this.each((function(){const e=ve.getOrCreateInstance(this);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t](this)}}))}}ge(ve,"close"),qt(ve);const me='[data-bs-toggle="button"]';class ye extends pe{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(t){return this.each((function(){const e=ye.getOrCreateInstance(this);"toggle"===t&&e[t]()}))}}function be(t){return"true"===t||"false"!==t&&(t===Number(t).toString()?Number(t):""===t||"null"===t?null:t)}function we(t){return t.replace(/[A-Z]/g,(t=>`-${t.toLowerCase()}`))}ue.on(document,"click.bs.button.data-api",me,(t=>{t.preventDefault();const e=t.target.closest(me);ye.getOrCreateInstance(e).toggle()})),qt(ye);const _e={setDataAttribute(t,e,i){t.setAttribute(`data-bs-${we(e)}`,i)},removeDataAttribute(t,e){t.removeAttribute(`data-bs-${we(e)}`)},getDataAttributes(t){if(!t)return{};const e={};return Object.keys(t.dataset).filter((t=>t.startsWith("bs"))).forEach((i=>{let n=i.replace(/^bs/,"");n=n.charAt(0).toLowerCase()+n.slice(1,n.length),e[n]=be(t.dataset[i])})),e},getDataAttribute:(t,e)=>be(t.getAttribute(`data-bs-${we(e)}`)),offset(t){const e=t.getBoundingClientRect();return{top:e.top+window.pageYOffset,left:e.left+window.pageXOffset}},position:t=>({top:t.offsetTop,left:t.offsetLeft})},xe={find:(t,e=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(e,t)),findOne:(t,e=document.documentElement)=>Element.prototype.querySelector.call(e,t),children:(t,e)=>[].concat(...t.children).filter((t=>t.matches(e))),parents(t,e){const i=[];let n=t.parentNode;for(;n&&n.nodeType===Node.ELEMENT_NODE&&3!==n.nodeType;)n.matches(e)&&i.push(n),n=n.parentNode;return i},prev(t,e){let i=t.previousElementSibling;for(;i;){if(i.matches(e))return[i];i=i.previousElementSibling}return[]},next(t,e){let i=t.nextElementSibling;for(;i;){if(i.matches(e))return[i];i=i.nextElementSibling}return[]},focusableChildren(t){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map((t=>`${t}:not([tabindex^="-"])`)).join(", ");return this.find(e,t).filter((t=>!Bt(t)&&jt(t)))}},ke="carousel",Ce={interval:5e3,keyboard:!0,slide:!1,pause:"hover",wrap:!0,touch:!0},Se={interval:"(number|boolean)",keyboard:"boolean",slide:"(boolean|string)",pause:"(string|boolean)",wrap:"boolean",touch:"boolean"},Ee="next",Ae="prev",Te="left",Me="right",Oe={ArrowLeft:Me,ArrowRight:Te},Pe="slid.bs.carousel",Re="active",Le=".active.carousel-item";class Ie extends pe{constructor(t,e){super(t),this._items=null,this._interval=null,this._activeElement=null,this._isPaused=!1,this._isSliding=!1,this.touchTimeout=null,this.touchStartX=0,this.touchDeltaX=0,this._config=this._getConfig(e),this._indicatorsElement=xe.findOne(".carousel-indicators",this._element),this._touchSupported="ontouchstart"in document.documentElement||navigator.maxTouchPoints>0,this._pointerEvent=Boolean(window.PointerEvent),this._addEventListeners()}static get Default(){return Ce}static get NAME(){return ke}next(){this._slide(Ee)}nextWhenVisible(){!document.hidden&&jt(this._element)&&this.next()}prev(){this._slide(Ae)}pause(t){t||(this._isPaused=!0),xe.findOne(".carousel-item-next, .carousel-item-prev",this._element)&&(It(this._element),this.cycle(!0)),clearInterval(this._interval),this._interval=null}cycle(t){t||(this._isPaused=!1),this._interval&&(clearInterval(this._interval),this._interval=null),this._config&&this._config.interval&&!this._isPaused&&(this._updateInterval(),this._interval=setInterval((document.visibilityState?this.nextWhenVisible:this.next).bind(this),this._config.interval))}to(t){this._activeElement=xe.findOne(Le,this._element);const e=this._getItemIndex(this._activeElement);if(t>this._items.length-1||t<0)return;if(this._isSliding)return void ue.one(this._element,Pe,(()=>this.to(t)));if(e===t)return this.pause(),void this.cycle();const i=t>e?Ee:Ae;this._slide(i,this._items[t])}_getConfig(t){return t={...Ce,..._e.getDataAttributes(this._element),..."object"==typeof t?t:{}},Nt(ke,t,Se),t}_handleSwipe(){const t=Math.abs(this.touchDeltaX);if(t<=40)return;const e=t/this.touchDeltaX;this.touchDeltaX=0,e&&this._slide(e>0?Me:Te)}_addEventListeners(){this._config.keyboard&&ue.on(this._element,"keydown.bs.carousel",(t=>this._keydown(t))),"hover"===this._config.pause&&(ue.on(this._element,"mouseenter.bs.carousel",(t=>this.pause(t))),ue.on(this._element,"mouseleave.bs.carousel",(t=>this.cycle(t)))),this._config.touch&&this._touchSupported&&this._addTouchEventListeners()}_addTouchEventListeners(){const t=t=>this._pointerEvent&&("pen"===t.pointerType||"touch"===t.pointerType),e=e=>{t(e)?this.touchStartX=e.clientX:this._pointerEvent||(this.touchStartX=e.touches[0].clientX)},i=t=>{this.touchDeltaX=t.touches&&t.touches.length>1?0:t.touches[0].clientX-this.touchStartX},n=e=>{t(e)&&(this.touchDeltaX=e.clientX-this.touchStartX),this._handleSwipe(),"hover"===this._config.pause&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout((t=>this.cycle(t)),500+this._config.interval))};xe.find(".carousel-item img",this._element).forEach((t=>{ue.on(t,"dragstart.bs.carousel",(t=>t.preventDefault()))})),this._pointerEvent?(ue.on(this._element,"pointerdown.bs.carousel",(t=>e(t))),ue.on(this._element,"pointerup.bs.carousel",(t=>n(t))),this._element.classList.add("pointer-event")):(ue.on(this._element,"touchstart.bs.carousel",(t=>e(t))),ue.on(this._element,"touchmove.bs.carousel",(t=>i(t))),ue.on(this._element,"touchend.bs.carousel",(t=>n(t))))}_keydown(t){if(/input|textarea/i.test(t.target.tagName))return;const e=Oe[t.key];e&&(t.preventDefault(),this._slide(e))}_getItemIndex(t){return this._items=t&&t.parentNode?xe.find(".carousel-item",t.parentNode):[],this._items.indexOf(t)}_getItemByOrder(t,e){const i=t===Ee;return Xt(this._items,e,i,this._config.wrap)}_triggerSlideEvent(t,e){const i=this._getItemIndex(t),n=this._getItemIndex(xe.findOne(Le,this._element));return ue.trigger(this._element,"slide.bs.carousel",{relatedTarget:t,direction:e,from:n,to:i})}_setActiveIndicatorElement(t){if(this._indicatorsElement){const e=xe.findOne(".active",this._indicatorsElement);e.classList.remove(Re),e.removeAttribute("aria-current");const i=xe.find("[data-bs-target]",this._indicatorsElement);for(let e=0;e<i.length;e++)if(Number.parseInt(i[e].getAttribute("data-bs-slide-to"),10)===this._getItemIndex(t)){i[e].classList.add(Re),i[e].setAttribute("aria-current","true");break}}}_updateInterval(){const t=this._activeElement||xe.findOne(Le,this._element);if(!t)return;const e=Number.parseInt(t.getAttribute("data-bs-interval"),10);e?(this._config.defaultInterval=this._config.defaultInterval||this._config.interval,this._config.interval=e):this._config.interval=this._config.defaultInterval||this._config.interval}_slide(t,e){const i=this._directionToOrder(t),n=xe.findOne(Le,this._element),r=this._getItemIndex(n),s=e||this._getItemByOrder(i,n),o=this._getItemIndex(s),a=Boolean(this._interval),l=i===Ee,h=l?"carousel-item-start":"carousel-item-end",c=l?"carousel-item-next":"carousel-item-prev",u=this._orderToDirection(i);if(s&&s.classList.contains(Re))return void(this._isSliding=!1);if(this._isSliding)return;if(this._triggerSlideEvent(s,u).defaultPrevented)return;if(!n||!s)return;this._isSliding=!0,a&&this.pause(),this._setActiveIndicatorElement(s),this._activeElement=s;const d=()=>{ue.trigger(this._element,Pe,{relatedTarget:s,direction:u,from:r,to:o})};if(this._element.classList.contains("slide")){s.classList.add(c),Ut(s),n.classList.add(h),s.classList.add(h);const t=()=>{s.classList.remove(h,c),s.classList.add(Re),n.classList.remove(Re,c,h),this._isSliding=!1,setTimeout(d,0)};this._queueCallback(t,n,!0)}else n.classList.remove(Re),s.classList.add(Re),this._isSliding=!1,d();a&&this.cycle()}_directionToOrder(t){return[Me,Te].includes(t)?Vt()?t===Te?Ae:Ee:t===Te?Ee:Ae:t}_orderToDirection(t){return[Ee,Ae].includes(t)?Vt()?t===Ae?Te:Me:t===Ae?Me:Te:t}static carouselInterface(t,e){const i=Ie.getOrCreateInstance(t,e);let{_config:n}=i;"object"==typeof e&&(n={...n,...e});const r="string"==typeof e?e:n.slide;if("number"==typeof e)i.to(e);else if("string"==typeof r){if(void 0===i[r])throw new TypeError(`No method named "${r}"`);i[r]()}else n.interval&&n.ride&&(i.pause(),i.cycle())}static jQueryInterface(t){return this.each((function(){Ie.carouselInterface(this,t)}))}static dataApiClickHandler(t){const e=Lt(this);if(!e||!e.classList.contains("carousel"))return;const i={..._e.getDataAttributes(e),..._e.getDataAttributes(this)},n=this.getAttribute("data-bs-slide-to");n&&(i.interval=!1),Ie.carouselInterface(e,i),n&&Ie.getInstance(e).to(n),t.preventDefault()}}ue.on(document,"click.bs.carousel.data-api","[data-bs-slide], [data-bs-slide-to]",Ie.dataApiClickHandler),ue.on(window,"load.bs.carousel.data-api",(()=>{const t=xe.find('[data-bs-ride="carousel"]');for(let e=0,i=t.length;e<i;e++)Ie.carouselInterface(t[e],Ie.getInstance(t[e]))})),qt(Ie);const $e="collapse",De={toggle:!0,parent:null},Ne={toggle:"boolean",parent:"(null|element)"},je="show",Be="collapse",Fe="collapsing",ze="collapsed",Ue=":scope .collapse .collapse",Ge='[data-bs-toggle="collapse"]';class He extends pe{constructor(t,e){super(t),this._isTransitioning=!1,this._config=this._getConfig(e),this._triggerArray=[];const i=xe.find(Ge);for(let t=0,e=i.length;t<e;t++){const e=i[t],n=Rt(e),r=xe.find(n).filter((t=>t===this._element));null!==n&&r.length&&(this._selector=n,this._triggerArray.push(e))}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return De}static get NAME(){return $e}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let t,e=[];if(this._config.parent){const t=xe.find(Ue,this._config.parent);e=xe.find(".collapse.show, .collapse.collapsing",this._config.parent).filter((e=>!t.includes(e)))}const i=xe.findOne(this._selector);if(e.length){const n=e.find((t=>i!==t));if(t=n?He.getInstance(n):null,t&&t._isTransitioning)return}if(ue.trigger(this._element,"show.bs.collapse").defaultPrevented)return;e.forEach((e=>{i!==e&&He.getOrCreateInstance(e,{toggle:!1}).hide(),t||fe.set(e,"bs.collapse",null)}));const n=this._getDimension();this._element.classList.remove(Be),this._element.classList.add(Fe),this._element.style[n]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const r=`scroll${n[0].toUpperCase()+n.slice(1)}`;this._queueCallback((()=>{this._isTransitioning=!1,this._element.classList.remove(Fe),this._element.classList.add(Be,je),this._element.style[n]="",ue.trigger(this._element,"shown.bs.collapse")}),this._element,!0),this._element.style[n]=`${this._element[r]}px`}hide(){if(this._isTransitioning||!this._isShown())return;if(ue.trigger(this._element,"hide.bs.collapse").defaultPrevented)return;const t=this._getDimension();this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,Ut(this._element),this._element.classList.add(Fe),this._element.classList.remove(Be,je);const e=this._triggerArray.length;for(let t=0;t<e;t++){const e=this._triggerArray[t],i=Lt(e);i&&!this._isShown(i)&&this._addAriaAndCollapsedClass([e],!1)}this._isTransitioning=!0,this._element.style[t]="",this._queueCallback((()=>{this._isTransitioning=!1,this._element.classList.remove(Fe),this._element.classList.add(Be),ue.trigger(this._element,"hidden.bs.collapse")}),this._element,!0)}_isShown(t=this._element){return t.classList.contains(je)}_getConfig(t){return(t={...De,..._e.getDataAttributes(this._element),...t}).toggle=Boolean(t.toggle),t.parent=Dt(t.parent),Nt($e,t,Ne),t}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const t=xe.find(Ue,this._config.parent);xe.find(Ge,this._config.parent).filter((e=>!t.includes(e))).forEach((t=>{const e=Lt(t);e&&this._addAriaAndCollapsedClass([t],this._isShown(e))}))}_addAriaAndCollapsedClass(t,e){t.length&&t.forEach((t=>{e?t.classList.remove(ze):t.classList.add(ze),t.setAttribute("aria-expanded",e)}))}static jQueryInterface(t){return this.each((function(){const e={};"string"==typeof t&&/show|hide/.test(t)&&(e.toggle=!1);const i=He.getOrCreateInstance(this,e);if("string"==typeof t){if(void 0===i[t])throw new TypeError(`No method named "${t}"`);i[t]()}}))}}ue.on(document,"click.bs.collapse.data-api",Ge,(function(t){("A"===t.target.tagName||t.delegateTarget&&"A"===t.delegateTarget.tagName)&&t.preventDefault();const e=Rt(this);xe.find(e).forEach((t=>{He.getOrCreateInstance(t,{toggle:!1}).toggle()}))})),qt(He);const Ve="dropdown",qe="Escape",We="Space",Ye="ArrowUp",Xe="ArrowDown",Ke=new RegExp("ArrowUp|ArrowDown|Escape"),Qe="click.bs.dropdown.data-api",Ze="keydown.bs.dropdown.data-api",Je="show",ti='[data-bs-toggle="dropdown"]',ei=".dropdown-menu",ii=Vt()?"top-end":"top-start",ni=Vt()?"top-start":"top-end",ri=Vt()?"bottom-end":"bottom-start",si=Vt()?"bottom-start":"bottom-end",oi=Vt()?"left-start":"right-start",ai=Vt()?"right-start":"left-start",li={offset:[0,2],boundary:"clippingParents",reference:"toggle",display:"dynamic",popperConfig:null,autoClose:!0},hi={offset:"(array|string|function)",boundary:"(string|element)",reference:"(string|element|object)",display:"string",popperConfig:"(null|object|function)",autoClose:"(boolean|string)"};class ci extends pe{constructor(t,e){super(t),this._popper=null,this._config=this._getConfig(e),this._menu=this._getMenuElement(),this._inNavbar=this._detectNavbar()}static get Default(){return li}static get DefaultType(){return hi}static get NAME(){return Ve}toggle(){return this._isShown()?this.hide():this.show()}show(){if(Bt(this._element)||this._isShown(this._menu))return;const t={relatedTarget:this._element};if(ue.trigger(this._element,"show.bs.dropdown",t).defaultPrevented)return;const e=ci.getParentFromElement(this._element);this._inNavbar?_e.setDataAttribute(this._menu,"popper","none"):this._createPopper(e),"ontouchstart"in document.documentElement&&!e.closest(".navbar-nav")&&[].concat(...document.body.children).forEach((t=>ue.on(t,"mouseover",zt))),this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Je),this._element.classList.add(Je),ue.trigger(this._element,"shown.bs.dropdown",t)}hide(){if(Bt(this._element)||!this._isShown(this._menu))return;const t={relatedTarget:this._element};this._completeHide(t)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(t){ue.trigger(this._element,"hide.bs.dropdown",t).defaultPrevented||("ontouchstart"in document.documentElement&&[].concat(...document.body.children).forEach((t=>ue.off(t,"mouseover",zt))),this._popper&&this._popper.destroy(),this._menu.classList.remove(Je),this._element.classList.remove(Je),this._element.setAttribute("aria-expanded","false"),_e.removeDataAttribute(this._menu,"popper"),ue.trigger(this._element,"hidden.bs.dropdown",t))}_getConfig(t){if(t={...this.constructor.Default,..._e.getDataAttributes(this._element),...t},Nt(Ve,t,this.constructor.DefaultType),"object"==typeof t.reference&&!$t(t.reference)&&"function"!=typeof t.reference.getBoundingClientRect)throw new TypeError(`${Ve.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return t}_createPopper(e){if(void 0===t)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let i=this._element;"parent"===this._config.reference?i=e:$t(this._config.reference)?i=Dt(this._config.reference):"object"==typeof this._config.reference&&(i=this._config.reference);const n=this._getPopperConfig(),r=n.modifiers.find((t=>"applyStyles"===t.name&&!1===t.enabled));this._popper=Tt(i,this._menu,n),r&&_e.setDataAttribute(this._menu,"popper","static")}_isShown(t=this._element){return t.classList.contains(Je)}_getMenuElement(){return xe.next(this._element,ei)[0]}_getPlacement(){const t=this._element.parentNode;if(t.classList.contains("dropend"))return oi;if(t.classList.contains("dropstart"))return ai;const e="end"===getComputedStyle(this._menu).getPropertyValue("--bs-position").trim();return t.classList.contains("dropup")?e?ni:ii:e?si:ri}_detectNavbar(){return null!==this._element.closest(".navbar")}_getOffset(){const{offset:t}=this._config;return"string"==typeof t?t.split(",").map((t=>Number.parseInt(t,10))):"function"==typeof t?e=>t(e,this._element):t}_getPopperConfig(){const t={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return"static"===this._config.display&&(t.modifiers=[{name:"applyStyles",enabled:!1}]),{...t,..."function"==typeof this._config.popperConfig?this._config.popperConfig(t):this._config.popperConfig}}_selectMenuItem({key:t,target:e}){const i=xe.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter(jt);i.length&&Xt(i,e,t===Xe,!i.includes(e)).focus()}static jQueryInterface(t){return this.each((function(){const e=ci.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}}))}static clearMenus(t){if(t&&(2===t.button||"keyup"===t.type&&"Tab"!==t.key))return;const e=xe.find(ti);for(let i=0,n=e.length;i<n;i++){const n=ci.getInstance(e[i]);if(!n||!1===n._config.autoClose)continue;if(!n._isShown())continue;const r={relatedTarget:n._element};if(t){const e=t.composedPath(),i=e.includes(n._menu);if(e.includes(n._element)||"inside"===n._config.autoClose&&!i||"outside"===n._config.autoClose&&i)continue;if(n._menu.contains(t.target)&&("keyup"===t.type&&"Tab"===t.key||/input|select|option|textarea|form/i.test(t.target.tagName)))continue;"click"===t.type&&(r.clickEvent=t)}n._completeHide(r)}}static getParentFromElement(t){return Lt(t)||t.parentNode}static dataApiKeydownHandler(t){if(/input|textarea/i.test(t.target.tagName)?t.key===We||t.key!==qe&&(t.key!==Xe&&t.key!==Ye||t.target.closest(ei)):!Ke.test(t.key))return;const e=this.classList.contains(Je);if(!e&&t.key===qe)return;if(t.preventDefault(),t.stopPropagation(),Bt(this))return;const i=this.matches(ti)?this:xe.prev(this,ti)[0],n=ci.getOrCreateInstance(i);if(t.key!==qe)return t.key===Ye||t.key===Xe?(e||n.show(),void n._selectMenuItem(t)):void(e&&t.key!==We||ci.clearMenus());n.hide()}}ue.on(document,Ze,ti,ci.dataApiKeydownHandler),ue.on(document,Ze,ei,ci.dataApiKeydownHandler),ue.on(document,Qe,ci.clearMenus),ue.on(document,"keyup.bs.dropdown.data-api",ci.clearMenus),ue.on(document,Qe,ti,(function(t){t.preventDefault(),ci.getOrCreateInstance(this).toggle()})),qt(ci);const ui=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",di=".sticky-top";class fi{constructor(){this._element=document.body}getWidth(){const t=document.documentElement.clientWidth;return Math.abs(window.innerWidth-t)}hide(){const t=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,"paddingRight",(e=>e+t)),this._setElementAttributes(ui,"paddingRight",(e=>e+t)),this._setElementAttributes(di,"marginRight",(e=>e-t))}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(t,e,i){const n=this.getWidth();this._applyManipulationCallback(t,(t=>{if(t!==this._element&&window.innerWidth>t.clientWidth+n)return;this._saveInitialAttribute(t,e);const r=window.getComputedStyle(t)[e];t.style[e]=`${i(Number.parseFloat(r))}px`}))}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,"paddingRight"),this._resetElementAttributes(ui,"paddingRight"),this._resetElementAttributes(di,"marginRight")}_saveInitialAttribute(t,e){const i=t.style[e];i&&_e.setDataAttribute(t,e,i)}_resetElementAttributes(t,e){this._applyManipulationCallback(t,(t=>{const i=_e.getDataAttribute(t,e);void 0===i?t.style.removeProperty(e):(_e.removeDataAttribute(t,e),t.style[e]=i)}))}_applyManipulationCallback(t,e){$t(t)?e(t):xe.find(t,this._element).forEach(e)}isOverflowing(){return this.getWidth()>0}}const pi={className:"modal-backdrop",isVisible:!0,isAnimated:!1,rootElement:"body",clickCallback:null},gi={className:"string",isVisible:"boolean",isAnimated:"boolean",rootElement:"(element|string)",clickCallback:"(function|null)"},vi="show",mi="mousedown.bs.backdrop";class yi{constructor(t){this._config=this._getConfig(t),this._isAppended=!1,this._element=null}show(t){this._config.isVisible?(this._append(),this._config.isAnimated&&Ut(this._getElement()),this._getElement().classList.add(vi),this._emulateAnimation((()=>{Wt(t)}))):Wt(t)}hide(t){this._config.isVisible?(this._getElement().classList.remove(vi),this._emulateAnimation((()=>{this.dispose(),Wt(t)}))):Wt(t)}_getElement(){if(!this._element){const t=document.createElement("div");t.className=this._config.className,this._config.isAnimated&&t.classList.add("fade"),this._element=t}return this._element}_getConfig(t){return(t={...pi,..."object"==typeof t?t:{}}).rootElement=Dt(t.rootElement),Nt("backdrop",t,gi),t}_append(){this._isAppended||(this._config.rootElement.append(this._getElement()),ue.on(this._getElement(),mi,(()=>{Wt(this._config.clickCallback)})),this._isAppended=!0)}dispose(){this._isAppended&&(ue.off(this._element,mi),this._element.remove(),this._isAppended=!1)}_emulateAnimation(t){Yt(t,this._getElement(),this._config.isAnimated)}}const bi={trapElement:null,autofocus:!0},wi={trapElement:"element",autofocus:"boolean"},_i=".bs.focustrap",xi="backward";class ki{constructor(t){this._config=this._getConfig(t),this._isActive=!1,this._lastTabNavDirection=null}activate(){const{trapElement:t,autofocus:e}=this._config;this._isActive||(e&&t.focus(),ue.off(document,_i),ue.on(document,"focusin.bs.focustrap",(t=>this._handleFocusin(t))),ue.on(document,"keydown.tab.bs.focustrap",(t=>this._handleKeydown(t))),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,ue.off(document,_i))}_handleFocusin(t){const{target:e}=t,{trapElement:i}=this._config;if(e===document||e===i||i.contains(e))return;const n=xe.focusableChildren(i);0===n.length?i.focus():this._lastTabNavDirection===xi?n[n.length-1].focus():n[0].focus()}_handleKeydown(t){"Tab"===t.key&&(this._lastTabNavDirection=t.shiftKey?xi:"forward")}_getConfig(t){return t={...bi,..."object"==typeof t?t:{}},Nt("focustrap",t,wi),t}}const Ci="modal",Si="Escape",Ei={backdrop:!0,keyboard:!0,focus:!0},Ai={backdrop:"(boolean|string)",keyboard:"boolean",focus:"boolean"},Ti="hidden.bs.modal",Mi="show.bs.modal",Oi="resize.bs.modal",Pi="click.dismiss.bs.modal",Ri="keydown.dismiss.bs.modal",Li="mousedown.dismiss.bs.modal",Ii="modal-open",$i="show",Di="modal-static";class Ni extends pe{constructor(t,e){super(t),this._config=this._getConfig(e),this._dialog=xe.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._ignoreBackdropClick=!1,this._isTransitioning=!1,this._scrollBar=new fi}static get Default(){return Ei}static get NAME(){return Ci}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){this._isShown||this._isTransitioning||ue.trigger(this._element,Mi,{relatedTarget:t}).defaultPrevented||(this._isShown=!0,this._isAnimated()&&(this._isTransitioning=!0),this._scrollBar.hide(),document.body.classList.add(Ii),this._adjustDialog(),this._setEscapeEvent(),this._setResizeEvent(),ue.on(this._dialog,Li,(()=>{ue.one(this._element,"mouseup.dismiss.bs.modal",(t=>{t.target===this._element&&(this._ignoreBackdropClick=!0)}))})),this._showBackdrop((()=>this._showElement(t))))}hide(){if(!this._isShown||this._isTransitioning)return;if(ue.trigger(this._element,"hide.bs.modal").defaultPrevented)return;this._isShown=!1;const t=this._isAnimated();t&&(this._isTransitioning=!0),this._setEscapeEvent(),this._setResizeEvent(),this._focustrap.deactivate(),this._element.classList.remove($i),ue.off(this._element,Pi),ue.off(this._dialog,Li),this._queueCallback((()=>this._hideModal()),this._element,t)}dispose(){[window,this._dialog].forEach((t=>ue.off(t,".bs.modal"))),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new yi({isVisible:Boolean(this._config.backdrop),isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new ki({trapElement:this._element})}_getConfig(t){return t={...Ei,..._e.getDataAttributes(this._element),..."object"==typeof t?t:{}},Nt(Ci,t,Ai),t}_showElement(t){const e=this._isAnimated(),i=xe.findOne(".modal-body",this._dialog);this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0,i&&(i.scrollTop=0),e&&Ut(this._element),this._element.classList.add($i),this._queueCallback((()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,ue.trigger(this._element,"shown.bs.modal",{relatedTarget:t})}),this._dialog,e)}_setEscapeEvent(){this._isShown?ue.on(this._element,Ri,(t=>{this._config.keyboard&&t.key===Si?(t.preventDefault(),this.hide()):this._config.keyboard||t.key!==Si||this._triggerBackdropTransition()})):ue.off(this._element,Ri)}_setResizeEvent(){this._isShown?ue.on(window,Oi,(()=>this._adjustDialog())):ue.off(window,Oi)}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide((()=>{document.body.classList.remove(Ii),this._resetAdjustments(),this._scrollBar.reset(),ue.trigger(this._element,Ti)}))}_showBackdrop(t){ue.on(this._element,Pi,(t=>{this._ignoreBackdropClick?this._ignoreBackdropClick=!1:t.target===t.currentTarget&&(!0===this._config.backdrop?this.hide():"static"===this._config.backdrop&&this._triggerBackdropTransition())})),this._backdrop.show(t)}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(ue.trigger(this._element,"hidePrevented.bs.modal").defaultPrevented)return;const{classList:t,scrollHeight:e,style:i}=this._element,n=e>document.documentElement.clientHeight;!n&&"hidden"===i.overflowY||t.contains(Di)||(n||(i.overflowY="hidden"),t.add(Di),this._queueCallback((()=>{t.remove(Di),n||this._queueCallback((()=>{i.overflowY=""}),this._dialog)}),this._dialog),this._element.focus())}_adjustDialog(){const t=this._element.scrollHeight>document.documentElement.clientHeight,e=this._scrollBar.getWidth(),i=e>0;(!i&&t&&!Vt()||i&&!t&&Vt())&&(this._element.style.paddingLeft=`${e}px`),(i&&!t&&!Vt()||!i&&t&&Vt())&&(this._element.style.paddingRight=`${e}px`)}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(t,e){return this.each((function(){const i=Ni.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===i[t])throw new TypeError(`No method named "${t}"`);i[t](e)}}))}}ue.on(document,"click.bs.modal.data-api",'[data-bs-toggle="modal"]',(function(t){const e=Lt(this);["A","AREA"].includes(this.tagName)&&t.preventDefault(),ue.one(e,Mi,(t=>{t.defaultPrevented||ue.one(e,Ti,(()=>{jt(this)&&this.focus()}))}));const i=xe.findOne(".modal.show");i&&Ni.getInstance(i).hide(),Ni.getOrCreateInstance(e).toggle(this)})),ge(Ni),qt(Ni);const ji="offcanvas",Bi={backdrop:!0,keyboard:!0,scroll:!1},Fi={backdrop:"boolean",keyboard:"boolean",scroll:"boolean"},zi="show",Ui=".offcanvas.show",Gi="hidden.bs.offcanvas";class Hi extends pe{constructor(t,e){super(t),this._config=this._getConfig(e),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get NAME(){return ji}static get Default(){return Bi}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){this._isShown||ue.trigger(this._element,"show.bs.offcanvas",{relatedTarget:t}).defaultPrevented||(this._isShown=!0,this._element.style.visibility="visible",this._backdrop.show(),this._config.scroll||(new fi).hide(),this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(zi),this._queueCallback((()=>{this._config.scroll||this._focustrap.activate(),ue.trigger(this._element,"shown.bs.offcanvas",{relatedTarget:t})}),this._element,!0))}hide(){this._isShown&&(ue.trigger(this._element,"hide.bs.offcanvas").defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.remove(zi),this._backdrop.hide(),this._queueCallback((()=>{this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._element.style.visibility="hidden",this._config.scroll||(new fi).reset(),ue.trigger(this._element,Gi)}),this._element,!0)))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_getConfig(t){return t={...Bi,..._e.getDataAttributes(this._element),..."object"==typeof t?t:{}},Nt(ji,t,Fi),t}_initializeBackDrop(){return new yi({className:"offcanvas-backdrop",isVisible:this._config.backdrop,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:()=>this.hide()})}_initializeFocusTrap(){return new ki({trapElement:this._element})}_addEventListeners(){ue.on(this._element,"keydown.dismiss.bs.offcanvas",(t=>{this._config.keyboard&&"Escape"===t.key&&this.hide()}))}static jQueryInterface(t){return this.each((function(){const e=Hi.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t](this)}}))}}ue.on(document,"click.bs.offcanvas.data-api",'[data-bs-toggle="offcanvas"]',(function(t){const e=Lt(this);if(["A","AREA"].includes(this.tagName)&&t.preventDefault(),Bt(this))return;ue.one(e,Gi,(()=>{jt(this)&&this.focus()}));const i=xe.findOne(Ui);i&&i!==e&&Hi.getInstance(i).hide(),Hi.getOrCreateInstance(e).toggle(this)})),ue.on(window,"load.bs.offcanvas.data-api",(()=>xe.find(Ui).forEach((t=>Hi.getOrCreateInstance(t).show())))),ge(Hi),qt(Hi);const Vi=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),qi=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^#&/:?]*(?:[#/?]|$))/i,Wi=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i,Yi=(t,e)=>{const i=t.nodeName.toLowerCase();if(e.includes(i))return!Vi.has(i)||Boolean(qi.test(t.nodeValue)||Wi.test(t.nodeValue));const n=e.filter((t=>t instanceof RegExp));for(let t=0,e=n.length;t<e;t++)if(n[t].test(i))return!0;return!1};function Xi(t,e,i){if(!t.length)return t;if(i&&"function"==typeof i)return i(t);const n=(new window.DOMParser).parseFromString(t,"text/html"),r=[].concat(...n.body.querySelectorAll("*"));for(let t=0,i=r.length;t<i;t++){const i=r[t],n=i.nodeName.toLowerCase();if(!Object.keys(e).includes(n)){i.remove();continue}const s=[].concat(...i.attributes),o=[].concat(e["*"]||[],e[n]||[]);s.forEach((t=>{Yi(t,o)||i.removeAttribute(t.nodeName)}))}return n.body.innerHTML}const Ki="tooltip",Qi=new Set(["sanitize","allowList","sanitizeFn"]),Zi={animation:"boolean",template:"string",title:"(string|element|function)",trigger:"string",delay:"(number|object)",html:"boolean",selector:"(string|boolean)",placement:"(string|function)",offset:"(array|string|function)",container:"(string|element|boolean)",fallbackPlacements:"array",boundary:"(string|element)",customClass:"(string|function)",sanitize:"boolean",sanitizeFn:"(null|function)",allowList:"object",popperConfig:"(null|object|function)"},Ji={AUTO:"auto",TOP:"top",RIGHT:Vt()?"left":"right",BOTTOM:"bottom",LEFT:Vt()?"right":"left"},tn={animation:!0,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,selector:!1,placement:"top",offset:[0,0],container:!1,fallbackPlacements:["top","right","bottom","left"],boundary:"clippingParents",customClass:"",sanitize:!0,sanitizeFn:null,allowList:{"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},popperConfig:null},en={HIDE:"hide.bs.tooltip",HIDDEN:"hidden.bs.tooltip",SHOW:"show.bs.tooltip",SHOWN:"shown.bs.tooltip",INSERTED:"inserted.bs.tooltip",CLICK:"click.bs.tooltip",FOCUSIN:"focusin.bs.tooltip",FOCUSOUT:"focusout.bs.tooltip",MOUSEENTER:"mouseenter.bs.tooltip",MOUSELEAVE:"mouseleave.bs.tooltip"},nn="fade",rn="show",sn="show",on="out",an=".tooltip-inner",ln=".modal",hn="hide.bs.modal",cn="hover",un="focus";class dn extends pe{constructor(e,i){if(void 0===t)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(e),this._isEnabled=!0,this._timeout=0,this._hoverState="",this._activeTrigger={},this._popper=null,this._config=this._getConfig(i),this.tip=null,this._setListeners()}static get Default(){return tn}static get NAME(){return Ki}static get Event(){return en}static get DefaultType(){return Zi}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(t){if(this._isEnabled)if(t){const e=this._initializeOnDelegatedTarget(t);e._activeTrigger.click=!e._activeTrigger.click,e._isWithActiveTrigger()?e._enter(null,e):e._leave(null,e)}else{if(this.getTipElement().classList.contains(rn))return void this._leave(null,this);this._enter(null,this)}}dispose(){clearTimeout(this._timeout),ue.off(this._element.closest(ln),hn,this._hideModalHandler),this.tip&&this.tip.remove(),this._disposePopper(),super.dispose()}show(){if("none"===this._element.style.display)throw new Error("Please use show on visible elements");if(!this.isWithContent()||!this._isEnabled)return;const t=ue.trigger(this._element,this.constructor.Event.SHOW),e=Ft(this._element),i=null===e?this._element.ownerDocument.documentElement.contains(this._element):e.contains(this._element);if(t.defaultPrevented||!i)return;"tooltip"===this.constructor.NAME&&this.tip&&this.getTitle()!==this.tip.querySelector(an).innerHTML&&(this._disposePopper(),this.tip.remove(),this.tip=null);const n=this.getTipElement(),r=(t=>{do{t+=Math.floor(1e6*Math.random())}while(document.getElementById(t));return t})(this.constructor.NAME);n.setAttribute("id",r),this._element.setAttribute("aria-describedby",r),this._config.animation&&n.classList.add(nn);const s="function"==typeof this._config.placement?this._config.placement.call(this,n,this._element):this._config.placement,o=this._getAttachment(s);this._addAttachmentClass(o);const{container:a}=this._config;fe.set(n,this.constructor.DATA_KEY,this),this._element.ownerDocument.documentElement.contains(this.tip)||(a.append(n),ue.trigger(this._element,this.constructor.Event.INSERTED)),this._popper?this._popper.update():this._popper=Tt(this._element,n,this._getPopperConfig(o)),n.classList.add(rn);const l=this._resolvePossibleFunction(this._config.customClass);l&&n.classList.add(...l.split(" ")),"ontouchstart"in document.documentElement&&[].concat(...document.body.children).forEach((t=>{ue.on(t,"mouseover",zt)}));const h=this.tip.classList.contains(nn);this._queueCallback((()=>{const t=this._hoverState;this._hoverState=null,ue.trigger(this._element,this.constructor.Event.SHOWN),t===on&&this._leave(null,this)}),this.tip,h)}hide(){if(!this._popper)return;const t=this.getTipElement();if(ue.trigger(this._element,this.constructor.Event.HIDE).defaultPrevented)return;t.classList.remove(rn),"ontouchstart"in document.documentElement&&[].concat(...document.body.children).forEach((t=>ue.off(t,"mouseover",zt))),this._activeTrigger.click=!1,this._activeTrigger.focus=!1,this._activeTrigger.hover=!1;const e=this.tip.classList.contains(nn);this._queueCallback((()=>{this._isWithActiveTrigger()||(this._hoverState!==sn&&t.remove(),this._cleanTipClass(),this._element.removeAttribute("aria-describedby"),ue.trigger(this._element,this.constructor.Event.HIDDEN),this._disposePopper())}),this.tip,e),this._hoverState=""}update(){null!==this._popper&&this._popper.update()}isWithContent(){return Boolean(this.getTitle())}getTipElement(){if(this.tip)return this.tip;const t=document.createElement("div");t.innerHTML=this._config.template;const e=t.children[0];return this.setContent(e),e.classList.remove(nn,rn),this.tip=e,this.tip}setContent(t){this._sanitizeAndSetContent(t,this.getTitle(),an)}_sanitizeAndSetContent(t,e,i){const n=xe.findOne(i,t);e||!n?this.setElementContent(n,e):n.remove()}setElementContent(t,e){if(null!==t)return $t(e)?(e=Dt(e),void(this._config.html?e.parentNode!==t&&(t.innerHTML="",t.append(e)):t.textContent=e.textContent)):void(this._config.html?(this._config.sanitize&&(e=Xi(e,this._config.allowList,this._config.sanitizeFn)),t.innerHTML=e):t.textContent=e)}getTitle(){const t=this._element.getAttribute("data-bs-original-title")||this._config.title;return this._resolvePossibleFunction(t)}updateAttachment(t){return"right"===t?"end":"left"===t?"start":t}_initializeOnDelegatedTarget(t,e){return e||this.constructor.getOrCreateInstance(t.delegateTarget,this._getDelegateConfig())}_getOffset(){const{offset:t}=this._config;return"string"==typeof t?t.split(",").map((t=>Number.parseInt(t,10))):"function"==typeof t?e=>t(e,this._element):t}_resolvePossibleFunction(t){return"function"==typeof t?t.call(this._element):t}_getPopperConfig(t){const e={placement:t,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"onChange",enabled:!0,phase:"afterWrite",fn:t=>this._handlePopperPlacementChange(t)}],onFirstUpdate:t=>{t.options.placement!==t.placement&&this._handlePopperPlacementChange(t)}};return{...e,..."function"==typeof this._config.popperConfig?this._config.popperConfig(e):this._config.popperConfig}}_addAttachmentClass(t){this.getTipElement().classList.add(`${this._getBasicClassPrefix()}-${this.updateAttachment(t)}`)}_getAttachment(t){return Ji[t.toUpperCase()]}_setListeners(){this._config.trigger.split(" ").forEach((t=>{if("click"===t)ue.on(this._element,this.constructor.Event.CLICK,this._config.selector,(t=>this.toggle(t)));else if("manual"!==t){const e=t===cn?this.constructor.Event.MOUSEENTER:this.constructor.Event.FOCUSIN,i=t===cn?this.constructor.Event.MOUSELEAVE:this.constructor.Event.FOCUSOUT;ue.on(this._element,e,this._config.selector,(t=>this._enter(t))),ue.on(this._element,i,this._config.selector,(t=>this._leave(t)))}})),this._hideModalHandler=()=>{this._element&&this.hide()},ue.on(this._element.closest(ln),hn,this._hideModalHandler),this._config.selector?this._config={...this._config,trigger:"manual",selector:""}:this._fixTitle()}_fixTitle(){const t=this._element.getAttribute("title"),e=typeof this._element.getAttribute("data-bs-original-title");(t||"string"!==e)&&(this._element.setAttribute("data-bs-original-title",t||""),!t||this._element.getAttribute("aria-label")||this._element.textContent||this._element.setAttribute("aria-label",t),this._element.setAttribute("title",""))}_enter(t,e){e=this._initializeOnDelegatedTarget(t,e),t&&(e._activeTrigger["focusin"===t.type?un:cn]=!0),e.getTipElement().classList.contains(rn)||e._hoverState===sn?e._hoverState=sn:(clearTimeout(e._timeout),e._hoverState=sn,e._config.delay&&e._config.delay.show?e._timeout=setTimeout((()=>{e._hoverState===sn&&e.show()}),e._config.delay.show):e.show())}_leave(t,e){e=this._initializeOnDelegatedTarget(t,e),t&&(e._activeTrigger["focusout"===t.type?un:cn]=e._element.contains(t.relatedTarget)),e._isWithActiveTrigger()||(clearTimeout(e._timeout),e._hoverState=on,e._config.delay&&e._config.delay.hide?e._timeout=setTimeout((()=>{e._hoverState===on&&e.hide()}),e._config.delay.hide):e.hide())}_isWithActiveTrigger(){for(const t in this._activeTrigger)if(this._activeTrigger[t])return!0;return!1}_getConfig(t){const e=_e.getDataAttributes(this._element);return Object.keys(e).forEach((t=>{Qi.has(t)&&delete e[t]})),(t={...this.constructor.Default,...e,..."object"==typeof t&&t?t:{}}).container=!1===t.container?document.body:Dt(t.container),"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),"number"==typeof t.title&&(t.title=t.title.toString()),"number"==typeof t.content&&(t.content=t.content.toString()),Nt(Ki,t,this.constructor.DefaultType),t.sanitize&&(t.template=Xi(t.template,t.allowList,t.sanitizeFn)),t}_getDelegateConfig(){const t={};for(const e in this._config)this.constructor.Default[e]!==this._config[e]&&(t[e]=this._config[e]);return t}_cleanTipClass(){const t=this.getTipElement(),e=new RegExp(`(^|\\s)${this._getBasicClassPrefix()}\\S+`,"g"),i=t.getAttribute("class").match(e);null!==i&&i.length>0&&i.map((t=>t.trim())).forEach((e=>t.classList.remove(e)))}_getBasicClassPrefix(){return"bs-tooltip"}_handlePopperPlacementChange(t){const{state:e}=t;e&&(this.tip=e.elements.popper,this._cleanTipClass(),this._addAttachmentClass(this._getAttachment(e.placement)))}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null)}static jQueryInterface(t){return this.each((function(){const e=dn.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}}))}}qt(dn);const fn={...dn.Default,placement:"right",offset:[0,8],trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'},pn={...dn.DefaultType,content:"(string|element|function)"},gn={HIDE:"hide.bs.popover",HIDDEN:"hidden.bs.popover",SHOW:"show.bs.popover",SHOWN:"shown.bs.popover",INSERTED:"inserted.bs.popover",CLICK:"click.bs.popover",FOCUSIN:"focusin.bs.popover",FOCUSOUT:"focusout.bs.popover",MOUSEENTER:"mouseenter.bs.popover",MOUSELEAVE:"mouseleave.bs.popover"};class vn extends dn{static get Default(){return fn}static get NAME(){return"popover"}static get Event(){return gn}static get DefaultType(){return pn}isWithContent(){return this.getTitle()||this._getContent()}setContent(t){this._sanitizeAndSetContent(t,this.getTitle(),".popover-header"),this._sanitizeAndSetContent(t,this._getContent(),".popover-body")}_getContent(){return this._resolvePossibleFunction(this._config.content)}_getBasicClassPrefix(){return"bs-popover"}static jQueryInterface(t){return this.each((function(){const e=vn.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}}))}}qt(vn);const mn="scrollspy",yn={offset:10,method:"auto",target:""},bn={offset:"number",method:"string",target:"(string|element)"},wn="active",_n=".nav-link, .list-group-item, .dropdown-item",xn="position";class kn extends pe{constructor(t,e){super(t),this._scrollElement="BODY"===this._element.tagName?window:this._element,this._config=this._getConfig(e),this._offsets=[],this._targets=[],this._activeTarget=null,this._scrollHeight=0,ue.on(this._scrollElement,"scroll.bs.scrollspy",(()=>this._process())),this.refresh(),this._process()}static get Default(){return yn}static get NAME(){return mn}refresh(){const t=this._scrollElement===this._scrollElement.window?"offset":xn,e="auto"===this._config.method?t:this._config.method,i=e===xn?this._getScrollTop():0;this._offsets=[],this._targets=[],this._scrollHeight=this._getScrollHeight(),xe.find(_n,this._config.target).map((t=>{const n=Rt(t),r=n?xe.findOne(n):null;if(r){const t=r.getBoundingClientRect();if(t.width||t.height)return[_e[e](r).top+i,n]}return null})).filter((t=>t)).sort(((t,e)=>t[0]-e[0])).forEach((t=>{this._offsets.push(t[0]),this._targets.push(t[1])}))}dispose(){ue.off(this._scrollElement,".bs.scrollspy"),super.dispose()}_getConfig(t){return(t={...yn,..._e.getDataAttributes(this._element),..."object"==typeof t&&t?t:{}}).target=Dt(t.target)||document.documentElement,Nt(mn,t,bn),t}_getScrollTop(){return this._scrollElement===window?this._scrollElement.pageYOffset:this._scrollElement.scrollTop}_getScrollHeight(){return this._scrollElement.scrollHeight||Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)}_getOffsetHeight(){return this._scrollElement===window?window.innerHeight:this._scrollElement.getBoundingClientRect().height}_process(){const t=this._getScrollTop()+this._config.offset,e=this._getScrollHeight(),i=this._config.offset+e-this._getOffsetHeight();if(this._scrollHeight!==e&&this.refresh(),t>=i){const t=this._targets[this._targets.length-1];this._activeTarget!==t&&this._activate(t)}else{if(this._activeTarget&&t<this._offsets[0]&&this._offsets[0]>0)return this._activeTarget=null,void this._clear();for(let e=this._offsets.length;e--;)this._activeTarget!==this._targets[e]&&t>=this._offsets[e]&&(void 0===this._offsets[e+1]||t<this._offsets[e+1])&&this._activate(this._targets[e])}}_activate(t){this._activeTarget=t,this._clear();const e=_n.split(",").map((e=>`${e}[data-bs-target="${t}"],${e}[href="${t}"]`)),i=xe.findOne(e.join(","),this._config.target);i.classList.add(wn),i.classList.contains("dropdown-item")?xe.findOne(".dropdown-toggle",i.closest(".dropdown")).classList.add(wn):xe.parents(i,".nav, .list-group").forEach((t=>{xe.prev(t,".nav-link, .list-group-item").forEach((t=>t.classList.add(wn))),xe.prev(t,".nav-item").forEach((t=>{xe.children(t,".nav-link").forEach((t=>t.classList.add(wn)))}))})),ue.trigger(this._scrollElement,"activate.bs.scrollspy",{relatedTarget:t})}_clear(){xe.find(_n,this._config.target).filter((t=>t.classList.contains(wn))).forEach((t=>t.classList.remove(wn)))}static jQueryInterface(t){return this.each((function(){const e=kn.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}}))}}ue.on(window,"load.bs.scrollspy.data-api",(()=>{xe.find('[data-bs-spy="scroll"]').forEach((t=>new kn(t)))})),qt(kn);const Cn="active",Sn="fade",En="show",An=".active",Tn=":scope > li > .active";class Mn extends pe{static get NAME(){return"tab"}show(){if(this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE&&this._element.classList.contains(Cn))return;let t;const e=Lt(this._element),i=this._element.closest(".nav, .list-group");if(i){const e="UL"===i.nodeName||"OL"===i.nodeName?Tn:An;t=xe.find(e,i),t=t[t.length-1]}const n=t?ue.trigger(t,"hide.bs.tab",{relatedTarget:this._element}):null;if(ue.trigger(this._element,"show.bs.tab",{relatedTarget:t}).defaultPrevented||null!==n&&n.defaultPrevented)return;this._activate(this._element,i);const r=()=>{ue.trigger(t,"hidden.bs.tab",{relatedTarget:this._element}),ue.trigger(this._element,"shown.bs.tab",{relatedTarget:t})};e?this._activate(e,e.parentNode,r):r()}_activate(t,e,i){const n=(!e||"UL"!==e.nodeName&&"OL"!==e.nodeName?xe.children(e,An):xe.find(Tn,e))[0],r=i&&n&&n.classList.contains(Sn),s=()=>this._transitionComplete(t,n,i);n&&r?(n.classList.remove(En),this._queueCallback(s,t,!0)):s()}_transitionComplete(t,e,i){if(e){e.classList.remove(Cn);const t=xe.findOne(":scope > .dropdown-menu .active",e.parentNode);t&&t.classList.remove(Cn),"tab"===e.getAttribute("role")&&e.setAttribute("aria-selected",!1)}t.classList.add(Cn),"tab"===t.getAttribute("role")&&t.setAttribute("aria-selected",!0),Ut(t),t.classList.contains(Sn)&&t.classList.add(En);let n=t.parentNode;if(n&&"LI"===n.nodeName&&(n=n.parentNode),n&&n.classList.contains("dropdown-menu")){const e=t.closest(".dropdown");e&&xe.find(".dropdown-toggle",e).forEach((t=>t.classList.add(Cn))),t.setAttribute("aria-expanded",!0)}i&&i()}static jQueryInterface(t){return this.each((function(){const e=Mn.getOrCreateInstance(this);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}}))}}ue.on(document,"click.bs.tab.data-api",'[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',(function(t){["A","AREA"].includes(this.tagName)&&t.preventDefault(),Bt(this)||Mn.getOrCreateInstance(this).show()})),qt(Mn);const On="toast",Pn="hide",Rn="show",Ln="showing",In={animation:"boolean",autohide:"boolean",delay:"number"},$n={animation:!0,autohide:!0,delay:5e3};class Dn extends pe{constructor(t,e){super(t),this._config=this._getConfig(e),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get DefaultType(){return In}static get Default(){return $n}static get NAME(){return On}show(){ue.trigger(this._element,"show.bs.toast").defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove(Pn),Ut(this._element),this._element.classList.add(Rn),this._element.classList.add(Ln),this._queueCallback((()=>{this._element.classList.remove(Ln),ue.trigger(this._element,"shown.bs.toast"),this._maybeScheduleHide()}),this._element,this._config.animation))}hide(){this._element.classList.contains(Rn)&&(ue.trigger(this._element,"hide.bs.toast").defaultPrevented||(this._element.classList.add(Ln),this._queueCallback((()=>{this._element.classList.add(Pn),this._element.classList.remove(Ln),this._element.classList.remove(Rn),ue.trigger(this._element,"hidden.bs.toast")}),this._element,this._config.animation)))}dispose(){this._clearTimeout(),this._element.classList.contains(Rn)&&this._element.classList.remove(Rn),super.dispose()}_getConfig(t){return t={...$n,..._e.getDataAttributes(this._element),..."object"==typeof t&&t?t:{}},Nt(On,t,this.constructor.DefaultType),t}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout((()=>{this.hide()}),this._config.delay)))}_onInteraction(t,e){switch(t.type){case"mouseover":case"mouseout":this._hasMouseInteraction=e;break;case"focusin":case"focusout":this._hasKeyboardInteraction=e}if(e)return void this._clearTimeout();const i=t.relatedTarget;this._element===i||this._element.contains(i)||this._maybeScheduleHide()}_setListeners(){ue.on(this._element,"mouseover.bs.toast",(t=>this._onInteraction(t,!0))),ue.on(this._element,"mouseout.bs.toast",(t=>this._onInteraction(t,!1))),ue.on(this._element,"focusin.bs.toast",(t=>this._onInteraction(t,!0))),ue.on(this._element,"focusout.bs.toast",(t=>this._onInteraction(t,!1)))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(t){return this.each((function(){const e=Dn.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t](this)}}))}}ge(Dn),qt(Dn),i(13);var Nn=i(466);const jn=new(i.n(Nn)());document.body.appendChild(jn.dom),requestAnimationFrame((function t(){jn.begin(),jn.end(),requestAnimationFrame(t)}))})()})();
//# sourceMappingURL=bundle.29a6740e24c3847885b5.js.map